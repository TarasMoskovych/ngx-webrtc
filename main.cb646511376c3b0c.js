"use strict";(self.webpackChunkngx_webrtc=self.webpackChunkngx_webrtc||[]).push([[792],{33:()=>{function Qp(e,t,n,i,r,o,s){try{var a=e[o](s),c=a.value}catch(l){return void n(l)}a.done?t(c):Promise.resolve(c).then(i,r)}function C(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function s(c){Qp(o,i,r,s,a,"next",c)}function a(c){Qp(o,i,r,s,a,"throw",c)}s(void 0)})}}let ai=null,U_=1;const Ul=Symbol("SIGNAL");function ut(e){const t=ai;return ai=e,t}function j1(e){if((!tf(e)||e.dirty)&&(e.dirty||e.lastCleanEpoch!==U_)){if(!e.producerMustRecompute(e)&&!GC(e))return e.dirty=!1,void(e.lastCleanEpoch=U_);e.producerRecomputeValue(e),e.dirty=!1,e.lastCleanEpoch=U_}}function GC(e){ru(e);for(let t=0;t<e.producerNode.length;t++){const n=e.producerNode[t],i=e.producerLastReadVersion[t];if(i!==n.version||(j1(n),i!==n.version))return!0}return!1}function V_(e,t){if(function $1(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),ru(e),1===e.liveConsumerNode.length)for(let i=0;i<e.producerNode.length;i++)V_(e.producerNode[i],e.producerIndexOfThis[i]);const n=e.liveConsumerNode.length-1;if(e.liveConsumerNode[t]=e.liveConsumerNode[n],e.liveConsumerIndexOfThis[t]=e.liveConsumerIndexOfThis[n],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,t<e.liveConsumerNode.length){const i=e.liveConsumerIndexOfThis[t],r=e.liveConsumerNode[t];ru(r),r.producerIndexOfThis[i]=t}}function tf(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function ru(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let X1=null;function Lt(e){return"function"==typeof e}function KC(e){const n=e(i=>{Error.call(i),i.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const qC=KC(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function B_(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class vi{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const o of n)o.remove(this);else n.remove(this);const{initialTeardown:i}=this;if(Lt(i))try{i()}catch(o){t=o instanceof qC?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{ex(o)}catch(s){t=t??[],s instanceof qC?t=[...t,...s.errors]:t.push(s)}}if(t)throw new qC(t)}}add(t){var n;if(t&&t!==this)if(this.closed)ex(t);else{if(t instanceof vi){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&B_(n,t)}remove(t){const{_finalizers:n}=this;n&&B_(n,t),t instanceof vi&&t._removeParent(this)}}vi.EMPTY=(()=>{const e=new vi;return e.closed=!0,e})();const J1=vi.EMPTY;function Q1(e){return e instanceof vi||e&&"closed"in e&&Lt(e.remove)&&Lt(e.add)&&Lt(e.unsubscribe)}function ex(e){Lt(e)?e():e.unsubscribe()}const Vl={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},j_={setTimeout(e,t,...n){const{delegate:i}=j_;return i?.setTimeout?i.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=j_;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function tx(e){j_.setTimeout(()=>{const{onUnhandledError:t}=Vl;if(!t)throw e;t(e)})}function YC(){}const VQ=$C("C",void 0,void 0);function $C(e,t,n){return{kind:e,value:t,error:n}}let Bl=null;function H_(e){if(Vl.useDeprecatedSynchronousErrorHandling){const t=!Bl;if(t&&(Bl={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:i}=Bl;if(Bl=null,n)throw i}}else e()}class XC extends vi{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Q1(t)&&t.add(this)):this.destination=KQ}static create(t,n,i){return new nf(t,n,i)}next(t){this.isStopped?JC(function jQ(e){return $C("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?JC(function BQ(e){return $C("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?JC(VQ,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const GQ=Function.prototype.bind;function ZC(e,t){return GQ.call(e,t)}class WQ{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(i){G_(i)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(i){G_(i)}else G_(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){G_(n)}}}class nf extends XC{constructor(t,n,i){let r;if(super(),Lt(t)||!t)r={next:t??void 0,error:n??void 0,complete:i??void 0};else{let o;this&&Vl.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&ZC(t.next,o),error:t.error&&ZC(t.error,o),complete:t.complete&&ZC(t.complete,o)}):r=t}this.destination=new WQ(r)}}function G_(e){Vl.useDeprecatedSynchronousErrorHandling?function HQ(e){Vl.useDeprecatedSynchronousErrorHandling&&Bl&&(Bl.errorThrown=!0,Bl.error=e)}(e):tx(e)}function JC(e,t){const{onStoppedNotification:n}=Vl;n&&j_.setTimeout(()=>n(e,t))}const KQ={closed:!0,next:YC,error:function zQ(e){throw e},complete:YC},QC="function"==typeof Symbol&&Symbol.observable||"@@observable";function Rc(e){return e}function nx(e){return 0===e.length?Rc:1===e.length?e[0]:function(n){return e.reduce((i,r)=>r(i),n)}}let Hn=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const i=new e;return i.source=this,i.operator=n,i}subscribe(n,i,r){const o=function $Q(e){return e&&e instanceof XC||function YQ(e){return e&&Lt(e.next)&&Lt(e.error)&&Lt(e.complete)}(e)&&Q1(e)}(n)?n:new nf(n,i,r);return H_(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return new(i=ix(i))((r,o)=>{const s=new nf({next:a=>{try{n(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(n){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(n)}[QC](){return this}pipe(...n){return nx(n)(this)}toPromise(n){return new(n=ix(n))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return e.create=t=>new e(t),e})();function ix(e){var t;return null!==(t=e??Vl.Promise)&&void 0!==t?t:Promise}const XQ=KC(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Tt=(()=>{class e extends Hn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const i=new rx(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new XQ}next(n){H_(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(n)}})}error(n){H_(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){H_(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:i,isStopped:r,observers:o}=this;return i||r?J1:(this.currentObservers=null,o.push(n),new vi(()=>{this.currentObservers=null,B_(o,n)}))}_checkFinalizedStatuses(n){const{hasError:i,thrownError:r,isStopped:o}=this;i?n.error(r):o&&n.complete()}asObservable(){const n=new Hn;return n.source=this,n}}return e.create=(t,n)=>new rx(t,n),e})();class rx extends Tt{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===i||i.call(n,t)}error(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===i||i.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,i;return null!==(i=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==i?i:J1}}class co extends Tt{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:i}=this;if(t)throw n;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}function ox(e){return Lt(e?.lift)}function ci(e){return t=>{if(ox(t))return t.lift(function(n){try{return e(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Gn(e,t,n,i,r){return new ZQ(e,t,n,i,r)}class ZQ extends XC{constructor(t,n,i,r,o,s){super(t),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=n?function(a){try{n(a)}catch(c){t.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function Ft(e,t){return ci((n,i)=>{let r=0;n.subscribe(Gn(i,o=>{i.next(e.call(t,o,r++))}))})}const sx="https://g.co/ng/security#xss";class W extends Error{constructor(t,n){super(function ou(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}(t,n)),this.code=t}}function Ga(e){return{toString:e}.toString()}const au="__parameters__";function lu(e,t,n){return Ga(()=>{const i=function eT(e){return function(...n){if(e){const i=e(...n);for(const r in i)this[r]=i[r]}}}(t);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(c,l,d){const u=c.hasOwnProperty(au)?c[au]:Object.defineProperty(c,au,{value:[]})[au];for(;u.length<=d;)u.push(null);return(u[d]=u[d]||[]).push(s),c}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}const Zt=globalThis;function rn(e){for(let t in e)if(e[t]===rn)return t;throw Error("Could not find renamed property on target object.")}function JQ(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Ri(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Ri).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function tT(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const QQ=rn({__forward_ref__:rn});function pn(e){return e.__forward_ref__=pn,e.toString=function(){return Ri(this())},e}function Ve(e){return z_(e)?e():e}function z_(e){return"function"==typeof e&&e.hasOwnProperty(QQ)&&e.__forward_ref__===pn}function ae(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function In(e){return{providers:e.providers||[],imports:e.imports||[]}}function K_(e){return dx(e,Y_)||dx(e,ux)}function dx(e,t){return e.hasOwnProperty(t)?e[t]:null}function q_(e){return e&&(e.hasOwnProperty(nT)||e.hasOwnProperty(oee))?e[nT]:null}const Y_=rn({\u0275prov:rn}),nT=rn({\u0275inj:rn}),ux=rn({ngInjectableDef:rn}),oee=rn({ngInjectorDef:rn});class re{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=ae({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function aT(e){return e&&!!e.\u0275providers}const rf=rn({\u0275cmp:rn}),cT=rn({\u0275dir:rn}),lT=rn({\u0275pipe:rn}),px=rn({\u0275mod:rn}),Wa=rn({\u0275fac:rn}),sf=rn({__NG_ELEMENT_ID__:rn}),fx=rn({__NG_ENV_ID__:rn});function Ke(e){return"string"==typeof e?e:null==e?"":String(e)}function dT(e,t){throw new W(-201,!1)}var Et=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(Et||{});let uT;function mx(){return uT}function Ur(e){const t=uT;return uT=e,t}function gx(e,t,n){const i=K_(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&Et.Optional?null:void 0!==t?t:void dT()}const af={},hT="__NG_DI_FLAG__",$_="ngTempTokenPath",uee=/\n/gm,_x="__source";let du;function Dc(e){const t=du;return du=e,t}function fee(e,t=Et.Default){if(void 0===du)throw new W(-203,!1);return null===du?gx(e,void 0,t):du.get(e,t&Et.Optional?null:void 0,t)}function Z(e,t=Et.Default){return(mx()||fee)(Ve(e),t)}function J(e,t=Et.Default){return Z(e,X_(t))}function X_(e){return typeof e>"u"||"number"==typeof e?e:(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function pT(e){const t=[];for(let n=0;n<e.length;n++){const i=Ve(e[n]);if(Array.isArray(i)){if(0===i.length)throw new W(900,!1);let r,o=Et.Default;for(let s=0;s<i.length;s++){const a=i[s],c=mee(a);"number"==typeof c?-1===c?r=a.token:o|=c:r=a}t.push(Z(r,o))}else t.push(Z(i))}return t}function cf(e,t){return e[hT]=t,e.prototype[hT]=t,e}function mee(e){return e[hT]}const Z_=cf(lu("Optional"),8),J_=cf(lu("SkipSelf"),4);function jl(e,t){return e.hasOwnProperty(Wa)?e[Wa]:null}function uu(e,t){e.forEach(n=>Array.isArray(n)?uu(n,t):t(n))}function Ex(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function Q_(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function ho(e,t,n){let i=hu(e,t);return i>=0?e[1|i]=n:(i=~i,function bx(e,t,n,i){let r=e.length;if(r==t)e.push(n,i);else if(1===r)e.push(i,e[0]),e[0]=n;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=n,e[t+1]=i}}(e,i,t,n)),i}function mT(e,t){const n=hu(e,t);if(n>=0)return e[1|n]}function hu(e,t){return function yx(e,t,n){let i=0,r=e.length>>n;for(;r!==i;){const o=i+(r-i>>1),s=e[o<<n];if(t===s)return o<<n;s>t?r=o:i=o+1}return~(r<<n)}(e,t,1)}const Ks={},Nt=[],Hl=new re(""),Sx=new re("",-1),gT=new re("");class tv{get(t,n=af){if(n===af){const i=new Error(`NullInjectorError: No provider for ${Ri(t)}!`);throw i.name="NullInjectorError",i}return n}}var nv=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(nv||{}),ms=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(ms||{}),we=function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e}(we||{});function See(e,t,n){let i=e.length;for(;;){const r=e.indexOf(t,n);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const o=t.length;if(r+o===i||e.charCodeAt(r+o)<=32)return r}n=r+1}}function _T(e,t,n){let i=0;for(;i<n.length;){const r=n[i];if("number"==typeof r){if(0!==r)break;i++;const o=n[i++],s=n[i++],a=n[i++];e.setAttribute(t,s,a,o)}else{const o=r,s=n[++i];Tx(o)?e.setProperty(t,o,s):e.setAttribute(t,o,s),i++}}return i}function Cx(e){return 3===e||4===e||6===e}function Tx(e){return 64===e.charCodeAt(0)}function lf(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?n=r:0===n||wx(e,n,r,null,-1===n||2===n?t[++i]:null)}}return e}function wx(e,t,n,i,r){let o=0,s=e.length;if(-1===t)s=-1;else for(;o<e.length;){const a=e[o++];if("number"==typeof a){if(a===t){s=-1;break}if(a>t){s=o-1;break}}}for(;o<e.length;){const a=e[o];if("number"==typeof a)break;if(a===n){if(null===i)return void(null!==r&&(e[o+1]=r));if(i===e[o+1])return void(e[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(e.splice(s,0,t),o=s+1),e.splice(o++,0,n),null!==i&&e.splice(o++,0,i),null!==r&&e.splice(o++,0,r)}const Ix="ng-template";function Cee(e,t,n,i){let r=0;if(i){for(;r<t.length&&"string"==typeof t[r];r+=2)if("class"===t[r]&&-1!==See(t[r+1].toLowerCase(),n,0))return!0}else if(vT(e))return!1;if(r=t.indexOf(1,r),r>-1){let o;for(;++r<t.length&&"string"==typeof(o=t[r]);)if(o.toLowerCase()===n)return!0}return!1}function vT(e){return 4===e.type&&e.value!==Ix}function Tee(e,t,n){return t===(4!==e.type||n?e.value:Ix)}function wee(e,t,n){let i=4;const r=e.attrs,o=null!==r?function Aee(e){for(let t=0;t<e.length;t++)if(Cx(e[t]))return t;return e.length}(r):0;let s=!1;for(let a=0;a<t.length;a++){const c=t[a];if("number"!=typeof c){if(!s)if(4&i){if(i=2|1&i,""!==c&&!Tee(e,c,n)||""===c&&1===t.length){if(gs(i))return!1;s=!0}}else if(8&i){if(null===r||!Cee(e,r,c,n)){if(gs(i))return!1;s=!0}}else{const l=t[++a],d=Iee(c,r,vT(e),n);if(-1===d){if(gs(i))return!1;s=!0;continue}if(""!==l){let u;if(u=d>o?"":r[d+1].toLowerCase(),2&i&&l!==u){if(gs(i))return!1;s=!0}}}}else{if(!s&&!gs(i)&&!gs(c))return!1;if(s&&gs(c))continue;s=!1,i=c|1&i}}return gs(i)||s}function gs(e){return!(1&e)}function Iee(e,t,n,i){if(null===t)return-1;let r=0;if(i||!n){let o=!1;for(;r<t.length;){const s=t[r];if(s===e)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=t[++r];for(;"string"==typeof a;)a=t[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function Dee(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const i=e[n];if("number"==typeof i)return-1;if(i===t)return n;n++}return-1}(t,e)}function Rx(e,t,n=!1){for(let i=0;i<t.length;i++)if(wee(e,t[i],n))return!0;return!1}function Oee(e,t){e:for(let n=0;n<t.length;n++){const i=t[n];if(e.length===i.length){for(let r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function Ax(e,t){return e?":not("+t.trim()+")":t}function Nee(e){let t=e[0],n=1,i=2,r="",o=!1;for(;n<e.length;){let s=e[n];if("string"==typeof s)if(2&i){const a=e[++n];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!gs(s)&&(t+=Ax(o,r),r=""),i=s,o=o||!gs(i);n++}return""!==r&&(t+=Ax(o,r)),t}function sr(e){return Ga(()=>{const t=Ox(e),n={...t,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===nv.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||ms.Emulated,styles:e.styles||Nt,_:null,schemas:e.schemas||null,tView:null,id:""};Nx(n);const i=e.dependencies;return n.directiveDefs=iv(i,!1),n.pipeDefs=iv(i,!0),n.id=function Fee(e){let t=0;const n=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const r of n)t=Math.imul(31,t)+r.charCodeAt(0)|0;return t+=2147483648,"c"+t}(n),n})}function xee(e){return mt(e)||Ai(e)}function kee(e){return null!==e}function xn(e){return Ga(()=>({type:e.type,bootstrap:e.bootstrap||Nt,declarations:e.declarations||Nt,imports:e.imports||Nt,exports:e.exports||Nt,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function Dx(e,t){if(null==e)return Ks;const n={};for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];let o,s,a=we.None;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o):(o=r,s=r),t?(n[o]=a!==we.None?[i,a]:i,t[o]=s):n[o]=i}return n}function ye(e){return Ga(()=>{const t=Ox(e);return Nx(t),t})}function Br(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,standalone:!0===e.standalone,onDestroy:e.type.prototype.ngOnDestroy||null}}function mt(e){return e[rf]||null}function Ai(e){return e[cT]||null}function Ji(e){return e[lT]||null}function ar(e,t){const n=e[px]||null;if(!n&&!0===t)throw new Error(`Type ${Ri(e)} does not have '\u0275mod' property.`);return n}function Ox(e){const t={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:e.inputs||Ks,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||Nt,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Dx(e.inputs,t),outputs:Dx(e.outputs),debugInfo:null}}function Nx(e){e.features?.forEach(t=>t(e))}function iv(e,t){if(!e)return null;const n=t?Ji:xee;return()=>("function"==typeof e?e():e).map(i=>n(i)).filter(kee)}function Uee(...e){return{\u0275providers:ET(0,e),\u0275fromNgModule:!0}}function ET(e,...t){const n=[],i=new Set;let r;const o=s=>{n.push(s)};return uu(t,s=>{const a=s;ov(a,o,[],i)&&(r||=[],r.push(a))}),void 0!==r&&Px(r,o),n}function Px(e,t){for(let n=0;n<e.length;n++){const{ngModule:i,providers:r}=e[n];bT(r,o=>{t(o,i)})}}function ov(e,t,n,i){if(!(e=Ve(e)))return!1;let r=null,o=q_(e);const s=!o&&mt(e);if(o||s){if(s&&!s.standalone)return!1;r=e}else{const c=e.ngModule;if(o=q_(c),!o)return!1;r=c}const a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){const c="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const l of c)ov(l,t,n,i)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let l;i.add(r);try{uu(o.imports,d=>{ov(d,t,n,i)&&(l||=[],l.push(d))})}finally{}void 0!==l&&Px(l,t)}if(!a){const l=jl(r)||(()=>new r);t({provide:r,useFactory:l,deps:Nt},r),t({provide:gT,useValue:r,multi:!0},r),t({provide:Hl,useValue:()=>Z(r),multi:!0},r)}const c=o.providers;if(null!=c&&!a){const l=e;bT(c,d=>{t(d,l)})}}}return r!==e&&void 0!==e.providers}function bT(e,t){for(let n of e)aT(n)&&(n=n.\u0275providers),Array.isArray(n)?bT(n,t):t(n)}const Vee=rn({provide:String,useValue:rn});function yT(e){return null!==e&&"object"==typeof e&&Vee in e}function Gl(e){return"function"==typeof e}const ST=new re(""),sv={},jee={};let CT;function av(){return void 0===CT&&(CT=new tv),CT}class jr{}class pu extends jr{get destroyed(){return this._destroyed}constructor(t,n,i,r){super(),this.parent=n,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,wT(t,s=>this.processProvider(s)),this.records.set(Sx,fu(void 0,this)),r.has("environment")&&this.records.set(jr,fu(void 0,this));const o=this.records.get(ST);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(gT,Nt,Et.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const t=ut(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of n)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ut(t)}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const n=Dc(this),i=Ur(void 0);try{return t()}finally{Dc(n),Ur(i)}}get(t,n=af,i=Et.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(fx))return t[fx](this);i=X_(i);const o=Dc(this),s=Ur(void 0);try{if(!(i&Et.SkipSelf)){let c=this.records.get(t);if(void 0===c){const l=function Kee(e){return"function"==typeof e||"object"==typeof e&&e instanceof re}(t)&&K_(t);c=l&&this.injectableDefInScope(l)?fu(TT(t),sv):null,this.records.set(t,c)}if(null!=c)return this.hydrate(t,c)}return(i&Et.Self?av():this.parent).get(t,n=i&Et.Optional&&n===af?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[$_]=a[$_]||[]).unshift(Ri(t)),o)throw a;return function gee(e,t,n,i){const r=e[$_];throw t[_x]&&r.unshift(t[_x]),e.message=function _ee(e,t,n,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let r=Ri(t);if(Array.isArray(t))r=t.map(Ri).join(" -> ");else if("object"==typeof t){let o=[];for(let s in t)if(t.hasOwnProperty(s)){let a=t[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):Ri(a)))}r=`{${o.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${e.replace(uee,"\n  ")}`}("\n"+e.message,r,n,i),e.ngTokenPath=r,e[$_]=null,e}(a,t,"R3InjectorError",this.source)}throw a}finally{Ur(s),Dc(o)}}resolveInjectorInitializers(){const t=ut(null),n=Dc(this),i=Ur(void 0);try{const o=this.get(Hl,Nt,Et.Self);for(const s of o)s()}finally{Dc(n),Ur(i),ut(t)}}toString(){const t=[],n=this.records;for(const i of n.keys())t.push(Ri(i));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new W(205,!1)}processProvider(t){let n=Gl(t=Ve(t))?t:Ve(t&&t.provide);const i=function Gee(e){return yT(e)?fu(void 0,e.useValue):fu(kx(e),sv)}(t);if(!Gl(t)&&!0===t.multi){let r=this.records.get(n);r||(r=fu(void 0,sv,!0),r.factory=()=>pT(r.multi),this.records.set(n,r)),n=t,r.multi.push(t)}this.records.set(n,i)}hydrate(t,n){const i=ut(null);try{return n.value===sv&&(n.value=jee,n.value=n.factory()),"object"==typeof n.value&&n.value&&function zee(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{ut(i)}}injectableDefInScope(t){if(!t.providedIn)return!1;const n=Ve(t.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(t){const n=this._onDestroyHooks.indexOf(t);-1!==n&&this._onDestroyHooks.splice(n,1)}}function TT(e){const t=K_(e),n=null!==t?t.factory:jl(e);if(null!==n)return n;if(e instanceof re)throw new W(204,!1);if(e instanceof Function)return function Hee(e){if(e.length>0)throw new W(204,!1);const n=function ree(e){return e&&(e[Y_]||e[ux])||null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new W(204,!1)}function kx(e,t,n){let i;if(Gl(e)){const r=Ve(e);return jl(r)||TT(r)}if(yT(e))i=()=>Ve(e.useValue);else if(function xx(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...pT(e.deps||[]));else if(function Mx(e){return!(!e||!e.useExisting)}(e))i=()=>Z(Ve(e.useExisting));else{const r=Ve(e&&(e.useClass||e.provide));if(!function Wee(e){return!!e.deps}(e))return jl(r)||TT(r);i=()=>new r(...pT(e.deps))}return i}function fu(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function wT(e,t){for(const n of e)Array.isArray(n)?wT(n,t):n&&aT(n)?wT(n.\u0275providers,t):t(n)}function za(e,t){e instanceof pu&&e.assertNotDestroyed();const i=Dc(e),r=Ur(void 0);try{return t()}finally{Dc(i),Ur(r)}}function Lx(){return void 0!==mx()||null!=function pee(){return du}()}const Un=0,se=1,Se=2,li=3,_s=4,cr=5,po=6,gu=7,Rn=8,Ei=9,vs=10,Be=11,uf=12,Ux=13,_u=14,Wn=15,hf=16,vu=17,Ka=18,pf=19,Vx=20,Nc=21,dv=22,Wl=23,qe=25,RT=1,qs=7,Eu=9,di=10;var AT=function(e){return e[e.None=0]="None",e[e.HasTransplantedViews=2]="HasTransplantedViews",e}(AT||{});function lr(e){return Array.isArray(e)&&"object"==typeof e[RT]}function dr(e){return Array.isArray(e)&&!0===e[RT]}function DT(e){return!!(4&e.flags)}function zl(e){return e.componentOffset>-1}function hv(e){return!(1&~e.flags)}function Es(e){return!!e.template}function OT(e){return!!(512&e[Se])}class ote{constructor(t,n,i){this.previousValue=t,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}}function Gx(e,t,n,i){null!==t?t.applyValueToInputSignal(t,i):e[n]=i}function Hr(){return Wx}function Wx(e){return e.type.prototype.ngOnChanges&&(e.setInput=ate),ste}function ste(){const e=Kx(this),t=e?.current;if(t){const n=e.previous;if(n===Ks)e.previous=t;else for(let i in t)n[i]=t[i];e.current=null,this.ngOnChanges(t)}}function ate(e,t,n,i,r){const o=this.declaredInputs[i],s=Kx(e)||function cte(e,t){return e[zx]=t}(e,{previous:Ks,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[o];a[o]=new ote(l&&l.currentValue,n,c===Ks),Gx(e,t,r,n)}Hr.ngInherit=!0;const zx="__ngSimpleChanges__";function Kx(e){return e[zx]||null}const Ys=function(e,t,n){},qx="svg";let $x=!1;function fn(e){for(;Array.isArray(e);)e=e[Un];return e}function mf(e,t){return fn(t[e])}function yr(e,t){return fn(t[e.index])}function gf(e,t){return e.data[t]}function bu(e,t){return e[t]}function fo(e,t){const n=t[e];return lr(n)?n:n[Un]}function kT(e){return!(128&~e[Se])}function $s(e,t){return null==t?null:e[t]}function Xx(e){e[vu]=0}function fte(e){1024&e[Se]||(e[Se]|=1024,kT(e)&&_f(e))}function LT(e){return!!(9216&e[Se]||e[Wl]?.dirty)}function FT(e){e[vs].changeDetectionScheduler?.notify(1),LT(e)?_f(e):64&e[Se]&&(function dte(){return $x}()?(e[Se]|=1024,_f(e)):e[vs].changeDetectionScheduler?.notify())}function _f(e){e[vs].changeDetectionScheduler?.notify();let t=Kl(e);for(;null!==t&&!(8192&t[Se])&&(t[Se]|=8192,kT(t));)t=Kl(t)}function pv(e,t){if(!(256&~e[Se]))throw new W(911,!1);null===e[Nc]&&(e[Nc]=[]),e[Nc].push(t)}function Kl(e){const t=e[li];return dr(t)?t[li]:t}const je={lFrame:sk(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Qx(){return je.bindingsEnabled}function yu(){return null!==je.skipHydrationRootTNode}function K(){return je.lFrame.lView}function bt(){return je.lFrame.tView}function Gr(e){return je.lFrame.contextLView=e,e[Rn]}function Wr(e){return je.lFrame.contextLView=null,e}function on(){let e=ek();for(;null!==e&&64===e.type;)e=e.parent;return e}function ek(){return je.lFrame.currentTNode}function Xs(e,t){const n=je.lFrame;n.currentTNode=e,n.isParent=t}function VT(){return je.lFrame.isParent}function BT(){je.lFrame.isParent=!1}function Sr(){const e=je.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function bs(){return je.lFrame.bindingIndex++}function Ya(e){const t=je.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function wte(e,t){const n=je.lFrame;n.bindingIndex=n.bindingRootIndex=e,jT(t)}function jT(e){je.lFrame.currentDirectiveIndex=e}function GT(){return je.lFrame.currentQueryIndex}function fv(e){je.lFrame.currentQueryIndex=e}function Rte(e){const t=e[se];return 2===t.type?t.declTNode:1===t.type?e[cr]:null}function rk(e,t,n){if(n&Et.SkipSelf){let r=t,o=e;for(;!(r=r.parent,null!==r||n&Et.Host||(r=Rte(o),null===r||(o=o[_u],10&r.type))););if(null===r)return!1;t=r,e=o}const i=je.lFrame=ok();return i.currentTNode=t,i.lView=e,!0}function WT(e){const t=ok(),n=e[se];je.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function ok(){const e=je.lFrame,t=null===e?null:e.child;return null===t?sk(e):t}function sk(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function ak(){const e=je.lFrame;return je.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const ck=ak;function zT(){const e=ak();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function ur(){return je.lFrame.selectedIndex}function ql(e){je.lFrame.selectedIndex=e}function An(){const e=je.lFrame;return gf(e.tView,e.selectedIndex)}function ys(){je.lFrame.currentNamespace=qx}function Pc(){!function Ote(){je.lFrame.currentNamespace=null}()}let dk=!0;function Ef(){return dk}function Zs(e){dk=e}function mv(e,t){for(let n=t.directiveStart,i=t.directiveEnd;n<i;n++){const o=e.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=o;s&&(e.contentHooks??=[]).push(-n,s),a&&((e.contentHooks??=[]).push(n,a),(e.contentCheckHooks??=[]).push(n,a)),c&&(e.viewHooks??=[]).push(-n,c),l&&((e.viewHooks??=[]).push(n,l),(e.viewCheckHooks??=[]).push(n,l)),null!=d&&(e.destroyHooks??=[]).push(n,d)}}function gv(e,t,n){uk(e,t,3,n)}function _v(e,t,n,i){(3&e[Se])===n&&uk(e,t,n,i)}function KT(e,t){let n=e[Se];(3&n)===t&&(n&=16383,n+=1,e[Se]=n)}function uk(e,t,n,i){const o=i??-1,s=t.length-1;let a=0;for(let c=void 0!==i?65535&e[vu]:0;c<s;c++)if("number"==typeof t[c+1]){if(a=t[c],null!=i&&a>=i)break}else t[c]<0&&(e[vu]+=65536),(a<o||-1==o)&&(Pte(e,n,t,c),e[vu]=(4294901760&e[vu])+c+2),c++}function hk(e,t){Ys(4,e,t);const n=ut(null);try{t.call(e)}finally{ut(n),Ys(5,e,t)}}function Pte(e,t,n,i){const r=n[i]<0,o=n[i+1],a=e[r?-n[i]:n[i]];r?e[Se]>>14<e[vu]>>16&&(3&e[Se])===t&&(e[Se]+=16384,hk(a,o)):hk(a,o)}const Su=-1;class bf{constructor(t,n,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}}function YT(e){return e!==Su}function yf(e){return 32767&e}function Sf(e,t){let n=function Fte(e){return e>>16}(e),i=t;for(;n>0;)i=i[_u],n--;return i}let $T=!0;function vv(e){const t=$T;return $T=e,t}const pk=255,fk=5;let Ute=0;const Js={};function Ev(e,t){const n=mk(e,t);if(-1!==n)return n;const i=t[se];i.firstCreatePass&&(e.injectorIndex=t.length,XT(i.data,e),XT(t,null),XT(i.blueprint,null));const r=bv(e,t),o=e.injectorIndex;if(YT(r)){const s=yf(r),a=Sf(r,t),c=a[se].data;for(let l=0;l<8;l++)t[o+l]=a[s+l]|c[s+l]}return t[o+8]=r,o}function XT(e,t){e.push(0,0,0,0,0,0,0,0,t)}function mk(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function bv(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,i=null,r=t;for(;null!==r;){if(i=Sk(r),null===i)return Su;if(n++,r=r[_u],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return Su}function ZT(e,t,n){!function Vte(e,t,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(sf)&&(i=n[sf]),null==i&&(i=n[sf]=Ute++);const r=i&pk;t.data[e+(r>>fk)]|=1<<r}(e,t,n)}function gk(e,t,n){if(n&Et.Optional||void 0!==e)return e;dT()}function _k(e,t,n,i){if(n&Et.Optional&&void 0===i&&(i=null),!(n&(Et.Self|Et.Host))){const r=e[Ei],o=Ur(void 0);try{return r?r.get(t,i,n&Et.Optional):gx(t,i,n&Et.Optional)}finally{Ur(o)}}return gk(i,0,n)}function vk(e,t,n,i=Et.Default,r){if(null!==e){if(2048&t[Se]&&!(i&Et.Self)){const s=function Wte(e,t,n,i,r){let o=e,s=t;for(;null!==o&&null!==s&&2048&s[Se]&&!(512&s[Se]);){const a=Ek(o,s,n,i|Et.Self,Js);if(a!==Js)return a;let c=o.parent;if(!c){const l=s[Vx];if(l){const d=l.get(n,Js,i);if(d!==Js)return d}c=Sk(s),s=s[_u]}o=c}return r}(e,t,n,i,Js);if(s!==Js)return s}const o=Ek(e,t,n,i,Js);if(o!==Js)return o}return _k(t,n,i,r)}function Ek(e,t,n,i,r){const o=function Hte(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(sf)?e[sf]:void 0;return"number"==typeof t?t>=0?t&pk:Gte:t}(n);if("function"==typeof o){if(!rk(t,e,i))return i&Et.Host?gk(r,0,i):_k(t,n,i,r);try{let s;if(s=o(i),null!=s||i&Et.Optional)return s;dT()}finally{ck()}}else if("number"==typeof o){let s=null,a=mk(e,t),c=Su,l=i&Et.Host?t[Wn][cr]:null;for((-1===a||i&Et.SkipSelf)&&(c=-1===a?bv(e,t):t[a+8],c!==Su&&yk(i,!1)?(s=t[se],a=yf(c),t=Sf(c,t)):a=-1);-1!==a;){const d=t[se];if(bk(o,a,d.data)){const u=jte(a,t,n,s,i,l);if(u!==Js)return u}c=t[a+8],c!==Su&&yk(i,t[se].data[a+8]===l)&&bk(o,a,t)?(s=d,a=yf(c),t=Sf(c,t)):a=-1}}return r}function jte(e,t,n,i,r,o){const s=t[se],a=s.data[e+8],d=yv(a,s,n,null==i?zl(a)&&$T:i!=s&&!!(3&a.type),r&Et.Host&&o===a);return null!==d?Yl(t,s,d,a):Js}function yv(e,t,n,i,r){const o=e.providerIndexes,s=t.data,a=1048575&o,c=e.directiveStart,d=o>>20,h=r?a+d:e.directiveEnd;for(let p=i?a:a+d;p<h;p++){const m=s[p];if(p<c&&n===m||p>=c&&m.type===n)return p}if(r){const p=s[c];if(p&&Es(p)&&p.type===n)return c}return null}function Yl(e,t,n,i){let r=e[n];const o=t.data;if(function Mte(e){return e instanceof bf}(r)){const s=r;s.resolving&&function cee(e,t){throw t&&t.join(" > "),new W(-200,e)}(function Gt(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Ke(e)}(o[n]));const a=vv(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?Ur(s.injectImpl):null;rk(e,i,Et.Default);try{r=e[n]=s.factory(void 0,o,e,i),t.firstCreatePass&&n>=i.directiveStart&&function Nte(e,t,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=t.type.prototype;if(i){const s=Wx(t);(n.preOrderHooks??=[]).push(e,s),(n.preOrderCheckHooks??=[]).push(e,s)}r&&(n.preOrderHooks??=[]).push(0-e,r),o&&((n.preOrderHooks??=[]).push(e,o),(n.preOrderCheckHooks??=[]).push(e,o))}(n,o[n],t)}finally{null!==l&&Ur(l),vv(a),s.resolving=!1,ck()}}return r}function bk(e,t,n){return!!(n[t+(e>>fk)]&1<<e)}function yk(e,t){return!(e&Et.Self||e&Et.Host&&t)}class Oi{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,i){return vk(this._tNode,this._lView,t,X_(i),n)}}function Gte(){return new Oi(on(),K())}function bi(e){return Ga(()=>{const t=e.prototype.constructor,n=t[Wa]||JT(t),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const o=r[Wa]||JT(r);if(o&&o!==n)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function JT(e){return z_(e)?()=>{const t=JT(Ve(e));return t&&t()}:jl(e)}function Sk(e){const t=e[se],n=t.type;return 2===n?t.declTNode:1===n?e[cr]:null}function Rk(e,t=null,n=null,i){const r=Ak(e,t,n,i);return r.resolveInjectorInitializers(),r}function Ak(e,t=null,n=null,i,r=new Set){const o=[n||Nt,Uee(e)];return i=i||("object"==typeof e?void 0:Ri(e)),new pu(o,t||av(),i||null,r)}let Bi=(()=>{class e{static{this.THROW_IF_NOT_FOUND=af}static{this.NULL=new tv}static create(n,i){if(Array.isArray(n))return Rk({name:""},i,n,"");{const r=n.name??"";return Rk({name:r},n.parent,n.providers,r)}}static{this.\u0275prov=ae({token:e,providedIn:"any",factory:()=>Z(Sx)})}static{this.__NG_ELEMENT_ID__=-1}}return e})();function e0(e){return e.ngOriginalError}class Qs{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t);this._console.error("ERROR",t),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&e0(t);for(;n&&e0(n);)n=e0(n);return n||null}}const Ok=new re("",{providedIn:"root",factory:()=>J(Qs).handleError.bind(void 0)});let Iu=(()=>{class e{static{this.__NG_ELEMENT_ID__=Qte}static{this.__NG_ENV_ID__=n=>n}}return e})();class Jte extends Iu{constructor(t){super(),this._lView=t}onDestroy(t){return pv(this._lView,t),()=>function UT(e,t){if(null===e[Nc])return;const n=e[Nc].indexOf(t);-1!==n&&e[Nc].splice(n,1)}(this._lView,t)}}function Qte(){return new Jte(K())}function ene(){return Ru(on(),K())}function Ru(e,t){return new sn(yr(e,t))}let sn=(()=>{class e{constructor(n){this.nativeElement=n}static{this.__NG_ELEMENT_ID__=ene}}return e})();function Pk(e){return e instanceof sn?e.nativeElement:e}function t0(e){return t=>{setTimeout(e,void 0,t)}}const Wt=class tne extends Tt{constructor(t=!1){super(),this.destroyRef=void 0,this.__isAsync=t,Lx()&&(this.destroyRef=J(Iu,{optional:!0})??void 0)}emit(t){const n=ut(null);try{super.next(t)}finally{ut(n)}}subscribe(t,n,i){let r=t,o=n||(()=>null),s=i;if(t&&"object"==typeof t){const c=t;r=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=t0(o),r&&(r=t0(r)),s&&(s=t0(s)));const a=super.subscribe({next:r,error:o,complete:s});return t instanceof vi&&t.add(a),a}};function nne(){return this._results[Symbol.iterator]()}class Cf{get changes(){return this._changes??=new Wt}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const n=Cf.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=nne)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){this.dirty=!1;const i=function Vr(e){return e.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function yee(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],o=t[i];if(n&&(r=n(r),o=n(o)),o!==r)return!1}return!0}(this._results,i,n))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(t){this._onDirty=t}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function Cv(e){return!(128&~e.flags)}const n0=new Map;let rne=0;const o0="__ngContext__";function hr(e,t){lr(t)?(e[o0]=t[pf],function sne(e){n0.set(e[pf],e)}(t)):e[o0]=t}function Hk(e){return Wk(e[uf])}function Gk(e){return Wk(e[_s])}function Wk(e){for(;null!==e&&!dr(e);)e=e[_s];return e}let s0;const If=new re("",{providedIn:"root",factory:()=>Tne}),Tne="ng",Jk=new re(""),xc=new re("",{providedIn:"platform",factory:()=>"unknown"}),$a=new re(""),a0=new re("",{providedIn:"root",factory:()=>function Mc(){if(void 0!==s0)return s0;if(typeof document<"u")return document;throw new W(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Qk=()=>null;function m0(e,t,n=!1){return Qk(e,t,n)}const rL=new re("",{providedIn:"root",factory:()=>!1});class lL{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${sx})`}}function kc(e){return e instanceof lL?e.changingThisBreaksApplicationSecurity:e}const qne=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var Nu=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(Nu||{});function w0(e){const t=function Mf(){const e=K();return e&&e[vs].sanitizer}();return t?t.sanitize(Nu.URL,e)||"":function Nf(e,t){const n=function Gne(e){return e instanceof lL&&e.getTypeName()||null}(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see ${sx})`)}return n===t}(e,"URL")?kc(e):function y0(e){return(e=String(e)).match(qne)?e:"unsafe:"+e}(Ke(e))}const lie=/^>|^->|<!--|-->|--!>|<!-$/g,die=/(<|>)/g,uie="\u200b$1\u200b";function mo(e){return e instanceof Function?e():e}var Lc=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Lc||{});let D0;function O0(e,t){return D0(e,t)}function Mu(e,t,n,i,r){if(null!=i){let o,s=!1;dr(i)?o=i:lr(i)&&(s=!0,i=i[Un]);const a=fn(i);0===e&&null!==n?null==r?NL(t,n,a):$l(t,n,a,r||null,!0):1===e&&null!==n?$l(t,n,a,r||null,!0):2===e?function Lf(e,t,n){const i=Vv(e,t);i&&function Oie(e,t,n,i){e.removeChild(t,n,i)}(e,i,t,n)}(t,a,s):3===e&&t.destroyNode(a),null!=o&&function Mie(e,t,n,i,r){const o=n[qs];o!==fn(n)&&Mu(t,e,i,o,r);for(let a=di;a<n.length;a++){const c=n[a];jv(c[se],c,e,t,i,o)}}(t,e,o,n,r)}}function P0(e,t){return e.createComment(function bL(e){return e.replace(lie,t=>t.replace(die,uie))}(t))}function Fv(e,t,n){return e.createElement(t,n)}function AL(e,t){t[vs].changeDetectionScheduler?.notify(1),jv(e,t,t[Be],2,null,null)}function DL(e,t){const n=e[Eu],i=n.indexOf(t);n.splice(i,1)}function xf(e,t){if(e.length<=di)return;const n=di+t,i=e[n];if(i){const r=i[hf];null!==r&&r!==e&&DL(r,i),t>0&&(e[n-1][_s]=i[_s]);const o=Q_(e,di+t);!function Cie(e,t){AL(e,t),t[Un]=null,t[cr]=null}(i[se],i);const s=o[Ka];null!==s&&s.detachView(o[se]),i[li]=null,i[_s]=null,i[Se]&=-129}return i}function Uv(e,t){if(!(256&t[Se])){const n=t[Be];n.destroyNode&&jv(e,t,n,3,null,null),function wie(e){let t=e[uf];if(!t)return M0(e[se],e);for(;t;){let n=null;if(lr(t))n=t[uf];else{const i=t[di];i&&(n=i)}if(!n){for(;t&&!t[_s]&&t!==e;)lr(t)&&M0(t[se],t),t=t[li];null===t&&(t=e),lr(t)&&M0(t[se],t),n=t&&t[_s]}t=n}}(t)}}function M0(e,t){if(256&t[Se])return;const n=ut(null);try{t[Se]&=-129,t[Se]|=256,t[Wl]&&function q1(e){if(ru(e),tf(e))for(let t=0;t<e.producerNode.length;t++)V_(e.producerNode[t],e.producerIndexOfThis[t]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}(t[Wl]),function Die(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let i=0;i<n.length;i+=2){const r=t[n[i]];if(!(r instanceof bf)){const o=n[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],c=o[s+1];Ys(4,a,c);try{c.call(a)}finally{Ys(5,a,c)}}else{Ys(4,r,o);try{o.call(r)}finally{Ys(5,r,o)}}}}}(e,t),function Aie(e,t){const n=e.cleanup,i=t[gu];if(null!==n)for(let o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){const s=n[o+3];s>=0?i[s]():i[-s].unsubscribe(),o+=2}else n[o].call(i[n[o+1]]);null!==i&&(t[gu]=null);const r=t[Nc];if(null!==r){t[Nc]=null;for(let o=0;o<r.length;o++)(0,r[o])()}}(e,t),1===t[se].type&&t[Be].destroy();const i=t[hf];if(null!==i&&dr(t[li])){i!==t[li]&&DL(i,t);const r=t[Ka];null!==r&&r.detachView(e)}!function ane(e){n0.delete(e[pf])}(t)}finally{ut(n)}}function x0(e,t,n){return function OL(e,t,n){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return n[Un];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:o}=e.data[i.directiveStart+r];if(o===ms.None||o===ms.Emulated)return null}return yr(i,n)}}(e,t.parent,n)}function $l(e,t,n,i,r){e.insertBefore(t,n,i,r)}function NL(e,t,n){e.appendChild(t,n)}function PL(e,t,n,i,r){null!==i?$l(e,t,n,i,r):NL(e,t,n)}function Vv(e,t){return e.parentNode(t)}function ML(e,t,n){return kL(e,t,n)}let k0,kL=function xL(e,t,n){return 40&e.type?yr(e,n):null};function Bv(e,t,n,i){const r=x0(e,i,t),o=t[Be],a=ML(i.parent||t[cr],i,t);if(null!=r)if(Array.isArray(n))for(let c=0;c<n.length;c++)PL(o,r,n[c],a,!1);else PL(o,r,n,a,!1);void 0!==k0&&k0(o,i,t,n,r)}function kf(e,t){if(null!==t){const n=t.type;if(3&n)return yr(t,e);if(4&n)return L0(-1,e[t.index]);if(8&n){const i=t.child;if(null!==i)return kf(e,i);{const r=e[t.index];return dr(r)?L0(-1,r):fn(r)}}if(32&n)return O0(t,e)()||fn(e[t.index]);{const i=FL(e,t);return null!==i?Array.isArray(i)?i[0]:kf(Kl(e[Wn]),i):kf(e,t.next)}}return null}function FL(e,t){return null!==t?e[Wn][cr].projection[t.projection]:null}function L0(e,t){const n=di+e+1;if(n<t.length){const i=t[n],r=i[se].firstChild;if(null!==r)return kf(i,r)}return t[qs]}function F0(e,t,n,i,r,o,s){for(;null!=n;){const a=i[n.index],c=n.type;if(s&&0===t&&(a&&hr(fn(a),i),n.flags|=2),32&~n.flags)if(8&c)F0(e,t,n.child,i,r,o,!1),Mu(t,e,r,a,o);else if(32&c){const l=O0(n,i);let d;for(;d=l();)Mu(t,e,r,d,o);Mu(t,e,r,a,o)}else 16&c?VL(e,t,i,n,r,o):Mu(t,e,r,a,o);n=s?n.projectionNext:n.next}}function jv(e,t,n,i,r,o){F0(n,i,e.firstChild,t,r,o,!1)}function VL(e,t,n,i,r,o){const s=n[Wn],c=s[cr].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)Mu(t,e,r,c[l],o);else{let l=c;const d=s[li];Cv(i)&&(l.flags|=128),F0(e,t,l,d,r,o,!0)}}function BL(e,t,n){""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}function jL(e,t,n){const{mergedAttrs:i,classes:r,styles:o}=n;null!==i&&_T(e,t,i),null!==r&&BL(e,t,r),null!==o&&function kie(e,t,n){e.setAttribute(t,"style",n)}(e,t,o)}const Je={};function Re(e=1){HL(bt(),K(),ur()+e,!1)}function HL(e,t,n,i){if(!i)if(3&~t[Se]){const o=e.preOrderHooks;null!==o&&_v(t,o,0,n)}else{const o=e.preOrderCheckHooks;null!==o&&gv(t,o,n)}ql(n)}function H(e,t=Et.Default){const n=K();return null===n?Z(e,t):vk(on(),n,Ve(e),t)}function U0(){throw new Error("invalid")}function GL(e,t,n,i,r,o){const s=ut(null);try{let a=null;r&we.SignalBased&&(a=t[i][Ul]),null!==a&&void 0!==a.transformFn&&(o=a.transformFn(o)),r&we.HasDecoratorInputTransform&&(o=e.inputTransforms[i].call(t,o)),null!==e.setInput?e.setInput(t,a,o,n,i):Gx(t,a,i,o)}finally{ut(s)}}function Hv(e,t,n,i,r,o,s,a,c,l,d){const u=t.blueprint.slice();return u[Un]=r,u[Se]=204|i,(null!==l||e&&2048&e[Se])&&(u[Se]|=2048),Xx(u),u[li]=u[_u]=e,u[Rn]=n,u[vs]=s||e&&e[vs],u[Be]=a||e&&e[Be],u[Ei]=c||e&&e[Ei]||null,u[cr]=o,u[pf]=function one(){return rne++}(),u[po]=d,u[Vx]=l,u[Wn]=2==t.type?e[Wn]:u,u}function xu(e,t,n,i,r){let o=e.data[t];if(null===o)o=function V0(e,t,n,i,r){const o=ek(),s=VT(),c=e.data[t]=function Gie(e,t,n,i,r,o){let s=t?t.injectorIndex:-1,a=0;return yu()&&(a|=128),{type:n,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,n,t,i,r);return null===e.firstChild&&(e.firstChild=c),null!==o&&(s?null==o.child&&null!==c.parent&&(o.child=c):null===o.next&&(o.next=c,c.prev=o)),c}(e,t,n,i,r),function Tte(){return je.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=n,o.value=i,o.attrs=r;const s=function vf(){const e=je.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return Xs(o,!0),o}function Ff(e,t,n,i){if(0===n)return-1;const r=t.length;for(let o=0;o<n;o++)t.push(i),e.blueprint.push(i),e.data.push(null);return r}function WL(e,t,n,i,r){const o=ur(),s=2&i;try{ql(-1),s&&t.length>qe&&HL(e,t,qe,!1),Ys(s?2:0,r),n(i,r)}finally{ql(o),Ys(s?3:1,r)}}function B0(e,t,n){if(DT(t)){const i=ut(null);try{const o=t.directiveEnd;for(let s=t.directiveStart;s<o;s++){const a=e.data[s];a.contentQueries&&a.contentQueries(1,n[s],s)}}finally{ut(i)}}}function j0(e,t,n){Qx()&&(function Xie(e,t,n,i){const r=n.directiveStart,o=n.directiveEnd;zl(n)&&function ire(e,t,n){const i=yr(t,e),r=zL(n);let s=16;n.signals?s=4096:n.onPush&&(s=64);const a=Gv(e,Hv(e,r,null,s,i,t,null,e[vs].rendererFactory.createRenderer(i,n),null,null,null));e[t.index]=a}(t,n,e.data[r+n.componentOffset]),e.firstCreatePass||Ev(n,t),hr(i,t);const s=n.initialInputs;for(let a=r;a<o;a++){const c=e.data[a],l=Yl(t,e,a,n);hr(l,t),null!==s&&rre(0,a-r,l,c,0,s),Es(c)&&(fo(n.index,t)[Rn]=Yl(t,e,a,n))}}(e,t,n,yr(n,t)),!(64&~n.flags)&&XL(e,t,n))}function H0(e,t,n=yr){const i=t.localNames;if(null!==i){let r=t.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?n(t,e):e[s];e[r++]=a}}}function zL(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=G0(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}function G0(e,t,n,i,r,o,s,a,c,l,d){const u=qe+i,h=u+r,p=function Fie(e,t){const n=[];for(let i=0;i<t;i++)n.push(i<e?null:Je);return n}(u,h),m="function"==typeof l?l():l;return p[se]={type:e,blueprint:p,template:n,queries:null,viewQuery:a,declTNode:t,data:p.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:c,consts:m,incompleteFirstPass:!1,ssrId:d}}let KL=()=>null;function qL(e,t,n,i,r){for(let o in t){if(!t.hasOwnProperty(o))continue;const s=t[o];if(void 0===s)continue;i??={};let a,c=we.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let l=o;if(null!==r){if(!r.hasOwnProperty(o))continue;l=r[o]}0===e?YL(i,n,l,a,c):YL(i,n,l,a)}return i}function YL(e,t,n,i,r){let o;e.hasOwnProperty(n)?(o=e[n]).push(t,i):o=e[n]=[t,i],void 0!==r&&o.push(r)}function Kr(e,t,n,i,r,o,s,a){const c=yr(t,n);let d,l=t.inputs;!a&&null!=l&&(d=l[i])?(Y0(e,n,d,i,r),zl(t)&&function Kie(e,t){const n=fo(t,e);16&n[Se]||(n[Se]|=64)}(n,t.index)):3&t.type&&(i=function zie(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=s?s(r,t.value||"",i):r,o.setProperty(c,i,r))}function W0(e,t,n,i){if(Qx()){const r=null===i?null:{"":-1},o=function Jie(e,t){const n=e.directiveRegistry;let i=null,r=null;if(n)for(let o=0;o<n.length;o++){const s=n[o];if(Rx(t,s.selectors,!1))if(i||(i=[]),Es(s))if(null!==s.findHostDirectiveDefs){const a=[];r=r||new Map,s.findHostDirectiveDefs(s,a,r),i.unshift(...a,s),z0(e,t,a.length)}else i.unshift(s),z0(e,t,0);else r=r||new Map,s.findHostDirectiveDefs?.(s,i,r),i.push(s)}return null===i?null:[i,r]}(e,n);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&$L(e,t,n,s,r,a),r&&function Qie(e,t,n){if(t){const i=e.localNames=[];for(let r=0;r<t.length;r+=2){const o=n[t[r+1]];if(null==o)throw new W(-301,!1);i.push(t[r],o)}}}(n,i,r)}n.mergedAttrs=lf(n.mergedAttrs,n.attrs)}function $L(e,t,n,i,r,o){for(let l=0;l<i.length;l++)ZT(Ev(n,t),e,i[l].type);!function tre(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}(n,e.data.length,i.length);for(let l=0;l<i.length;l++){const d=i[l];d.providersResolver&&d.providersResolver(d)}let s=!1,a=!1,c=Ff(e,t,i.length,null);for(let l=0;l<i.length;l++){const d=i[l];n.mergedAttrs=lf(n.mergedAttrs,d.hostAttrs),nre(e,n,t,c,d),ere(c,d,r),null!==d.contentQueries&&(n.flags|=4),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=64);const u=d.type.prototype;!s&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((e.preOrderHooks??=[]).push(n.index),s=!0),!a&&(u.ngOnChanges||u.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}!function Wie(e,t,n){const r=t.directiveEnd,o=e.data,s=t.attrs,a=[];let c=null,l=null;for(let d=t.directiveStart;d<r;d++){const u=o[d],h=n?n.get(u):null,m=h?h.outputs:null;c=qL(0,u.inputs,d,c,h?h.inputs:null),l=qL(1,u.outputs,d,l,m);const f=null===c||null===s||vT(t)?null:ore(c,d,s);a.push(f)}null!==c&&(c.hasOwnProperty("class")&&(t.flags|=8),c.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=a,t.inputs=c,t.outputs=l}(e,n,o)}function XL(e,t,n){const i=n.directiveStart,r=n.directiveEnd,o=n.index,s=function Ite(){return je.lFrame.currentDirectiveIndex}();try{ql(o);for(let a=i;a<r;a++){const c=e.data[a],l=t[a];jT(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&Zie(c,l)}}finally{ql(-1),jT(s)}}function Zie(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function z0(e,t,n){t.componentOffset=n,(e.components??=[]).push(t.index)}function ere(e,t,n){if(n){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)n[t.exportAs[i]]=e;Es(t)&&(n[""]=e)}}function nre(e,t,n,i,r){e.data[i]=r;const o=r.factory||(r.factory=jl(r.type)),s=new bf(o,Es(r),H);e.blueprint[i]=s,n[i]=s,function Yie(e,t,n,i,r){const o=r.hostBindings;if(o){let s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);const a=~t.index;(function $ie(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=a&&s.push(a),s.push(n,i,o)}}(e,t,i,Ff(e,n,r.hostVars,Je),r)}function ea(e,t,n,i,r,o){const s=yr(e,t);!function K0(e,t,n,i,r,o,s){if(null==o)e.removeAttribute(t,r,n);else{const a=null==s?Ke(o):s(o,i||"",r);e.setAttribute(t,r,a,n)}}(t[Be],s,o,e.value,n,i,r)}function rre(e,t,n,i,r,o){const s=o[t];if(null!==s)for(let a=0;a<s.length;)GL(i,n,s[a++],s[a++],s[a++],s[a++])}function ore(e,t,n){let i=null,r=0;for(;r<n.length;){const o=n[r];if(0!==o)if(5!==o){if("number"==typeof o)break;if(e.hasOwnProperty(o)){null===i&&(i=[]);const s=e[o];for(let a=0;a<s.length;a+=3)if(s[a]===t){i.push(o,s[a+1],s[a+2],n[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function ZL(e,t,n,i){return[e,!0,0,t,null,i,null,n,null,null]}function JL(e,t){const n=e.contentQueries;if(null!==n){const i=ut(null);try{for(let r=0;r<n.length;r+=2){const s=n[r+1];if(-1!==s){const a=e.data[s];fv(n[r]),a.contentQueries(2,t[s],s)}}}finally{ut(i)}}}function Gv(e,t){return e[uf]?e[Ux][_s]=t:e[uf]=t,e[Ux]=t,t}function q0(e,t,n){fv(0);const i=ut(null);try{t(e,n)}finally{ut(i)}}function QL(e){return e[gu]||(e[gu]=[])}function e2(e){return e.cleanup||(e.cleanup=[])}function Wv(e,t){const n=e[Ei],i=n?n.get(Qs,null):null;i&&i.handleError(t)}function Y0(e,t,n,i,r){for(let o=0;o<n.length;){const s=n[o++],a=n[o++],c=n[o++];GL(e.data[s],t[s],i,a,c,r)}}function sre(e,t){const n=fo(t,e),i=n[se];!function are(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(i,n);const r=n[Un];null!==r&&null===n[po]&&(n[po]=m0(r,n[Ei])),$0(i,n,n[Rn])}function $0(e,t,n){WT(t);try{const i=e.viewQuery;null!==i&&q0(1,i,n);const r=e.template;null!==r&&WL(e,t,r,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),t[Ka]?.finishViewCreation(e),e.staticContentQueries&&JL(e,t),e.staticViewQueries&&q0(2,e.viewQuery,n);const o=e.components;null!==o&&function cre(e,t){for(let n=0;n<t.length;n++)sre(e,t[n])}(t,o)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{t[Se]&=-5,zT()}}function Uf(e,t,n,i){const r=ut(null);try{const o=t.tView,c=Hv(e,o,n,4096&e[Se]?4096:16,null,t,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);c[hf]=e[t.index];const d=e[Ka];return null!==d&&(c[Ka]=d.createEmbeddedView(o)),$0(o,c,n),c}finally{ut(r)}}function ku(e,t){return!t||null===t.firstChild||Cv(e)}function Vf(e,t,n,i=!0){const r=t[se];if(function Iie(e,t,n,i){const r=di+i,o=n.length;i>0&&(n[r-1][_s]=t),i<o-di?(t[_s]=n[r],Ex(n,di+i,t)):(n.push(t),t[_s]=null),t[li]=n;const s=t[hf];null!==s&&n!==s&&function Rie(e,t){const n=e[Eu];t[Wn]!==t[li][li][Wn]&&(e[Se]|=AT.HasTransplantedViews),null===n?e[Eu]=[t]:n.push(t)}(s,t);const a=t[Ka];null!==a&&a.insertView(e),FT(t),t[Se]|=128}(r,t,e,n),i){const s=L0(n,e),a=t[Be],c=Vv(a,e[qs]);null!==c&&function Tie(e,t,n,i,r,o){i[Un]=r,i[cr]=t,jv(e,i,n,1,r,o)}(r,e[cr],a,t,c,s)}const o=t[po];null!==o&&null!==o.firstChild&&(o.firstChild=null)}function Bf(e,t,n,i,r=!1){for(;null!==n;){const o=t[n.index];null!==o&&i.push(fn(o)),dr(o)&&r2(o,i);const s=n.type;if(8&s)Bf(e,t,n.child,i);else if(32&s){const a=O0(n,t);let c;for(;c=a();)i.push(c)}else if(16&s){const a=FL(t,n);if(Array.isArray(a))i.push(...a);else{const c=Kl(t[Wn]);Bf(c[se],c,a,i,!0)}}n=r?n.projectionNext:n.next}return i}function r2(e,t){for(let n=di;n<e.length;n++){const i=e[n],r=i[se].firstChild;null!==r&&Bf(i[se],i,r,t)}e[qs]!==e[Un]&&t.push(e[qs])}let o2=[];const hre={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{_f(e.lView)},consumerOnSignalRead(){this.lView[Wl]=this}},s2=100;function zv(e,t=!0,n=0){const i=e[vs],r=i.rendererFactory;r.begin?.();try{!function pre(e,t){Z0(e,t);let n=0;for(;LT(e);){if(n===s2)throw new W(103,!1);n++,Z0(e,1)}}(e,n)}catch(s){throw t&&Wv(e,s),s}finally{r.end?.(),i.inlineEffectRunner?.flush()}}function fre(e,t,n,i){const r=t[Se];if(!(256&~r))return;t[vs].inlineEffectRunner?.flush(),WT(t);let s=null,a=null;(function mre(e){return 2!==e.type})(e)&&(a=function lre(e){return e[Wl]??function dre(e){const t=o2.pop()??Object.create(hre);return t.lView=e,t}(e)}(t),s=function z1(e){return e&&(e.nextProducerIndex=0),ut(e)}(a));try{Xx(t),function nk(e){return je.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&WL(e,t,n,2,i);const c=!(3&~r);if(c){const u=e.preOrderCheckHooks;null!==u&&gv(t,u,null)}else{const u=e.preOrderHooks;null!==u&&_v(t,u,0,null),KT(t,0)}if(function gre(e){for(let t=Hk(e);null!==t;t=Gk(t)){if(!(t[Se]&AT.HasTransplantedViews))continue;const n=t[Eu];for(let i=0;i<n.length;i++){fte(n[i])}}}(t),a2(t,0),null!==e.contentQueries&&JL(e,t),c){const u=e.contentCheckHooks;null!==u&&gv(t,u)}else{const u=e.contentHooks;null!==u&&_v(t,u,1),KT(t,1)}!function Lie(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let i=0;i<n.length;i++){const r=n[i];if(r<0)ql(~r);else{const o=r,s=n[++i],a=n[++i];wte(s,o),a(2,t[o])}}}finally{ql(-1)}}(e,t);const l=e.components;null!==l&&l2(t,l,0);const d=e.viewQuery;if(null!==d&&q0(2,d,i),c){const u=e.viewCheckHooks;null!==u&&gv(t,u)}else{const u=e.viewHooks;null!==u&&_v(t,u,2),KT(t,2)}if(!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[dv]){for(const u of t[dv])u();t[dv]=null}t[Se]&=-73}catch(c){throw _f(t),c}finally{null!==a&&(function K1(e,t){if(ut(t),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(tf(e))for(let n=e.nextProducerIndex;n<e.producerNode.length;n++)V_(e.producerNode[n],e.producerIndexOfThis[n]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}(a,s),function ure(e){e.lView[Wl]!==e&&(e.lView=null,o2.push(e))}(a)),zT()}}function a2(e,t){for(let n=Hk(e);null!==n;n=Gk(n))for(let i=di;i<n.length;i++)c2(n[i],t)}function _re(e,t,n){c2(fo(t,e),n)}function c2(e,t){kT(e)&&Z0(e,t)}function Z0(e,t){const i=e[se],r=e[Se],o=e[Wl];let s=!!(0===t&&16&r);if(s||=!!(64&r&&0===t),s||=!!(1024&r),s||=!(!o?.dirty||!GC(o)),o&&(o.dirty=!1),e[Se]&=-9217,s)fre(i,e,i.template,e[Rn]);else if(8192&r){a2(e,1);const a=i.components;null!==a&&l2(e,a,1)}}function l2(e,t,n){for(let i=0;i<t.length;i++)_re(e,t[i],n)}function jf(e){for(e[vs].changeDetectionScheduler?.notify();e;){e[Se]|=64;const t=Kl(e);if(OT(e)&&!t)return e;e=t}return null}class Hf{get rootNodes(){const t=this._lView,n=t[se];return Bf(n,t,n.firstChild,[])}constructor(t,n,i=!0){this._lView=t,this._cdRefInjectingView=n,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Rn]}set context(t){this._lView[Rn]=t}get destroyed(){return!(256&~this._lView[Se])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[li];if(dr(t)){const n=t[8],i=n?n.indexOf(this):-1;i>-1&&(xf(t,i),Q_(n,i))}this._attachedToViewContainer=!1}Uv(this._lView[se],this._lView)}onDestroy(t){pv(this._lView,t)}markForCheck(){jf(this._cdRefInjectingView||this._lView)}detach(){this._lView[Se]&=-129}reattach(){FT(this._lView),this._lView[Se]|=128}detectChanges(){this._lView[Se]|=1024,zv(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new W(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,AL(this._lView[se],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new W(902,!1);this._appRef=t,FT(this._lView)}}let Ja=(()=>{class e{static{this.__NG_ELEMENT_ID__=bre}}return e})();const vre=Ja,Ere=class extends vre{constructor(t,n,i){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,n){return this.createEmbeddedViewImpl(t,n)}createEmbeddedViewImpl(t,n,i){const r=Uf(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:n,dehydratedView:i});return new Hf(r)}};function bre(){return Kv(on(),K())}function Kv(e,t){return 4&e.type?new Ere(t,e,Ru(e,t)):null}let m2=()=>null;function Lu(e,t){return m2(e,t)}class Zv{}class Wre{}class g2{}class Kre{resolveComponentFactory(t){throw function zre(e){const t=Error(`No component factory found for ${Ri(e)}.`);return t.ngComponent=e,t}(t)}}let Fu=(()=>{class e{static{this.NULL=new Kre}}return e})();class iw{}let ta=(()=>{class e{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>function qre(){const e=K(),n=fo(on().index,e);return(lr(n)?n:e)[Be]}()}}return e})(),Yre=(()=>{class e{static{this.\u0275prov=ae({token:e,providedIn:"root",factory:()=>null})}}return e})();const rw={},v2=new Set;function na(e){v2.has(e)||(v2.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}}))}function E2(...e){}class Le{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Wt(!1),this.onMicrotaskEmpty=new Wt(!1),this.onStable=new Wt(!1),this.onError=new Wt(!1),typeof Zone>"u")throw new W(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&n,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function $re(){const e="function"==typeof Zt.requestAnimationFrame;let t=Zt[e?"requestAnimationFrame":"setTimeout"],n=Zt[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&t&&n){const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i);const r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function Jre(e){const t=()=>{!function Zre(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Zt,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,sw(e),e.isCheckStableRunning=!0,ow(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),sw(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,o,s,a)=>{if(function Qre(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(a))return n.invokeTask(r,o,s,a);try{return b2(e),n.invokeTask(r,o,s,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||e.shouldCoalesceRunChangeDetection)&&t(),y2(e)}},onInvoke:(n,i,r,o,s,a,c)=>{try{return b2(e),n.invoke(r,o,s,a,c)}finally{e.shouldCoalesceRunChangeDetection&&t(),y2(e)}},onHasTask:(n,i,r,o)=>{n.hasTask(r,o),i===r&&("microTask"==o.change?(e._hasPendingMicrotasks=o.microTask,sw(e),ow(e)):"macroTask"==o.change&&(e.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,i,r,o)=>(n.handleError(r,o),e.runOutsideAngular(()=>e.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Le.isInAngularZone())throw new W(909,!1)}static assertNotInAngularZone(){if(Le.isInAngularZone())throw new W(909,!1)}run(t,n,i){return this._inner.run(t,n,i)}runTask(t,n,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,t,Xre,E2,E2);try{return o.runTask(s,n,i)}finally{o.cancelTask(s)}}runGuarded(t,n,i){return this._inner.runGuarded(t,n,i)}runOutsideAngular(t){return this._outer.run(t)}}const Xre={};function ow(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function sw(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function b2(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function y2(e){e._nesting--,ow(e)}class S2{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Wt,this.onMicrotaskEmpty=new Wt,this.onStable=new Wt,this.onError=new Wt}run(t,n,i){return t.apply(n,i)}runGuarded(t,n,i){return t.apply(n,i)}runOutsideAngular(t){return t()}runTask(t,n,i,r){return t.apply(n,i)}}var Xl=function(e){return e[e.EarlyRead=0]="EarlyRead",e[e.Write=1]="Write",e[e.MixedReadWrite=2]="MixedReadWrite",e[e.Read=3]="Read",e}(Xl||{});const C2={destroy(){}};function cw(e,t){!t&&function cv(e){if(!Lx())throw new W(-203,!1)}();const n=t?.injector??J(Bi);if(!function Ss(e){return"browser"===(e??J(Bi)).get(xc)}(n))return C2;na("NgAfterNextRender");const i=n.get(qf),r=i.handler??=new w2,o=t?.phase??Xl.MixedReadWrite,s=()=>{r.unregister(c),a()},a=n.get(Iu).onDestroy(s),c=za(n,()=>new T2(o,()=>{s(),e()}));return r.register(c),{destroy:s}}class T2{constructor(t,n){this.phase=t,this.callbackFn=n,this.zone=J(Le),this.errorHandler=J(Qs,{optional:!0}),J(Zv,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(t){this.errorHandler?.handleError(t)}}}class w2{constructor(){this.executingCallbacks=!1,this.buckets={[Xl.EarlyRead]:new Set,[Xl.Write]:new Set,[Xl.MixedReadWrite]:new Set,[Xl.Read]:new Set},this.deferredCallbacks=new Set}register(t){(this.executingCallbacks?this.deferredCallbacks:this.buckets[t.phase]).add(t)}unregister(t){this.buckets[t.phase].delete(t),this.deferredCallbacks.delete(t)}execute(){this.executingCallbacks=!0;for(const t of Object.values(this.buckets))for(const n of t)n.invoke();this.executingCallbacks=!1;for(const t of this.deferredCallbacks)this.buckets[t.phase].add(t);this.deferredCallbacks.clear()}destroy(){for(const t of Object.values(this.buckets))t.clear();this.deferredCallbacks.clear()}}let qf=(()=>{class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const n=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of n)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=ae({token:e,providedIn:"root",factory:()=>new e})}}return e})();function Qv(e,t,n){let i=n?e.styles:null,r=n?e.classes:null,o=0;if(null!==t)for(let s=0;s<t.length;s++){const a=t[s];"number"==typeof a?o=a:1==o?r=tT(r,a):2==o&&(i=tT(i,a+": "+t[++s]+";"))}n?e.styles=i:e.stylesWithoutHost=i,n?e.classes=r:e.classesWithoutHost=r}class A2 extends Fu{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=mt(t);return new Xf(n,this.ngModule)}}function D2(e){const t=[];for(const n in e){if(!e.hasOwnProperty(n))continue;const i=e[n];void 0!==i&&t.push({propName:Array.isArray(i)?i[0]:i,templateName:n})}return t}class eE{constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,i){i=X_(i);const r=this.injector.get(t,rw,i);return r!==rw||n===rw?r:this.parentInjector.get(t,n,i)}}class Xf extends g2{get inputs(){const t=this.componentDef,n=t.inputTransforms,i=D2(t.inputs);if(null!==n)for(const r of i)n.hasOwnProperty(r.propName)&&(r.transform=n[r.propName]);return i}get outputs(){return D2(this.componentDef.outputs)}constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function Pee(e){return e.map(Nee).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}create(t,n,i,r){const o=ut(null);try{let s=(r=r||this.ngModule)instanceof jr?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const a=s?new eE(t,s):t,c=a.get(iw,null);if(null===c)throw new W(407,!1);const l=a.get(Yre,null),h={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:a.get(qf,null),changeDetectionScheduler:a.get(Zv,null)},p=c.createRenderer(null,this.componentDef),m=this.componentDef.selectors[0][0]||"div",f=i?function Uie(e,t,n,i){const o=i.get(rL,!1)||n===ms.ShadowDom,s=e.selectRootElement(t,o);return function Vie(e){KL(e)}(s),s}(p,i,this.componentDef.encapsulation,a):Fv(p,m,function roe(e){const t=e.toLowerCase();return"svg"===t?qx:"math"===t?"math":null}(m));let g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let E=null;null!==f&&(E=m0(f,a,!0));const b=G0(0,null,null,1,0,null,null,null,null,null,null),T=Hv(null,b,null,g,null,null,h,p,a,null,E);let I,D;WT(T);try{const O=this.componentDef;let k,L=null;O.findHostDirectiveDefs?(k=[],L=new Map,O.findHostDirectiveDefs(O,k,L),k.push(O)):k=[O];const V=function soe(e,t){const n=e[se],i=qe;return e[i]=t,xu(n,i,2,"#host",null)}(T,f),ee=function aoe(e,t,n,i,r,o,s){const a=r[se];!function coe(e,t,n,i){for(const r of e)t.mergedAttrs=lf(t.mergedAttrs,r.hostAttrs);null!==t.mergedAttrs&&(Qv(t,t.mergedAttrs,!0),null!==n&&jL(i,n,t))}(i,e,t,s);let c=null;null!==t&&(c=m0(t,r[Ei]));const l=o.rendererFactory.createRenderer(t,n);let d=16;n.signals?d=4096:n.onPush&&(d=64);const u=Hv(r,zL(n),null,d,r[e.index],e,o,l,null,null,c);return a.firstCreatePass&&z0(a,e,i.length-1),Gv(r,u),r[e.index]=u}(V,f,O,k,T,h,p);D=gf(b,qe),f&&function doe(e,t,n,i){if(i)_T(e,n,["ng-version","17.3.12"]);else{const{attrs:r,classes:o}=function Mee(e){const t=[],n=[];let i=1,r=2;for(;i<e.length;){let o=e[i];if("string"==typeof o)2===r?""!==o&&t.push(o,e[++i]):8===r&&n.push(o);else{if(!gs(r))break;r=o}i++}return{attrs:t,classes:n}}(t.selectors[0]);r&&_T(e,n,r),o&&o.length>0&&BL(e,n,o.join(" "))}}(p,O,f,i),void 0!==n&&function uoe(e,t,n){const i=e.projection=[];for(let r=0;r<t.length;r++){const o=n[r];i.push(null!=o?Array.from(o):null)}}(D,this.ngContentSelectors,n),I=function loe(e,t,n,i,r,o){const s=on(),a=r[se],c=yr(s,r);$L(a,r,s,n,null,i);for(let d=0;d<n.length;d++)hr(Yl(r,a,s.directiveStart+d,s),r);XL(a,r,s),c&&hr(c,r);const l=Yl(r,a,s.directiveStart+s.componentOffset,s);if(e[Rn]=r[Rn]=l,null!==o)for(const d of o)d(l,t);return B0(a,s,r),l}(ee,O,k,L,T,[hoe]),$0(b,T,null)}finally{zT()}return new ooe(this.componentType,I,Ru(D,T),T,D)}finally{ut(o)}}}class ooe extends Wre{constructor(t,n,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Hf(r,void 0,!1),this.componentType=t}setInput(t,n){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),n))return;const o=this._rootLView;Y0(o[se],o,r,t,n),this.previousInputValues.set(t,n),jf(fo(this._tNode.index,o))}}get injector(){return new Oi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function hoe(){const e=on();mv(K()[se],e)}let Bo=(()=>{class e{static{this.__NG_ELEMENT_ID__=poe}}return e})();function poe(){return P2(on(),K())}const foe=Bo,O2=class extends foe{constructor(t,n,i){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=i}get element(){return Ru(this._hostTNode,this._hostLView)}get injector(){return new Oi(this._hostTNode,this._hostLView)}get parentInjector(){const t=bv(this._hostTNode,this._hostLView);if(YT(t)){const n=Sf(t,this._hostLView),i=yf(t);return new Oi(n[se].data[i+8],n)}return new Oi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=N2(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-di}createEmbeddedView(t,n,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const s=Lu(this._lContainer,t.ssrId),a=t.createEmbeddedViewImpl(n||{},o,s);return this.insertImpl(a,r,ku(this._hostTNode,s)),a}createComponent(t,n,i,r,o){const s=t&&!function df(e){return"function"==typeof e}(t);let a;if(s)a=n;else{const m=n||{};a=m.index,i=m.injector,r=m.projectableNodes,o=m.environmentInjector||m.ngModuleRef}const c=s?t:new Xf(mt(t)),l=i||this.parentInjector;if(!o&&null==c.ngModule){const f=(s?l:this.parentInjector).get(jr,null);f&&(o=f)}const d=mt(c.componentType??{}),u=Lu(this._lContainer,d?.id??null),p=c.create(l,r,u?.firstChild??null,o);return this.insertImpl(p.hostView,a,ku(this._hostTNode,u)),p}insert(t,n){return this.insertImpl(t,n,!0)}insertImpl(t,n,i){const r=t._lView;if(function pte(e){return dr(e[li])}(r)){const a=this.indexOf(t);if(-1!==a)this.detach(a);else{const c=r[li],l=new O2(c,c[cr],c[li]);l.detach(l.indexOf(t))}}const o=this._adjustIndex(n),s=this._lContainer;return Vf(s,r,o,i),t.attachToViewContainerRef(),Ex(uw(s),o,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=N2(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),i=xf(this._lContainer,n);i&&(Q_(uw(this._lContainer),n),Uv(i[se],i))}detach(t){const n=this._adjustIndex(t,-1),i=xf(this._lContainer,n);return i&&null!=Q_(uw(this._lContainer),n)?new Hf(i):null}_adjustIndex(t,n=0){return t??this.length+n}};function N2(e){return e[8]}function uw(e){return e[8]||(e[8]=[])}function P2(e,t){let n;const i=t[e.index];return dr(i)?n=i:(n=ZL(i,t,null,e),t[e.index]=n,Gv(t,n)),M2(n,t,e,i),new O2(n,e,t)}let M2=function k2(e,t,n,i){if(e[qs])return;let r;r=8&n.type?fn(i):function moe(e,t){const n=e[Be],i=n.createComment(""),r=yr(t,e);return $l(n,Vv(n,r),i,function Nie(e,t){return e.nextSibling(t)}(n,r),!1),i}(t,n),e[qs]=r},hw=()=>!1;class pw{constructor(t){this.queryList=t,this.matches=null}clone(){return new pw(this.queryList)}setDirty(){this.queryList.setDirty()}}class fw{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const i=null!==t.contentQueries?t.contentQueries[0]:n.length,r=[];for(let o=0;o<i;o++){const s=n.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new fw(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}finishViewCreation(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==Ew(t,n).matches&&this.queries[n].setDirty()}}class L2{constructor(t,n,i=null){this.flags=n,this.read=i,this.predicate="string"==typeof t?function Coe(e){return e.split(",").map(t=>t.trim())}(t):t}}class mw{constructor(t=[]){this.queries=t}elementStart(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let i=0;i<this.length;i++){const r=null!==n?n.length:0,o=this.getByIndex(i).embeddedTView(t,r);o&&(o.indexInDeclarationView=i,null!==n?n.push(o):n=[o])}return null!==n?new mw(n):null}template(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class gw{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new gw(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1&~this.metadata.flags){const n=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==n;)i=i.parent;return n===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(t,n,Eoe(n,o)),this.matchTNodeWithReadOption(t,n,yv(n,t,o,!1,!1))}else i===Ja?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,yv(n,t,i,!1,!1))}matchTNodeWithReadOption(t,n,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===sn||r===Bo||r===Ja&&4&n.type)this.addMatch(n.index,-2);else{const o=yv(n,t,r,!1,!1);null!==o&&this.addMatch(n.index,o)}else this.addMatch(n.index,i)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function Eoe(e,t){const n=e.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===t)return n[i+1];return null}function yoe(e,t,n,i){return-1===n?function boe(e,t){return 11&e.type?Ru(e,t):4&e.type?Kv(e,t):null}(t,e):-2===n?function Soe(e,t,n){return n===sn?Ru(t,e):n===Ja?Kv(t,e):n===Bo?P2(t,e):void 0}(e,t,i):Yl(e,e[se],n,t)}function F2(e,t,n,i){const r=t[Ka].queries[i];if(null===r.matches){const o=e.data,s=n.matches,a=[];for(let c=0;null!==s&&c<s.length;c+=2){const l=s[c];a.push(l<0?null:yoe(t,o[l],s[c+1],n.metadata.read))}r.matches=a}return r.matches}function _w(e,t,n,i){const r=e.queries.getByIndex(n),o=r.matches;if(null!==o){const s=F2(e,t,r,n);for(let a=0;a<o.length;a+=2){const c=o[a];if(c>0)i.push(s[a/2]);else{const l=o[a+1],d=t[-c];for(let u=di;u<d.length;u++){const h=d[u];h[hf]===h[li]&&_w(h[se],h,l,i)}if(null!==d[Eu]){const u=d[Eu];for(let h=0;h<u.length;h++){const p=u[h];_w(p[se],p,l,i)}}}}}return i}function U2(e,t,n){const i=new Cf(!(4&~n));return function Hie(e,t,n,i){const r=QL(t);r.push(n),e.firstCreatePass&&e2(e).push(i,r.length-1)}(e,t,i,i.destroy),(t[Ka]??=new fw).queries.push(new pw(i))-1}function j2(e,t,n){null===e.queries&&(e.queries=new mw),e.queries.track(new gw(t,n))}function Ew(e,t){return e.queries.getByIndex(t)}function H2(e,t){const n=e[se],i=Ew(n,t);return i.crossesNgTemplate?_w(n,e,t,[]):F2(n,e,i,t)}function Pt(e){let t=function tF(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const i=[e];for(;t;){let r;if(Es(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new W(903,!1);r=t.\u0275dir}if(r){if(n){i.push(r);const s=e;s.inputs=iE(e.inputs),s.inputTransforms=iE(e.inputTransforms),s.declaredInputs=iE(e.declaredInputs),s.outputs=iE(e.outputs);const a=r.hostBindings;a&&Voe(e,a);const c=r.viewQuery,l=r.contentQueries;if(c&&Foe(e,c),l&&Uoe(e,l),koe(e,r),JQ(e.outputs,r.outputs),Es(r)&&r.data.animation){const d=e.data;d.animation=(d.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(e),a===Pt&&(n=!1)}}t=Object.getPrototypeOf(t)}!function Loe(e){let t=0,n=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=t+=r.hostVars,r.hostAttrs=lf(r.hostAttrs,n=lf(n,r.hostAttrs))}}(i)}function koe(e,t){for(const n in t.inputs){if(!t.inputs.hasOwnProperty(n)||e.inputs.hasOwnProperty(n))continue;const i=t.inputs[n];if(void 0!==i&&(e.inputs[n]=i,e.declaredInputs[n]=t.declaredInputs[n],null!==t.inputTransforms)){const r=Array.isArray(i)?i[0]:i;if(!t.inputTransforms.hasOwnProperty(r))continue;e.inputTransforms??={},e.inputTransforms[r]=t.inputTransforms[r]}}}function iE(e){return e===Ks?{}:e===Nt?[]:e}function Foe(e,t){const n=e.viewQuery;e.viewQuery=n?(i,r)=>{t(i,r),n(i,r)}:t}function Uoe(e,t){const n=e.contentQueries;e.contentQueries=n?(i,r,o)=>{t(i,r,o),n(i,r,o)}:t}function Voe(e,t){const n=e.hostBindings;e.hostBindings=n?(i,r)=>{t(i,r),n(i,r)}:t}function rE(e){const t=e.inputConfig,n={};for(const i in t)if(t.hasOwnProperty(i)){const r=t[i];Array.isArray(r)&&r[3]&&(n[i]=r[3])}e.inputTransforms=n}class Zl{}class oF{}class yw extends Zl{constructor(t,n,i){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new A2(this);const r=ar(t);this._bootstrapComponents=mo(r.bootstrap),this._r3Injector=Ak(t,n,[{provide:Zl,useValue:this},{provide:Fu,useValue:this.componentFactoryResolver},...i],Ri(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Sw extends oF{constructor(t){super(),this.moduleType=t}create(t){return new yw(this.moduleType,t,[])}}class sF extends Zl{constructor(t){super(),this.componentFactoryResolver=new A2(this),this.instance=null;const n=new pu([...t.providers,{provide:Zl,useValue:this},{provide:Fu,useValue:this.componentFactoryResolver}],t.parent||av(),t.debugName,new Set(["environment"]));this.injector=n,t.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function oE(e,t,n=null){return new sF({providers:e,parent:t,debugName:n,runEnvironmentInitializers:!0}).injector}let Vu=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new co(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function aE(e){return!!function Cw(e){return null!==e&&("function"==typeof e||"object"==typeof e)}(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function ia(e,t,n){return e[t]=n}function ui(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function Jl(e,t,n,i){const r=ui(e,t,n);return ui(e,t+1,i)||r}function an(e,t,n,i,r,o,s,a){const c=K(),l=bt(),d=e+qe,u=l.firstCreatePass?function Joe(e,t,n,i,r,o,s,a,c){const l=t.consts,d=xu(t,e,4,s||null,$s(l,a));W0(t,n,d,$s(l,c)),mv(t,d);const u=d.tView=G0(2,d,i,r,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,l,null);return null!==t.queries&&(t.queries.template(t,d),u.queries=t.queries.embeddedTView(d)),d}(d,l,c,t,n,i,r,o,s):l.data[d];Xs(u,!1);const h=aF(l,c,u,e);Ef()&&Bv(l,c,h,u),hr(h,c);const p=ZL(h,c,h,u);return c[d]=p,Gv(c,p),function x2(e,t,n){return hw(e,t,n)}(p,u,c),hv(u)&&j0(l,c,u),null!=s&&H0(c,u,a),an}let aF=function cF(e,t,n,i){return Zs(!0),t[Be].createComment("")};function Ni(e,t,n,i){const r=K();return ui(r,bs(),t)&&(bt(),ea(An(),r,e,t,n,i)),Ni}function fE(e,t){return e<<17|t<<2}function Bc(e){return e>>17&32767}function Mw(e){return 2|e}function ed(e){return(131068&e)>>2}function xw(e,t){return-131069&e|t<<2}function kw(e){return 1|e}function VF(e,t,n,i){const r=e[n+1],o=null===t;let s=i?Bc(r):ed(r),a=!1;for(;0!==s&&(!1===a||o);){const l=e[s+1];Use(e[s],t)&&(a=!0,e[s+1]=i?kw(l):Mw(l)),s=i?Bc(l):ed(l)}a&&(e[n+1]=i?Mw(r):kw(r))}function Use(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&hu(e,t)>=0}const Pi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function BF(e){return e.substring(Pi.key,Pi.keyEnd)}function jF(e,t){const n=Pi.textEnd;return n===t?-1:(t=Pi.keyEnd=function Hse(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,Pi.key=t,n),th(e,t,n))}function th(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function ht(e,t,n){const i=K();return ui(i,bs(),t)&&Kr(bt(),An(),i,e,t,i[Be],n,!1),ht}function Lw(e,t,n,i,r){const s=r?"class":"style";Y0(e,n,t.inputs[s],s,i)}function Fw(e,t,n){return Cs(e,t,n,!1),Fw}function wt(e,t){return Cs(e,t,null,!0),wt}function Uw(e){!function Ts(e,t,n,i){const r=bt(),o=Ya(2);r.firstUpdatePass&&qF(r,null,o,i);const s=K();if(n!==Je&&ui(s,o,n)){const a=r.data[ur()];if(ZF(a,i)&&!KF(r,o)){let c=i?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(n=tT(c,n||"")),Lw(r,a,s,n,i)}else!function Jse(e,t,n,i,r,o,s,a){r===Je&&(r=Nt);let c=0,l=0,d=0<r.length?r[0]:null,u=0<o.length?o[0]:null;for(;null!==d||null!==u;){const h=c<r.length?r[c+1]:void 0,p=l<o.length?o[l+1]:void 0;let f,m=null;d===u?(c+=2,l+=2,h!==p&&(m=u,f=p)):null===u||null!==d&&d<u?(c+=2,m=d):(l+=2,m=u,f=p),null!==m&&$F(e,t,n,i,m,f,s,a),d=c<r.length?r[c]:null,u=l<o.length?o[l]:null}}(r,a,s,s[Be],s[o+1],s[o+1]=function Xse(e,t,n){if(null==n||""===n)return Nt;const i=[],r=kc(n);if(Array.isArray(r))for(let o=0;o<r.length;o++)e(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&e(i,o,r[o]);else"string"==typeof r&&t(i,r);return i}(e,t,n),i,o)}}(Zse,oa,e,!0)}function oa(e,t){for(let n=function Bse(e){return function GF(e){Pi.key=0,Pi.keyEnd=0,Pi.value=0,Pi.valueEnd=0,Pi.textEnd=e.length}(e),jF(e,th(e,0,Pi.textEnd))}(t);n>=0;n=jF(t,n))ho(e,BF(t),!0)}function Cs(e,t,n,i){const r=K(),o=bt(),s=Ya(2);o.firstUpdatePass&&qF(o,e,s,i),t!==Je&&ui(r,s,t)&&$F(o,o.data[ur()],r,r[Be],e,r[s+1]=function Qse(e,t){return null==e||""===e||("string"==typeof t?e+=t:"object"==typeof e&&(e=Ri(kc(e)))),e}(t,n),i,s)}function KF(e,t){return t>=e.expandoStartIndex}function qF(e,t,n,i){const r=e.data;if(null===r[n+1]){const o=r[ur()],s=KF(e,n);ZF(o,i)&&null===t&&!s&&(t=!1),t=function Kse(e,t,n,i){const r=function HT(e){const t=je.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let o=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(n=im(n=Vw(null,e,t,n,i),t.attrs,i),o=null);else{const s=t.directiveStylingLast;if(-1===s||e[s]!==r)if(n=Vw(r,e,t,n,i),null===o){let c=function qse(e,t,n){const i=n?t.classBindings:t.styleBindings;if(0!==ed(i))return e[Bc(i)]}(e,t,i);void 0!==c&&Array.isArray(c)&&(c=Vw(null,e,t,c[1],i),c=im(c,t.attrs,i),function Yse(e,t,n,i){e[Bc(n?t.classBindings:t.styleBindings)]=i}(e,t,i,c))}else o=function $se(e,t,n){let i;const r=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<r;o++)i=im(i,e[o].hostAttrs,n);return im(i,t.attrs,n)}(e,t,i)}return void 0!==o&&(i?t.residualClasses=o:t.residualStyles=o),n}(r,o,t,i),function Lse(e,t,n,i,r,o){let s=o?t.classBindings:t.styleBindings,a=Bc(s),c=ed(s);e[i]=n;let d,l=!1;if(Array.isArray(n)?(d=n[1],(null===d||hu(n,d)>0)&&(l=!0)):d=n,r)if(0!==c){const h=Bc(e[a+1]);e[i+1]=fE(h,a),0!==h&&(e[h+1]=xw(e[h+1],i)),e[a+1]=function xse(e,t){return 131071&e|t<<17}(e[a+1],i)}else e[i+1]=fE(a,0),0!==a&&(e[a+1]=xw(e[a+1],i)),a=i;else e[i+1]=fE(c,0),0===a?a=i:e[c+1]=xw(e[c+1],i),c=i;l&&(e[i+1]=Mw(e[i+1])),VF(e,d,i,!0),VF(e,d,i,!1),function Fse(e,t,n,i,r){const o=r?e.residualClasses:e.residualStyles;null!=o&&"string"==typeof t&&hu(o,t)>=0&&(n[i+1]=kw(n[i+1]))}(t,d,e,i,o),s=fE(a,c),o?t.classBindings=s:t.styleBindings=s}(r,o,t,n,s,i)}}function Vw(e,t,n,i,r){let o=null;const s=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<s&&(o=t[a],i=im(i,o.hostAttrs,r),o!==e);)a++;return null!==e&&(n.directiveStylingLast=a),i}function im(e,t,n){const i=n?1:2;let r=-1;if(null!==t)for(let o=0;o<t.length;o++){const s=t[o];"number"==typeof s?r=s:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),ho(e,s,!!n||t[++o]))}return void 0===e?null:e}function Zse(e,t,n){const i=String(t);""!==i&&!i.includes(" ")&&ho(e,i,n)}function $F(e,t,n,i,r,o,s,a){if(!(3&t.type))return;const c=e.data,l=c[a+1],d=function kse(e){return!(1&~e)}(l)?XF(c,t,n,r,ed(l),s):void 0;mE(d)||(mE(o)||function Mse(e){return!(2&~e)}(l)&&(o=XF(c,null,n,r,a,s)),function xie(e,t,n,i,r){if(t)r?e.addClass(n,i):e.removeClass(n,i);else{let o=-1===i.indexOf("-")?void 0:Lc.DashCase;null==r?e.removeStyle(n,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Lc.Important),e.setStyle(n,i,r,o))}}(i,s,mf(ur(),n),r,o))}function XF(e,t,n,i,r,o){const s=null===t;let a;for(;r>0;){const c=e[r],l=Array.isArray(c),d=l?c[1]:c,u=null===d;let h=n[r+1];h===Je&&(h=u?Nt:void 0);let p=u?mT(h,i):d===i?h:void 0;if(l&&!mE(p)&&(p=mT(c,i)),mE(p)&&(a=p,s))return a;const m=e[r+1];r=s?Bc(m):ed(m)}if(null!==t){let c=o?t.residualClasses:t.residualStyles;null!=c&&(a=mT(c,i))}return a}function mE(e){return void 0!==e}function ZF(e,t){return!!(e.flags&(t?8:16))}function Cr(e,t,n){na("NgControlFlow");const i=K(),r=bs(),o=function Hw(e,t){return e[t]}(i,qe+e);if(ui(i,r,t)){const a=ut(null);try{if(function X0(e,t){const n=xf(e,t);return void 0!==n&&Uv(n[se],n),n}(o,0),-1!==t){const c=function Gw(e,t){return gf(e,t)}(i[se],qe+t),l=Lu(o,c.tView.ssrId);Vf(o,Uf(i,c,n,{dehydratedView:l}),0,ku(c,l))}}finally{ut(a)}}else{const a=function n2(e,t){const n=di+t;if(n<e.length)return e[n]}(o,0);void 0!==a&&(a[Rn]=n)}}function ue(e,t,n,i){const r=K(),o=bt(),s=qe+e,a=r[Be],c=o.firstCreatePass?function yae(e,t,n,i,r,o){const s=t.consts,c=xu(t,e,2,i,$s(s,r));return W0(t,n,c,$s(s,o)),null!==c.attrs&&Qv(c,c.attrs,!1),null!==c.mergedAttrs&&Qv(c,c.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,c),c}(s,o,r,t,n,i):o.data[s],l=tU(o,r,c,a,t,e);r[s]=l;const d=hv(c);return Xs(c,!0),jL(a,l,c),!function Qf(e){return!(32&~e.flags)}(c)&&Ef()&&Bv(o,r,l,c),0===function mte(){return je.lFrame.elementDepthCount}()&&hr(l,r),function gte(){je.lFrame.elementDepthCount++}(),d&&(j0(o,r,c),B0(o,c,r)),null!==i&&H0(r,c),ue}function ve(){let e=on();VT()?BT():(e=e.parent,Xs(e,!1));const t=e;(function vte(e){return je.skipHydrationRootTNode===e})(t)&&function Ste(){je.skipHydrationRootTNode=null}(),function _te(){je.lFrame.elementDepthCount--}();const n=bt();return n.firstCreatePass&&(mv(n,e),DT(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function kte(e){return!!(8&e.flags)}(t)&&Lw(n,t,K(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function Lte(e){return!!(16&e.flags)}(t)&&Lw(n,t,K(),t.stylesWithoutHost,!1),ve}function pt(e,t,n,i){return ue(e,t,n,i),ve(),pt}let tU=(e,t,n,i,r,o)=>(Zs(!0),Fv(i,r,function lk(){return je.lFrame.currentNamespace}()));function rm(e,t,n){const i=K(),r=bt(),o=e+qe,s=r.firstCreatePass?function Tae(e,t,n,i,r){const o=t.consts,s=$s(o,i),a=xu(t,e,8,"ng-container",s);return null!==s&&Qv(a,s,!0),W0(t,n,a,$s(o,r)),null!==t.queries&&t.queries.elementStart(t,a),a}(o,r,i,t,n):r.data[o];Xs(s,!0);const a=iU(r,i,s,e);return i[o]=a,Ef()&&Bv(r,i,a,s),hr(a,i),hv(s)&&(j0(r,i,s),B0(r,s,i)),null!=n&&H0(i,s),rm}function om(){let e=on();const t=bt();return VT()?BT():(e=e.parent,Xs(e,!1)),t.firstCreatePass&&(mv(t,e),DT(e)&&t.queries.elementEnd(e)),om}let iU=(e,t,n,i)=>(Zs(!0),P0(t[Be],""));function Qa(){return K()}function sm(e,t,n){const i=K();return ui(i,bs(),t)&&Kr(bt(),An(),i,e,t,i[Be],n,!0),sm}const ih="en-US";let aU=ih;function zt(e,t,n,i){const r=K(),o=bt(),s=on();return function Kw(e,t,n,i,r,o,s){const a=hv(i),l=e.firstCreatePass&&e2(e),d=t[Rn],u=QL(t);let h=!0;if(3&i.type||s){const f=yr(i,t),g=s?s(f):f,E=u.length,b=s?I=>s(fn(I[i.index])):i.index;let T=null;if(!s&&a&&(T=function wce(e,t,n,i){const r=e.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===n&&r[o+1]===i){const a=t[gu],c=r[o+2];return a.length>c?a[c]:null}"string"==typeof s&&(o+=2)}return null}(e,t,r,i.index)),null!==T)(T.__ngLastListenerFn__||T).__ngNextListenerFn__=o,T.__ngLastListenerFn__=o,h=!1;else{o=kU(i,t,d,o,!1);const I=n.listen(g,r,o);u.push(o,I),l&&l.push(r,b,E,E+1)}}else o=kU(i,t,d,o,!1);const p=i.outputs;let m;if(h&&null!==p&&(m=p[r])){const f=m.length;if(f)for(let g=0;g<f;g+=2){const D=t[m[g]][m[g+1]].subscribe(o),O=u.length;u.push(o,D),l&&l.push(r,i.index,O,-(O+1))}}}(o,r,r[Be],s,e,t,i),zt}function xU(e,t,n,i){const r=ut(null);try{return Ys(6,t,n),!1!==n(i)}catch(o){return Wv(e,o),!1}finally{Ys(7,t,n),ut(r)}}function kU(e,t,n,i,r){return function o(s){if(s===Function)return i;jf(e.componentOffset>-1?fo(e.index,t):t);let c=xU(t,n,i,s),l=o.__ngNextListenerFn__;for(;l;)c=xU(t,n,l,s)&&c,l=l.__ngNextListenerFn__;return r&&!1===c&&s.preventDefault(),c}}function Kt(e=1){return function Ate(e){return(je.lFrame.contextLView=function Zx(e,t){for(;e>0;)t=t[_u],e--;return t}(e,je.lFrame.contextLView))[Rn]}(e)}function Ice(e,t){let n=null;const i=function Ree(e){const t=e.attrs;if(null!=t){const n=t.indexOf(5);if(!(1&n))return t[n+1]}return null}(e);for(let r=0;r<t.length;r++){const o=t[r];if("*"!==o){if(null===i?Rx(e,o,!0):Oee(i,o))return r}else n=r}return n}function rh(e){const t=K()[Wn][cr];if(!t.projection){const i=t.projection=function ev(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}(e?e.length:1,null),r=i.slice();let o=t.child;for(;null!==o;){const s=e?Ice(o,e):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function pr(e,t=0,n){const i=K(),r=bt(),o=xu(r,qe+e,16,null,n||null);null===o.projection&&(o.projection=t),BT(),(!i[po]||yu())&&32&~o.flags&&function Pie(e,t,n){VL(t[Be],0,t,n,x0(e,n,t),ML(n.parent||t[cr],n,t))}(r,i,o)}function ec(e,t,n,i){!function B2(e,t,n,i){const r=bt();if(r.firstCreatePass){const o=on();j2(r,new L2(t,n,i),o.index),function Toe(e,t){const n=e.contentQueries||(e.contentQueries=[]);t!==(n.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(r,e),!(2&~n)&&(r.staticContentQueries=!0)}return U2(r,K(),n)}(e,t,n,i)}function sa(e,t,n){!function V2(e,t,n){const i=bt();return i.firstCreatePass&&(j2(i,new L2(e,t,n),-1),!(2&~t)&&(i.staticViewQueries=!0)),U2(i,K(),t)}(e,t,n)}function ji(e){const t=K(),n=bt(),i=GT();fv(i+1);const r=Ew(n,i);if(e.dirty&&function hte(e){return!(4&~e[Se])}(t)===!(2&~r.metadata.flags)){if(null===r.matches)e.reset([]);else{const o=H2(t,i);e.reset(o,Pk),e.notifyOnChanges()}return!0}return!1}function Hi(){return function vw(e,t){return e[Ka].queries[t].queryList}(K(),GT())}function pm(e){return bu(function Cte(){return je.lFrame.contextLView}(),qe+e)}function fr(e,t=""){const n=K(),i=bt(),r=e+qe,o=i.firstCreatePass?xu(i,r,1,t,null):i.data[r],s=eV(i,n,o,t,e);n[r]=s,Ef()&&Bv(i,n,s,o),Xs(o,!1)}let eV=(e,t,n,i,r)=>(Zs(!0),function N0(e,t){return e.createText(t)}(t[Be],i));function nd(e){return fm("",e,""),nd}function fm(e,t,n){const i=K(),r=function qu(e,t,n,i){return ui(e,bs(),n)?t+Ke(n)+i:Je}(i,e,t,n);return r!==Je&&function Za(e,t,n){const i=mf(t,e);!function RL(e,t,n){e.setValue(t,n)}(e[Be],i,n)}(i,ur(),r),fm}function Yw(e,t,n,i,r){if(e=Ve(e),Array.isArray(e))for(let o=0;o<e.length;o++)Yw(e[o],t,n,i,r);else{const o=bt(),s=K(),a=on();let c=Gl(e)?e:Ve(e.provide);const l=kx(e),d=1048575&a.providerIndexes,u=a.directiveStart,h=a.providerIndexes>>20;if(Gl(e)||!e.multi){const p=new bf(l,r,H),m=Xw(c,t,r?d:d+h,u);-1===m?(ZT(Ev(a,s),o,c),$w(o,e,t.length),t.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),n.push(p),s.push(p)):(n[m]=p,s[m]=p)}else{const p=Xw(c,t,d+h,u),m=Xw(c,t,d,d+h),g=m>=0&&n[m];if(r&&!g||!r&&!(p>=0&&n[p])){ZT(Ev(a,s),o,c);const E=function Kce(e,t,n,i,r){const o=new bf(e,n,H);return o.multi=[],o.index=t,o.componentProviders=0,uV(o,r,i&&!n),o}(r?zce:Wce,n.length,r,i,l);!r&&g&&(n[m].providerFactory=E),$w(o,e,t.length,0),t.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),n.push(E),s.push(E)}else $w(o,e,p>-1?p:m,uV(n[r?m:p],l,!r&&i));!r&&i&&g&&n[m].componentProviders++}}}function $w(e,t,n,i){const r=Gl(t),o=function Bee(e){return!!e.useClass}(t);if(r||o){const c=(o?Ve(t.useClass):t).prototype.ngOnDestroy;if(c){const l=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){const d=l.indexOf(n);-1===d?l.push(n,[i,c]):l[d+1].push(i,c)}else l.push(n,c)}}}function uV(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function Xw(e,t,n,i){for(let r=n;r<i;r++)if(t[r]===e)return r;return-1}function Wce(e,t,n,i){return Zw(this.multi,[])}function zce(e,t,n,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=Yl(n,n[se],this.providerFactory.index,i);o=a.slice(0,s),Zw(r,o);for(let c=s;c<a.length;c++)o.push(a[c])}else o=[],Zw(r,o);return o}function Zw(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function mn(e,t=[]){return n=>{n.providersResolver=(i,r)=>function Gce(e,t,n){const i=bt();if(i.firstCreatePass){const r=Es(e);Yw(n,i.data,i.blueprint,r,!0),Yw(t,i.data,i.blueprint,r,!1)}}(i,r?r(e):e,t)}}let qce=(()=>{class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const i=ET(0,n.type),r=i.length>0?oE([i],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,r)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=ae({token:e,providedIn:"environment",factory:()=>new e(Z(jr))})}}return e})();function jc(e){na("NgStandalone"),e.getStandaloneInjector=t=>t.get(qce).getOrCreateStandaloneInjector(e)}function pV(e,t,n,i,r,o,s){return function _V(e,t,n,i,r,o,s,a,c){const l=t+n;return function jo(e,t,n,i,r,o){const s=Jl(e,t,n,i);return Jl(e,t+2,r,o)||s}(e,l,r,o,s,a)?ia(e,l+4,c?i.call(c,r,o,s,a):i(r,o,s,a)):mm(e,l+4)}(K(),Sr(),e,t,n,i,r,o,s)}function mm(e,t){const n=e[t];return n===Je?void 0:n}function yE(e,t){const n=bt();let i;const r=e+qe;n.firstCreatePass?(i=function ole(e,t){if(t)for(let n=t.length-1;n>=0;n--){const i=t[n];if(e===i.name)return i}}(t,n.pipeRegistry),n.data[r]=i,i.onDestroy&&(n.destroyHooks??=[]).push(r,i.onDestroy)):i=n.data[r];const o=i.factory||(i.factory=jl(i.type)),a=Ur(H);try{const c=vv(!1),l=o();return vv(c),function Oce(e,t,n,i){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=i}(n,K(),r,l),l}finally{Ur(a)}}function SE(e,t,n){const i=e+qe,r=K(),o=bu(r,i);return function gm(e,t){return e[se].data[t].pure}(r,i)?function fV(e,t,n,i,r,o){const s=t+n;return ui(e,s,r)?ia(e,s+1,o?i.call(o,r):i(r)):mm(e,s+1)}(r,Sr(),t,o.transform,n,o):o.transform(n)}function Jw(e,t){return Kv(e,t)}let xV=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"platform"})}}return e})();const VV=new re(""),wE=new re("");let sI,rI=(()=>{class e{constructor(n,i,r){this._ngZone=n,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,sI||(function nde(e){sI=e}(r),r.addToWindow(i)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Le.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb()}});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),n()},i)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:r})}whenStable(n,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,i,r){return[]}static{this.\u0275fac=function(i){return new(i||e)(Z(Le),Z(oI),Z(wE))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})(),oI=(()=>{class e{constructor(){this._applications=new Map}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return sI?.findTestabilityInTree(this,n,i)??null}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"platform"})}}return e})();function Em(e){return!!e&&"function"==typeof e.then}function BV(e){return!!e&&"function"==typeof e.subscribe}const aI=new re("");let cI=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i}),this.appInits=J(aI,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const r of this.appInits){const o=r();if(Em(o))n.push(o);else if(BV(o)){const s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});n.push(s)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{i()}).catch(r=>{this.reject(r)}),0===n.length&&i(),this.initialized=!0}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const lI=new re("");function GV(e,t){return Array.isArray(t)?t.reduce(GV,e):{...e,...t}}let aa=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=J(Ok),this.afterRenderEffectManager=J(qf),this.externalTestViews=new Set,this.beforeRender=new Tt,this.afterTick=new Tt,this.componentTypes=[],this.components=[],this.isStable=J(Vu).hasPendingTasks.pipe(Ft(n=>!n)),this._injector=J(jr)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,i){const r=n instanceof g2;if(!this._injector.get(cI).done)throw!r&&function Oc(e){const t=mt(e)||Ai(e)||Ji(e);return null!==t&&t.standalone}(n),new W(405,!1);let s;s=r?n:this._injector.get(Fu).resolveComponentFactory(n),this.componentTypes.push(s.componentType);const a=function ide(e){return e.isBoundToModule}(s)?void 0:this._injector.get(Zl),l=s.create(Bi.NULL,[],i||s.selector,a),d=l.location.nativeElement,u=l.injector.get(VV,null);return u?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),IE(this.components,l),u?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(n){if(this._runningTick)throw new W(101,!1);const i=ut(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(n)}catch(r){this.internalErrorHandler(r)}finally{this.afterTick.next(),this._runningTick=!1,ut(i)}}detectChangesInAttachedViews(n){let i=0;const r=this.afterRenderEffectManager;for(;;){if(i===s2)throw new W(103,!1);if(n){const o=0===i;this.beforeRender.next(o);for(let{_lView:s,notifyErrorHandler:a}of this._views)ode(s,o,a)}if(i++,r.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>dI(o))&&(r.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>dI(o))))break}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;IE(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const i=this._injector.get(lI,[]);[...this._bootstrapListeners,...i].forEach(r=>r(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>IE(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new W(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function IE(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}function ode(e,t,n){!t&&!dI(e)||function sde(e,t,n){let i;n?(i=0,e[Se]|=1024):i=64&e[Se]?0:1,zv(e,t,i)}(e,n,t)}function dI(e){return LT(e)}class ade{constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let WV=(()=>{class e{compileModuleSync(n){return new Sw(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),o=mo(ar(n).declarations).reduce((s,a)=>{const c=mt(a);return c&&s.push(new Xf(c)),s},[]);return new ade(i,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),dde=(()=>{class e{constructor(){this.zone=J(Le),this.applicationRef=J(aa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function ude(){const e=J(Le),t=J(Qs);return n=>e.runOutsideAngular(()=>t.handleError(n))}let pde=(()=>{class e{constructor(){this.subscription=new vi,this.initialized=!1,this.zone=J(Le),this.pendingTasks=J(Vu)}initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Le.assertNotInAngularZone(),queueMicrotask(()=>{null!==n&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Le.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const ca=new re("",{providedIn:"root",factory:()=>J(ca,Et.Optional|Et.SkipSelf)||function fde(){return typeof $localize<"u"&&$localize.locale||ih}()}),uI=new re("");let YV=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const r=function eoe(e="zone.js",t){return"noop"===e?new S2:"zone.js"===e?new Le(t):e}(i?.ngZone,function qV(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const o=function Koe(e,t,n){return new yw(e,t,n)}(n.moduleType,this.injector,function KV(e){return[{provide:Le,useFactory:e},{provide:Hl,multi:!0,useFactory:()=>{const t=J(dde,{optional:!0});return()=>t.initialize()}},{provide:Hl,multi:!0,useFactory:()=>{const t=J(pde);return()=>{t.initialize()}}},{provide:Ok,useFactory:ude}]}(()=>r)),s=o.injector.get(Qs,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:c=>{s.handleError(c)}});o.onDestroy(()=>{IE(this._modules,o),a.unsubscribe()})}),function HV(e,t,n){try{const i=n();return Em(i)?i.catch(r=>{throw t.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>e.handleError(i)),i}}(s,r,()=>{const a=o.injector.get(cI);return a.runInitializers(),a.donePromise.then(()=>(function cU(e){"string"==typeof e&&(aU=e.toLowerCase().replace(/_/g,"-"))}(o.injector.get(ca,ih)||ih),this._moduleDoBootstrap(o),o))})})}bootstrapModule(n,i=[]){const r=GV({},i);return function lde(e,t,n){const i=new Sw(n);return Promise.resolve(i)}(0,0,n).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(n){const i=n.injector.get(aa);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!n.instance.ngDoBootstrap)throw new W(-403,!1);n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new W(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const n=this._injector.get(uI,null);n&&(n.forEach(i=>i()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(i){return new(i||e)(Z(Bi))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"platform"})}}return e})(),Hc=null;const $V=new re("");function XV(e,t,n=[]){const i=`Platform: ${t}`,r=new re(i);return(o=[])=>{let s=hI();if(!s||s.injector.get($V,!1)){const a=[...n,...o,{provide:r,useValue:!0}];e?e(a):function _de(e){if(Hc&&!Hc.get($V,!1))throw new W(400,!1);(function jV(){!function MQ(e){X1=e}(()=>{throw new W(600,!1)})})(),Hc=e;const t=e.get(YV);(function JV(e){e.get(Jk,null)?.forEach(n=>n())})(e)}(function ZV(e=[],t){return Bi.create({name:t,providers:[{provide:ST,useValue:"platform"},{provide:uI,useValue:new Set([()=>Hc=null])},...e]})}(a,i))}return function vde(e){const t=hI();if(!t)throw new W(401,!1);return t}()}}function hI(){return Hc?.get(YV)??null}let ws=(()=>{class e{static{this.__NG_ELEMENT_ID__=bde}}return e})();function bde(e){return function yde(e,t,n){if(zl(e)&&!n){const i=fo(e.index,t);return new Hf(i,i)}return 47&e.type?new Hf(t[Wn],t):null}(on(),K(),!(16&~e))}class iB{constructor(){}supports(t){return aE(t)}create(t){return new Ide(t)}}const wde=(e,t)=>t;class Ide{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||wde}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,i=this._removalsHead,r=0,o=null;for(;n||i;){const s=!i||n&&n.currentIndex<oB(i,r,o)?n:i,a=oB(s,r,o),c=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(n=n._next,null==s.previousIndex)r++;else{o||(o=[]);const l=a-r,d=c-r;if(l!=d){for(let h=0;h<l;h++){const p=h<o.length?o[h]:o[h]=0,m=p+h;d<=m&&m<l&&(o[h]=p+1)}o[s.previousIndex]=d-l}}a!==c&&t(s,a,c)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!aE(t))throw new W(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,o,s,n=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)o=t[a],s=this._trackByFn(a,o),null!==n&&Object.is(n.trackById,s)?(i&&(n=this._verifyReinsertion(n,o,s,a)),Object.is(n.item,o)||this._addIdentityChange(n,o)):(n=this._mismatch(n,o,s,a),i=!0),n=n._next}else r=0,function Xoe(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Symbol.iterator]();let i;for(;!(i=n.next()).done;)t(i.value)}}(t,a=>{s=this._trackByFn(r,a),null!==n&&Object.is(n.trackById,s)?(i&&(n=this._verifyReinsertion(n,a,s,r)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,s,r),i=!0),n=n._next,r++}),this.length=r;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,i,r){let o;return null===t?o=this._itTail:(o=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,o,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,o,r)):t=this._addAfter(new Rde(n,i),o,r),t}_verifyReinsertion(t,n,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?t=this._reinsertAfter(o,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,o=t._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(t,n,i),this._addToMoves(t,i),t}_moveAfter(t,n,i){return this._unlink(t),this._insertAfter(t,n,i),this._addToMoves(t,i),t}_addAfter(t,n,i){return this._insertAfter(t,n,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,i){const r=null===n?this._itHead:n._next;return t._next=r,t._prev=n,null===r?this._itTail=t:r._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new rB),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,i=t._next;return null===n?this._itHead=i:n._next=i,null===i?this._itTail=n:i._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new rB),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Rde{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Ade{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===n||n<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const n=t._prevDup,i=t._nextDup;return null===n?this._head=i:n._nextDup=i,null===i?this._tail=n:i._prevDup=n,null===this._head}}class rB{constructor(){this.map=new Map}put(t){const n=t.trackById;let i=this.map.get(n);i||(i=new Ade,this.map.set(n,i)),i.add(t)}get(t,n){const r=this.map.get(t);return r?r.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function oB(e,t,n){const i=e.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+t+r}function aB(){return new _I([new iB])}let _I=(()=>{class e{static{this.\u0275prov=ae({token:e,providedIn:"root",factory:aB})}constructor(n){this.factories=n}static create(n,i){if(null!=i){const r=i.factories.slice();n=n.concat(r)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||aB()),deps:[[e,new J_,new Z_]]}}find(n){const i=this.factories.find(r=>r.supports(n));if(null!=i)return i;throw new W(901,!1)}}return e})();const Mde=XV(null,"core",[]);let xde=(()=>{class e{constructor(n){}static{this.\u0275fac=function(i){return new(i||e)(Z(aa))}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({})}}return e})();function Ir(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}function OB(e){const t=ut(null);try{return e()}finally{ut(t)}}let PB=null;function Gc(){return PB}class _ue{}const Ut=new re("");let bI=(()=>{class e{historyGo(n){throw new Error("")}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:()=>J(Eue),providedIn:"platform"})}}return e})();const vue=new re("");let Eue=(()=>{class e extends bI{constructor(){super(),this._doc=J(Ut),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Gc().getBaseHref(this._doc)}onPopState(n){const i=Gc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=Gc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,i,r){this._history.pushState(n,i,r)}replaceState(n,i,r){this._history.replaceState(n,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:()=>new e,providedIn:"platform"})}}return e})();function yI(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function MB(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function tc(e){return e&&"?"!==e[0]?"?"+e:e}let od=(()=>{class e{historyGo(n){throw new Error("")}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:()=>J(kB),providedIn:"root"})}}return e})();const xB=new re("");let kB=(()=>{class e extends od{constructor(n,i){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??J(Ut).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return yI(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+tc(this._platformLocation.search),r=this._platformLocation.hash;return r&&n?`${i}${r}`:i}pushState(n,i,r,o){const s=this.prepareExternalUrl(r+tc(o));this._platformLocation.pushState(n,i,s)}replaceState(n,i,r,o){const s=this.prepareExternalUrl(r+tc(o));this._platformLocation.replaceState(n,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static{this.\u0275fac=function(i){return new(i||e)(Z(bI),Z(xB,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),bue=(()=>{class e extends od{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){const i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=yI(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,r,o){let s=this.prepareExternalUrl(r+tc(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(n,i,s)}replaceState(n,i,r,o){let s=this.prepareExternalUrl(r+tc(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static{this.\u0275fac=function(i){return new(i||e)(Z(bI),Z(xB,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})(),ch=(()=>{class e{constructor(n){this._subject=new Wt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const i=this._locationStrategy.getBaseHref();this._basePath=function Cue(e){if(new RegExp("^(https?:)?//").test(e)){const[,n]=e.split(/\/\/[^\/]+/);return n}return e}(MB(LB(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+tc(i))}normalize(n){return e.stripTrailingSlash(function Sue(e,t){if(!e||!t.startsWith(e))return t;const n=t.substring(e.length);return""===n||["/",";","?","#"].includes(n[0])?n:t}(this._basePath,LB(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,i="",r=null){this._locationStrategy.pushState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+tc(i)),r)}replaceState(n,i="",r=null){this._locationStrategy.replaceState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+tc(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{const i=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(r=>r(n,i))}subscribe(n,i,r){return this._subject.subscribe({next:n,error:i,complete:r})}static{this.normalizeQueryParams=tc}static{this.joinWithSlash=yI}static{this.stripTrailingSlash=MB}static{this.\u0275fac=function(i){return new(i||e)(Z(od))}}static{this.\u0275prov=ae({token:e,factory:()=>function yue(){return new ch(Z(od))}(),providedIn:"root"})}}return e})();function LB(e){return e.replace(/\/index.html$/,"")}const NI=/\s+/,zB=[];let PI=(()=>{class e{constructor(n,i){this._ngEl=n,this._renderer=i,this.initialClasses=zB,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(NI):zB}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(NI):n}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const i of n)this._updateState(i,!0);else if(null!=n)for(const i of Object.keys(n))this._updateState(i,!!n[i]);this._applyStateDiff()}_updateState(n,i){const r=this.stateMap.get(n);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(n,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const i=n[0],r=n[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(n,i){(n=n.trim()).length>0&&n.split(NI).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static{this.\u0275fac=function(i){return new(i||e)(H(sn),H(ta))}}static{this.\u0275dir=ye({type:e,selectors:[["","ngClass",""]],inputs:{klass:[we.None,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return e})();class lhe{constructor(t,n,i,r){this.$implicit=t,this.ngForOf=n,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let qB=(()=>{class e{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,i,r){this._viewContainer=n,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new lhe(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),YB(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}n.forEachIdentityChange(r=>{YB(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(n,i){return!0}static{this.\u0275fac=function(i){return new(i||e)(H(Bo),H(Ja),H(_I))}}static{this.\u0275dir=ye({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return e})();function YB(e,t){e.context.$implicit=t.item}let Cm=(()=>{class e{constructor(n,i){this._viewContainer=n,this._context=new dhe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){$B("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){$B("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}static{this.\u0275fac=function(i){return new(i||e)(H(Bo),H(Ja))}}static{this.\u0275dir=ye({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return e})();class dhe{constructor(){this.$implicit=null,this.ngIf=null}}function $B(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${Ri(t)}'.`)}let ZB=(()=>{class e{constructor(n){this._viewContainerRef=n,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(n){if(this._shouldRecreateView(n)){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(n){return!!n.ngTemplateOutlet||!!n.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(n,i,r)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,i,r),get:(n,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static{this.\u0275fac=function(i){return new(i||e)(H(Bo))}}static{this.\u0275dir=ye({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Hr]})}}return e})();class ghe{createSubscription(t,n){return OB(()=>t.subscribe({next:n,error:i=>{throw i}}))}dispose(t){OB(()=>t.unsubscribe())}}class _he{createSubscription(t,n){return t.then(n,i=>{throw i})}dispose(t){}}const vhe=new _he,Ehe=new ghe;let kI=(()=>{class e{constructor(n){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=n}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(n){if(!this._obj){if(n)try{this.markForCheckOnValueUpdate=!1,this._subscribe(n)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return n!==this._obj?(this._dispose(),this.transform(n)):this._latestValue}_subscribe(n){this._obj=n,this._strategy=this._selectStrategy(n),this._subscription=this._strategy.createSubscription(n,i=>this._updateLatestValue(n,i))}_selectStrategy(n){if(Em(n))return vhe;if(BV(n))return Ehe;throw function Rs(e,t){return new W(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(n,i){n===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static{this.\u0275fac=function(i){return new(i||e)(H(ws,16))}}static{this.\u0275pipe=Br({name:"async",type:e,pure:!1,standalone:!0})}}return e})(),qE=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({})}}return e})();const QB="browser";function e3(e){return e===QB}function t3(e){return"server"===e}let Bhe=(()=>{class e{static{this.\u0275prov=ae({token:e,providedIn:"root",factory:()=>e3(J(xc))?new jhe(J(Ut),window):new Ghe})}}return e})();class jhe{constructor(t,n){this.document=t,this.window=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(t){this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){const n=function Hhe(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const o=r.shadowRoot;if(o){const s=o.getElementById(t)||o.querySelector(`[name="${t}"]`);if(s)return s}r=i.nextNode()}}return null}(this.document,t);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(t){this.window.history.scrollRestoration=t}scrollToElement(t){const n=t.getBoundingClientRect(),i=n.left+this.window.pageXOffset,r=n.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(i-o[0],r-o[1])}}class Ghe{setOffset(t){}getScrollPosition(){return[0,0]}scrollToPosition(t){}scrollToAnchor(t){}setHistoryScrollRestoration(t){}}class vpe extends _ue{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class VI extends vpe{static makeCurrent(){!function gue(e){PB??=e}(new VI)}onAndCancel(t,n,i){return t.addEventListener(n,i),()=>{t.removeEventListener(n,i)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function Epe(){return Im=Im||document.querySelector("base"),Im?Im.getAttribute("href"):null}();return null==n?null:function bpe(e){return new URL(e,document.baseURI).pathname}(n)}resetBaseElement(){Im=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function ahe(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const i=n.indexOf("="),[r,o]=-1==i?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===t)return decodeURIComponent(o)}return null}(document.cookie,t)}}let Im=null,Spe=(()=>{class e{build(){return new XMLHttpRequest}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})();const BI=new re("");let d3=(()=>{class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(r=>{r.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,r){return this._findPluginFor(i).addEventListener(n,i,r)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(o=>o.supports(n)),!i)throw new W(5101,!1);return this._eventNameToPlugin.set(n,i),i}static{this.\u0275fac=function(i){return new(i||e)(Z(BI),Z(Le))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})();class u3{constructor(t){this._doc=t}}const jI="ng-app-id";let h3=(()=>{class e{constructor(n,i,r,o={}){this.doc=n,this.appId=i,this.nonce=r,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=t3(o),this.resetHostNodes()}addStyles(n){for(const i of n)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(n){for(const i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){const i=this.styleRef;i.get(n)?.elements?.forEach(r=>r.remove()),i.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${jI}="${this.appId}"]`);if(n?.length){const i=new Map;return n.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(n,i){const r=this.styleRef;if(r.has(n)){const o=r.get(n);return o.usage+=i,o.usage}return r.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){const r=this.styleNodesInDOM,o=r?.get(i);if(o?.parentNode===n)return r.delete(i),o.removeAttribute(jI),o;{const s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=i,this.platformIsServer&&s.setAttribute(jI,this.appId),n.appendChild(s),s}}addStyleToHost(n,i){const r=this.getStyleElement(n,i),o=this.styleRef,s=o.get(i)?.elements;s?s.push(r):o.set(i,{elements:[r],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut),Z(If),Z(a0,8),Z(xc))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})();const HI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},GI=/%COMP%/g,Ipe=new re("",{providedIn:"root",factory:()=>!0});function f3(e,t){return t.map(n=>n.replace(GI,e))}let WI=(()=>{class e{constructor(n,i,r,o,s,a,c,l=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=t3(a),this.defaultRenderer=new zI(n,s,c,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ms.ShadowDom&&(i={...i,encapsulation:ms.Emulated});const r=this.getOrCreateRenderer(n,i);return r instanceof g3?r.applyToHost(n):r instanceof KI&&r.applyStyles(),r}getOrCreateRenderer(n,i){const r=this.rendererByCompId;let o=r.get(i.id);if(!o){const s=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,u=this.platformIsServer;switch(i.encapsulation){case ms.Emulated:o=new g3(c,l,i,this.appId,d,s,a,u);break;case ms.ShadowDom:return new Ope(c,l,n,i,s,a,this.nonce,u);default:o=new KI(c,l,i,d,s,a,u)}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(i){return new(i||e)(Z(d3),Z(h3),Z(If),Z(Ipe),Z(Ut),Z(xc),Z(Le),Z(a0))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})();class zI{constructor(t,n,i,r){this.eventManager=t,this.doc=n,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(t,n){return n?this.doc.createElementNS(HI[n]||n,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,n){(m3(t)?t.content:t).appendChild(n)}insertBefore(t,n,i){t&&(m3(t)?t.content:t).insertBefore(n,i)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let i="string"==typeof t?this.doc.querySelector(t):t;if(!i)throw new W(-5104,!1);return n||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,i,r){if(r){n=r+":"+n;const o=HI[r];o?t.setAttributeNS(o,n,i):t.setAttribute(n,i)}else t.setAttribute(n,i)}removeAttribute(t,n,i){if(i){const r=HI[i];r?t.removeAttributeNS(r,n):t.removeAttribute(`${i}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,i,r){r&(Lc.DashCase|Lc.Important)?t.style.setProperty(n,i,r&Lc.Important?"important":""):t.style[n]=i}removeStyle(t,n,i){i&Lc.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,i){null!=t&&(t[n]=i)}setValue(t,n){t.nodeValue=n}listen(t,n,i){if("string"==typeof t&&!(t=Gc().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${n}`);return this.eventManager.addEventListener(t,n,this.decoratePreventDefault(i))}decoratePreventDefault(t){return n=>{if("__ngUnwrap__"===n)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(n)):t(n))&&n.preventDefault()}}}function m3(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class Ope extends zI{constructor(t,n,i,r,o,s,a,c){super(t,o,s,c),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=f3(r.id,r.styles);for(const d of l){const u=document.createElement("style");a&&u.setAttribute("nonce",a),u.textContent=d,this.shadowRoot.appendChild(u)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,i){return super.insertBefore(this.nodeOrShadowRoot(t),n,i)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class KI extends zI{constructor(t,n,i,r,o,s,a,c){super(t,o,s,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=r,this.styles=c?f3(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class g3 extends KI{constructor(t,n,i,r,o,s,a,c){const l=r+"-"+i.id;super(t,n,i,o,s,a,c,l),this.contentAttr=function Rpe(e){return"_ngcontent-%COMP%".replace(GI,e)}(l),this.hostAttr=function Ape(e){return"_nghost-%COMP%".replace(GI,e)}(l)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,n){const i=super.createElement(t,n);return super.setAttribute(i,this.contentAttr,""),i}}let Npe=(()=>{class e extends u3{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,r){return n.addEventListener(i,r,!1),()=>this.removeEventListener(n,i,r)}removeEventListener(n,i,r){return n.removeEventListener(i,r)}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})();const _3=["alt","control","meta","shift"],Ppe={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Mpe={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let xpe=(()=>{class e extends u3{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,r){const o=e.parseEventName(i),s=e.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Gc().onAndCancel(n,o.domEventName,s))}static parseEventName(n){const i=n.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=e._normalizeKey(i.pop());let s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),_3.forEach(l=>{const d=i.indexOf(l);d>-1&&(i.splice(d,1),s+=l+".")}),s+=o,0!=i.length||0===o.length)return null;const c={};return c.domEventName=r,c.fullKey=s,c}static matchEventFullKeyCode(n,i){let r=Ppe[n.key]||n.key,o="";return i.indexOf("code.")>-1&&(r=n.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),_3.forEach(s=>{s!==r&&(0,Mpe[s])(n)&&(o+=s+".")}),o+=r,o===i)}static eventCallback(n,i,r){return o=>{e.matchEventFullKeyCode(o,n)&&r.runGuarded(()=>i(o))}}static _normalizeKey(n){return"esc"===n?"escape":n}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})();const E3=[{provide:xc,useValue:QB},{provide:Jk,useValue:function kpe(){VI.makeCurrent()},multi:!0},{provide:Ut,useFactory:function Fpe(){return function Cne(e){s0=e}(document),document},deps:[]}],Upe=XV(Mde,"browser",E3),Vpe=new re(""),b3=[{provide:wE,useClass:class ype{addToWindow(t){Zt.getAngularTestability=(i,r=!0)=>{const o=t.findTestabilityInTree(i,r);if(null==o)throw new W(5103,!1);return o},Zt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Zt.getAllAngularRootElements=()=>t.getAllRootElements(),Zt.frameworkStabilizers||(Zt.frameworkStabilizers=[]),Zt.frameworkStabilizers.push(i=>{const r=Zt.getAllAngularTestabilities();let o=r.length;const s=function(){o--,0==o&&i()};r.forEach(a=>{a.whenStable(s)})})}findTestabilityInTree(t,n,i){return null==n?null:t.getTestability(n)??(i?Gc().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null)}},deps:[]},{provide:VV,useClass:rI,deps:[Le,oI,wE]},{provide:rI,useClass:rI,deps:[Le,oI,wE]}],y3=[{provide:ST,useValue:"root"},{provide:Qs,useFactory:function Lpe(){return new Qs},deps:[]},{provide:BI,useClass:Npe,multi:!0,deps:[Ut,Le,xc]},{provide:BI,useClass:xpe,multi:!0,deps:[Ut]},WI,h3,d3,{provide:iw,useExisting:WI},{provide:class Whe{},useClass:Spe,deps:[]},[]];let S3=(()=>{class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:If,useValue:n.appId}]}}static{this.\u0275fac=function(i){return new(i||e)(Z(Vpe,12))}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({providers:[...y3,...b3],imports:[qE,xde]})}}return e})(),Bpe=(()=>{class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Wc(e){return this instanceof Wc?(this.v=e,this):new Wc(e)}function D3(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function XI(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=e[o]&&function(s){return new Promise(function(a,c){!function r(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}(a,c,(s=e[o](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const ZI=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function O3(e){return Lt(e?.then)}function N3(e){return Lt(e[QC])}function P3(e){return Symbol.asyncIterator&&Lt(e?.[Symbol.asyncIterator])}function M3(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const x3=function gfe(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function k3(e){return Lt(e?.[x3])}function L3(e){return function A3(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function s(p){return function(m){return Promise.resolve(m).then(p,u)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(p,m){i[p]&&(r[p]=function(f){return new Promise(function(g,E){o.push([p,f,g,E])>1||c(p,f)})},m&&(r[p]=m(r[p])))}function c(p,m){try{!function l(p){p.value instanceof Wc?Promise.resolve(p.value.v).then(d,u):h(o[0][2],p)}(i[p](m))}catch(f){h(o[0][3],f)}}function d(p){c("next",p)}function u(p){c("throw",p)}function h(p,m){p(m),o.shift(),o.length&&c(o[0][0],o[0][1])}}(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:i,done:r}=yield Wc(n.read());if(r)return yield Wc(void 0);yield yield Wc(i)}}finally{n.releaseLock()}})}function F3(e){return Lt(e?.getReader)}function Ar(e){if(e instanceof Hn)return e;if(null!=e){if(N3(e))return function _fe(e){return new Hn(t=>{const n=e[QC]();if(Lt(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(ZI(e))return function vfe(e){return new Hn(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(O3(e))return function Efe(e){return new Hn(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,tx)})}(e);if(P3(e))return U3(e);if(k3(e))return function bfe(e){return new Hn(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(F3(e))return function yfe(e){return U3(L3(e))}(e)}throw M3(e)}function U3(e){return new Hn(t=>{(function Sfe(e,t){var n,i,r,o;return function I3(e,t,n,i){return new(n||(n=Promise))(function(o,s){function a(d){try{l(i.next(d))}catch(u){s(u)}}function c(d){try{l(i.throw(d))}catch(u){s(u)}}function l(d){d.done?o(d.value):function r(o){return o instanceof n?o:new n(function(s){s(o)})}(d.value).then(a,c)}l((i=i.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=D3(e);!(i=yield n.next()).done;)if(t.next(i.value),t.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=n.return)&&(yield o.call(n))}finally{if(r)throw r.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function rc(e,t,n,i=0,r=!1){const o=t.schedule(function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(o),!r)return o}function V3(e,t=0){return ci((n,i)=>{n.subscribe(Gn(i,r=>rc(i,e,()=>i.next(r),t),()=>rc(i,e,()=>i.complete(),t),r=>rc(i,e,()=>i.error(r),t)))})}function B3(e,t=0){return ci((n,i)=>{i.add(e.schedule(()=>n.subscribe(i),t))})}function j3(e,t){if(!e)throw new Error("Iterable cannot be null");return new Hn(n=>{rc(n,t,()=>{const i=e[Symbol.asyncIterator]();rc(n,t,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function xi(e,t){return t?function Afe(e,t){if(null!=e){if(N3(e))return function Cfe(e,t){return Ar(e).pipe(B3(t),V3(t))}(e,t);if(ZI(e))return function wfe(e,t){return new Hn(n=>{let i=0;return t.schedule(function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())})})}(e,t);if(O3(e))return function Tfe(e,t){return Ar(e).pipe(B3(t),V3(t))}(e,t);if(P3(e))return j3(e,t);if(k3(e))return function Ife(e,t){return new Hn(n=>{let i;return rc(n,t,()=>{i=e[x3](),rc(n,t,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void n.error(s)}o?n.complete():n.next(r)},0,!0)}),()=>Lt(i?.return)&&i.return()})}(e,t);if(F3(e))return function Rfe(e,t){return j3(L3(e),t)}(e,t)}throw M3(e)}(e,t):Ar(e)}const{isArray:Dfe}=Array,{getPrototypeOf:Ofe,prototype:Nfe,keys:Pfe}=Object;function H3(e){if(1===e.length){const t=e[0];if(Dfe(t))return{args:t,keys:null};if(function Mfe(e){return e&&"object"==typeof e&&Ofe(e)===Nfe}(t)){const n=Pfe(t);return{args:n.map(i=>t[i]),keys:n}}}return{args:e,keys:null}}function G3(e){return e&&Lt(e.schedule)}function JI(e){return e[e.length-1]}function W3(e){return Lt(JI(e))?e.pop():void 0}function Am(e){return G3(JI(e))?e.pop():void 0}const{isArray:kfe}=Array;function QI(e){return Ft(t=>function Lfe(e,t){return kfe(t)?e(...t):e(t)}(e,t))}function z3(e,t){return e.reduce((n,i,r)=>(n[i]=t[r],n),{})}let K3=(()=>{class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}static{this.\u0275fac=function(i){return new(i||e)(H(ta),H(sn))}}static{this.\u0275dir=ye({type:e})}}return e})(),sd=(()=>{class e extends K3{static{this.\u0275fac=(()=>{let n;return function(r){return(n||(n=bi(e)))(r||e)}})()}static{this.\u0275dir=ye({type:e,features:[Pt]})}}return e})();const As=new re(""),Vfe={provide:As,useExisting:pn(()=>ZE),multi:!0},jfe=new re("");let ZE=(()=>{class e extends K3{constructor(n,i,r){super(n,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Bfe(){const e=Gc()?Gc().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}static{this.\u0275fac=function(i){return new(i||e)(H(ta),H(sn),H(jfe,8))}}static{this.\u0275dir=ye({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&zt("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[mn([Vfe]),Pt]})}}return e})();function zc(e){return null==e||("string"==typeof e||Array.isArray(e))&&0===e.length}function Y3(e){return null!=e&&"number"==typeof e.length}const Gi=new re(""),Kc=new re(""),Hfe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class $3{static min(t){return function X3(e){return t=>{if(zc(t.value)||zc(e))return null;const n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}(t)}static max(t){return function Z3(e){return t=>{if(zc(t.value)||zc(e))return null;const n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}(t)}static required(t){return function J3(e){return zc(e.value)?{required:!0}:null}(t)}static requiredTrue(t){return function Q3(e){return!0===e.value?null:{required:!0}}(t)}static email(t){return function ej(e){return zc(e.value)||Hfe.test(e.value)?null:{email:!0}}(t)}static minLength(t){return function tj(e){return t=>zc(t.value)||!Y3(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function nj(e){return t=>Y3(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}(t)}static pattern(t){return function ij(e){if(!e)return JE;let t,n;return"string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),i=>{if(zc(i.value))return null;const r=i.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}(t)}static nullValidator(t){return null}static compose(t){return lj(t)}static composeAsync(t){return dj(t)}}function JE(e){return null}function rj(e){return null!=e}function oj(e){return Em(e)?xi(e):e}function sj(e){let t={};return e.forEach(n=>{t=null!=n?{...t,...n}:t}),0===Object.keys(t).length?null:t}function aj(e,t){return t.map(n=>n(e))}function cj(e){return e.map(t=>function Gfe(e){return!e.validate}(t)?t:n=>t.validate(n))}function lj(e){if(!e)return null;const t=e.filter(rj);return 0==t.length?null:function(n){return sj(aj(n,t))}}function eR(e){return null!=e?lj(cj(e)):null}function dj(e){if(!e)return null;const t=e.filter(rj);return 0==t.length?null:function(n){return function Ffe(...e){const t=W3(e),{args:n,keys:i}=H3(e),r=new Hn(o=>{const{length:s}=n;if(!s)return void o.complete();const a=new Array(s);let c=s,l=s;for(let d=0;d<s;d++){let u=!1;Ar(n[d]).subscribe(Gn(o,h=>{u||(u=!0,l--),a[d]=h},()=>c--,void 0,()=>{(!c||!u)&&(l||o.next(i?z3(i,a):a),o.complete())}))}});return t?r.pipe(QI(t)):r}(aj(n,t).map(oj)).pipe(Ft(sj))}}function tR(e){return null!=e?dj(cj(e)):null}function uj(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function hj(e){return e._rawValidators}function pj(e){return e._rawAsyncValidators}function nR(e){return e?Array.isArray(e)?e:[e]:[]}function QE(e,t){return Array.isArray(e)?e.includes(t):e===t}function fj(e,t){const n=nR(t);return nR(e).forEach(r=>{QE(n,r)||n.push(r)}),n}function mj(e,t){return nR(t).filter(n=>!QE(e,n))}class gj{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=eR(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=tR(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,n){return!!this.control&&this.control.hasError(t,n)}getError(t,n){return this.control?this.control.getError(t,n):null}}class Dr extends gj{get formDirective(){return null}get path(){return null}}class oc extends gj{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class _j{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let vj=(()=>{class e extends _j{constructor(n){super(n)}static{this.\u0275fac=function(i){return new(i||e)(H(oc,2))}}static{this.\u0275dir=ye({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&wt("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Pt]})}}return e})(),Ej=(()=>{class e extends _j{constructor(n){super(n)}static{this.\u0275fac=function(i){return new(i||e)(H(Dr,10))}}static{this.\u0275dir=ye({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){2&i&&wt("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[Pt]})}}return e})();const Dm="VALID",tb="INVALID",dh="PENDING",Om="DISABLED";function oR(e){return(nb(e)?e.validators:e)||null}function sR(e,t){return(nb(t)?t.asyncValidators:e)||null}function nb(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function yj(e,t,n){const i=e.controls;if(!(t?Object.keys(i):i).length)throw new W(1e3,"");if(!i[n])throw new W(1001,"")}function Sj(e,t,n){e._forEachChild((i,r)=>{if(void 0===n[r])throw new W(1002,"")})}class ib{constructor(t,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Dm}get invalid(){return this.status===tb}get pending(){return this.status==dh}get disabled(){return this.status===Om}get enabled(){return this.status!==Om}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(fj(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(fj(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(mj(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(mj(t,this._rawAsyncValidators))}hasValidator(t){return QE(this._rawValidators,t)}hasAsyncValidator(t){return QE(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=dh,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=Om,this.errors=null,this._forEachChild(i=>{i.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:n}),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=Dm,this._forEachChild(i=>{i.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:n}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Dm||this.status===dh)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Om:Dm}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=dh,this._hasOwnPendingAsyncValidator=!0;const n=oj(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,n={}){this.errors=t,this._updateControlsErrors(!1!==n.emitEvent)}get(t){let n=t;return null==n||(Array.isArray(n)||(n=n.split(".")),0===n.length)?null:n.reduce((i,r)=>i&&i._find(r),this)}getError(t,n){const i=n?this.get(n):this;return i&&i.errors?i.errors[t]:null}hasError(t,n){return!!this.getError(t,n)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Wt,this.statusChanges=new Wt}_calculateStatus(){return this._allControlsDisabled()?Om:this.errors?tb:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(dh)?dh:this._anyControlsHaveStatus(tb)?tb:Dm}_anyControlsHaveStatus(t){return this._anyControls(n=>n.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){nb(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function qfe(e){return Array.isArray(e)?eR(e):e||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function Yfe(e){return Array.isArray(e)?tR(e):e||null}(this._rawAsyncValidators)}}class Nm extends ib{constructor(t,n,i){super(oR(n),sR(i,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,n){return this.controls[t]?this.controls[t]:(this.controls[t]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(t,n,i={}){this.registerControl(t,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(t,n,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],n&&this.registerControl(t,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,n={}){Sj(this,0,t),Object.keys(t).forEach(i=>{yj(this,!0,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(Object.keys(t).forEach(i=>{const r=this.controls[i];r&&r.patchValue(t[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t={},n={}){this._forEachChild((i,r)=>{i.reset(t?t[r]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(t,n,i)=>(t[i]=n.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(n,i)=>!!i._syncPendingControls()||n);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(n=>{const i=this.controls[n];i&&t(i,n)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[n,i]of Object.entries(this.controls))if(this.contains(n)&&t(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(n,i,r)=>((i.enabled||this.disabled)&&(n[r]=i.value),n))}_reduceChildren(t,n){let i=t;return this._forEachChild((r,o)=>{i=n(i,r,o)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class Cj extends Nm{}const uh=new re("CallSetDisabledState",{providedIn:"root",factory:()=>rb}),rb="always";function Pm(e,t,n=rb){aR(e,t),t.valueAccessor.writeValue(e.value),(e.disabled||"always"===n)&&t.valueAccessor.setDisabledState?.(e.disabled),function Xfe(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&Tj(e,t)})}(e,t),function Jfe(e,t){const n=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};e.registerOnChange(n),t._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,t),function Zfe(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&Tj(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function $fe(e,t){if(t.valueAccessor.setDisabledState){const n=i=>{t.valueAccessor.setDisabledState(i)};e.registerOnDisabledChange(n),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,t)}function sb(e,t,n=!0){const i=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(i),t.valueAccessor.registerOnTouched(i)),cb(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function ab(e,t){e.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(t)})}function aR(e,t){const n=hj(e);null!==t.validator?e.setValidators(uj(n,t.validator)):"function"==typeof n&&e.setValidators([n]);const i=pj(e);null!==t.asyncValidator?e.setAsyncValidators(uj(i,t.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]);const r=()=>e.updateValueAndValidity();ab(t._rawValidators,r),ab(t._rawAsyncValidators,r)}function cb(e,t){let n=!1;if(null!==e){if(null!==t.validator){const r=hj(e);if(Array.isArray(r)&&r.length>0){const o=r.filter(s=>s!==t.validator);o.length!==r.length&&(n=!0,e.setValidators(o))}}if(null!==t.asyncValidator){const r=pj(e);if(Array.isArray(r)&&r.length>0){const o=r.filter(s=>s!==t.asyncValidator);o.length!==r.length&&(n=!0,e.setAsyncValidators(o))}}}const i=()=>{};return ab(t._rawValidators,i),ab(t._rawAsyncValidators,i),n}function Tj(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function wj(e,t){aR(e,t)}function Ij(e,t){e._syncPendingControls(),t.forEach(n=>{const i=n.control;"submit"===i.updateOn&&i._pendingChange&&(n.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}const ime={provide:Dr,useExisting:pn(()=>lb)},Mm=Promise.resolve();let lb=(()=>{class e extends Dr{constructor(n,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Wt,this.form=new Nm({},eR(n),tR(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){Mm.then(()=>{const i=this._findContainer(n.path);n.control=i.registerControl(n.name,n.control),Pm(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){Mm.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){Mm.then(()=>{const i=this._findContainer(n.path),r=new Nm({});wj(r,n),i.registerControl(n.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){Mm.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,i){Mm.then(()=>{this.form.get(n.path).setValue(i)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,Ij(this.form,this._directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}static{this.\u0275fac=function(i){return new(i||e)(H(Gi,10),H(Kc,10),H(uh,8))}}static{this.\u0275dir=ye({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){1&i&&zt("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:[we.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[mn([ime]),Pt]})}}return e})();function Rj(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}function Aj(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}const xm=class extends ib{constructor(t=null,n,i){super(oR(n),sR(i,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),nb(n)&&(n.nonNullable||n.initialValueIsDefault)&&(this.defaultValue=Aj(t)?t.value:t)}setValue(t,n={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(t,n={}){this.setValue(t,n)}reset(t=this.defaultValue,n={}){this._applyFormState(t),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Rj(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Rj(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){Aj(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};Promise.resolve();let Mj=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275dir=ye({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return e})();const uR=new re(""),hme={provide:Dr,useExisting:pn(()=>km)};let km=(()=>{class e extends Dr{constructor(n,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Wt,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(cb(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){const i=this.form.get(n.path);return Pm(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){sb(n.control||null,n,!1),function nme(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,Ij(this.form,this.directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{const i=n.control,r=this.form.get(n.path);i!==r&&(sb(i||null,n),(e=>e instanceof xm)(r)&&(Pm(r,n,this.callSetDisabledState),n.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){const i=this.form.get(n.path);wj(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){const i=this.form.get(n.path);i&&function Qfe(e,t){return cb(e,t)}(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){aR(this.form,this),this._oldForm&&cb(this._oldForm,this)}_checkFormPresent(){}static{this.\u0275fac=function(i){return new(i||e)(H(Gi,10),H(Kc,10),H(uh,8))}}static{this.\u0275dir=ye({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,r){1&i&&zt("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[we.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[mn([hme]),Pt,Hr]})}}return e})();const mme={provide:oc,useExisting:pn(()=>fR)};let fR=(()=>{class e extends oc{set isDisabled(n){}static{this._ngModelWarningSentOnce=!1}constructor(n,i,r,o,s){super(),this._ngModelWarningConfig=s,this._added=!1,this.name=null,this.update=new Wt,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function dR(e,t){if(!t)return null;let n,i,r;return Array.isArray(t),t.forEach(o=>{o.constructor===ZE?n=o:function tme(e){return Object.getPrototypeOf(e.constructor)===sd}(o)?i=o:r=o}),r||i||n||null}(0,o)}ngOnChanges(n){this._added||this._setUpControl(),function lR(e,t){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return function ob(e,t){return[...t.path,e]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(i){return new(i||e)(H(Dr,13),H(Gi,10),H(Kc,10),H(As,10),H(uR,8))}}static{this.\u0275dir=ye({type:e,selectors:[["","formControlName",""]],inputs:{name:[we.None,"formControlName","name"],isDisabled:[we.None,"disabled","isDisabled"],model:[we.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[mn([mme]),Pt,Hr]})}}return e})(),Ome=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({})}}return e})();class $j extends ib{constructor(t,n,i){super(oR(n),sR(i,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,n={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(t,n,i={}){this.controls.splice(t,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,n={}){let i=this._adjustIndex(t);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(t,n,i={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),n&&(this.controls.splice(r,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,n={}){Sj(this,0,t),t.forEach((i,r)=>{yj(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t=[],n={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((n,i)=>!!i._syncPendingControls()||n,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((n,i)=>{t(n,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(n=>n.enabled&&t(n))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function Xj(e){return!!e&&(void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn)}let ER,Nme=(()=>{class e{constructor(){this.useNonNullable=!1}get nonNullable(){const n=new e;return n.useNonNullable=!0,n}group(n,i=null){const r=this._reduceControls(n);let o={};return Xj(i)?o=i:null!==i&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new Nm(r,o)}record(n,i=null){const r=this._reduceControls(n);return new Cj(r,i)}control(n,i,r){let o={};return this.useNonNullable?(Xj(i)?o=i:(o.validators=i,o.asyncValidators=r),new xm(n,{...o,nonNullable:!0})):new xm(n,i,r)}array(n,i,r){const o=n.map(s=>this._createControl(s));return new $j(o,i,r)}_reduceControls(n){const i={};return Object.keys(n).forEach(r=>{i[r]=this._createControl(n[r])}),i}_createControl(n){return n instanceof xm||n instanceof ib?n:Array.isArray(n)?this.control(n[0],n.length>1?n[1]:null,n.length>2?n[2]:null):this.control(n)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Pme=(()=>{class e extends Nme{group(n,i=null){return super.group(n,i)}control(n,i,r){return super.control(n,i,r)}array(n,i,r){return super.array(n,i,r)}static{this.\u0275fac=(()=>{let n;return function(r){return(n||(n=bi(e)))(r||e)}})()}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Mme=(()=>{class e{static withConfig(n){return{ngModule:e,providers:[{provide:uR,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:uh,useValue:n.callSetDisabledState??rb}]}}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({imports:[Ome]})}}return e})();try{ER=typeof Intl<"u"&&Intl.v8BreakIterator}catch{ER=!1}let hh,Qi=(()=>{class e{constructor(n){this._platformId=n,this.isBrowser=this._platformId?e3(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!ER)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(i){return new(i||e)(Z(xc))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const Zj=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function Jj(){if(hh)return hh;if("object"!=typeof document||!document)return hh=new Set(Zj),hh;let e=document.createElement("input");return hh=new Set(Zj.filter(t=>(e.setAttribute("type",t),e.type===t))),hh}let Lm,cd,bR;function ph(e){return function xme(){if(null==Lm&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Lm=!0}))}finally{Lm=Lm||!1}return Lm}()?e:!!e.capture}function kme(){if(null==cd){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return cd=!1,cd;if("scrollBehavior"in document.documentElement.style)cd=!0;else{const e=Element.prototype.scrollTo;cd=!!e&&!/\{\s*\[native code\]\s*\}/.test(e.toString())}}return cd}function qc(e){return e.composedPath?e.composedPath()[0]:e.target}function yR(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function He(...e){return xi(e,Am(e))}function er(e,t,n){const i=Lt(e)||t||n?{next:e,error:t,complete:n}:e;return i?ci((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe(Gn(o,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),o.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),o.complete()},c=>{var l;a=!1,null===(l=i.error)||void 0===l||l.call(i,c),o.error(c)},()=>{var c,l;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):Rc}class ige extends vi{constructor(t,n){super()}schedule(t,n=0){return this}}const ub={setInterval(e,t,...n){const{delegate:i}=ub;return i?.setInterval?i.setInterval(e,t,...n):setInterval(e,t,...n)},clearInterval(e){const{delegate:t}=ub;return(t?.clearInterval||clearInterval)(e)},delegate:void 0};class SR extends ige{constructor(t,n){super(t,n),this.scheduler=t,this.work=n,this.pending=!1}schedule(t,n=0){var i;if(this.closed)return this;this.state=t;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,n)),this.pending=!0,this.delay=n,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(o,this.id,n),this}requestAsyncId(t,n,i=0){return ub.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,n,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return n;null!=n&&ub.clearInterval(n)}execute(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,n);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,n){let r,i=!1;try{this.work(t)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:n}=this,{actions:i}=n;this.work=this.state=this.scheduler=null,this.pending=!1,B_(i,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,super.unsubscribe()}}}const CR={now:()=>(CR.delegate||Date).now(),delegate:void 0};class Um{constructor(t,n=Um.now){this.schedulerActionCtor=t,this.now=n}schedule(t,n=0,i){return new this.schedulerActionCtor(this,t).schedule(i,n)}}Um.now=CR.now;class TR extends Um{constructor(t,n=Um.now){super(t,n),this.actions=[],this._active=!1}flush(t){const{actions:n}=this;if(this._active)return void n.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=n.shift());if(this._active=!1,i){for(;t=n.shift();)t.unsubscribe();throw i}}}const wR=new TR(SR),rge=wR;function Yr(e,t){return ci((n,i)=>{let r=0;n.subscribe(Gn(i,o=>e.call(t,o,r++)&&i.next(o)))})}const Wo=new Hn(e=>e.complete());function la(e){return e<=0?()=>Wo:ci((t,n)=>{let i=0;t.subscribe(Gn(n,r=>{++i<=e&&(n.next(r),e<=i&&n.complete())}))})}function t4(e){return Yr((t,n)=>e<=n)}function age(e,t){return e===t}function mr(e){return ci((t,n)=>{Ar(e).subscribe(Gn(n,()=>n.complete(),YC)),!n.closed&&t.subscribe(n)})}let cge=(()=>{class e{create(n){return typeof MutationObserver>"u"?null:new MutationObserver(n)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),n4=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({providers:[cge]})}}return e})();function fh(e){return null!=e&&"false"!=`${e}`}function i4(e,t=0){return function lge(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):t}function hb(e){return Array.isArray(e)?e:[e]}function Ci(e){return null==e?"":"string"==typeof e?e:`${e}px`}function Yc(e){return e instanceof sn?e.nativeElement:e}function pb(...e){const t=Am(e),n=W3(e),{args:i,keys:r}=H3(e);if(0===i.length)return xi([],t);const o=new Hn(function dge(e,t,n=Rc){return i=>{r4(t,()=>{const{length:r}=e,o=new Array(r);let s=r,a=r;for(let c=0;c<r;c++)r4(t,()=>{const l=xi(e[c],t);let d=!1;l.subscribe(Gn(i,u=>{o[c]=u,d||(d=!0,a--),a||i.next(n(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}(i,t,r?s=>z3(r,s):Rc));return n?o.pipe(QI(n)):o}function r4(e,t,n){e?rc(n,e,t):t()}function tr(e,t,n=1/0){return Lt(t)?tr((i,r)=>Ft((o,s)=>t(i,o,r,s))(Ar(e(i,r))),n):("number"==typeof t&&(n=t),ci((i,r)=>function uge(e,t,n,i,r,o,s,a){const c=[];let l=0,d=0,u=!1;const h=()=>{u&&!c.length&&!l&&t.complete()},p=f=>l<i?m(f):c.push(f),m=f=>{o&&t.next(f),l++;let g=!1;Ar(n(f,d++)).subscribe(Gn(t,E=>{r?.(E),o?p(E):t.next(E)},()=>{g=!0},void 0,()=>{if(g)try{for(l--;c.length&&l<i;){const E=c.shift();s?rc(t,s,()=>m(E)):m(E)}h()}catch(E){t.error(E)}}))};return e.subscribe(Gn(t,p,()=>{u=!0,h()})),()=>{a?.()}}(i,r,e,n)))}function mh(e=1/0){return tr(Rc,e)}function fb(...e){return function hge(){return mh(1)}()(xi(e,Am(e)))}function o4(...e){const t=Am(e);return ci((n,i)=>{(t?fb(e,n,t):fb(e,n)).subscribe(i)})}const s4=new Set;let ld,pge=(()=>{class e{constructor(n,i){this._platform=n,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):mge}matchMedia(n){return(this._platform.WEBKIT||this._platform.BLINK)&&function fge(e,t){if(!s4.has(e))try{ld||(ld=document.createElement("style"),t&&ld.setAttribute("nonce",t),ld.setAttribute("type","text/css"),document.head.appendChild(ld)),ld.sheet&&(ld.sheet.insertRule(`@media ${e} {body{ }}`,0),s4.add(e))}catch(n){console.error(n)}}(n,this._nonce),this._matchMedia(n)}static{this.\u0275fac=function(i){return new(i||e)(Z(Qi),Z(a0,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function mge(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let gge=(()=>{class e{constructor(n,i){this._mediaMatcher=n,this._zone=i,this._queries=new Map,this._destroySubject=new Tt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(n){return a4(hb(n)).some(r=>this._registerQuery(r).mql.matches)}observe(n){let o=pb(a4(hb(n)).map(s=>this._registerQuery(s).observable));return o=fb(o.pipe(la(1)),o.pipe(t4(1),function e4(e,t=wR){return ci((n,i)=>{let r=null,o=null,s=null;const a=()=>{if(r){r.unsubscribe(),r=null;const l=o;o=null,i.next(l)}};function c(){const l=s+e,d=t.now();if(d<l)return r=this.schedule(void 0,l-d),void i.add(r);a()}n.subscribe(Gn(i,l=>{o=l,s=t.now(),r||(r=t.schedule(c,e),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}(0))),o.pipe(Ft(s=>{const a={matches:!1,breakpoints:{}};return s.forEach(({matches:c,query:l})=>{a.matches=a.matches||c,a.breakpoints[l]=c}),a}))}_registerQuery(n){if(this._queries.has(n))return this._queries.get(n);const i=this._mediaMatcher.matchMedia(n),o={observable:new Hn(s=>{const a=c=>this._zone.run(()=>s.next(c));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(o4(i),Ft(({matches:s})=>({query:n,matches:s})),mr(this._destroySubject)),mql:i};return this._queries.set(n,o),o}static{this.\u0275fac=function(i){return new(i||e)(Z(pge),Z(Le))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function a4(e){return e.map(t=>t.split(",")).reduce((t,n)=>t.concat(n)).map(t=>t.trim())}function mb(e,t){return e.getAttribute(t)?.match(/\S+/g)??[]}const l4="cdk-describedby-message",gb="cdk-describedby-host";let IR=0,Ege=(()=>{class e{constructor(n,i){this._platform=i,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+IR++,this._document=n,this._id=J(If)+"-"+IR++}describe(n,i,r){if(!this._canBeDescribed(n,i))return;const o=RR(i,r);"string"!=typeof i?(d4(i,this._id),this._messageRegistry.set(o,{messageElement:i,referenceCount:0})):this._messageRegistry.has(o)||this._createMessageElement(i,r),this._isElementDescribedByMessage(n,o)||this._addMessageReference(n,o)}removeDescription(n,i,r){if(!i||!this._isElementNode(n))return;const o=RR(i,r);if(this._isElementDescribedByMessage(n,o)&&this._removeMessageReference(n,o),"string"==typeof i){const s=this._messageRegistry.get(o);s&&0===s.referenceCount&&this._deleteMessageElement(o)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const n=this._document.querySelectorAll(`[${gb}="${this._id}"]`);for(let i=0;i<n.length;i++)this._removeCdkDescribedByReferenceIds(n[i]),n[i].removeAttribute(gb);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(n,i){const r=this._document.createElement("div");d4(r,this._id),r.textContent=n,i&&r.setAttribute("role",i),this._createMessagesContainer(),this._messagesContainer.appendChild(r),this._messageRegistry.set(RR(n,i),{messageElement:r,referenceCount:0})}_deleteMessageElement(n){this._messageRegistry.get(n)?.messageElement?.remove(),this._messageRegistry.delete(n)}_createMessagesContainer(){if(this._messagesContainer)return;const n="cdk-describedby-message-container",i=this._document.querySelectorAll(`.${n}[platform="server"]`);for(let o=0;o<i.length;o++)i[o].remove();const r=this._document.createElement("div");r.style.visibility="hidden",r.classList.add(n),r.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&r.setAttribute("platform","server"),this._document.body.appendChild(r),this._messagesContainer=r}_removeCdkDescribedByReferenceIds(n){const i=mb(n,"aria-describedby").filter(r=>0!=r.indexOf(l4));n.setAttribute("aria-describedby",i.join(" "))}_addMessageReference(n,i){const r=this._messageRegistry.get(i);(function _ge(e,t,n){const i=mb(e,t);n=n.trim(),!i.some(r=>r.trim()===n)&&(i.push(n),e.setAttribute(t,i.join(" ")))})(n,"aria-describedby",r.messageElement.id),n.setAttribute(gb,this._id),r.referenceCount++}_removeMessageReference(n,i){const r=this._messageRegistry.get(i);r.referenceCount--,function vge(e,t,n){const i=mb(e,t);n=n.trim();const r=i.filter(o=>o!==n);r.length?e.setAttribute(t,r.join(" ")):e.removeAttribute(t)}(n,"aria-describedby",r.messageElement.id),n.removeAttribute(gb)}_isElementDescribedByMessage(n,i){const r=mb(n,"aria-describedby"),o=this._messageRegistry.get(i),s=o&&o.messageElement.id;return!!s&&-1!=r.indexOf(s)}_canBeDescribed(n,i){if(!this._isElementNode(n))return!1;if(i&&"object"==typeof i)return!0;const r=null==i?"":`${i}`.trim(),o=n.getAttribute("aria-label");return!(!r||o&&o.trim()===r)}_isElementNode(n){return n.nodeType===this._document.ELEMENT_NODE}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut),Z(Qi))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function RR(e,t){return"string"==typeof e?`${t||""}/${e}`:e}function d4(e,t){e.id||(e.id=`${l4}-${t}-${IR++}`)}function h4(e){return 0===e.buttons||0===e.detail}function p4(e){const t=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const Rge=new re("cdk-input-modality-detector-options"),Age={ignoreKeys:[18,17,224,91,16]},gh=ph({passive:!0,capture:!0});let Dge=(()=>{class e{get mostRecentModality(){return this._modality.value}constructor(n,i,r,o){this._platform=n,this._mostRecentTarget=null,this._modality=new co(null),this._lastTouchMs=0,this._onKeydown=s=>{this._options?.ignoreKeys?.some(a=>a===s.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=qc(s))},this._onMousedown=s=>{Date.now()-this._lastTouchMs<650||(this._modality.next(h4(s)?"keyboard":"mouse"),this._mostRecentTarget=qc(s))},this._onTouchstart=s=>{p4(s)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=qc(s))},this._options={...Age,...o},this.modalityDetected=this._modality.pipe(t4(1)),this.modalityChanged=this.modalityDetected.pipe(function sge(e,t=Rc){return e=e??age,ci((n,i)=>{let r,o=!0;n.subscribe(Gn(i,s=>{const a=t(s);(o||!e(r,a))&&(o=!1,r=a,i.next(s))}))})}()),n.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,gh),r.addEventListener("mousedown",this._onMousedown,gh),r.addEventListener("touchstart",this._onTouchstart,gh)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,gh),document.removeEventListener("mousedown",this._onMousedown,gh),document.removeEventListener("touchstart",this._onTouchstart,gh))}static{this.\u0275fac=function(i){return new(i||e)(Z(Qi),Z(Le),Z(Ut),Z(Rge,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var _b=function(e){return e[e.IMMEDIATE=0]="IMMEDIATE",e[e.EVENTUAL=1]="EVENTUAL",e}(_b||{});const Nge=new re("cdk-focus-monitor-default-options"),vb=ph({passive:!0,capture:!0});let AR=(()=>{class e{constructor(n,i,r,o,s){this._ngZone=n,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Tt,this._rootNodeFocusAndBlurListener=a=>{for(let l=qc(a);l;l=l.parentElement)"focus"===a.type?this._onFocus(a,l):this._onBlur(a,l)},this._document=o,this._detectionMode=s?.detectionMode||_b.IMMEDIATE}monitor(n,i=!1){const r=Yc(n);if(!this._platform.isBrowser||1!==r.nodeType)return He();const o=function Fme(e){if(function Lme(){if(null==bR){const e=typeof document<"u"?document.head:null;bR=!(!e||!e.createShadowRoot&&!e.attachShadow)}return bR}()){const t=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(r)||this._getDocument(),s=this._elementInfo.get(r);if(s)return i&&(s.checkChildren=!0),s.subject;const a={checkChildren:i,subject:new Tt,rootNode:o};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(n){const i=Yc(n),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(n,i,r){const o=Yc(n);o===this._getDocument().activeElement?this._getClosestElementsInfo(o).forEach(([a,c])=>this._originChanged(a,i,c)):(this._setOrigin(i),"function"==typeof o.focus&&o.focus(r))}ngOnDestroy(){this._elementInfo.forEach((n,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(n){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(n)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:n&&this._isLastInteractionFromInputLabel(n)?"mouse":"program"}_shouldBeAttributedToTouch(n){return this._detectionMode===_b.EVENTUAL||!!n?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(n,i){n.classList.toggle("cdk-focused",!!i),n.classList.toggle("cdk-touch-focused","touch"===i),n.classList.toggle("cdk-keyboard-focused","keyboard"===i),n.classList.toggle("cdk-mouse-focused","mouse"===i),n.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(n,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=n,this._originFromTouchInteraction="touch"===n&&i,this._detectionMode===_b.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(n,i){const r=this._elementInfo.get(i),o=qc(n);!r||!r.checkChildren&&i!==o||this._originChanged(i,this._getFocusOrigin(o),r)}_onBlur(n,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&n.relatedTarget instanceof Node&&i.contains(n.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(n,i){n.subject.observers.length&&this._ngZone.run(()=>n.subject.next(i))}_registerGlobalListeners(n){if(!this._platform.isBrowser)return;const i=n.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,vb),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,vb)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(mr(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(n){const i=n.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,vb),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,vb),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(n,i,r){this._setClasses(n,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(n){const i=[];return this._elementInfo.forEach((r,o)=>{(o===n||r.checkChildren&&o.contains(n))&&i.push([o,r])}),i}_isLastInteractionFromInputLabel(n){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===n||"INPUT"!==n.nodeName&&"TEXTAREA"!==n.nodeName||n.disabled)return!1;const o=n.labels;if(o)for(let s=0;s<o.length;s++)if(o[s].contains(i))return!0;return!1}static{this.\u0275fac=function(i){return new(i||e)(Z(Le),Z(Qi),Z(Dge),Z(Ut,8),Z(Nge,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var dd=function(e){return e[e.NONE=0]="NONE",e[e.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",e[e.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",e}(dd||{});const m4="cdk-high-contrast-black-on-white",g4="cdk-high-contrast-white-on-black",DR="cdk-high-contrast-active";let _4=(()=>{class e{constructor(n,i){this._platform=n,this._document=i,this._breakpointSubscription=J(gge).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return dd.NONE;const n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(n):null,o=(r&&r.backgroundColor||"").replace(/ /g,"");switch(n.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return dd.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return dd.BLACK_ON_WHITE}return dd.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const n=this._document.body.classList;n.remove(DR,m4,g4),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();i===dd.BLACK_ON_WHITE?n.add(DR,m4):i===dd.WHITE_ON_BLACK&&n.add(DR,g4)}}static{this.\u0275fac=function(i){return new(i||e)(Z(Qi),Z(Ut))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Pge=(()=>{class e{constructor(n){n._applyBodyHighContrastModeCssClasses()}static{this.\u0275fac=function(i){return new(i||e)(Z(_4))}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({imports:[n4]})}}return e})();const Mge=new re("cdk-dir-doc",{providedIn:"root",factory:function xge(){return J(Ut)}}),kge=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let OR=(()=>{class e{constructor(n){this.value="ltr",this.change=new Wt,n&&(this.value=function Lge(e){const t=e?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?kge.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((n.body?n.body.dir:null)||(n.documentElement?n.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(i){return new(i||e)(Z(Mge,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Vm=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({})}}return e})();const Fge=["mat-internal-form-field",""],Uge=["*"],Bge=new re("mat-sanity-checks",{providedIn:"root",factory:function Vge(){return!0}});let zo=(()=>{class e{constructor(n,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,n._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(n){return!yR()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[n])}static{this.\u0275fac=function(i){return new(i||e)(Z(_4),Z(Bge,8),Z(Ut))}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({imports:[Vm,Vm]})}}return e})();class b4{constructor(t,n,i,r,o){this._defaultMatcher=t,this.ngControl=n,this._parentFormGroup=i,this._parentForm=r,this._stateChanges=o,this.errorState=!1}updateErrorState(){const t=this.errorState,n=this._parentFormGroup||this._parentForm,i=this.matcher||this._defaultMatcher,r=this.ngControl?this.ngControl.control:null,o=i?.isErrorState(r,n)??!1;o!==t&&(this.errorState=o,this._stateChanges.next())}}let Kge=(()=>{class e{isErrorState(n,i){return!!(n&&n.invalid&&(n.touched||i&&i.submitted))}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ko=function(e){return e[e.FADING_IN=0]="FADING_IN",e[e.VISIBLE=1]="VISIBLE",e[e.FADING_OUT=2]="FADING_OUT",e[e.HIDDEN=3]="HIDDEN",e}(Ko||{});class qge{constructor(t,n,i,r=!1){this._renderer=t,this.element=n,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=Ko.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}}const y4=ph({passive:!0,capture:!0});class Yge{constructor(){this._events=new Map,this._delegateEventHandler=t=>{const n=qc(t);n&&this._events.get(t.type)?.forEach((i,r)=>{(r===n||r.contains(n))&&i.forEach(o=>o.handleEvent(t))})}}addHandler(t,n,i,r){const o=this._events.get(n);if(o){const s=o.get(i);s?s.add(r):o.set(i,new Set([r]))}else this._events.set(n,new Map([[i,new Set([r])]])),t.runOutsideAngular(()=>{document.addEventListener(n,this._delegateEventHandler,y4)})}removeHandler(t,n,i){const r=this._events.get(t);if(!r)return;const o=r.get(n);o&&(o.delete(i),0===o.size&&r.delete(n),0===r.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,y4)))}}const S4={enterDuration:225,exitDuration:150},C4=ph({passive:!0,capture:!0}),T4=["mousedown","touchstart"],w4=["mouseup","mouseleave","touchend","touchcancel"];class Eb{static{this._eventManager=new Yge}constructor(t,n,i,r){this._target=t,this._ngZone=n,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Yc(i))}fadeInRipple(t,n,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o={...S4,...i.animation};i.centered&&(t=r.left+r.width/2,n=r.top+r.height/2);const s=i.radius||function Xge(e,t,n){const i=Math.max(Math.abs(e-n.left),Math.abs(e-n.right)),r=Math.max(Math.abs(t-n.top),Math.abs(t-n.bottom));return Math.sqrt(i*i+r*r)}(t,n,r),a=t-r.left,c=n-r.top,l=o.enterDuration,d=document.createElement("div");d.classList.add("mat-ripple-element"),d.style.left=a-s+"px",d.style.top=c-s+"px",d.style.height=2*s+"px",d.style.width=2*s+"px",null!=i.color&&(d.style.backgroundColor=i.color),d.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(d);const u=window.getComputedStyle(d),p=u.transitionDuration,m="none"===u.transitionProperty||"0s"===p||"0s, 0s"===p||0===r.width&&0===r.height,f=new qge(this,d,i,m);d.style.transform="scale3d(1, 1, 1)",f.state=Ko.FADING_IN,i.persistent||(this._mostRecentTransientRipple=f);let g=null;return!m&&(l||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const E=()=>this._finishRippleTransition(f),b=()=>this._destroyRipple(f);d.addEventListener("transitionend",E),d.addEventListener("transitioncancel",b),g={onTransitionEnd:E,onTransitionCancel:b}}),this._activeRipples.set(f,g),(m||!l)&&this._finishRippleTransition(f),f}fadeOutRipple(t){if(t.state===Ko.FADING_OUT||t.state===Ko.HIDDEN)return;const n=t.element,i={...S4,...t.config.animation};n.style.transitionDuration=`${i.exitDuration}ms`,n.style.opacity="0",t.state=Ko.FADING_OUT,(t._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const n=Yc(t);!this._platform.isBrowser||!n||n===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=n,T4.forEach(i=>{Eb._eventManager.addHandler(this._ngZone,i,n,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{w4.forEach(n=>{this._triggerElement.addEventListener(n,this,C4)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){t.state===Ko.FADING_IN?this._startFadeOutTransition(t):t.state===Ko.FADING_OUT&&this._destroyRipple(t)}_startFadeOutTransition(t){const n=t===this._mostRecentTransientRipple,{persistent:i}=t.config;t.state=Ko.VISIBLE,!i&&(!n||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const n=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=Ko.HIDDEN,null!==n&&(t.element.removeEventListener("transitionend",n.onTransitionEnd),t.element.removeEventListener("transitioncancel",n.onTransitionCancel)),t.element.remove()}_onMousedown(t){const n=h4(t),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!n&&!i&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!p4(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const n=t.changedTouches;if(n)for(let i=0;i<n.length;i++)this.fadeInRipple(n[i].clientX,n[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(t.state===Ko.VISIBLE||t.config.terminateOnPointerUp&&t.state===Ko.FADING_IN)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(T4.forEach(n=>Eb._eventManager.removeHandler(n,t,this)),this._pointerUpEventsRegistered&&(w4.forEach(n=>t.removeEventListener(n,this,C4)),this._pointerUpEventsRegistered=!1))}}const I4=new re("mat-ripple-global-options");let R4=(()=>{class e{get disabled(){return this._disabled}set disabled(n){n&&this.fadeOutAllNonPersistent(),this._disabled=n,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(n){this._trigger=n,this._setupTriggerEventsIfEnabled()}constructor(n,i,r,o,s){this._elementRef=n,this._animationMode=s,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=o||{},this._rippleRenderer=new Eb(this,i,n,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(n,i=0,r){return"number"==typeof n?this._rippleRenderer.fadeInRipple(n,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...n})}static{this.\u0275fac=function(i){return new(i||e)(H(sn),H(Le),H(Qi),H(I4,8),H($a,8))}}static{this.\u0275dir=ye({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&wt("mat-ripple-unbounded",r.unbounded)},inputs:{color:[we.None,"matRippleColor","color"],unbounded:[we.None,"matRippleUnbounded","unbounded"],centered:[we.None,"matRippleCentered","centered"],radius:[we.None,"matRippleRadius","radius"],animation:[we.None,"matRippleAnimation","animation"],disabled:[we.None,"matRippleDisabled","disabled"],trigger:[we.None,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}}return e})(),Zge=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({imports:[zo,zo]})}}return e})();const A4={capture:!0},D4=["focus","click","mouseenter","touchstart"],NR="mat-ripple-loader-uninitialized",PR="mat-ripple-loader-class-name",O4="mat-ripple-loader-centered",bb="mat-ripple-loader-disabled";let Jge=(()=>{class e{constructor(){this._document=J(Ut,{optional:!0}),this._animationMode=J($a,{optional:!0}),this._globalRippleOptions=J(I4,{optional:!0}),this._platform=J(Qi),this._ngZone=J(Le),this._hosts=new Map,this._onInteraction=n=>{if(!(n.target instanceof HTMLElement))return;const r=n.target.closest(`[${NR}]`);r&&this._createRipple(r)},this._ngZone.runOutsideAngular(()=>{for(const n of D4)this._document?.addEventListener(n,this._onInteraction,A4)})}ngOnDestroy(){const n=this._hosts.keys();for(const i of n)this.destroyRipple(i);for(const i of D4)this._document?.removeEventListener(i,this._onInteraction,A4)}configureRipple(n,i){n.setAttribute(NR,""),(i.className||!n.hasAttribute(PR))&&n.setAttribute(PR,i.className||""),i.centered&&n.setAttribute(O4,""),i.disabled&&n.setAttribute(bb,"")}getRipple(n){return this._hosts.get(n)||this._createRipple(n)}setDisabled(n,i){const r=this._hosts.get(n);r?r.disabled=i:i?n.setAttribute(bb,""):n.removeAttribute(bb)}_createRipple(n){if(!this._document)return;const i=this._hosts.get(n);if(i)return i;n.querySelector(".mat-ripple")?.remove();const r=this._document.createElement("span");r.classList.add("mat-ripple",n.getAttribute(PR)),n.append(r);const o=new R4(new sn(r),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return o._isInitialized=!0,o.trigger=n,o.centered=n.hasAttribute(O4),o.disabled=n.hasAttribute(bb),this.attachRipple(n,o),o}attachRipple(n,i){n.removeAttribute(NR),this._hosts.set(n,i)}destroyRipple(n){const i=this._hosts.get(n);i&&(i.ngOnDestroy(),this._hosts.delete(n))}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Qge=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=sr({type:e,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(i,r){2&i&&wt("mdc-form-field--align-end","before"===r.labelPosition)},inputs:{labelPosition:"labelPosition"},standalone:!0,features:[jc],attrs:Fge,ngContentSelectors:Uge,decls:1,vars:0,template:function(i,r){1&i&&(rh(),pr(0))},styles:[".mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mdc-form-field{font-family:var(--mdc-form-field-label-text-font);line-height:var(--mdc-form-field-label-text-line-height);font-size:var(--mdc-form-field-label-text-size);font-weight:var(--mdc-form-field-label-text-weight);letter-spacing:var(--mdc-form-field-label-text-tracking);color:var(--mdc-form-field-label-text-color)}.mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}"],encapsulation:2,changeDetection:0})}}return e})();const e_e=["mat-button",""],t_e=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],n_e=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],i_e=new re("MAT_BUTTON_CONFIG"),r_e=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}];let o_e=(()=>{class e{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(n){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,n)}get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=n,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(n){this._disabled=n,this._updateRippleDisabled()}constructor(n,i,r,o){this._elementRef=n,this._platform=i,this._ngZone=r,this._animationMode=o,this._focusMonitor=J(AR),this._rippleLoader=J(Jge),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;const s=J(i_e,{optional:!0}),a=n.nativeElement,c=a.classList;this.disabledInteractive=s?.disabledInteractive??!1,this._rippleLoader?.configureRipple(a,{className:"mat-mdc-button-ripple"});for(const{attribute:l,mdcClasses:d}of r_e)a.hasAttribute(l)&&c.add(...d)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(n="program",i){n?this._focusMonitor.focusVia(this._elementRef.nativeElement,n,i):this._elementRef.nativeElement.focus(i)}_getAriaDisabled(){return null!=this.ariaDisabled?this.ariaDisabled:!(!this.disabled||!this.disabledInteractive)||null}_getDisabledAttribute(){return!(this.disabledInteractive||!this.disabled)||null}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static{this.\u0275fac=function(i){U0()}}static{this.\u0275dir=ye({type:e,inputs:{color:"color",disableRipple:[we.HasDecoratorInputTransform,"disableRipple","disableRipple",Ir],disabled:[we.HasDecoratorInputTransform,"disabled","disabled",Ir],ariaDisabled:[we.HasDecoratorInputTransform,"aria-disabled","ariaDisabled",Ir],disabledInteractive:[we.HasDecoratorInputTransform,"disabledInteractive","disabledInteractive",Ir]},features:[rE]})}}return e})(),s_e=(()=>{class e extends o_e{constructor(n,i,r,o){super(n,i,r,o)}static{this.\u0275fac=function(i){return new(i||e)(H(sn),H(Qi),H(Le),H($a,8))}}static{this.\u0275cmp=sr({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(i,r){2&i&&(Ni("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),Uw(r.color?"mat-"+r.color:""),wt("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[Pt,jc],attrs:e_e,ngContentSelectors:n_e,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(rh(t_e),pt(0,"span",0),pr(1),ue(2,"span",1),pr(3,1),ve(),pr(4,2),pt(5,"span",2)(6,"span",3)),2&i&&wt("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px);display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);font-weight:var(--mdc-text-button-label-text-weight);text-transform:var(--mdc-text-button-label-text-transform);height:var(--mdc-text-button-container-height);border-radius:var(--mdc-text-button-container-shape);padding:0 var(--mat-text-button-horizontal-padding, 8px)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);font-weight:var(--mdc-filled-button-label-text-weight);text-transform:var(--mdc-filled-button-label-text-transform);height:var(--mdc-filled-button-container-height);border-radius:var(--mdc-filled-button-container-shape);padding:0 var(--mat-filled-button-horizontal-padding, 16px)}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color)}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);font-weight:var(--mdc-protected-button-label-text-weight);text-transform:var(--mdc-protected-button-label-text-transform);height:var(--mdc-protected-button-container-height);border-radius:var(--mdc-protected-button-container-shape);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow)}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color)}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);font-weight:var(--mdc-outlined-button-label-text-weight);text-transform:var(--mdc-outlined-button-label-text-transform);height:var(--mdc-outlined-button-container-height);border-radius:var(--mdc-outlined-button-container-shape);padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width);padding:0 var(--mat-outlined-button-horizontal-padding, 15px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color)}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape)}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width))}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button-base{text-decoration:none}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}}return e})(),c_e=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({imports:[zo,Zge,zo]})}}return e})();const N4=ph({passive:!0});let l_e=(()=>{class e{constructor(n,i){this._platform=n,this._ngZone=i,this._monitoredElements=new Map}monitor(n){if(!this._platform.isBrowser)return Wo;const i=Yc(n),r=this._monitoredElements.get(i);if(r)return r.subject;const o=new Tt,s="cdk-text-field-autofilled",a=c=>{"cdk-text-field-autofill-start"!==c.animationName||i.classList.contains(s)?"cdk-text-field-autofill-end"===c.animationName&&i.classList.contains(s)&&(i.classList.remove(s),this._ngZone.run(()=>o.next({target:c.target,isAutofilled:!1}))):(i.classList.add(s),this._ngZone.run(()=>o.next({target:c.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{i.addEventListener("animationstart",a,N4),i.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(i,{subject:o,unlisten:()=>{i.removeEventListener("animationstart",a,N4)}}),o}stopMonitoring(n){const i=Yc(n),r=this._monitoredElements.get(i);r&&(r.unlisten(),r.subject.complete(),i.classList.remove("cdk-text-field-autofill-monitored"),i.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(i))}ngOnDestroy(){this._monitoredElements.forEach((n,i)=>this.stopMonitoring(i))}static{this.\u0275fac=function(i){return new(i||e)(Z(Qi),Z(Le))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),d_e=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({})}}return e})();function P4(...e){const t=Am(e),n=function xfe(e,t){return"number"==typeof JI(e)?e.pop():t}(e,1/0),i=e;return i.length?1===i.length?Ar(i[0]):mh(n)(xi(i,t)):Wo}class u_e extends Tt{constructor(t=1/0,n=1/0,i=CR){super(),this._bufferSize=t,this._windowTime=n,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,n)}next(t){const{isStopped:n,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:o,_windowTime:s}=this;n||(i.push(t),!r&&i.push(o.now()+s)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const n=this._innerSubscribe(t),{_infiniteTimeWindow:i,_buffer:r}=this,o=r.slice();for(let s=0;s<o.length&&!t.closed;s+=i?1:2)t.next(o[s]);return this._checkFinalizedStatuses(t),n}_trimBuffer(){const{_bufferSize:t,_timestampProvider:n,_buffer:i,_infiniteTimeWindow:r}=this,o=(r?1:2)*t;if(t<1/0&&o<i.length&&i.splice(0,i.length-o),!r){const s=n.now();let a=0;for(let c=1;c<i.length&&i[c]<=s;c+=2)a=c;a&&i.splice(0,a+1)}}}function MR(e,t,...n){if(!0===t)return void e();if(!1===t)return;const i=new nf({next:()=>{i.unsubscribe(),e()}});return Ar(t(...n)).subscribe(i)}class f_e{constructor(t){this._box=t,this._destroyed=new Tt,this._resizeSubject=new Tt,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(n=>this._resizeSubject.next(n)))}observe(t){return this._elementObservables.has(t)||this._elementObservables.set(t,new Hn(n=>{const i=this._resizeSubject.subscribe(n);return this._resizeObserver?.observe(t,{box:this._box}),()=>{this._resizeObserver?.unobserve(t),i.unsubscribe(),this._elementObservables.delete(t)}}).pipe(Yr(n=>n.some(i=>i.target===t)),function p_e(e,t,n){let i,r=!1;return e&&"object"==typeof e?({bufferSize:i=1/0,windowTime:t=1/0,refCount:r=!1,scheduler:n}=e):i=e??1/0,function h_e(e={}){const{connector:t=(()=>new Tt),resetOnError:n=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return o=>{let s,a,c,l=0,d=!1,u=!1;const h=()=>{a?.unsubscribe(),a=void 0},p=()=>{h(),s=c=void 0,d=u=!1},m=()=>{const f=s;p(),f?.unsubscribe()};return ci((f,g)=>{l++,!u&&!d&&h();const E=c=c??t();g.add(()=>{l--,0===l&&!u&&!d&&(a=MR(m,r))}),E.subscribe(g),!s&&l>0&&(s=new nf({next:b=>E.next(b),error:b=>{u=!0,h(),a=MR(p,n,b),E.error(b)},complete:()=>{d=!0,h(),a=MR(p,i),E.complete()}}),Ar(f).subscribe(s))})(o)}}({connector:()=>new u_e(i,t,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}({bufferSize:1,refCount:!0}),mr(this._destroyed))),this._elementObservables.get(t)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}}let m_e=(()=>{class e{constructor(){this._observers=new Map,this._ngZone=J(Le)}ngOnDestroy(){for(const[,n]of this._observers)n.destroy();this._observers.clear()}observe(n,i){const r=i?.box||"content-box";return this._observers.has(r)||this._observers.set(r,new f_e(r)),this._observers.get(r).observe(n)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ge=function(e){return e[e.State=0]="State",e[e.Transition=1]="Transition",e[e.Sequence=2]="Sequence",e[e.Group=3]="Group",e[e.Animate=4]="Animate",e[e.Keyframes=5]="Keyframes",e[e.Style=6]="Style",e[e.Trigger=7]="Trigger",e[e.Reference=8]="Reference",e[e.AnimateChild=9]="AnimateChild",e[e.AnimateRef=10]="AnimateRef",e[e.Query=11]="Query",e[e.Stagger=12]="Stagger",e}(Ge||{});const sc="*";function xR(e,t){return{type:Ge.Trigger,name:e,definitions:t,options:{}}}function jm(e,t=null){return{type:Ge.Animate,styles:t,timings:e}}function da(e){return{type:Ge.Style,styles:e,offset:null}}function kR(e,t,n){return{type:Ge.State,name:e,styles:t,options:n}}function Hm(e,t,n=null){return{type:Ge.Transition,expr:e,animation:t,options:n}}class Gm{constructor(t=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class M4{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let n=0,i=0,r=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++n==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const n=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,n/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((n,i)=>null===n||i.totalTime>n.totalTime?i:n,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}const y_e=["notch"],S_e=["matFormFieldNotchedOutline",""],C_e=["*"],T_e=["textField"],w_e=["iconPrefixContainer"],I_e=["textPrefixContainer"],R_e=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],A_e=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function D_e(e,t){1&e&&pt(0,"span",17)}function O_e(e,t){if(1&e&&(ue(0,"label",16),pr(1,1),an(2,D_e,1,0,"span",17),ve()),2&e){const n=Kt(2);ht("floating",n._shouldLabelFloat())("monitorResize",n._hasOutline())("id",n._labelId),Ni("for",n._control.disableAutomaticLabeling?null:n._control.id),Re(2),Cr(2,!n.hideRequiredMarker&&n._control.required?2:-1)}}function N_e(e,t){1&e&&an(0,O_e,3,5,"label",16),2&e&&Cr(0,Kt()._hasFloatingLabel()?0:-1)}function P_e(e,t){1&e&&pt(0,"div",5)}function M_e(e,t){}function x_e(e,t){1&e&&an(0,M_e,0,0,"ng-template",11),2&e&&(Kt(2),ht("ngTemplateOutlet",pm(1)))}function k_e(e,t){if(1&e&&(ue(0,"div",7),an(1,x_e,1,1,null,11),ve()),2&e){const n=Kt();ht("matFormFieldNotchedOutlineOpen",n._shouldLabelFloat()),Re(),Cr(1,n._forceDisplayInfixLabel()?-1:1)}}function L_e(e,t){1&e&&(ue(0,"div",8,2),pr(2,2),ve())}function F_e(e,t){1&e&&(ue(0,"div",9,3),pr(2,3),ve())}function U_e(e,t){}function V_e(e,t){1&e&&an(0,U_e,0,0,"ng-template",11),2&e&&(Kt(),ht("ngTemplateOutlet",pm(1)))}function B_e(e,t){1&e&&(ue(0,"div",12),pr(1,4),ve())}function j_e(e,t){1&e&&(ue(0,"div",13),pr(1,5),ve())}function H_e(e,t){1&e&&pt(0,"div",14)}function G_e(e,t){1&e&&(ue(0,"div",18),pr(1,6),ve()),2&e&&ht("@transitionMessages",Kt()._subscriptAnimationState)}function W_e(e,t){if(1&e&&(ue(0,"mat-hint",20),fr(1),ve()),2&e){const n=Kt(2);ht("id",n._hintLabelId),Re(),nd(n.hintLabel)}}function z_e(e,t){if(1&e&&(ue(0,"div",19),an(1,W_e,2,2,"mat-hint",20),pr(2,7),pt(3,"div",21),pr(4,8),ve()),2&e){const n=Kt();ht("@transitionMessages",n._subscriptAnimationState),Re(),Cr(1,n.hintLabel?1:-1)}}let FR=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275dir=ye({type:e,selectors:[["mat-label"]],standalone:!0})}}return e})();const K_e=new re("MatError");let q_e=0,x4=(()=>{class e{constructor(){this.align="start",this.id="mat-mdc-hint-"+q_e++}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275dir=ye({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(i,r){2&i&&(sm("id",r.id),Ni("align",null),wt("mat-mdc-form-field-hint-end","end"===r.align))},inputs:{align:"align",id:"id"},standalone:!0})}}return e})();const Y_e=new re("MatPrefix"),$_e=new re("MatSuffix"),k4=new re("FloatingLabelParent");let L4=(()=>{class e{get floating(){return this._floating}set floating(n){this._floating=n,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(n){this._monitorResize=n,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(n){this._elementRef=n,this._floating=!1,this._monitorResize=!1,this._resizeObserver=J(m_e),this._ngZone=J(Le),this._parent=J(k4),this._resizeSubscription=new vi}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return function X_e(e){if(null!==e.offsetParent)return e.scrollWidth;const n=e.cloneNode(!0);n.style.setProperty("position","absolute"),n.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(n);const i=n.scrollWidth;return n.remove(),i}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static{this.\u0275fac=function(i){return new(i||e)(H(sn))}}static{this.\u0275dir=ye({type:e,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(i,r){2&i&&wt("mdc-floating-label--float-above",r.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0})}}return e})();const F4="mdc-line-ripple--active",yb="mdc-line-ripple--deactivating";let U4=(()=>{class e{constructor(n,i){this._elementRef=n,this._handleTransitionEnd=r=>{const o=this._elementRef.nativeElement.classList,s=o.contains(yb);"opacity"===r.propertyName&&s&&o.remove(F4,yb)},i.runOutsideAngular(()=>{n.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){const n=this._elementRef.nativeElement.classList;n.remove(yb),n.add(F4)}deactivate(){this._elementRef.nativeElement.classList.add(yb)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}static{this.\u0275fac=function(i){return new(i||e)(H(sn),H(Le))}}static{this.\u0275dir=ye({type:e,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0})}}return e})(),V4=(()=>{class e{constructor(n,i){this._elementRef=n,this._ngZone=i,this.open=!1}ngAfterViewInit(){const n=this._elementRef.nativeElement.querySelector(".mdc-floating-label");n?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(n.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>n.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(n){this._notch.nativeElement.style.width=this.open&&n?`calc(${n}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:""}static{this.\u0275fac=function(i){return new(i||e)(H(sn),H(Le))}}static{this.\u0275cmp=sr({type:e,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(i,r){if(1&i&&sa(y_e,5),2&i){let o;ji(o=Hi())&&(r._notch=o.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(i,r){2&i&&wt("mdc-notched-outline--notched",r.open)},inputs:{open:[we.None,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[jc],attrs:S_e,ngContentSelectors:C_e,decls:5,vars:0,consts:[["notch",""],[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(i,r){1&i&&(rh(),pt(0,"div",1),ue(1,"div",2,0),pr(3),ve(),pt(4,"div",3))},encapsulation:2,changeDetection:0})}}return e})();const Z_e={transitionMessages:xR("transitionMessages",[kR("enter",da({opacity:1,transform:"translateY(0%)"})),Hm("void => enter",[da({opacity:0,transform:"translateY(-5px)"}),jm("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let B4=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275dir=ye({type:e})}}return e})();const j4=new re("MatFormField"),J_e=new re("MAT_FORM_FIELD_DEFAULT_OPTIONS");let H4=0,tve=(()=>{class e{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(n){this._hideRequiredMarker=fh(n)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(n){n!==this._floatLabel&&(this._floatLabel=n,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(n){const i=this._appearance;this._appearance=n||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==i&&(this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(n){this._subscriptSizing=n||this._defaults?.subscriptSizing||"fixed"}get hintLabel(){return this._hintLabel}set hintLabel(n){this._hintLabel=n,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(n){this._explicitFormFieldControl=n}constructor(n,i,r,o,s,a,c,l){this._elementRef=n,this._changeDetectorRef=i,this._ngZone=r,this._dir=o,this._platform=s,this._defaults=a,this._animationMode=c,this._hideRequiredMarker=!1,this.color="primary",this._appearance="fill",this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId="mat-mdc-form-field-label-"+H4++,this._hintLabelId="mat-mdc-hint-"+H4++,this._subscriptAnimationState="",this._destroyed=new Tt,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,a&&(a.appearance&&(this.appearance=a.appearance),this._hideRequiredMarker=!!a?.hideRequiredMarker,a.color&&(this.color=a.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){const n=this._control;n.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${n.controlType}`),n.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),n.ngControl&&n.ngControl.valueChanges&&n.ngControl.valueChanges.pipe(mr(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(n=>!n._isText),this._hasTextPrefix=!!this._prefixChildren.find(n=>n._isText),this._hasIconSuffix=!!this._suffixChildren.find(n=>!n._isText),this._hasTextSuffix=!!this._suffixChildren.find(n=>n._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),P4(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(mr(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(mr(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(n){const i=this._control?this._control.ngControl:null;return i&&i[n]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){this._hasOutline()&&this._floatingLabel&&this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth()):this._notchedOutline?._setNotchWidth(0)}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let n=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&n.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const i=this._hintChildren?this._hintChildren.find(o=>"start"===o.align):null,r=this._hintChildren?this._hintChildren.find(o=>"end"===o.align):null;i?n.push(i.id):this._hintLabel&&n.push(this._hintLabelId),r&&n.push(r.id)}else this._errorChildren&&n.push(...this._errorChildren.map(i=>i.id));this._control.setDescribedByIds(n)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;const n=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(n.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdateOnStable=!0);const i=this._iconPrefixContainer?.nativeElement,r=this._textPrefixContainer?.nativeElement,o=i?.getBoundingClientRect().width??0,s=r?.getBoundingClientRect().width??0;n.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${o+s}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`}_isAttachedToDom(){const n=this._elementRef.nativeElement;if(n.getRootNode){const i=n.getRootNode();return i&&i!==n}return document.documentElement.contains(n)}static{this.\u0275fac=function(i){return new(i||e)(H(sn),H(ws),H(Le),H(OR),H(Qi),H(J_e,8),H($a,8),H(Ut))}}static{this.\u0275cmp=sr({type:e,selectors:[["mat-form-field"]],contentQueries:function(i,r,o){if(1&i&&(ec(o,FR,5),ec(o,FR,7),ec(o,B4,5),ec(o,Y_e,5),ec(o,$_e,5),ec(o,K_e,5),ec(o,x4,5)),2&i){let s;ji(s=Hi())&&(r._labelChildNonStatic=s.first),ji(s=Hi())&&(r._labelChildStatic=s.first),ji(s=Hi())&&(r._formFieldControl=s.first),ji(s=Hi())&&(r._prefixChildren=s),ji(s=Hi())&&(r._suffixChildren=s),ji(s=Hi())&&(r._errorChildren=s),ji(s=Hi())&&(r._hintChildren=s)}},viewQuery:function(i,r){if(1&i&&(sa(T_e,5),sa(w_e,5),sa(I_e,5),sa(L4,5),sa(V4,5),sa(U4,5)),2&i){let o;ji(o=Hi())&&(r._textField=o.first),ji(o=Hi())&&(r._iconPrefixContainer=o.first),ji(o=Hi())&&(r._textPrefixContainer=o.first),ji(o=Hi())&&(r._floatingLabel=o.first),ji(o=Hi())&&(r._notchedOutline=o.first),ji(o=Hi())&&(r._lineRipple=o.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(i,r){2&i&&wt("mat-mdc-form-field-label-always-float",r._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",r._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",r._hasIconSuffix)("mat-form-field-invalid",r._control.errorState)("mat-form-field-disabled",r._control.disabled)("mat-form-field-autofilled",r._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===r._animationMode)("mat-form-field-appearance-fill","fill"==r.appearance)("mat-form-field-appearance-outline","outline"==r.appearance)("mat-form-field-hide-placeholder",r._hasFloatingLabel()&&!r._shouldLabelFloat())("mat-focused",r._control.focused)("mat-primary","accent"!==r.color&&"warn"!==r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color)("ng-untouched",r._shouldForward("untouched"))("ng-touched",r._shouldForward("touched"))("ng-pristine",r._shouldForward("pristine"))("ng-dirty",r._shouldForward("dirty"))("ng-valid",r._shouldForward("valid"))("ng-invalid",r._shouldForward("invalid"))("ng-pending",r._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[mn([{provide:j4,useExisting:e},{provide:k4,useExisting:e}]),jc],ngContentSelectors:A_e,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(i,r){if(1&i){const o=Qa();rh(R_e),an(0,N_e,1,1,"ng-template",null,0,Jw),ue(2,"div",4,1),zt("click",function(a){return Gr(o),Wr(r._control.onContainerClick(a))}),an(4,P_e,1,0,"div",5),ue(5,"div",6),an(6,k_e,2,2,"div",7)(7,L_e,3,0,"div",8)(8,F_e,3,0,"div",9),ue(9,"div",10),an(10,V_e,1,1,null,11),pr(11),ve(),an(12,B_e,2,0,"div",12)(13,j_e,2,0,"div",13),ve(),an(14,H_e,1,0,"div",14),ve(),ue(15,"div",15),an(16,G_e,2,1)(17,z_e,5,2),ve()}if(2&i){let o;Re(2),wt("mdc-text-field--filled",!r._hasOutline())("mdc-text-field--outlined",r._hasOutline())("mdc-text-field--no-label",!r._hasFloatingLabel())("mdc-text-field--disabled",r._control.disabled)("mdc-text-field--invalid",r._control.errorState),Re(2),Cr(4,r._hasOutline()||r._control.disabled?-1:4),Re(2),Cr(6,r._hasOutline()?6:-1),Re(),Cr(7,r._hasIconPrefix?7:-1),Re(),Cr(8,r._hasTextPrefix?8:-1),Re(2),Cr(10,!r._hasOutline()||r._forceDisplayInfixLabel()?10:-1),Re(2),Cr(12,r._hasTextSuffix?12:-1),Re(),Cr(13,r._hasIconSuffix?13:-1),Re(),Cr(14,r._hasOutline()?-1:14),Re(),wt("mat-mdc-form-field-subscript-dynamic-size","dynamic"===r.subscriptSizing),Re(),Cr(16,"error"===(o=r._getDisplayedMessages())?16:"hint"===o?17:-1)}},dependencies:[L4,V4,ZB,U4,x4],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-hover-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-hover-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-hover-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-hover-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(.75*var(--mdc-outlined-text-field-label-text-size))}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mdc-outlined-text-field-label-text-size)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color)}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color)}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color)}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[Z_e.transitionMessages]},changeDetection:0})}}return e})(),z4=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({imports:[zo,qE,n4,zo]})}}return e})();const nve=new re("MAT_INPUT_VALUE_ACCESSOR"),ive=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let rve=0,ove=(()=>{class e{get disabled(){return this._disabled}set disabled(n){this._disabled=fh(n),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(n){this._id=n||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator($3.required)??!1}set required(n){this._required=fh(n)}get type(){return this._type}set type(n){this._type=n||"text",this._validateType(),!this._isTextarea&&Jj().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(n){this._errorStateTracker.matcher=n}get value(){return this._inputValueAccessor.value}set value(n){n!==this.value&&(this._inputValueAccessor.value=n,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(n){this._readonly=fh(n)}get errorState(){return this._errorStateTracker.errorState}set errorState(n){this._errorStateTracker.errorState=n}constructor(n,i,r,o,s,a,c,l,d,u){this._elementRef=n,this._platform=i,this.ngControl=r,this._autofillMonitor=l,this._formField=u,this._uid="mat-input-"+rve++,this.focused=!1,this.stateChanges=new Tt,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(m=>Jj().has(m)),this._iOSKeyupListener=m=>{const f=m.target;!f.value&&0===f.selectionStart&&0===f.selectionEnd&&(f.setSelectionRange(1,1),f.setSelectionRange(0,0))};const h=this._elementRef.nativeElement,p=h.nodeName.toLowerCase();this._inputValueAccessor=c||h,this._previousNativeValue=this.value,this.id=this.id,i.IOS&&d.runOutsideAngular(()=>{n.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._errorStateTracker=new b4(a,r,s,o,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===p,this._isTextarea="textarea"===p,this._isInFormField=!!u,this._isNativeSelect&&(this.controlType=h.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(n=>{this.autofilled=n.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),null!==this.ngControl.disabled&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(n){this._elementRef.nativeElement.focus(n)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(n){n!==this.focused&&(this.focused=n,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const n=this._elementRef.nativeElement.value;this._previousNativeValue!==n&&(this._previousNativeValue=n,this.stateChanges.next())}_dirtyCheckPlaceholder(){const n=this._getPlaceholder();if(n!==this._previousPlaceholder){const i=this._elementRef.nativeElement;this._previousPlaceholder=n,n?i.setAttribute("placeholder",n):i.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){ive.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let n=this._elementRef.nativeElement.validity;return n&&n.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const n=this._elementRef.nativeElement,i=n.options[0];return this.focused||n.multiple||!this.empty||!!(n.selectedIndex>-1&&i&&i.label)}return this.focused||!this.empty}setDescribedByIds(n){n.length?this._elementRef.nativeElement.setAttribute("aria-describedby",n.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const n=this._elementRef.nativeElement;return this._isNativeSelect&&(n.multiple||n.size>1)}static{this.\u0275fac=function(i){return new(i||e)(H(sn),H(Qi),H(oc,10),H(lb,8),H(km,8),H(Kge),H(nve,10),H(l_e),H(Le),H(j4,8))}}static{this.\u0275dir=ye({type:e,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(i,r){1&i&&zt("focus",function(){return r._focusChanged(!0)})("blur",function(){return r._focusChanged(!1)})("input",function(){return r._onInput()}),2&i&&(sm("id",r.id)("disabled",r.disabled)("required",r.required),Ni("name",r.name||null)("readonly",r.readonly&&!r._isNativeSelect||null)("aria-invalid",r.empty&&r.required?null:r.errorState)("aria-required",r.required)("id",r.id),wt("mat-input-server",r._isServer)("mat-mdc-form-field-textarea-control",r._isInFormField&&r._isTextarea)("mat-mdc-form-field-input-control",r._isInFormField)("mdc-text-field__input",r._isInFormField)("mat-mdc-native-select-inline",r._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[we.None,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],standalone:!0,features:[mn([{provide:B4,useExisting:e}]),Hr]})}}return e})(),sve=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({imports:[zo,z4,z4,d_e,zo]})}}return e})();const ave=["switch"],cve=["*"];function lve(e,t){1&e&&(ue(0,"div",10),ys(),ue(1,"svg",12),pt(2,"path",13),ve(),ue(3,"svg",14),pt(4,"path",15),ve()())}const dve=new re("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1})}),uve={provide:As,useExisting:pn(()=>UR),multi:!0};class K4{constructor(t,n){this.source=t,this.checked=n}}let hve=0,UR=(()=>{class e{_createChangeEvent(n){return new K4(this,n)}get buttonId(){return`${this.id||this._uniqueId}-button`}focus(){this._switchElement.nativeElement.focus()}get checked(){return this._checked}set checked(n){this._checked=n,this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(n,i,r,o,s,a){this._elementRef=n,this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=s,this._onChange=c=>{},this._onTouched=()=>{},this._validatorOnChange=()=>{},this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this.change=new Wt,this.toggleChange=new Wt,this.tabIndex=parseInt(o)||0,this.color=s.color||"accent",this._noopAnimations="NoopAnimations"===a,this.id=this._uniqueId="mat-mdc-slide-toggle-"+ ++hve,this.hideIcon=s.hideIcon??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(n=>{"keyboard"===n||"program"===n?(this._focused=!0,this._changeDetectorRef.markForCheck()):n||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(n){n.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(n){this.checked=!!n}registerOnChange(n){this._onChange=n}registerOnTouched(n){this._onTouched=n}validate(n){return this.required&&!0!==n.value?{required:!0}:null}registerOnValidatorChange(n){this._validatorOnChange=n}setDisabledState(n){this.disabled=n,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new K4(this,this.checked)))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static{this.\u0275fac=function(i){return new(i||e)(H(sn),H(AR),H(ws),function wu(e){return function Bte(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const i=n.length;let r=0;for(;r<i;){const o=n[r];if(Cx(o))break;if(0===o)r+=2;else if("number"==typeof o)for(r++;r<i&&"string"==typeof n[r];)r++;else{if(o===t)return n[r+1];r+=2}}}return null}(on(),e)}("tabindex"),H(dve),H($a,8))}}static{this.\u0275cmp=sr({type:e,selectors:[["mat-slide-toggle"]],viewQuery:function(i,r){if(1&i&&sa(ave,5),2&i){let o;ji(o=Hi())&&(r._switchElement=o.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(i,r){2&i&&(sm("id",r.id),Ni("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),Uw(r.color?"mat-"+r.color:""),wt("mat-mdc-slide-toggle-focused",r._focused)("mat-mdc-slide-toggle-checked",r.checked)("_mat-animation-noopable",r._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[we.None,"aria-label","ariaLabel"],ariaLabelledby:[we.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[we.None,"aria-describedby","ariaDescribedby"],required:[we.HasDecoratorInputTransform,"required","required",Ir],color:"color",disabled:[we.HasDecoratorInputTransform,"disabled","disabled",Ir],disableRipple:[we.HasDecoratorInputTransform,"disableRipple","disableRipple",Ir],tabIndex:[we.HasDecoratorInputTransform,"tabIndex","tabIndex",n=>null==n?0:function lue(e,t=NaN){return isNaN(parseFloat(e))||isNaN(Number(e))?t:Number(e)}(n)],checked:[we.HasDecoratorInputTransform,"checked","checked",Ir],hideIcon:[we.HasDecoratorInputTransform,"hideIcon","hideIcon",Ir]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],standalone:!0,features:[mn([uve,{provide:Gi,useExisting:e,multi:!0}]),rE,Hr,jc],ngContentSelectors:cve,decls:13,vars:24,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(i,r){if(1&i){const o=Qa();rh(),ue(0,"div",1)(1,"button",2,0),zt("click",function(){return Gr(o),Wr(r._handleClick())}),pt(3,"div",3),ue(4,"div",4)(5,"div",5)(6,"div",6),pt(7,"div",7),ve(),ue(8,"div",8),pt(9,"div",9),ve(),an(10,lve,5,0,"div",10),ve()()(),ue(11,"label",11),zt("click",function(a){return Gr(o),Wr(a.stopPropagation())}),pr(12),ve()()}if(2&i){const o=pm(2);ht("labelPosition",r.labelPosition),Re(),wt("mdc-switch--selected",r.checked)("mdc-switch--unselected",!r.checked)("mdc-switch--checked",r.checked)("mdc-switch--disabled",r.disabled),ht("tabIndex",r.disabled?-1:r.tabIndex)("disabled",r.disabled),Ni("id",r.buttonId)("name",r.name)("aria-label",r.ariaLabel)("aria-labelledby",r._getAriaLabelledBy())("aria-describedby",r.ariaDescribedby)("aria-required",r.required||null)("aria-checked",r.checked),Re(8),ht("matRippleTrigger",o)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),Re(),Cr(10,r.hideIcon?-1:10),Re(),ht("for",r.buttonId),Ni("id",r._labelId)}},dependencies:[R4,Qge],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:var(--mdc-elevation-overlay-color)}.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative}.mdc-switch[hidden]{display:none}.mdc-switch:disabled{cursor:default;pointer-events:none}.mdc-switch__track{overflow:hidden;position:relative;width:100%}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%}@media screen and (forced-colors: active){.mdc-switch__track::before,.mdc-switch__track::after{border-color:currentColor}}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(-100%)}[dir=rtl] .mdc-switch__track::after,.mdc-switch__track[dir=rtl]::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track[dir=rtl]::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0)}[dir=rtl] .mdc-switch__handle-track,.mdc-switch__handle-track[dir=rtl]{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track,.mdc-switch--selected .mdc-switch__handle-track[dir=rtl]{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto}[dir=rtl] .mdc-switch__handle,.mdc-switch__handle[dir=rtl]{left:auto;right:0}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}@media screen and (forced-colors: active){.mdc-switch__handle::before,.mdc-switch__handle::after{border-color:currentColor}}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-elevation-overlay{bottom:0;left:0;right:0;top:0}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1}.mdc-switch:disabled .mdc-switch__ripple{display:none}.mdc-switch__icons{height:100%;position:relative;width:100%;z-index:1}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}.mdc-switch{width:var(--mdc-switch-track-width)}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color)}.mdc-switch.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color)}.mdc-switch .mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation)}.mdc-switch .mdc-switch__focus-ring-wrapper,.mdc-switch .mdc-switch__handle{height:var(--mdc-switch-handle-height)}.mdc-switch .mdc-switch__handle{border-radius:var(--mdc-switch-handle-shape)}.mdc-switch .mdc-switch__handle{width:var(--mdc-switch-handle-width)}.mdc-switch .mdc-switch__handle-track{width:calc(100% - var(--mdc-switch-handle-width))}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__icon{fill:var(--mdc-switch-selected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__icon{fill:var(--mdc-switch-unselected-icon-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity)}.mdc-switch.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size);height:var(--mdc-switch-selected-icon-size)}.mdc-switch.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size);height:var(--mdc-switch-unselected-icon-size)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-hover-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-focus-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-pressed-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-hover-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-focus-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-pressed-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-selected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-selected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-unselected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-unselected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch .mdc-switch__ripple{height:var(--mdc-switch-state-layer-size);width:var(--mdc-switch-state-layer-size)}.mdc-switch .mdc-switch__track{height:var(--mdc-switch-track-height)}.mdc-switch:disabled .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity)}.mdc-switch:enabled .mdc-switch__track::after{background:var(--mdc-switch-selected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color)}.mdc-switch:enabled .mdc-switch__track::before{background:var(--mdc-switch-unselected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color)}.mdc-switch .mdc-switch__track{border-radius:var(--mdc-switch-track-shape)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mat-mdc-slide-toggle{display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle .mdc-switch__ripple::after{content:"";opacity:0}.mat-mdc-slide-toggle .mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:opacity 75ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-elevation-overlay,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mdc-switch__handle{transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size);height:var(--mat-switch-unselected-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size);height:var(--mat-switch-selected-handle-size)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size);height:var(--mat-switch-with-icon-handle-size)}.mat-mdc-slide-toggle:active .mdc-switch:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size);height:var(--mat-switch-pressed-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{margin:var(--mat-switch-selected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{margin:var(--mat-switch-unselected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--selected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--unselected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin)}.mdc-switch__track::after,.mdc-switch__track::before{border-width:var(--mat-switch-track-outline-width);border-color:var(--mat-switch-track-outline-color)}.mdc-switch--selected .mdc-switch__track::after,.mdc-switch--selected .mdc-switch__track::before{border-width:var(--mat-switch-selected-track-outline-width)}.mdc-switch--disabled .mdc-switch__track::after,.mdc-switch--disabled .mdc-switch__track::before{border-width:var(--mat-switch-disabled-unselected-track-outline-width);border-color:var(--mat-switch-disabled-unselected-track-outline-color)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity)}'],encapsulation:2,changeDetection:0})}}return e})(),mve=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({imports:[UR,zo,zo]})}}return e})();const gve=["addListener","removeListener"],_ve=["addEventListener","removeEventListener"],vve=["on","off"];function VR(e,t,n,i){if(Lt(n)&&(i=n,n=void 0),i)return VR(e,t,n).pipe(QI(i));const[r,o]=function yve(e){return Lt(e.addEventListener)&&Lt(e.removeEventListener)}(e)?_ve.map(s=>a=>e[s](t,a,n)):function Eve(e){return Lt(e.addListener)&&Lt(e.removeListener)}(e)?gve.map(q4(e,t)):function bve(e){return Lt(e.on)&&Lt(e.off)}(e)?vve.map(q4(e,t)):[];if(!r&&ZI(e))return tr(s=>VR(s,t,n))(Ar(e));if(!r)throw new TypeError("Invalid event target");return new Hn(s=>{const a=(...c)=>s.next(1<c.length?c:c[0]);return r(a),()=>o(a)})}function q4(e,t){return n=>i=>e[n](t,i)}const Wm={schedule(e){let t=requestAnimationFrame,n=cancelAnimationFrame;const{delegate:i}=Wm;i&&(t=i.requestAnimationFrame,n=i.cancelAnimationFrame);const r=t(o=>{n=void 0,e(o)});return new vi(()=>n?.(r))},requestAnimationFrame(...e){const{delegate:t}=Wm;return(t?.requestAnimationFrame||requestAnimationFrame)(...e)},cancelAnimationFrame(...e){const{delegate:t}=Wm;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...e)},delegate:void 0};new class Cve extends TR{flush(t){this._active=!0;const n=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;t=t||i.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===n&&i.shift());if(this._active=!1,r){for(;(t=i[0])&&t.id===n&&i.shift();)t.unsubscribe();throw r}}}(class Sve extends SR{constructor(t,n){super(t,n),this.scheduler=t,this.work=n}requestAsyncId(t,n,i=0){return null!==i&&i>0?super.requestAsyncId(t,n,i):(t.actions.push(this),t._scheduled||(t._scheduled=Wm.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,n,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(t,n,i);const{actions:o}=t;null!=n&&(null===(r=o[o.length-1])||void 0===r?void 0:r.id)!==n&&(Wm.cancelAnimationFrame(n),t._scheduled=void 0)}});let BR,wve=1;const Sb={};function Y4(e){return e in Sb&&(delete Sb[e],!0)}const Ive={setImmediate(e){const t=wve++;return Sb[t]=!0,BR||(BR=Promise.resolve()),BR.then(()=>Y4(t)&&e()),t},clearImmediate(e){Y4(e)}},{setImmediate:Rve,clearImmediate:Ave}=Ive,Cb={setImmediate(...e){const{delegate:t}=Cb;return(t?.setImmediate||Rve)(...e)},clearImmediate(e){const{delegate:t}=Cb;return(t?.clearImmediate||Ave)(e)},delegate:void 0};new class Ove extends TR{flush(t){this._active=!0;const n=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;t=t||i.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===n&&i.shift());if(this._active=!1,r){for(;(t=i[0])&&t.id===n&&i.shift();)t.unsubscribe();throw r}}}(class Dve extends SR{constructor(t,n){super(t,n),this.scheduler=t,this.work=n}requestAsyncId(t,n,i=0){return null!==i&&i>0?super.requestAsyncId(t,n,i):(t.actions.push(this),t._scheduled||(t._scheduled=Cb.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,n,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(t,n,i);const{actions:o}=t;null!=n&&(null===(r=o[o.length-1])||void 0===r?void 0:r.id)!==n&&(Cb.clearImmediate(n),t._scheduled===n&&(t._scheduled=void 0))}});function $4(e,t=wR){return function Pve(e){return ci((t,n)=>{let i=!1,r=null,o=null,s=!1;const a=()=>{if(o?.unsubscribe(),o=null,i){i=!1;const l=r;r=null,n.next(l)}s&&n.complete()},c=()=>{o=null,s&&n.complete()};t.subscribe(Gn(n,l=>{i=!0,r=l,o||Ar(e(l)).subscribe(o=Gn(n,a,c))},()=>{s=!0,(!i||!o||o.closed)&&n.complete()}))})}(()=>function xve(e=0,t,n=rge){let i=-1;return null!=t&&(G3(t)?n=t:i=t),new Hn(r=>{let o=function Mve(e){return e instanceof Date&&!isNaN(e)}(e)?+e-n.now():e;o<0&&(o=0);let s=0;return n.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}(e,t))}let X4=(()=>{class e{constructor(n,i,r){this._ngZone=n,this._platform=i,this._scrolled=new Tt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(n){this.scrollContainers.has(n)||this.scrollContainers.set(n,n.elementScrolled().subscribe(()=>this._scrolled.next(n)))}deregister(n){const i=this.scrollContainers.get(n);i&&(i.unsubscribe(),this.scrollContainers.delete(n))}scrolled(n=20){return this._platform.isBrowser?new Hn(i=>{this._globalSubscription||this._addGlobalListener();const r=n>0?this._scrolled.pipe($4(n)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):He()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((n,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(n,i){const r=this.getAncestorScrollContainers(n);return this.scrolled(i).pipe(Yr(o=>!o||r.indexOf(o)>-1))}getAncestorScrollContainers(n){const i=[];return this.scrollContainers.forEach((r,o)=>{this._scrollableContainsElement(o,n)&&i.push(o)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(n,i){let r=Yc(i),o=n.getElementRef().nativeElement;do{if(r==o)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>VR(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static{this.\u0275fac=function(i){return new(i||e)(Z(Le),Z(Qi),Z(Ut,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Z4=(()=>{class e{constructor(n,i,r){this._platform=n,this._change=new Tt,this._changeListener=o=>{this._change.next(o)},this._document=r,i.runOutsideAngular(()=>{if(n.isBrowser){const o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const n=this._getWindow();n.removeEventListener("resize",this._changeListener),n.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const n={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),n}getViewportRect(){const n=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:n.top,left:n.left,bottom:n.top+r,right:n.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const n=this._document,i=this._getWindow(),r=n.documentElement,o=r.getBoundingClientRect();return{top:-o.top||n.body.scrollTop||i.scrollY||r.scrollTop||0,left:-o.left||n.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(n=20){return n>0?this._change.pipe($4(n)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const n=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:n.innerWidth,height:n.innerHeight}:{width:0,height:0}}static{this.\u0275fac=function(i){return new(i||e)(Z(Qi),Z(Le),Z(Ut,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),jR=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({})}}return e})(),J4=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({imports:[Vm,jR,Vm,jR]})}}return e})();class HR{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class Q4 extends HR{constructor(t,n,i,r,o){super(),this.component=t,this.viewContainerRef=n,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=o}}class Fve extends HR{constructor(t,n,i,r){super(),this.templateRef=t,this.viewContainerRef=n,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(t,n=this.context){return this.context=n,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class Uve extends HR{constructor(t){super(),this.element=t instanceof sn?t.nativeElement:t}}class Vve{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof Q4?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof Fve?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof Uve?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Bve extends Vve{constructor(t,n,i,r,o){super(),this.outletElement=t,this._componentFactoryResolver=n,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=s=>{const a=s.element,c=this._document.createComment("dom-portal");a.parentNode.insertBefore(c,a),this.outletElement.appendChild(a),this._attachedPortal=s,super.setDisposeFn(()=>{c.parentNode&&c.parentNode.replaceChild(a,c)})},this._document=o}attachComponentPortal(t){const i=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let r;return t.viewContainerRef?(r=t.viewContainerRef.createComponent(i,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(t.injector||this._defaultInjector||Bi.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=t,r}attachTemplatePortal(t){let n=t.viewContainerRef,i=n.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=n.indexOf(i);-1!==r&&n.remove(r)}),this._attachedPortal=t,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let jve=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({})}}return e})();const e5=kme();class Hve{constructor(t,n){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=n}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Ci(-this._previousScrollPosition.left),t.style.top=Ci(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,i=t.style,r=this._document.body.style,o=i.scrollBehavior||"",s=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),e5&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),e5&&(i.scrollBehavior=o,r.scrollBehavior=s)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const n=this._document.body,i=this._viewportRuler.getViewportSize();return n.scrollHeight>i.height||n.scrollWidth>i.width}}class Gve{constructor(t,n,i,r){this._scrollDispatcher=t,this._ngZone=n,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0).pipe(Yr(n=>!n||!this._overlayRef.overlayElement.contains(n.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const n=this._viewportRuler.getViewportScrollPosition().top;Math.abs(n-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class t5{enable(){}disable(){}attach(){}}function GR(e,t){return t.some(n=>e.bottom<n.top||e.top>n.bottom||e.right<n.left||e.left>n.right)}function n5(e,t){return t.some(n=>e.top<n.top||e.bottom>n.bottom||e.left<n.left||e.right>n.right)}class Wve{constructor(t,n,i,r){this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const n=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();GR(n,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let zve=(()=>{class e{constructor(n,i,r,o){this._scrollDispatcher=n,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new t5,this.close=s=>new Gve(this._scrollDispatcher,this._ngZone,this._viewportRuler,s),this.block=()=>new Hve(this._viewportRuler,this._document),this.reposition=s=>new Wve(this._scrollDispatcher,this._viewportRuler,this._ngZone,s),this._document=o}static{this.\u0275fac=function(i){return new(i||e)(Z(X4),Z(Z4),Z(Le),Z(Ut))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();class Kve{constructor(t){if(this.scrollStrategy=new t5,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const n=Object.keys(t);for(const i of n)void 0!==t[i]&&(this[i]=t[i])}}}class qve{constructor(t,n){this.connectionPair=t,this.scrollableViewProperties=n}}let r5=(()=>{class e{constructor(n){this._attachedOverlays=[],this._document=n}ngOnDestroy(){this.detach()}add(n){this.remove(n),this._attachedOverlays.push(n)}remove(n){const i=this._attachedOverlays.indexOf(n);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Yve=(()=>{class e extends r5{constructor(n,i){super(n),this._ngZone=i,this._keydownListener=r=>{const o=this._attachedOverlays;for(let s=o.length-1;s>-1;s--)if(o[s]._keydownEvents.observers.length>0){const a=o[s]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(n){super.add(n),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut),Z(Le,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),$ve=(()=>{class e extends r5{constructor(n,i,r){super(n),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=o=>{this._pointerDownEventTarget=qc(o)},this._clickListener=o=>{const s=qc(o),a="click"===o.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:s;this._pointerDownEventTarget=null;const c=this._attachedOverlays.slice();for(let l=c.length-1;l>-1;l--){const d=c[l];if(d._outsidePointerEvents.observers.length<1||!d.hasAttached())continue;if(d.overlayElement.contains(s)||d.overlayElement.contains(a))break;const u=d._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>u.next(o)):u.next(o)}}}add(n){if(super.add(n),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const n=this._document.body;n.removeEventListener("pointerdown",this._pointerDownListener,!0),n.removeEventListener("click",this._clickListener,!0),n.removeEventListener("auxclick",this._clickListener,!0),n.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(n.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(n){n.addEventListener("pointerdown",this._pointerDownListener,!0),n.addEventListener("click",this._clickListener,!0),n.addEventListener("auxclick",this._clickListener,!0),n.addEventListener("contextmenu",this._clickListener,!0)}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut),Z(Qi),Z(Le,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),o5=(()=>{class e{constructor(n,i){this._platform=i,this._document=n}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const n="cdk-overlay-container";if(this._platform.isBrowser||yR()){const r=this._document.querySelectorAll(`.${n}[platform="server"], .${n}[platform="test"]`);for(let o=0;o<r.length;o++)r[o].remove()}const i=this._document.createElement("div");i.classList.add(n),yR()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut),Z(Qi))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();class Xve{constructor(t,n,i,r,o,s,a,c,l,d=!1){this._portalOutlet=t,this._host=n,this._pane=i,this._config=r,this._ngZone=o,this._keyboardDispatcher=s,this._document=a,this._location=c,this._outsideClickDispatcher=l,this._animationsDisabled=d,this._backdropElement=null,this._backdropClick=new Tt,this._attachments=new Tt,this._detachments=new Tt,this._locationChanges=vi.EMPTY,this._backdropClickHandler=u=>this._backdropClick.next(u),this._backdropTransitionendHandler=u=>{this._disposeBackdrop(u.target)},this._keydownEvents=new Tt,this._outsidePointerEvents=new Tt,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const n=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(la(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof n?.onDestroy&&n.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),n}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=Ci(this._config.width),t.height=Ci(this._config.height),t.minWidth=Ci(this._config.minWidth),t.minHeight=Ci(this._config.minHeight),t.maxWidth=Ci(this._config.maxWidth),t.maxHeight=Ci(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;if(t){if(this._animationsDisabled)return void this._disposeBackdrop(t);t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,n,i){const r=hb(n||[]).filter(o=>!!o);r.length&&(i?t.classList.add(...r):t.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(mr(P4(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const s5="cdk-overlay-connected-position-bounding-box",Zve=/([A-Za-z%]+)$/;class Jve{get positions(){return this._preferredPositions}constructor(t,n,i,r,o){this._viewportRuler=n,this._document=i,this._platform=r,this._overlayContainer=o,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Tt,this._resizeSubscription=vi.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}attach(t){this._validatePositions(),t.hostElement.classList.add(s5),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,n=this._overlayRect,i=this._viewportRect,r=this._containerRect,o=[];let s;for(let a of this._preferredPositions){let c=this._getOriginPoint(t,r,a),l=this._getOverlayPoint(c,n,a),d=this._getOverlayFit(l,n,i,a);if(d.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,c);this._canFitWithFlexibleDimensions(d,l,i)?o.push({position:a,origin:c,overlayRect:n,boundingBoxRect:this._calculateBoundingBoxRect(c,a)}):(!s||s.overlayFit.visibleArea<d.visibleArea)&&(s={overlayFit:d,overlayPoint:l,originPoint:c,position:a,overlayRect:n})}if(o.length){let a=null,c=-1;for(const l of o){const d=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);d>c&&(c=d,a=l)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(s.position,s.originPoint);this._applyPosition(s.position,s.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&ud(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(s5),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const n=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,n)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,n,i){let r,o;if("center"==i.originX)r=t.left+t.width/2;else{const s=this._isRtl()?t.right:t.left,a=this._isRtl()?t.left:t.right;r="start"==i.originX?s:a}return n.left<0&&(r-=n.left),o="center"==i.originY?t.top+t.height/2:"top"==i.originY?t.top:t.bottom,n.top<0&&(o-=n.top),{x:r,y:o}}_getOverlayPoint(t,n,i){let r,o;return r="center"==i.overlayX?-n.width/2:"start"===i.overlayX?this._isRtl()?-n.width:0:this._isRtl()?0:-n.width,o="center"==i.overlayY?-n.height/2:"top"==i.overlayY?0:-n.height,{x:t.x+r,y:t.y+o}}_getOverlayFit(t,n,i,r){const o=c5(n);let{x:s,y:a}=t,c=this._getOffset(r,"x"),l=this._getOffset(r,"y");c&&(s+=c),l&&(a+=l);let h=0-a,p=a+o.height-i.height,m=this._subtractOverflows(o.width,0-s,s+o.width-i.width),f=this._subtractOverflows(o.height,h,p),g=m*f;return{visibleArea:g,isCompletelyWithinViewport:o.width*o.height===g,fitsInViewportVertically:f===o.height,fitsInViewportHorizontally:m==o.width}}_canFitWithFlexibleDimensions(t,n,i){if(this._hasFlexibleDimensions){const r=i.bottom-n.y,o=i.right-n.x,s=a5(this._overlayRef.getConfig().minHeight),a=a5(this._overlayRef.getConfig().minWidth);return(t.fitsInViewportVertically||null!=s&&s<=r)&&(t.fitsInViewportHorizontally||null!=a&&a<=o)}return!1}_pushOverlayOnScreen(t,n,i){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=c5(n),o=this._viewportRect,s=Math.max(t.x+r.width-o.width,0),a=Math.max(t.y+r.height-o.height,0),c=Math.max(o.top-i.top-t.y,0),l=Math.max(o.left-i.left-t.x,0);let d=0,u=0;return d=r.width<=o.width?l||-s:t.x<this._viewportMargin?o.left-i.left-t.x:0,u=r.height<=o.height?c||-a:t.y<this._viewportMargin?o.top-i.top-t.y:0,this._previousPushAmount={x:d,y:u},{x:t.x+d,y:t.y+u}}_applyPosition(t,n){if(this._setTransformOrigin(t),this._setOverlayElementStyles(n,t),this._setBoundingBoxStyles(n,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._positionChanges.observers.length){const i=this._getScrollVisibility();if(t!==this._lastPosition||!this._lastScrollVisibility||!function Qve(e,t){return e===t||e.isOriginClipped===t.isOriginClipped&&e.isOriginOutsideView===t.isOriginOutsideView&&e.isOverlayClipped===t.isOverlayClipped&&e.isOverlayOutsideView===t.isOverlayOutsideView}(this._lastScrollVisibility,i)){const r=new qve(t,i);this._positionChanges.next(r)}this._lastScrollVisibility=i}this._lastPosition=t,this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const n=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=t.overlayY;i="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let o=0;o<n.length;o++)n[o].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(t,n){const i=this._viewportRect,r=this._isRtl();let o,s,a,d,u,h;if("top"===n.overlayY)s=t.y,o=i.height-s+this._viewportMargin;else if("bottom"===n.overlayY)a=i.height-t.y+2*this._viewportMargin,o=i.height-a+this._viewportMargin;else{const p=Math.min(i.bottom-t.y+i.top,t.y),m=this._lastBoundingBoxSize.height;o=2*p,s=t.y-p,o>m&&!this._isInitialRender&&!this._growAfterOpen&&(s=t.y-m/2)}if("end"===n.overlayX&&!r||"start"===n.overlayX&&r)h=i.width-t.x+2*this._viewportMargin,d=t.x-this._viewportMargin;else if("start"===n.overlayX&&!r||"end"===n.overlayX&&r)u=t.x,d=i.right-t.x;else{const p=Math.min(i.right-t.x+i.left,t.x),m=this._lastBoundingBoxSize.width;d=2*p,u=t.x-p,d>m&&!this._isInitialRender&&!this._growAfterOpen&&(u=t.x-m/2)}return{top:s,left:u,bottom:a,right:h,width:d,height:o}}_setBoundingBoxStyles(t,n){const i=this._calculateBoundingBoxRect(t,n);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const o=this._overlayRef.getConfig().maxHeight,s=this._overlayRef.getConfig().maxWidth;r.height=Ci(i.height),r.top=Ci(i.top),r.bottom=Ci(i.bottom),r.width=Ci(i.width),r.left=Ci(i.left),r.right=Ci(i.right),r.alignItems="center"===n.overlayX?"center":"end"===n.overlayX?"flex-end":"flex-start",r.justifyContent="center"===n.overlayY?"center":"bottom"===n.overlayY?"flex-end":"flex-start",o&&(r.maxHeight=Ci(o)),s&&(r.maxWidth=Ci(s))}this._lastBoundingBoxSize=i,ud(this._boundingBox.style,r)}_resetBoundingBoxStyles(){ud(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){ud(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,n){const i={},r=this._hasExactPosition(),o=this._hasFlexibleDimensions,s=this._overlayRef.getConfig();if(r){const d=this._viewportRuler.getViewportScrollPosition();ud(i,this._getExactOverlayY(n,t,d)),ud(i,this._getExactOverlayX(n,t,d))}else i.position="static";let a="",c=this._getOffset(n,"x"),l=this._getOffset(n,"y");c&&(a+=`translateX(${c}px) `),l&&(a+=`translateY(${l}px)`),i.transform=a.trim(),s.maxHeight&&(r?i.maxHeight=Ci(s.maxHeight):o&&(i.maxHeight="")),s.maxWidth&&(r?i.maxWidth=Ci(s.maxWidth):o&&(i.maxWidth="")),ud(this._pane.style,i)}_getExactOverlayY(t,n,i){let r={top:"",bottom:""},o=this._getOverlayPoint(n,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,i)),"bottom"===t.overlayY?r.bottom=this._document.documentElement.clientHeight-(o.y+this._overlayRect.height)+"px":r.top=Ci(o.y),r}_getExactOverlayX(t,n,i){let s,r={left:"",right:""},o=this._getOverlayPoint(n,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,i)),s=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===s?r.right=this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)+"px":r.left=Ci(o.x),r}_getScrollVisibility(){const t=this._getOriginRect(),n=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:n5(t,i),isOriginOutsideView:GR(t,i),isOverlayClipped:n5(n,i),isOverlayOutsideView:GR(n,i)}}_subtractOverflows(t,...n){return n.reduce((i,r)=>i-Math.max(r,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,n=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+t-this._viewportMargin,bottom:i.top+n-this._viewportMargin,width:t-2*this._viewportMargin,height:n-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,n){return"x"===n?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&hb(t).forEach(n=>{""!==n&&-1===this._appliedPanelClasses.indexOf(n)&&(this._appliedPanelClasses.push(n),this._pane.classList.add(n))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof sn)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const n=t.width||0,i=t.height||0;return{top:t.y,bottom:t.y+i,left:t.x,right:t.x+n,height:i,width:n}}}function ud(e,t){for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function a5(e){if("number"!=typeof e&&null!=e){const[t,n]=e.split(Zve);return n&&"px"!==n?null:parseFloat(t)}return e||null}function c5(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}const l5="cdk-global-overlay-wrapper";class eEe{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){const n=t.getConfig();this._overlayRef=t,this._width&&!n.width&&t.updateSize({width:this._width}),this._height&&!n.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(l5),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,n=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:o,maxWidth:s,maxHeight:a}=i,c=!("100%"!==r&&"100vw"!==r||s&&"100%"!==s&&"100vw"!==s),l=!("100%"!==o&&"100vh"!==o||a&&"100%"!==a&&"100vh"!==a),d=this._xPosition,u=this._xOffset,h="rtl"===this._overlayRef.getConfig().direction;let p="",m="",f="";c?f="flex-start":"center"===d?(f="center",h?m=u:p=u):h?"left"===d||"end"===d?(f="flex-end",p=u):("right"===d||"start"===d)&&(f="flex-start",m=u):"left"===d||"start"===d?(f="flex-start",p=u):("right"===d||"end"===d)&&(f="flex-end",m=u),t.position=this._cssPosition,t.marginLeft=c?"0":p,t.marginTop=l?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=c?"0":m,n.justifyContent=f,n.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,n=this._overlayRef.hostElement,i=n.style;n.classList.remove(l5),i.justifyContent=i.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let tEe=(()=>{class e{constructor(n,i,r,o){this._viewportRuler=n,this._document=i,this._platform=r,this._overlayContainer=o}global(){return new eEe}flexibleConnectedTo(n){return new Jve(n,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static{this.\u0275fac=function(i){return new(i||e)(Z(Z4),Z(Ut),Z(Qi),Z(o5))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),nEe=0,_h=(()=>{class e{constructor(n,i,r,o,s,a,c,l,d,u,h,p){this.scrollStrategies=n,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=o,this._keyboardDispatcher=s,this._injector=a,this._ngZone=c,this._document=l,this._directionality=d,this._location=u,this._outsideClickDispatcher=h,this._animationsModuleType=p}create(n){const i=this._createHostElement(),r=this._createPaneElement(i),o=this._createPortalOutlet(r),s=new Kve(n);return s.direction=s.direction||this._directionality.value,new Xve(o,i,r,s,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(n){const i=this._document.createElement("div");return i.id="cdk-overlay-"+nEe++,i.classList.add("cdk-overlay-pane"),n.appendChild(i),i}_createHostElement(){const n=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(n),n}_createPortalOutlet(n){return this._appRef||(this._appRef=this._injector.get(aa)),new Bve(n,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static{this.\u0275fac=function(i){return new(i||e)(Z(zve),Z(o5),Z(Fu),Z(tEe),Z(Yve),Z(Bi),Z(Le),Z(Ut),Z(OR),Z(ch),Z($ve),Z($a,8))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const iEe=new re("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{const e=J(_h);return()=>e.scrollStrategies.reposition()}}),oEe={provide:iEe,deps:[_h],useFactory:function rEe(e){return()=>e.scrollStrategies.reposition()}};let sEe=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({providers:[_h,oEe],imports:[Vm,jve,J4,J4]})}}return e})();const aEe=["tooltip"],u5=new re("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{const e=J(_h);return()=>e.scrollStrategies.reposition({scrollThrottle:20})}}),lEe={provide:u5,deps:[_h],useFactory:function cEe(e){return()=>e.scrollStrategies.reposition({scrollThrottle:20})}},uEe=new re("mat-tooltip-default-options",{providedIn:"root",factory:function dEe(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),h5="tooltip-panel",p5=ph({passive:!0});let gEe=(()=>{class e{get position(){return this._position}set position(n){n!==this._position&&(this._position=n,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(n){this._positionAtOrigin=fh(n),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(n){this._disabled=fh(n),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(n){this._showDelay=i4(n)}get hideDelay(){return this._hideDelay}set hideDelay(n){this._hideDelay=i4(n),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(n){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=n?String(n).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(n){this._tooltipClass=n,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(n,i,r,o,s,a,c,l,d,u,h,p){this._overlay=n,this._elementRef=i,this._scrollDispatcher=r,this._viewContainerRef=o,this._ngZone=s,this._platform=a,this._ariaDescriber=c,this._focusMonitor=l,this._dir=u,this._defaultOptions=h,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._tooltipComponent=_Ee,this._viewportMargin=8,this._cssClassPrefix="mat-mdc",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new Tt,this._scrollStrategy=d,this._document=p,h&&(this._showDelay=h.showDelay,this._hideDelay=h.hideDelay,h.position&&(this.position=h.position),h.positionAtOrigin&&(this.positionAtOrigin=h.positionAtOrigin),h.touchGestures&&(this.touchGestures=h.touchGestures)),u.change.pipe(mr(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=8}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(mr(this._destroyed)).subscribe(n=>{n?"keyboard"===n&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const n=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([i,r])=>{n.removeEventListener(i,r,p5)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(n,this.message,"tooltip"),this._focusMonitor.stopMonitoring(n)}show(n=this.showDelay,i){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const r=this._createOverlay(i);this._detach(),this._portal=this._portal||new Q4(this._tooltipComponent,this._viewContainerRef);const o=this._tooltipInstance=r.attach(this._portal).instance;o._triggerElement=this._elementRef.nativeElement,o._mouseLeaveHideDelay=this._hideDelay,o.afterHidden().pipe(mr(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),o.show(n)}hide(n=this.hideDelay){const i=this._tooltipInstance;i&&(i.isVisible()?i.hide(n):(i._cancelPendingAnimations(),this._detach()))}toggle(n){this._isTooltipVisible()?this.hide():this.show(void 0,n)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(n){if(this._overlayRef){const o=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!n)&&o._origin instanceof sn)return this._overlayRef;this._detach()}const i=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),r=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&n||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(i);return r.positionChanges.pipe(mr(this._destroyed)).subscribe(o=>{this._updateCurrentPositionClass(o.connectionPair),this._tooltipInstance&&o.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${h5}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(mr(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(mr(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(mr(this._destroyed)).subscribe(o=>{this._isTooltipVisible()&&27===o.keyCode&&!function Qj(e,...t){return t.length?t.some(n=>e[n]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}(o)&&(o.preventDefault(),o.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(n){const i=n.getConfig().positionStrategy,r=this._getOrigin(),o=this._getOverlayPosition();i.withPositions([this._addOffset({...r.main,...o.main}),this._addOffset({...r.fallback,...o.fallback})])}_addOffset(n){const r=!this._dir||"ltr"==this._dir.value;return"top"===n.originY?n.offsetY=-8:"bottom"===n.originY?n.offsetY=8:"start"===n.originX?n.offsetX=r?-8:8:"end"===n.originX&&(n.offsetX=r?8:-8),n}_getOrigin(){const n=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i||"below"==i?r={originX:"center",originY:"above"==i?"top":"bottom"}:"before"==i||"left"==i&&n||"right"==i&&!n?r={originX:"start",originY:"center"}:("after"==i||"right"==i&&n||"left"==i&&!n)&&(r={originX:"end",originY:"center"});const{x:o,y:s}=this._invertPosition(r.originX,r.originY);return{main:r,fallback:{originX:o,originY:s}}}_getOverlayPosition(){const n=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i?r={overlayX:"center",overlayY:"bottom"}:"below"==i?r={overlayX:"center",overlayY:"top"}:"before"==i||"left"==i&&n||"right"==i&&!n?r={overlayX:"end",overlayY:"center"}:("after"==i||"right"==i&&n||"left"==i&&!n)&&(r={overlayX:"start",overlayY:"center"});const{x:o,y:s}=this._invertPosition(r.overlayX,r.overlayY);return{main:r,fallback:{overlayX:o,overlayY:s}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(la(1),mr(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(n){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=n,this._tooltipInstance._markForCheck())}_invertPosition(n,i){return"above"===this.position||"below"===this.position?"top"===i?i="bottom":"bottom"===i&&(i="top"):"end"===n?n="start":"start"===n&&(n="end"),{x:n,y:i}}_updateCurrentPositionClass(n){const{overlayY:i,originX:r,originY:o}=n;let s;if(s="center"===i?this._dir&&"rtl"===this._dir.value?"end"===r?"left":"right":"start"===r?"left":"right":"bottom"===i&&"top"===o?"above":"below",s!==this._currentPosition){const a=this._overlayRef;if(a){const c=`${this._cssClassPrefix}-${h5}-`;a.removePanelClass(c+this._currentPosition),a.addPanelClass(c+s)}this._currentPosition=s}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",n=>{let i;this._setupPointerExitEventsIfNeeded(),void 0!==n.x&&void 0!==n.y&&(i=n),this.show(void 0,i)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",n=>{const i=n.targetTouches?.[0],r=i?{x:i.clientX,y:i.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,r),this._defaultOptions.touchLongPressShowDelay??500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const n=[];if(this._platformSupportsMouseEvents())n.push(["mouseleave",i=>{const r=i.relatedTarget;(!r||!this._overlayRef?.overlayElement.contains(r))&&this.hide()}],["wheel",i=>this._wheelListener(i)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const i=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};n.push(["touchend",i],["touchcancel",i])}this._addListeners(n),this._passiveListeners.push(...n)}_addListeners(n){n.forEach(([i,r])=>{this._elementRef.nativeElement.addEventListener(i,r,p5)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(n){if(this._isTooltipVisible()){const i=this._document.elementFromPoint(n.clientX,n.clientY),r=this._elementRef.nativeElement;i!==r&&!r.contains(i)&&this.hide()}}_disableNativeGesturesIfNecessary(){const n=this.touchGestures;if("off"!==n){const i=this._elementRef.nativeElement,r=i.style;("on"===n||"INPUT"!==i.nodeName&&"TEXTAREA"!==i.nodeName)&&(r.userSelect=r.msUserSelect=r.webkitUserSelect=r.MozUserSelect="none"),("on"===n||!i.draggable)&&(r.webkitUserDrag="none"),r.touchAction="none",r.webkitTapHighlightColor="transparent"}}static{this.\u0275fac=function(i){return new(i||e)(H(_h),H(sn),H(X4),H(Bo),H(Le),H(Qi),H(Ege),H(AR),H(u5),H(OR),H(uEe,8),H(Ut))}}static{this.\u0275dir=ye({type:e,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(i,r){2&i&&wt("mat-mdc-tooltip-disabled",r.disabled)},inputs:{position:[we.None,"matTooltipPosition","position"],positionAtOrigin:[we.None,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[we.None,"matTooltipDisabled","disabled"],showDelay:[we.None,"matTooltipShowDelay","showDelay"],hideDelay:[we.None,"matTooltipHideDelay","hideDelay"],touchGestures:[we.None,"matTooltipTouchGestures","touchGestures"],message:[we.None,"matTooltip","message"],tooltipClass:[we.None,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"],standalone:!0})}}return e})(),_Ee=(()=>{class e{constructor(n,i,r){this._changeDetectorRef=n,this._elementRef=i,this._isMultiline=!1,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new Tt,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide",this._animationsDisabled="NoopAnimations"===r}show(n){null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},n)}hide(n){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},n)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:n}){(!n||!this._triggerElement.contains(n))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const n=this._elementRef.nativeElement.getBoundingClientRect();return n.height>24&&n.width>=200}_handleAnimationEnd({animationName:n}){(n===this._showAnimation||n===this._hideAnimation)&&this._finalizeAnimation(n===this._showAnimation)}_cancelPendingAnimations(){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(n){n?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(n){const i=this._tooltip.nativeElement,r=this._showAnimation,o=this._hideAnimation;if(i.classList.remove(n?o:r),i.classList.add(n?r:o),this._isVisible!==n&&(this._isVisible=n,this._changeDetectorRef.markForCheck()),n&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const s=getComputedStyle(i);("0s"===s.getPropertyValue("animation-duration")||"none"===s.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}n&&this._onShow(),this._animationsDisabled&&(i.classList.add("_mat-animation-noopable"),this._finalizeAnimation(n))}static{this.\u0275fac=function(i){return new(i||e)(H(ws),H(sn),H($a,8))}}static{this.\u0275cmp=sr({type:e,selectors:[["mat-tooltip-component"]],viewQuery:function(i,r){if(1&i&&sa(aEe,7),2&i){let o;ji(o=Hi())&&(r._tooltip=o.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(i,r){1&i&&zt("mouseleave",function(s){return r._handleMouseLeave(s)}),2&i&&Fw("zoom",r.isVisible()?1:null)},standalone:!0,features:[jc],decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mdc-tooltip--shown","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mdc-tooltip__surface","mdc-tooltip__surface-animation"]],template:function(i,r){if(1&i){const o=Qa();ue(0,"div",1,0),zt("animationend",function(a){return Gr(o),Wr(r._handleAnimationEnd(a))}),ue(2,"div",2),fr(3),ve()()}2&i&&(wt("mdc-tooltip--multiline",r._isMultiline),ht("ngClass",r.tooltipClass),Re(3),nd(r.message))},dependencies:[PI],styles:['.mdc-tooltip__surface{word-break:break-all;word-break:var(--mdc-tooltip-word-break, normal);overflow-wrap:anywhere}.mdc-tooltip--showing-transition .mdc-tooltip__surface-animation{transition:opacity 150ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-tooltip--hide-transition .mdc-tooltip__surface-animation{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-tooltip{position:fixed;display:none;z-index:9}.mdc-tooltip-wrapper--rich{position:relative}.mdc-tooltip--shown,.mdc-tooltip--showing,.mdc-tooltip--hide{display:inline-flex}.mdc-tooltip--shown.mdc-tooltip--rich,.mdc-tooltip--showing.mdc-tooltip--rich,.mdc-tooltip--hide.mdc-tooltip--rich{display:inline-block;left:-320px;position:absolute}.mdc-tooltip__surface{line-height:16px;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center}.mdc-tooltip__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-tooltip__surface::before{border-color:CanvasText}}.mdc-tooltip--rich .mdc-tooltip__surface{align-items:flex-start;display:flex;flex-direction:column;min-height:24px;min-width:40px;max-width:320px;position:relative}.mdc-tooltip--multiline .mdc-tooltip__surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mdc-tooltip__surface,.mdc-tooltip--multiline .mdc-tooltip__surface[dir=rtl]{text-align:right}.mdc-tooltip__surface .mdc-tooltip__title{margin:0 8px}.mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(200px - 2*8px);margin:8px;text-align:left}[dir=rtl] .mdc-tooltip__surface .mdc-tooltip__content,.mdc-tooltip__surface .mdc-tooltip__content[dir=rtl]{text-align:right}.mdc-tooltip--rich .mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(320px - 2*8px);align-self:stretch}.mdc-tooltip__surface .mdc-tooltip__content-link{text-decoration:none}.mdc-tooltip--rich-actions,.mdc-tooltip__content,.mdc-tooltip__title{z-index:1}.mdc-tooltip__surface-animation{opacity:0;transform:scale(0.8);will-change:transform,opacity}.mdc-tooltip--shown .mdc-tooltip__surface-animation{transform:scale(1);opacity:1}.mdc-tooltip--hide .mdc-tooltip__surface-animation{transform:scale(1)}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{position:absolute;height:24px;width:24px;transform:rotate(35deg) skewY(20deg) scaleX(0.9396926208)}.mdc-tooltip__caret-surface-top .mdc-elevation-overlay,.mdc-tooltip__caret-surface-bottom .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-tooltip__caret-surface-bottom{box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);outline:1px solid rgba(0,0,0,0);z-index:-1}@media screen and (forced-colors: active){.mdc-tooltip__caret-surface-bottom{outline-color:CanvasText}}.mat-mdc-tooltip .mdc-tooltip__surface{background-color:var(--mdc-plain-tooltip-container-color)}.mat-mdc-tooltip .mdc-tooltip__surface{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__caret-surface-top,.mat-mdc-tooltip .mdc-tooltip__caret-surface-bottom{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__surface{color:var(--mdc-plain-tooltip-supporting-text-color)}.mat-mdc-tooltip .mdc-tooltip__surface{font-family:var(--mdc-plain-tooltip-supporting-text-font);line-height:var(--mdc-plain-tooltip-supporting-text-line-height);font-size:var(--mdc-plain-tooltip-supporting-text-size);font-weight:var(--mdc-plain-tooltip-supporting-text-weight);letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking)}.mat-mdc-tooltip{position:relative;transform:scale(0)}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0})}}return e})(),vEe=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({providers:[lEe],imports:[Pge,qE,sEe,zo,zo,jR]})}}return e})();function f5(e){return new W(3e3,!1)}function $c(e){switch(e.length){case 0:return new Gm;case 1:return e[0];default:return new M4(e)}}function m5(e,t,n=new Map,i=new Map){const r=[],o=[];let s=-1,a=null;if(t.forEach(c=>{const l=c.get("offset"),d=l==s,u=d&&a||new Map;c.forEach((h,p)=>{let m=p,f=h;if("offset"!==p)switch(m=e.normalizePropertyName(m,r),f){case"!":f=n.get(p);break;case sc:f=i.get(p);break;default:f=e.normalizeStyleValue(p,m,f,r)}u.set(m,f)}),d||o.push(u),a=u,s=l}),r.length)throw function jEe(e){return new W(3502,!1)}();return o}function WR(e,t,n,i){switch(t){case"start":e.onStart(()=>i(n&&zR(n,"start",e)));break;case"done":e.onDone(()=>i(n&&zR(n,"done",e)));break;case"destroy":e.onDestroy(()=>i(n&&zR(n,"destroy",e)))}}function zR(e,t,n){const o=KR(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,n.totalTime??e.totalTime,!!n.disabled),s=e._data;return null!=s&&(o._data=s),o}function KR(e,t,n,i,r="",o=0,s){return{element:e,triggerName:t,fromState:n,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function vo(e,t,n){let i=e.get(t);return i||e.set(t,i=n),i}function g5(e){const t=e.indexOf(":");return[e.substring(1,t),e.slice(t+1)]}const QEe=typeof document>"u"?null:document.documentElement;function qR(e){const t=e.parentNode||e.host||null;return t===QEe?null:t}let hd=null,_5=!1;function v5(e,t){for(;t;){if(t===e)return!0;t=qR(t)}return!1}function E5(e,t,n){if(n)return Array.from(e.querySelectorAll(t));const i=e.querySelector(t);return i?[i]:[]}let YR=(()=>{class e{validateStyleProperty(n){return function tbe(e){hd||(hd=function nbe(){return typeof document<"u"?document.body:null}()||{},_5=!!hd.style&&"WebkitAppearance"in hd.style);let t=!0;return hd.style&&!function ebe(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in hd.style,!t&&_5&&(t="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in hd.style)),t}(n)}matchesElement(n,i){return!1}containsElement(n,i){return v5(n,i)}getParentElement(n){return qR(n)}query(n,i,r){return E5(n,i,r)}computeStyle(n,i,r){return r||""}animate(n,i,r,o,s,a=[],c){return new Gm(r,o)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})();class $R{static{this.NOOP=new YR}}class XR{}const rbe=1e3,ZR="ng-enter",Tb="ng-leave",wb="ng-trigger",Ib=".ng-trigger",y5="ng-animating",JR=".ng-animating";function ac(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:QR(parseFloat(t[1]),t[2])}function QR(e,t){return"s"===t?e*rbe:e}function Rb(e,t,n){return e.hasOwnProperty("duration")?e:function sbe(e,t,n){let r,o=0,s="";if("string"==typeof e){const a=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push(f5()),{duration:0,delay:0,easing:""};r=QR(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(o=QR(parseFloat(c),a[4]));const l=a[5];l&&(s=l)}else r=e;if(!n){let a=!1,c=t.length;r<0&&(t.push(function EEe(){return new W(3100,!1)}()),a=!0),o<0&&(t.push(function bEe(){return new W(3101,!1)}()),a=!0),a&&t.splice(c,0,f5())}return{duration:r,delay:o,easing:s}}(e,t,n)}function ua(e,t,n){t.forEach((i,r)=>{const o=tA(r);n&&!n.has(r)&&n.set(r,e.style[o]),e.style[o]=i})}function pd(e,t){t.forEach((n,i)=>{const r=tA(i);e.style[r]=""})}function zm(e){return Array.isArray(e)?1==e.length?e[0]:function g_e(e,t=null){return{type:Ge.Sequence,steps:e,options:t}}(e):e}const eA=new RegExp("{{\\s*(.+?)\\s*}}","g");function C5(e){let t=[];if("string"==typeof e){let n;for(;n=eA.exec(e);)t.push(n[1]);eA.lastIndex=0}return t}function Km(e,t,n){const i=`${e}`,r=i.replace(eA,(o,s)=>{let a=t[s];return null==a&&(n.push(function SEe(e){return new W(3003,!1)}()),a=""),a.toString()});return r==i?e:r}const lbe=/-+([a-z0-9])/g;function tA(e){return e.replace(lbe,(...t)=>t[1].toUpperCase())}function Eo(e,t,n){switch(t.type){case Ge.Trigger:return e.visitTrigger(t,n);case Ge.State:return e.visitState(t,n);case Ge.Transition:return e.visitTransition(t,n);case Ge.Sequence:return e.visitSequence(t,n);case Ge.Group:return e.visitGroup(t,n);case Ge.Animate:return e.visitAnimate(t,n);case Ge.Keyframes:return e.visitKeyframes(t,n);case Ge.Style:return e.visitStyle(t,n);case Ge.Reference:return e.visitReference(t,n);case Ge.AnimateChild:return e.visitAnimateChild(t,n);case Ge.AnimateRef:return e.visitAnimateRef(t,n);case Ge.Query:return e.visitQuery(t,n);case Ge.Stagger:return e.visitStagger(t,n);default:throw function CEe(e){return new W(3004,!1)}()}}function nA(e,t){return window.getComputedStyle(e)[t]}const hbe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class T5 extends XR{normalizePropertyName(t,n){return tA(t)}normalizeStyleValue(t,n,i,r){let o="";const s=i.toString().trim();if(hbe.has(n)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function TEe(e,t){return new W(3005,!1)}())}return s+o}}const Ab="*";const Db=new Set(["true","1"]),Ob=new Set(["false","0"]);function w5(e,t){const n=Db.has(e)||Ob.has(e),i=Db.has(t)||Ob.has(t);return(r,o)=>{let s=e==Ab||e==r,a=t==Ab||t==o;return!s&&n&&"boolean"==typeof r&&(s=r?Db.has(e):Ob.has(e)),!a&&i&&"boolean"==typeof o&&(a=o?Db.has(t):Ob.has(t)),s&&a}}const gbe=new RegExp("s*:selfs*,?","g");function iA(e,t,n,i){return new _be(e).build(t,n,i)}class _be{constructor(t){this._driver=t}build(t,n,i){const r=new bbe(n);return this._resetContextStyleTimingState(r),Eo(this,zm(t),r)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,n){let i=n.queryCount=0,r=n.depCount=0;const o=[],s=[];return"@"==t.name.charAt(0)&&n.errors.push(function wEe(){return new W(3006,!1)}()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(n),a.type==Ge.State){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(d=>{c.name=d,o.push(this.visitState(c,n))}),c.name=l}else if(a.type==Ge.Transition){const c=this.visitTransition(a,n);i+=c.queryCount,r+=c.depCount,s.push(c)}else n.errors.push(function IEe(){return new W(3007,!1)}())}),{type:Ge.Trigger,name:t.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(t,n){const i=this.visitStyle(t.styles,n),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{C5(c).forEach(l=>{s.hasOwnProperty(l)||o.add(l)})})}),o.size&&n.errors.push(function REe(e,t){return new W(3008,!1)}(0,o.values()))}return{type:Ge.State,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,n){n.queryCount=0,n.depCount=0;const i=Eo(this,zm(t.animation),n),r=function pbe(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(i=>function fbe(e,t,n){if(":"==e[0]){const c=function mbe(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,i)=>parseFloat(i)>parseFloat(n);case":decrement":return(n,i)=>parseFloat(i)<parseFloat(n);default:return t.push(function FEe(e){return new W(3016,!1)}()),"* => *"}}(e,n);if("function"==typeof c)return void t.push(c);e=c}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push(function LEe(e){return new W(3015,!1)}()),t;const r=i[1],o=i[2],s=i[3];t.push(w5(r,s)),"<"==o[0]&&(r!=Ab||s!=Ab)&&t.push(w5(s,r))}(i,n,t)):n.push(e),n}(t.expr,n.errors);return{type:Ge.Transition,matchers:r,animation:i,queryCount:n.queryCount,depCount:n.depCount,options:fd(t.options)}}visitSequence(t,n){return{type:Ge.Sequence,steps:t.steps.map(i=>Eo(this,i,n)),options:fd(t.options)}}visitGroup(t,n){const i=n.currentTime;let r=0;const o=t.steps.map(s=>{n.currentTime=i;const a=Eo(this,s,n);return r=Math.max(r,n.currentTime),a});return n.currentTime=r,{type:Ge.Group,steps:o,options:fd(t.options)}}visitAnimate(t,n){const i=function Sbe(e,t){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return rA(Rb(e,t).duration,0,"");const n=e;if(n.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=rA(0,0,"");return o.dynamic=!0,o.strValue=n,o}const r=Rb(n,t);return rA(r.duration,r.delay,r.easing)}(t.timings,n.errors);n.currentAnimateTimings=i;let r,o=t.styles?t.styles:da({});if(o.type==Ge.Keyframes)r=this.visitKeyframes(o,n);else{let s=t.styles,a=!1;if(!s){a=!0;const l={};i.easing&&(l.easing=i.easing),s=da(l)}n.currentTime+=i.duration+i.delay;const c=this.visitStyle(s,n);c.isEmptyStep=a,r=c}return n.currentAnimateTimings=null,{type:Ge.Animate,timings:i,style:r,options:null}}visitStyle(t,n){const i=this._makeStyleAst(t,n);return this._validateStyleAst(i,n),i}_makeStyleAst(t,n){const i=[],r=Array.isArray(t.styles)?t.styles:[t.styles];for(let a of r)"string"==typeof a?a===sc?i.push(a):n.errors.push(new W(3002,!1)):i.push(new Map(Object.entries(a)));let o=!1,s=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let c of a.values())if(c.toString().indexOf("{{")>=0){o=!0;break}}),{type:Ge.Style,styles:i,easing:s,offset:t.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(t,n){const i=n.currentAnimateTimings;let r=n.currentTime,o=n.currentTime;i&&o>0&&(o-=i.duration+i.delay),t.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,c)=>{const l=n.collectedStyles.get(n.currentQuerySelector),d=l.get(c);let u=!0;d&&(o!=r&&o>=d.startTime&&r<=d.endTime&&(n.errors.push(function DEe(e,t,n,i,r){return new W(3010,!1)}()),u=!1),o=d.startTime),u&&l.set(c,{startTime:o,endTime:r}),n.options&&function cbe(e,t,n){const i=t.params||{},r=C5(e);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||n.push(function yEe(e){return new W(3001,!1)}())})}(a,n.options,n.errors)})})}visitKeyframes(t,n){const i={type:Ge.Keyframes,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(function OEe(){return new W(3011,!1)}()),i;let o=0;const s=[];let a=!1,c=!1,l=0;const d=t.steps.map(E=>{const b=this._makeStyleAst(E,n);let T=null!=b.offset?b.offset:function ybe(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(n=>{if(n instanceof Map&&n.has("offset")){const i=n;t=parseFloat(i.get("offset")),i.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const n=e;t=parseFloat(n.get("offset")),n.delete("offset")}return t}(b.styles),I=0;return null!=T&&(o++,I=b.offset=T),c=c||I<0||I>1,a=a||I<l,l=I,s.push(I),b});c&&n.errors.push(function NEe(){return new W(3012,!1)}()),a&&n.errors.push(function PEe(){return new W(3200,!1)}());const u=t.steps.length;let h=0;o>0&&o<u?n.errors.push(function MEe(){return new W(3202,!1)}()):0==o&&(h=1/(u-1));const p=u-1,m=n.currentTime,f=n.currentAnimateTimings,g=f.duration;return d.forEach((E,b)=>{const T=h>0?b==p?1:h*b:s[b],I=T*g;n.currentTime=m+f.delay+I,f.duration=I,this._validateStyleAst(E,n),E.offset=T,i.styles.push(E)}),i}visitReference(t,n){return{type:Ge.Reference,animation:Eo(this,zm(t.animation),n),options:fd(t.options)}}visitAnimateChild(t,n){return n.depCount++,{type:Ge.AnimateChild,options:fd(t.options)}}visitAnimateRef(t,n){return{type:Ge.AnimateRef,animation:this.visitReference(t.animation,n),options:fd(t.options)}}visitQuery(t,n){const i=n.currentQuerySelector,r=t.options||{};n.queryCount++,n.currentQuery=t;const[o,s]=function vbe(e){const t=!!e.split(/\s*,\s*/).find(n=>":self"==n);return t&&(e=e.replace(gbe,"")),e=e.replace(/@\*/g,Ib).replace(/@\w+/g,n=>Ib+"-"+n.slice(1)).replace(/:animating/g,JR),[e,t]}(t.selector);n.currentQuerySelector=i.length?i+" "+o:o,vo(n.collectedStyles,n.currentQuerySelector,new Map);const a=Eo(this,zm(t.animation),n);return n.currentQuery=null,n.currentQuerySelector=i,{type:Ge.Query,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:t.selector,options:fd(t.options)}}visitStagger(t,n){n.currentQuery||n.errors.push(function xEe(){return new W(3013,!1)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:Rb(t.timings,n.errors,!0);return{type:Ge.Stagger,animation:Eo(this,zm(t.animation),n),timings:i,options:null}}}class bbe{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function fd(e){return e?(e={...e}).params&&(e.params=function Ebe(e){return e?{...e}:null}(e.params)):e={},e}function rA(e,t,n){return{duration:e,delay:t,easing:n}}function oA(e,t,n,i,r,o,s=null,a=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class Nb{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,n){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...n)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const wbe=new RegExp(":enter","g"),Rbe=new RegExp(":leave","g");function sA(e,t,n,i,r,o=new Map,s=new Map,a,c,l=[]){return(new Abe).buildKeyframes(e,t,n,i,r,o,s,a,c,l)}class Abe{buildKeyframes(t,n,i,r,o,s,a,c,l,d=[]){l=l||new Nb;const u=new aA(t,n,l,r,o,d,[]);u.options=c;const h=c.delay?ac(c.delay):0;u.currentTimeline.delayNextStep(h),u.currentTimeline.setStyles([s],null,u.errors,c),Eo(this,i,u);const p=u.timelines.filter(m=>m.containsAnimation());if(p.length&&a.size){let m;for(let f=p.length-1;f>=0;f--){const g=p[f];if(g.element===n){m=g;break}}m&&!m.allowOnlyTimelineStyles()&&m.setStyles([a],null,u.errors,c)}return p.length?p.map(m=>m.buildKeyframes()):[oA(n,[],[],[],0,h,"",!1)]}visitTrigger(t,n){}visitState(t,n){}visitTransition(t,n){}visitAnimateChild(t,n){const i=n.subInstructions.get(n.element);if(i){const r=n.createSubContext(t.options),o=n.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&n.transformIntoNewTimeline(s)}n.previousNode=t}visitAnimateRef(t,n){const i=n.createSubContext(t.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],n,i),this.visitReference(t.animation,i),n.transformIntoNewTimeline(i.currentTimeline.currentTime),n.previousNode=t}_applyAnimationRefDelays(t,n,i){for(const r of t){const o=r?.delay;if(o){const s="number"==typeof o?o:ac(Km(o,r?.params??{},n.errors));i.delayNextStep(s)}}}_visitSubInstructions(t,n,i){let o=n.currentTimeline.currentTime;const s=null!=i.duration?ac(i.duration):null,a=null!=i.delay?ac(i.delay):null;return 0!==s&&t.forEach(c=>{const l=n.appendInstructionToTimeline(c,s,a);o=Math.max(o,l.duration+l.delay)}),o}visitReference(t,n){n.updateOptions(t.options,!0),Eo(this,t.animation,n),n.previousNode=t}visitSequence(t,n){const i=n.subContextCount;let r=n;const o=t.options;if(o&&(o.params||o.delay)&&(r=n.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){r.previousNode.type==Ge.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Pb);const s=ac(o.delay);r.delayNextStep(s)}t.steps.length&&(t.steps.forEach(s=>Eo(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),n.previousNode=t}visitGroup(t,n){const i=[];let r=n.currentTimeline.currentTime;const o=t.options&&t.options.delay?ac(t.options.delay):0;t.steps.forEach(s=>{const a=n.createSubContext(t.options);o&&a.delayNextStep(o),Eo(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>n.currentTimeline.mergeTimelineCollectedStyles(s)),n.transformIntoNewTimeline(r),n.previousNode=t}_visitTiming(t,n){if(t.dynamic){const i=t.strValue;return Rb(n.params?Km(i,n.params,n.errors):i,n.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,n){const i=n.currentAnimateTimings=this._visitTiming(t.timings,n),r=n.currentTimeline;i.delay&&(n.incrementTime(i.delay),r.snapshotCurrentStyles());const o=t.style;o.type==Ge.Keyframes?this.visitKeyframes(o,n):(n.incrementTime(i.duration),this.visitStyle(o,n),r.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=t}visitStyle(t,n){const i=n.currentTimeline,r=n.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(o):i.setStyles(t.styles,o,n.errors,n.options),n.previousNode=t}visitKeyframes(t,n){const i=n.currentAnimateTimings,r=n.currentTimeline.duration,o=i.duration,a=n.createSubContext().currentTimeline;a.easing=i.easing,t.styles.forEach(c=>{a.forwardTime((c.offset||0)*o),a.setStyles(c.styles,c.easing,n.errors,n.options),a.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(a),n.transformIntoNewTimeline(r+o),n.previousNode=t}visitQuery(t,n){const i=n.currentTimeline.currentTime,r=t.options||{},o=r.delay?ac(r.delay):0;o&&(n.previousNode.type===Ge.Style||0==i&&n.currentTimeline.hasCurrentStyleProperties())&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=Pb);let s=i;const a=n.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,n.errors);n.currentQueryTotal=a.length;let c=null;a.forEach((l,d)=>{n.currentQueryIndex=d;const u=n.createSubContext(t.options,l);o&&u.delayNextStep(o),l===n.element&&(c=u.currentTimeline),Eo(this,t.animation,u),u.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,u.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(s),c&&(n.currentTimeline.mergeTimelineCollectedStyles(c),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=t}visitStagger(t,n){const i=n.parentContext,r=n.currentTimeline,o=t.timings,s=Math.abs(o.duration),a=s*(n.currentQueryTotal-1);let c=s*n.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":c=a-c;break;case"full":c=i.currentStaggerTime}const d=n.currentTimeline;c&&d.delayNextStep(c);const u=d.currentTime;Eo(this,t.animation,n),n.previousNode=t,i.currentStaggerTime=r.currentTime-u+(r.startTime-i.currentTimeline.startTime)}}const Pb={};class aA{constructor(t,n,i,r,o,s,a,c){this._driver=t,this.element=n,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Pb,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new Mb(this._driver,n,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,n){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=ac(i.duration)),null!=i.delay&&(r.delay=ac(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!n||!s.hasOwnProperty(a))&&(s[a]=Km(o[a],s,this.errors))})}}_copyOptions(){const t={};if(this.options){const n=this.options.params;if(n){const i=t.params={};Object.keys(n).forEach(r=>{i[r]=n[r]})}}return t}createSubContext(t=null,n,i){const r=n||this.element,o=new aA(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(t){return this.previousNode=Pb,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,n,i){const r={duration:n??t.duration,delay:this.currentTimeline.currentTime+(i??0)+t.delay,easing:""},o=new Dbe(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,n,i,r,o,s){let a=[];if(r&&a.push(this.element),t.length>0){t=(t=t.replace(wbe,"."+this._enterClassName)).replace(Rbe,"."+this._leaveClassName);let l=this._driver.query(this.element,t,1!=i);0!==i&&(l=i<0?l.slice(l.length+i,l.length):l.slice(0,i)),a.push(...l)}return!o&&0==a.length&&s.push(function kEe(e){return new W(3014,!1)}()),a}}class Mb{constructor(t,n,i,r){this._driver=t,this.element=n,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const n=1===this._keyframes.size&&this._pendingStyles.size;this.duration||n?(this.forwardTime(this.currentTime+t),n&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,n){return this.applyStylesToKeyframe(),new Mb(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,n){this._localTimelineStyles.set(t,n),this._globalTimelineStyles.set(t,n),this._styleSummary.set(t,{time:this.currentTime,value:n})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[n,i]of this._globalTimelineStyles)this._backFill.set(n,i||sc),this._currentKeyframe.set(n,sc);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,n,i,r){n&&this._previousKeyframe.set("easing",n);const o=r&&r.params||{},s=function Obe(e,t){const n=new Map;let i;return e.forEach(r=>{if("*"===r){i??=t.keys();for(let o of i)n.set(o,sc)}else for(let[o,s]of r)n.set(o,s)}),n}(t,this._globalTimelineStyles);for(let[a,c]of s){const l=Km(c,o,i);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??sc),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,n)=>{this._currentKeyframe.set(n,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,n)=>{this._currentKeyframe.has(n)||this._currentKeyframe.set(n,t)}))}snapshotCurrentStyles(){for(let[t,n]of this._localTimelineStyles)this._pendingStyles.set(t,n),this._updateStyle(t,n)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let n in this._currentKeyframe)t.push(n);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((n,i)=>{const r=this._styleSummary.get(i);(!r||n.time>r.time)&&this._updateStyle(i,n.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,n=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,c)=>{const l=new Map([...this._backFill,...a]);l.forEach((d,u)=>{"!"===d?t.add(u):d===sc&&n.add(u)}),i||l.set("offset",c/this.duration),r.push(l)});const o=[...t.values()],s=[...n.values()];if(i){const a=r[0],c=new Map(a);a.set("offset",0),c.set("offset",1),r=[a,c]}return oA(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class Dbe extends Mb{constructor(t,n,i,r,o,s,a=!1){super(t,n,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:n,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&n){const o=[],s=i+n,a=n/s,c=new Map(t[0]);c.set("offset",0),o.push(c);const l=new Map(t[0]);l.set("offset",A5(a)),o.push(l);const d=t.length-1;for(let u=1;u<=d;u++){let h=new Map(t[u]);const p=h.get("offset");h.set("offset",A5((n+p*i)/s)),o.push(h)}i=s,n=0,r="",t=o}return oA(this.element,t,this.preStyleProps,this.postStyleProps,i,n,r,!0)}}function A5(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}function D5(e,t,n,i,r,o,s,a,c,l,d,u,h){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:n,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:d,totalTime:u,errors:h}}const cA={};class O5{constructor(t,n,i){this._triggerName=t,this.ast=n,this._stateStyles=i}match(t,n,i,r){return function Nbe(e,t,n,i,r){return e.some(o=>o(t,n,i,r))}(this.ast.matchers,t,n,i,r)}buildStyles(t,n,i){let r=this._stateStyles.get("*");return void 0!==t&&(r=this._stateStyles.get(t?.toString())||r),r?r.buildStyles(n,i):new Map}build(t,n,i,r,o,s,a,c,l,d){const u=[],h=this.ast.options&&this.ast.options.params||cA,m=this.buildStyles(i,a&&a.params||cA,u),f=c&&c.params||cA,g=this.buildStyles(r,f,u),E=new Set,b=new Map,T=new Map,I="void"===r,D={params:N5(f,h),delay:this.ast.options?.delay},O=d?[]:sA(t,n,this.ast.animation,o,s,m,g,D,l,u);let k=0;return O.forEach(L=>{k=Math.max(L.duration+L.delay,k)}),u.length?D5(n,this._triggerName,i,r,I,m,g,[],[],b,T,k,u):(O.forEach(L=>{const V=L.element,ee=vo(b,V,new Set);L.preStyleProps.forEach(Ie=>ee.add(Ie));const oe=vo(T,V,new Set);L.postStyleProps.forEach(Ie=>oe.add(Ie)),V!==n&&E.add(V)}),D5(n,this._triggerName,i,r,I,m,g,O,[...E.values()],b,T,k))}}function N5(e,t){const n={...t};return Object.entries(e).forEach(([i,r])=>{null!=r&&(n[i]=r)}),n}class Pbe{constructor(t,n,i){this.styles=t,this.defaultParams=n,this.normalizer=i}buildStyles(t,n){const i=new Map,r=N5(t,this.defaultParams);return this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=Km(s,r,n));const c=this.normalizer.normalizePropertyName(a,n);s=this.normalizer.normalizeStyleValue(a,c,s,n),i.set(a,s)})}),i}}class xbe{constructor(t,n,i){this.name=t,this.ast=n,this._normalizer=i,this.transitionFactories=[],this.states=new Map,n.states.forEach(r=>{this.states.set(r.name,new Pbe(r.style,r.options&&r.options.params||{},i))}),P5(this.states,"true","1"),P5(this.states,"false","0"),n.transitions.forEach(r=>{this.transitionFactories.push(new O5(t,r,this.states))}),this.fallbackTransition=function kbe(e,t,n){return new O5(e,{type:Ge.Transition,animation:{type:Ge.Sequence,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,n,i,r){return this.transitionFactories.find(s=>s.match(t,n,i,r))||null}matchStyles(t,n,i){return this.fallbackTransition.buildStyles(t,n,i)}}function P5(e,t,n){e.has(t)?e.has(n)||e.set(n,e.get(t)):e.has(n)&&e.set(t,e.get(n))}const Lbe=new Nb;class Fbe{constructor(t,n,i){this.bodyNode=t,this._driver=n,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,n){const i=[],o=iA(this._driver,n,i,[]);if(i.length)throw function HEe(e){return new W(3503,!1)}();this._animations.set(t,o)}_buildPlayer(t,n,i){const r=t.element,o=m5(this._normalizer,t.keyframes,n,i);return this._driver.animate(r,o,t.duration,t.delay,t.easing,[],!0)}create(t,n,i={}){const r=[],o=this._animations.get(t);let s;const a=new Map;if(o?(s=sA(this._driver,n,o,ZR,Tb,new Map,new Map,i,Lbe,r),s.forEach(d=>{const u=vo(a,d.element,new Map);d.postStyleProps.forEach(h=>u.set(h,null))})):(r.push(function GEe(){return new W(3300,!1)}()),s=[]),r.length)throw function WEe(e){return new W(3504,!1)}();a.forEach((d,u)=>{d.forEach((h,p)=>{d.set(p,this._driver.computeStyle(u,p,sc))})});const l=$c(s.map(d=>{const u=a.get(d.element);return this._buildPlayer(d,new Map,u)}));return this._playersById.set(t,l),l.onDestroy(()=>this.destroy(t)),this.players.push(l),l}destroy(t){const n=this._getPlayer(t);n.destroy(),this._playersById.delete(t);const i=this.players.indexOf(n);i>=0&&this.players.splice(i,1)}_getPlayer(t){const n=this._playersById.get(t);if(!n)throw function zEe(e){return new W(3301,!1)}();return n}listen(t,n,i,r){const o=KR(n,"","","");return WR(this._getPlayer(t),i,o,r),()=>{}}command(t,n,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,n,r[0]||{});const o=this._getPlayer(t);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const M5="ng-animate-queued",lA="ng-animate-disabled",Hbe=[],x5={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Gbe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ds="__ng_removed";class dA{get params(){return this.options.params}constructor(t,n=""){this.namespaceId=n;const i=t&&t.hasOwnProperty("value");if(this.value=function qbe(e){return e??null}(i?t.value:t),i){const{value:o,...s}=t;this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const n=t.params;if(n){const i=this.options.params;Object.keys(n).forEach(r=>{null==i[r]&&(i[r]=n[r])})}}}const qm="void",uA=new dA(qm);class Wbe{constructor(t,n,i){this.id=t,this.hostElement=n,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,qo(n,this._hostClassName)}listen(t,n,i,r){if(!this._triggers.has(n))throw function KEe(e,t){return new W(3302,!1)}();if(null==i||0==i.length)throw function qEe(e){return new W(3303,!1)}();if(!function Ybe(e){return"start"==e||"done"==e}(i))throw function YEe(e,t){return new W(3400,!1)}();const o=vo(this._elementListeners,t,[]),s={name:n,phase:i,callback:r};o.push(s);const a=vo(this._engine.statesByElement,t,new Map);return a.has(n)||(qo(t,wb),qo(t,wb+"-"+n),a.set(n,uA)),()=>{this._engine.afterFlush(()=>{const c=o.indexOf(s);c>=0&&o.splice(c,1),this._triggers.has(n)||a.delete(n)})}}register(t,n){return!this._triggers.has(t)&&(this._triggers.set(t,n),!0)}_getTrigger(t){const n=this._triggers.get(t);if(!n)throw function $Ee(e){return new W(3401,!1)}();return n}trigger(t,n,i,r=!0){const o=this._getTrigger(n),s=new hA(this.id,n,t);let a=this._engine.statesByElement.get(t);a||(qo(t,wb),qo(t,wb+"-"+n),this._engine.statesByElement.set(t,a=new Map));let c=a.get(n);const l=new dA(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(n,l),c||(c=uA),l.value!==qm&&c.value===l.value){if(!function Zbe(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(let r=0;r<n.length;r++){const o=n[r];if(!t.hasOwnProperty(o)||e[o]!==t[o])return!1}return!0}(c.params,l.params)){const f=[],g=o.matchStyles(c.value,c.params,f),E=o.matchStyles(l.value,l.params,f);f.length?this._engine.reportError(f):this._engine.afterFlush(()=>{pd(t,g),ua(t,E)})}return}const h=vo(this._engine.playersByElement,t,[]);h.forEach(f=>{f.namespaceId==this.id&&f.triggerName==n&&f.queued&&f.destroy()});let p=o.matchTransition(c.value,l.value,t,l.params),m=!1;if(!p){if(!r)return;p=o.fallbackTransition,m=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:n,transition:p,fromState:c,toState:l,player:s,isFallbackTransition:m}),m||(qo(t,M5),s.onStart(()=>{vh(t,M5)})),s.onDone(()=>{let f=this.players.indexOf(s);f>=0&&this.players.splice(f,1);const g=this._engine.playersByElement.get(t);if(g){let E=g.indexOf(s);E>=0&&g.splice(E,1)}}),this.players.push(s),h.push(s),s}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(n=>n.delete(t)),this._elementListeners.forEach((n,i)=>{this._elementListeners.set(i,n.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const n=this._engine.playersByElement.get(t);n&&(n.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,n){const i=this._engine.driver.query(t,Ib,!0);i.forEach(r=>{if(r[Ds])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,n,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,n,i,r){const o=this._engine.statesByElement.get(t),s=new Map;if(o){const a=[];if(o.forEach((c,l)=>{if(s.set(l,c.value),this._triggers.has(l)){const d=this.trigger(t,l,qm,r);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,n,s),i&&$c(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const n=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(n&&i){const r=new Set;n.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const c=this._triggers.get(s).fallbackTransition,l=i.get(s)||uA,d=new dA(qm),u=new hA(this.id,s,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:s,transition:c,fromState:l,toState:d,player:u,isFallbackTransition:!0})})}}removeNode(t,n){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,n),this.triggerLeaveAnimation(t,n,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(t):[];if(o&&o.length)r=!0;else{let s=t;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,n);else{const o=t[Ds];(!o||o===x5)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,n))}}insertNode(t,n){qo(t,this._hostClassName)}drainQueuedTransitions(t){const n=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const c=KR(o,i.triggerName,i.fromState.value,i.toState.value);c._data=t,WR(i.player,a.phase,c,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):n.push(i)}),this._queue=[],n.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}}class zbe{_onRemovalComplete(t,n){this.onRemovalComplete(t,n)}constructor(t,n,i,r){this.bodyNode=t,this.driver=n,this._normalizer=i,this.scheduler=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,s)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(n=>{n.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,n){const i=new Wbe(t,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(i,n):(this.newHostElements.set(n,i),this.collectEnterElement(n)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,n){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let s=!1,a=this.driver.getParentElement(n);for(;a;){const c=r.get(a);if(c){const l=i.indexOf(c);i.splice(l+1,0,t),s=!0;break}a=this.driver.getParentElement(a)}s||i.unshift(t)}else i.push(t);return r.set(n,t),t}register(t,n){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,n)),i}registerTrigger(t,n,i){let r=this._namespaceLookup[t];r&&r.register(n,i)&&this.totalAnimations++}destroy(t,n){t&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(t);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(n),delete this._namespaceLookup[t]}))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const n=new Set,i=this.statesByElement.get(t);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&n.add(o)}return n}trigger(t,n,i,r){if(xb(n)){const o=this._fetchNamespace(t);if(o)return o.trigger(n,i,r),!0}return!1}insertNode(t,n,i,r){if(!xb(n))return;const o=n[Ds];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(n);s>=0&&this.collectedLeaveElements.splice(s,1)}if(t){const s=this._fetchNamespace(t);s&&s.insertNode(n,i)}r&&this.collectEnterElement(n)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,n){n?this.disabledNodes.has(t)||(this.disabledNodes.add(t),qo(t,lA)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),vh(t,lA))}removeNode(t,n,i){if(xb(n)){this.scheduler?.notify();const r=t?this._fetchNamespace(t):null;r?r.removeNode(n,i):this.markElementAsRemoved(t,n,!1,i);const o=this.namespacesByHostElement.get(n);o&&o.id!==t&&o.removeNode(n,i)}else this._onRemovalComplete(n,i)}markElementAsRemoved(t,n,i,r,o){this.collectedLeaveElements.push(n),n[Ds]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(t,n,i,r,o){return xb(n)?this._fetchNamespace(t).listen(n,i,r,o):()=>{}}_buildInstruction(t,n,i,r,o){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,n,o)}destroyInnerAnimations(t){let n=this.driver.query(t,Ib,!0);n.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(t,JR,!0),n.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const n=this.playersByElement.get(t);n&&n.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const n=this.playersByQueriedElement.get(t);n&&n.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return $c(this.players).onDone(()=>t());t()})}processLeaveNode(t){const n=t[Ds];if(n&&n.setForRemoval){if(t[Ds]=x5,n.namespaceId){this.destroyInnerAnimations(t);const i=this._fetchNamespace(n.namespaceId);i&&i.clearElementCache(t)}this._onRemovalComplete(t,n.setForRemoval)}t.classList?.contains(lA)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(t=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)qo(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{n=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],n.length?$c(n).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function XEe(e){return new W(3402,!1)}()}_flushAnimations(t,n){const i=new Nb,r=[],o=new Map,s=[],a=new Map,c=new Map,l=new Map,d=new Set;this.disabledNodes.forEach(me=>{d.add(me);const P=this.driver.query(me,".ng-animate-queued",!0);for(let F=0;F<P.length;F++)d.add(P[F])});const u=this.bodyNode,h=Array.from(this.statesByElement.keys()),p=F5(h,this.collectedEnterElements),m=new Map;let f=0;p.forEach((me,P)=>{const F=ZR+f++;m.set(P,F),me.forEach(G=>qo(G,F))});const g=[],E=new Set,b=new Set;for(let me=0;me<this.collectedLeaveElements.length;me++){const P=this.collectedLeaveElements[me],F=P[Ds];F&&F.setForRemoval&&(g.push(P),E.add(P),F.hasAnimation?this.driver.query(P,".ng-star-inserted",!0).forEach(G=>E.add(G)):b.add(P))}const T=new Map,I=F5(h,Array.from(E));I.forEach((me,P)=>{const F=Tb+f++;T.set(P,F),me.forEach(G=>qo(G,F))}),t.push(()=>{p.forEach((me,P)=>{const F=m.get(P);me.forEach(G=>vh(G,F))}),I.forEach((me,P)=>{const F=T.get(P);me.forEach(G=>vh(G,F))}),g.forEach(me=>{this.processLeaveNode(me)})});const D=[],O=[];for(let me=this._namespaceList.length-1;me>=0;me--)this._namespaceList[me].drainQueuedTransitions(n).forEach(F=>{const G=F.player,U=F.element;if(D.push(G),this.collectedEnterElements.length){const nt=U[Ds];if(nt&&nt.setForMove){if(nt.previousTriggersValues&&nt.previousTriggersValues.has(F.triggerName)){const jn=nt.previousTriggersValues.get(F.triggerName),si=this.statesByElement.get(F.element);if(si&&si.has(F.triggerName)){const Ic=si.get(F.triggerName);Ic.value=jn,si.set(F.triggerName,Ic)}}return void G.destroy()}}const v=!u||!this.driver.containsElement(u,U),w=T.get(U),A=m.get(U),B=this._buildInstruction(F,i,A,w,v);if(B.errors&&B.errors.length)return void O.push(B);if(v)return G.onStart(()=>pd(U,B.fromStyles)),G.onDestroy(()=>ua(U,B.toStyles)),void r.push(G);if(F.isFallbackTransition)return G.onStart(()=>pd(U,B.fromStyles)),G.onDestroy(()=>ua(U,B.toStyles)),void r.push(G);const ge=[];B.timelines.forEach(nt=>{nt.stretchStartingKeyframe=!0,this.disabledNodes.has(nt.element)||ge.push(nt)}),B.timelines=ge,i.append(U,B.timelines),s.push({instruction:B,player:G,element:U}),B.queriedElements.forEach(nt=>vo(a,nt,[]).push(G)),B.preStyleProps.forEach((nt,jn)=>{if(nt.size){let si=c.get(jn);si||c.set(jn,si=new Set),nt.forEach((Ic,kl)=>si.add(kl))}}),B.postStyleProps.forEach((nt,jn)=>{let si=l.get(jn);si||l.set(jn,si=new Set),nt.forEach((Ic,kl)=>si.add(kl))})});if(O.length){const me=[];O.forEach(P=>{me.push(function ZEe(e,t){return new W(3505,!1)}())}),D.forEach(P=>P.destroy()),this.reportError(me)}const k=new Map,L=new Map;s.forEach(me=>{const P=me.element;i.has(P)&&(L.set(P,P),this._beforeAnimationBuild(me.player.namespaceId,me.instruction,k))}),r.forEach(me=>{const P=me.element;this._getPreviousPlayers(P,!1,me.namespaceId,me.triggerName,null).forEach(G=>{vo(k,P,[]).push(G),G.destroy()})});const V=g.filter(me=>V5(me,c,l)),ee=new Map;L5(ee,this.driver,b,l,sc).forEach(me=>{V5(me,c,l)&&V.push(me)});const Ie=new Map;p.forEach((me,P)=>{L5(Ie,this.driver,new Set(me),c,"!")}),V.forEach(me=>{const P=ee.get(me),F=Ie.get(me);ee.set(me,new Map([...P?.entries()??[],...F?.entries()??[]]))});const Ue=[],Dt=[],dt={};s.forEach(me=>{const{element:P,player:F,instruction:G}=me;if(i.has(P)){if(d.has(P))return F.onDestroy(()=>ua(P,G.toStyles)),F.disabled=!0,F.overrideTotalTime(G.totalTime),void r.push(F);let U=dt;if(L.size>1){let w=P;const A=[];for(;w=w.parentNode;){const B=L.get(w);if(B){U=B;break}A.push(w)}A.forEach(B=>L.set(B,U))}const v=this._buildAnimation(F.namespaceId,G,k,o,Ie,ee);if(F.setRealPlayer(v),U===dt)Ue.push(F);else{const w=this.playersByElement.get(U);w&&w.length&&(F.parentPlayer=$c(w)),r.push(F)}}else pd(P,G.fromStyles),F.onDestroy(()=>ua(P,G.toStyles)),Dt.push(F),d.has(P)&&r.push(F)}),Dt.forEach(me=>{const P=o.get(me.element);if(P&&P.length){const F=$c(P);me.setRealPlayer(F)}}),r.forEach(me=>{me.parentPlayer?me.syncPlayerEvents(me.parentPlayer):me.destroy()});for(let me=0;me<g.length;me++){const P=g[me],F=P[Ds];if(vh(P,Tb),F&&F.hasAnimation)continue;let G=[];if(a.size){let v=a.get(P);v&&v.length&&G.push(...v);let w=this.driver.query(P,JR,!0);for(let A=0;A<w.length;A++){let B=a.get(w[A]);B&&B.length&&G.push(...B)}}const U=G.filter(v=>!v.destroyed);U.length?$be(this,P,U):this.processLeaveNode(P)}return g.length=0,Ue.forEach(me=>{this.players.push(me),me.onDone(()=>{me.destroy();const P=this.players.indexOf(me);this.players.splice(P,1)}),me.play()}),Ue}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,n,i,r,o){let s=[];if(n){const a=this.playersByQueriedElement.get(t);a&&(s=a)}else{const a=this.playersByElement.get(t);if(a){const c=!o||o==qm;a.forEach(l=>{l.queued||!c&&l.triggerName!=r||s.push(l)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(t,n,i){const o=n.element,s=n.isRemovalTransition?void 0:t,a=n.isRemovalTransition?void 0:n.triggerName;for(const c of n.timelines){const l=c.element,d=l!==o,u=vo(i,l,[]);this._getPreviousPlayers(l,d,s,a,n.toState).forEach(p=>{const m=p.getRealPlayer();m.beforeDestroy&&m.beforeDestroy(),p.destroy(),u.push(p)})}pd(o,n.fromStyles)}_buildAnimation(t,n,i,r,o,s){const a=n.triggerName,c=n.element,l=[],d=new Set,u=new Set,h=n.timelines.map(m=>{const f=m.element;d.add(f);const g=f[Ds];if(g&&g.removedBeforeQueried)return new Gm(m.duration,m.delay);const E=f!==c,b=function Xbe(e){const t=[];return U5(e,t),t}((i.get(f)||Hbe).map(k=>k.getRealPlayer())).filter(k=>!!k.element&&k.element===f),T=o.get(f),I=s.get(f),D=m5(this._normalizer,m.keyframes,T,I),O=this._buildPlayer(m,D,b);if(m.subTimeline&&r&&u.add(f),E){const k=new hA(t,a,f);k.setRealPlayer(O),l.push(k)}return O});l.forEach(m=>{vo(this.playersByQueriedElement,m.element,[]).push(m),m.onDone(()=>function Kbe(e,t,n){let i=e.get(t);if(i){if(i.length){const r=i.indexOf(n);i.splice(r,1)}0==i.length&&e.delete(t)}return i}(this.playersByQueriedElement,m.element,m))}),d.forEach(m=>qo(m,y5));const p=$c(h);return p.onDestroy(()=>{d.forEach(m=>vh(m,y5)),ua(c,n.toStyles)}),u.forEach(m=>{vo(r,m,[]).push(p)}),p}_buildPlayer(t,n,i){return n.length>0?this.driver.animate(t.element,n,t.duration,t.delay,t.easing,i):new Gm(t.duration,t.delay)}}class hA{constructor(t,n,i){this.namespaceId=t,this.triggerName=n,this.element=i,this._player=new Gm,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((n,i)=>{n.forEach(r=>WR(t,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const n=this._player;n.triggerCallback&&t.onStart(()=>n.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,n){vo(this._queuedCallbacks,t,[]).push(n)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const n=this._player;n.triggerCallback&&n.triggerCallback(t)}}function xb(e){return e&&1===e.nodeType}function k5(e,t){const n=e.style.display;return e.style.display=t??"none",n}function L5(e,t,n,i,r){const o=[];n.forEach(c=>o.push(k5(c)));const s=[];i.forEach((c,l)=>{const d=new Map;c.forEach(u=>{const h=t.computeStyle(l,u,r);d.set(u,h),(!h||0==h.length)&&(l[Ds]=Gbe,s.push(l))}),e.set(l,d)});let a=0;return n.forEach(c=>k5(c,o[a++])),s}function F5(e,t){const n=new Map;if(e.forEach(a=>n.set(a,[])),0==t.length)return n;const r=new Set(t),o=new Map;function s(a){if(!a)return 1;let c=o.get(a);if(c)return c;const l=a.parentNode;return c=n.has(l)?l:r.has(l)?1:s(l),o.set(a,c),c}return t.forEach(a=>{const c=s(a);1!==c&&n.get(c).push(a)}),n}function qo(e,t){e.classList?.add(t)}function vh(e,t){e.classList?.remove(t)}function $be(e,t,n){$c(n).onDone(()=>e.processLeaveNode(t))}function U5(e,t){for(let n=0;n<e.length;n++){const i=e[n];i instanceof M4?U5(i.players,t):t.push(i)}}function V5(e,t,n){const i=n.get(e);if(!i)return!1;let r=t.get(e);return r?i.forEach(o=>r.add(o)):t.set(e,i),n.delete(e),!0}class Ym{constructor(t,n,i,r){this._driver=n,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(o,s)=>{},this._transitionEngine=new zbe(t.body,n,i,r),this._timelineEngine=new Fbe(t.body,n,i),this._transitionEngine.onRemovalComplete=(o,s)=>this.onRemovalComplete(o,s)}registerTrigger(t,n,i,r,o){const s=t+"-"+r;let a=this._triggerCache[s];if(!a){const c=[],d=iA(this._driver,o,c,[]);if(c.length)throw function BEe(e,t){return new W(3404,!1)}();a=function Mbe(e,t,n){return new xbe(e,t,n)}(r,d,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(n,r,a)}register(t,n){this._transitionEngine.register(t,n)}destroy(t,n){this._transitionEngine.destroy(t,n)}onInsert(t,n,i,r){this._transitionEngine.insertNode(t,n,i,r)}onRemove(t,n,i){this._transitionEngine.removeNode(t,n,i)}disableAnimations(t,n){this._transitionEngine.markElementAsDisabled(t,n)}process(t,n,i,r){if("@"==i.charAt(0)){const[o,s]=g5(i);this._timelineEngine.command(o,n,s,r)}else this._transitionEngine.trigger(t,n,i,r)}listen(t,n,i,r,o){if("@"==i.charAt(0)){const[s,a]=g5(i);return this._timelineEngine.listen(s,n,a,o)}return this._transitionEngine.listen(t,n,i,r,o)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}}class $m{static{this.initialStylesByElement=new WeakMap}constructor(t,n,i){this._element=t,this._startStyles=n,this._endStyles=i,this._state=0;let r=$m.initialStylesByElement.get(t);r||$m.initialStylesByElement.set(t,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&ua(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(ua(this._element,this._initialStyles),this._endStyles&&(ua(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&($m.initialStylesByElement.delete(this._element),this._startStyles&&(pd(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(pd(this._element,this._endStyles),this._endStyles=null),ua(this._element,this._initialStyles),this._state=3)}}function pA(e){let t=null;return e.forEach((n,i)=>{(function Qbe(e){return"display"===e||"position"===e})(i)&&(t=t||new Map,t.set(i,n))}),t}class B5{constructor(t,n,i,r){this.element=t,this.keyframes=n,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map;const n=()=>this._onFinish();this.domPlayer.addEventListener("finish",n),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",n)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const n=[];return t.forEach(i=>{n.push(Object.fromEntries(i))}),n}_triggerWebAnimation(t,n,i){return t.animate(this._convertKeyframesToObject(n),i)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&t.set(r,this._finished?i:nA(this.element,r))}),this.currentSnapshot=t}triggerCallback(t){const n="start"===t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class j5{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,n){return!1}containsElement(t,n){return v5(t,n)}getParentElement(t){return qR(t)}query(t,n,i){return E5(t,n,i)}computeStyle(t,n,i){return nA(t,n)}animate(t,n,i,r,o,s=[]){const c={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(c.easing=o);const l=new Map,d=s.filter(p=>p instanceof B5);(function dbe(e,t){return 0===e||0===t})(i,r)&&d.forEach(p=>{p.currentSnapshot.forEach((m,f)=>l.set(f,m))});let u=function abe(e){return e.length?e[0]instanceof Map?e:e.map(t=>new Map(Object.entries(t))):[]}(n).map(p=>new Map(p));u=function ube(e,t,n){if(n.size&&t.length){let i=t[0],r=[];if(n.forEach((o,s)=>{i.has(s)||r.push(s),i.set(s,o)}),r.length)for(let o=1;o<t.length;o++){let s=t[o];r.forEach(a=>s.set(a,nA(e,a)))}}return t}(t,u,l);const h=function Jbe(e,t){let n=null,i=null;return Array.isArray(t)&&t.length?(n=pA(t[0]),t.length>1&&(i=pA(t[t.length-1]))):t instanceof Map&&(n=pA(t)),n||i?new $m(e,n,i):null}(t,u);return new B5(t,u,c,h)}}const H5="@.disabled";class G5{constructor(t,n,i,r){this.namespaceId=t,this.delegate=n,this.engine=i,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,n){return this.delegate.createElement(t,n)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,n){this.delegate.appendChild(t,n),this.engine.onInsert(this.namespaceId,n,t,!1)}insertBefore(t,n,i,r=!0){this.delegate.insertBefore(t,n,i),this.engine.onInsert(this.namespaceId,n,t,r)}removeChild(t,n,i){this.engine.onRemove(this.namespaceId,n,this.delegate)}selectRootElement(t,n){return this.delegate.selectRootElement(t,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,n,i,r){this.delegate.setAttribute(t,n,i,r)}removeAttribute(t,n,i){this.delegate.removeAttribute(t,n,i)}addClass(t,n){this.delegate.addClass(t,n)}removeClass(t,n){this.delegate.removeClass(t,n)}setStyle(t,n,i,r){this.delegate.setStyle(t,n,i,r)}removeStyle(t,n,i){this.delegate.removeStyle(t,n,i)}setProperty(t,n,i){"@"==n.charAt(0)&&n==H5?this.disableAnimations(t,!!i):this.delegate.setProperty(t,n,i)}setValue(t,n){this.delegate.setValue(t,n)}listen(t,n,i){return this.delegate.listen(t,n,i)}disableAnimations(t,n){this.engine.disableAnimations(t,n)}}class eye extends G5{constructor(t,n,i,r,o){super(n,i,r,o),this.factory=t,this.namespaceId=n}setProperty(t,n,i){"@"==n.charAt(0)?"."==n.charAt(1)&&n==H5?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,n.slice(1),i):this.delegate.setProperty(t,n,i)}listen(t,n,i){if("@"==n.charAt(0)){const r=function tye(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(t);let o=n.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function nye(e){const t=e.indexOf(".");return[e.substring(0,t),e.slice(t+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(t,n,i)}}class iye{constructor(t,n,i){this.delegate=t,this.engine=n,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,n.onRemovalComplete=(r,o)=>{const s=o?.parentNode(r);s&&o.removeChild(s,r)}}createRenderer(t,n){const r=this.delegate.createRenderer(t,n);if(!t||!n?.data?.animation){const l=this._rendererCache;let d=l.get(r);return d||(d=new G5("",r,this.engine,()=>l.delete(r)),l.set(r,d)),d}const o=n.id,s=n.id+"-"+this._currentId;this._currentId++,this.engine.register(s,t);const a=l=>{Array.isArray(l)?l.forEach(a):this.engine.registerTrigger(o,s,t,l.name,l)};return n.data.animation.forEach(a),new eye(this,s,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,i){if(t>=0&&t<this._microtaskId)return void this._zone.run(()=>n(i));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),r.push([n,i])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}let rye=(()=>{class e extends Ym{constructor(n,i,r){super(n,i,r,J(Zv,{optional:!0}))}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut),Z($R),Z(XR))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})();const W5=[{provide:XR,useFactory:function oye(){return new T5}},{provide:Ym,useClass:rye},{provide:iw,useFactory:function sye(e,t,n){return new iye(e,t,n)},deps:[WI,Ym,Le]}],fA=[{provide:$R,useFactory:()=>new j5},{provide:$a,useValue:"BrowserAnimations"},...W5],z5=[{provide:$R,useClass:YR},{provide:$a,useValue:"NoopAnimations"},...W5];let aye=(()=>{class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?z5:fA}}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({providers:fA,imports:[S3]})}}return e})();const Lb=KC(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function K5(e){return new Hn(t=>{Ar(e()).subscribe(t)})}function Fb(e,t){const n=Lt(e)?e:()=>e,i=r=>r.error(n());return new Hn(t?r=>t.schedule(i,0,r):i)}function mA(){return ci((e,t)=>{let n=null;e._refCount++;const i=Gn(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const r=e._connection,o=n;n=null,r&&(!o||r===o)&&r.unsubscribe(),t.unsubscribe()});e.subscribe(i),i.closed||(n=e.connect())})}class q5 extends Hn{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,ox(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new vi;const n=this.getSubject();t.add(this.source.subscribe(Gn(n,void 0,()=>{this._teardown(),n.complete()},i=>{this._teardown(),n.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=vi.EMPTY)}return t}refCount(){return mA()(this)}}function ha(e,t){return ci((n,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();n.subscribe(Gn(i,c=>{r?.unsubscribe();let l=0;const d=o++;Ar(e(c,d)).subscribe(r=Gn(i,u=>i.next(t?t(c,u,d,l++):u),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Ub(e){return ci((t,n)=>{let i=!1;t.subscribe(Gn(n,r=>{i=!0,n.next(r)},()=>{i||n.next(e),n.complete()}))})}function Y5(e=lye){return ci((t,n)=>{let i=!1;t.subscribe(Gn(n,r=>{i=!0,n.next(r)},()=>i?n.complete():n.error(e())))})}function lye(){return new Lb}function md(e,t){const n=arguments.length>=2;return i=>i.pipe(e?Yr((r,o)=>e(r,o,i)):Rc,la(1),n?Ub(t):Y5(()=>new Lb))}function Xm(e,t){return Lt(t)?tr(e,t,1):tr(e,1)}function Eh(e){return ci((t,n)=>{let o,i=null,r=!1;i=t.subscribe(Gn(n,void 0,void 0,s=>{o=Ar(e(s,Eh(e)(t))),i?(i.unsubscribe(),i=null,o.subscribe(n)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(n))})}function gA(e){return e<=0?()=>Wo:ci((t,n)=>{let i=[];t.subscribe(Gn(n,r=>{i.push(r),e<i.length&&i.shift()},()=>{for(const r of i)n.next(r);n.complete()},void 0,()=>{i=null}))})}function _A(e){return ci((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}const at="primary",Zm=Symbol("RouteTitle");class fye{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function bh(e){return new fye(e)}function mye(e,t,n){const i=n.path.split("/");if(i.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||i.length<e.length))return null;const r={};for(let o=0;o<i.length;o++){const s=i[o],a=e[o];if(s.startsWith(":"))r[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}function pa(e,t){const n=e?vA(e):void 0,i=t?vA(t):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let o=0;o<n.length;o++)if(r=n[o],!$5(e[r],t[r]))return!1;return!0}function vA(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function $5(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),i=[...t].sort();return n.every((r,o)=>i[o]===r)}return e===t}function X5(e){return e.length>0?e[e.length-1]:null}function Xc(e){return function cye(e){return!!e&&(e instanceof Hn||Lt(e.lift)&&Lt(e.subscribe))}(e)?e:Em(e)?xi(Promise.resolve(e)):He(e)}const _ye={exact:function Q5(e,t,n){if(!gd(e.segments,t.segments)||!Vb(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!e.children[i]||!Q5(e.children[i],t.children[i],n))return!1;return!0},subset:eH},Z5={exact:function vye(e,t){return pa(e,t)},subset:function Eye(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>$5(e[n],t[n]))},ignored:()=>!0};function J5(e,t,n){return _ye[n.paths](e.root,t.root,n.matrixParams)&&Z5[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function eH(e,t,n){return tH(e,t,t.segments,n)}function tH(e,t,n,i){if(e.segments.length>n.length){const r=e.segments.slice(0,n.length);return!(!gd(r,n)||t.hasChildren()||!Vb(r,n,i))}if(e.segments.length===n.length){if(!gd(e.segments,n)||!Vb(e.segments,n,i))return!1;for(const r in t.children)if(!e.children[r]||!eH(e.children[r],t.children[r],i))return!1;return!0}{const r=n.slice(0,e.segments.length),o=n.slice(e.segments.length);return!!(gd(e.segments,r)&&Vb(e.segments,r,i)&&e.children[at])&&tH(e.children[at],t,o,i)}}function Vb(e,t,n){return t.every((i,r)=>Z5[n](e[r].parameters,i.parameters))}class yh{constructor(t=new gn([],{}),n={},i=null){this.root=t,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap??=bh(this.queryParams),this._queryParamMap}toString(){return Sye.serialize(this)}}class gn{constructor(t,n){this.segments=t,this.children=n,this.parent=null,Object.values(n).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Bb(this)}}class Jm{constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap??=bh(this.parameters),this._parameterMap}toString(){return rH(this)}}function gd(e,t){return e.length===t.length&&e.every((n,i)=>n.path===t[i].path)}let Sh=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:()=>new EA,providedIn:"root"})}}return e})();class EA{parse(t){const n=new Mye(t);return new yh(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${Qm(t.root,!0)}`,i=function wye(e){const t=Object.entries(e).map(([n,i])=>Array.isArray(i)?i.map(r=>`${jb(n)}=${jb(r)}`).join("&"):`${jb(n)}=${jb(i)}`).filter(n=>n);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${n}${i}${"string"==typeof t.fragment?`#${function Cye(e){return encodeURI(e)}(t.fragment)}`:""}`}}const Sye=new EA;function Bb(e){return e.segments.map(t=>rH(t)).join("/")}function Qm(e,t){if(!e.hasChildren())return Bb(e);if(t){const n=e.children[at]?Qm(e.children[at],!1):"",i=[];return Object.entries(e.children).forEach(([r,o])=>{r!==at&&i.push(`${r}:${Qm(o,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}{const n=function yye(e,t){let n=[];return Object.entries(e.children).forEach(([i,r])=>{i===at&&(n=n.concat(t(r,i)))}),Object.entries(e.children).forEach(([i,r])=>{i!==at&&(n=n.concat(t(r,i)))}),n}(e,(i,r)=>r===at?[Qm(e.children[at],!1)]:[`${r}:${Qm(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[at]?`${Bb(e)}/${n[0]}`:`${Bb(e)}/(${n.join("//")})`}}function nH(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function jb(e){return nH(e).replace(/%3B/gi,";")}function bA(e){return nH(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Hb(e){return decodeURIComponent(e)}function iH(e){return Hb(e.replace(/\+/g,"%20"))}function rH(e){return`${bA(e.path)}${function Tye(e){return Object.entries(e).map(([t,n])=>`;${bA(t)}=${bA(n)}`).join("")}(e.parameters)}`}const Iye=/^[^\/()?;#]+/;function yA(e){const t=e.match(Iye);return t?t[0]:""}const Rye=/^[^\/()?;=#]+/,Dye=/^[^=?&#]+/,Nye=/^[^&#]+/;class Mye{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new gn([],{}):new gn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(i[at]=new gn(t,n)),i}parseSegment(){const t=yA(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new W(4009,!1);return this.capture(t),new Jm(Hb(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=function Aye(e){const t=e.match(Rye);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const r=yA(this.remaining);r&&(i=r,this.capture(i))}t[Hb(n)]=Hb(i)}parseQueryParam(t){const n=function Oye(e){const t=e.match(Dye);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const s=function Pye(e){const t=e.match(Nye);return t?t[0]:""}(this.remaining);s&&(i=s,this.capture(i))}const r=iH(n),o=iH(i);if(t.hasOwnProperty(r)){let s=t[r];Array.isArray(s)||(s=[s],t[r]=s),s.push(o)}else t[r]=o}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=yA(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new W(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):t&&(o=at);const s=this.parseChildren();n[o]=1===Object.keys(s).length?s[at]:new gn([],s),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new W(4011,!1)}}function oH(e){return e.segments.length>0?new gn([],{[at]:e}):e}function sH(e){const t={};for(const[i,r]of Object.entries(e.children)){const o=sH(r);if(i===at&&0===o.segments.length&&o.hasChildren())for(const[s,a]of Object.entries(o.children))t[s]=a;else(o.segments.length>0||o.hasChildren())&&(t[i]=o)}return function xye(e){if(1===e.numberOfChildren&&e.children[at]){const t=e.children[at];return new gn(e.segments.concat(t.segments),t.children)}return e}(new gn(e.segments,t))}function Ch(e){return e instanceof yh}function aH(e){let t;const r=oH(function n(o){const s={};for(const c of o.children){const l=n(c);s[c.outlet]=l}const a=new gn(o.url,s);return o===e&&(t=a),a}(e.root));return t??r}function cH(e,t,n,i){let r=e;for(;r.parent;)r=r.parent;if(0===t.length)return SA(r,r,r,n,i);const o=function Lye(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new dH(!0,0,e);let t=0,n=!1;const i=e.reduce((r,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return"string"!=typeof o?[...r,o]:0===s?(o.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?n=!0:".."===a?t++:""!=a&&r.push(a))}),r):[...r,o]},[]);return new dH(n,t,i)}(t);if(o.toRoot())return SA(r,r,new gn([],{}),n,i);const s=function Fye(e,t,n){if(e.isAbsolute)return new Wb(t,!0,0);if(!n)return new Wb(t,!1,NaN);if(null===n.parent)return new Wb(n,!0,0);const i=Gb(e.commands[0])?0:1;return function Uye(e,t,n){let i=e,r=t,o=n;for(;o>r;){if(o-=r,i=i.parent,!i)throw new W(4005,!1);r=i.segments.length}return new Wb(i,!1,r-o)}(n,n.segments.length-1+i,e.numberOfDoubleDots)}(o,r,e),a=s.processChildren?tg(s.segmentGroup,s.index,o.commands):uH(s.segmentGroup,s.index,o.commands);return SA(r,s.segmentGroup,a,n,i)}function Gb(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function eg(e){return"object"==typeof e&&null!=e&&e.outlets}function SA(e,t,n,i,r){let s,o={};i&&Object.entries(i).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`}),s=e===t?n:lH(e,t,n);const a=oH(sH(s));return new yh(a,o,r)}function lH(e,t,n){const i={};return Object.entries(e.children).forEach(([r,o])=>{i[r]=o===t?n:lH(o,t,n)}),new gn(e.segments,i)}class dH{constructor(t,n,i){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=i,t&&i.length>0&&Gb(i[0]))throw new W(4003,!1);const r=i.find(eg);if(r&&r!==X5(i))throw new W(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Wb{constructor(t,n,i){this.segmentGroup=t,this.processChildren=n,this.index=i}}function uH(e,t,n){if(e??=new gn([],{}),0===e.segments.length&&e.hasChildren())return tg(e,t,n);const i=function Bye(e,t,n){let i=0,r=t;const o={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(i>=n.length)return o;const s=e.segments[r],a=n[i];if(eg(a))break;const c=`${a}`,l=i<n.length-1?n[i+1]:null;if(r>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!pH(c,l,s))return o;i+=2}else{if(!pH(c,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,t,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){const o=new gn(e.segments.slice(0,i.pathIndex),{});return o.children[at]=new gn(e.segments.slice(i.pathIndex),e.children),tg(o,0,r)}return i.match&&0===r.length?new gn(e.segments,{}):i.match&&!e.hasChildren()?CA(e,t,n):i.match?tg(e,0,r):CA(e,t,n)}function tg(e,t,n){if(0===n.length)return new gn(e.segments,{});{const i=function Vye(e){return eg(e[0])?e[0].outlets:{[at]:e}}(n),r={};if(Object.keys(i).some(o=>o!==at)&&e.children[at]&&1===e.numberOfChildren&&0===e.children[at].segments.length){const o=tg(e.children[at],t,n);return new gn(e.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=uH(e.children[o],t,s))}),Object.entries(e.children).forEach(([o,s])=>{void 0===i[o]&&(r[o]=s)}),new gn(e.segments,r)}}function CA(e,t,n){const i=e.segments.slice(0,t);let r=0;for(;r<n.length;){const o=n[r];if(eg(o)){const c=jye(o.outlets);return new gn(i,c)}if(0===r&&Gb(n[0])){i.push(new Jm(e.segments[t].path,hH(n[0]))),r++;continue}const s=eg(o)?o.outlets[at]:`${o}`,a=r<n.length-1?n[r+1]:null;s&&a&&Gb(a)?(i.push(new Jm(s,hH(a))),r+=2):(i.push(new Jm(s,{})),r++)}return new gn(i,{})}function jye(e){const t={};return Object.entries(e).forEach(([n,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(t[n]=CA(new gn([],{}),0,i))}),t}function hH(e){const t={};return Object.entries(e).forEach(([n,i])=>t[n]=`${i}`),t}function pH(e,t,n){return e==n.path&&pa(t,n.parameters)}const ng="imperative";var It=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(It||{});class fa{constructor(t,n){this.id=t,this.url=n}}class zb extends fa{constructor(t,n,i="imperative",r=null){super(t,n),this.type=It.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class cc extends fa{constructor(t,n,i){super(t,n),this.urlAfterRedirects=i,this.type=It.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var bo=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e}(bo||{}),Kb=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(Kb||{});class Th extends fa{constructor(t,n,i,r){super(t,n),this.reason=i,this.code=r,this.type=It.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class wh extends fa{constructor(t,n,i,r){super(t,n),this.reason=i,this.code=r,this.type=It.NavigationSkipped}}class qb extends fa{constructor(t,n,i,r){super(t,n),this.error=i,this.target=r,this.type=It.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class fH extends fa{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r,this.type=It.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hye extends fa{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r,this.type=It.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Gye extends fa{constructor(t,n,i,r,o){super(t,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o,this.type=It.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Wye extends fa{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r,this.type=It.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zye extends fa{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r,this.type=It.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Kye{constructor(t){this.route=t,this.type=It.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class qye{constructor(t){this.route=t,this.type=It.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Yye{constructor(t){this.snapshot=t,this.type=It.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $ye{constructor(t){this.snapshot=t,this.type=It.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Xye{constructor(t){this.snapshot=t,this.type=It.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Zye{constructor(t){this.snapshot=t,this.type=It.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class mH{constructor(t,n,i){this.routerEvent=t,this.position=n,this.anchor=i,this.type=It.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class TA{}class wA{constructor(t){this.url=t}}class Jye{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new ig,this.attachRef=null}}let ig=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){const r=this.getOrCreateContext(n);r.outlet=i,this.contexts.set(n,r)}onChildOutletDestroyed(n){const i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new Jye,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();class gH{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=IA(t,this._root);return n?n.children.map(i=>i.value):[]}firstChild(t){const n=IA(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=RA(t,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return RA(t,this._root).map(n=>n.value)}}function IA(e,t){if(e===t.value)return t;for(const n of t.children){const i=IA(e,n);if(i)return i}return null}function RA(e,t){if(e===t.value)return[t];for(const n of t.children){const i=RA(e,n);if(i.length)return i.unshift(t),i}return[]}class Os{constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function Ih(e){const t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}class _H extends gH{constructor(t,n){super(t),this.snapshot=n,OA(this,t)}toString(){return this.snapshot.toString()}}function vH(e){const t=function Qye(e){const o=new DA([],{},{},"",{},at,e,null,{});return new EH("",new Os(o,[]))}(e),n=new co([new Jm("",{})]),i=new co({}),r=new co({}),o=new co({}),s=new co(""),a=new _d(n,i,o,s,r,at,e,t.root);return a.snapshot=t.root,new _H(new Os(a,[]),t)}class _d{constructor(t,n,i,r,o,s,a,c){this.urlSubject=t,this.paramsSubject=n,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Ft(l=>l[Zm]))??He(void 0),this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Ft(t=>bh(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Ft(t=>bh(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function AA(e,t,n="emptyOnly"){let i;const{routeConfig:r}=e;return i=null===t||"always"!==n&&""!==r?.path&&(t.component||t.routeConfig?.loadComponent)?{params:{...e.params},data:{...e.data},resolve:{...e.data,...e._resolvedData??{}}}:{params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.data,...r?.data,...e._resolvedData}},r&&yH(r)&&(i.resolve[Zm]=r.title),i}class DA{get title(){return this.data?.[Zm]}constructor(t,n,i,r,o,s,a,c,l){this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=bh(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=bh(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class EH extends gH{constructor(t,n){super(n),this.url=t,OA(this,n)}toString(){return bH(this._root)}}function OA(e,t){t.value._routerState=e,t.children.forEach(n=>OA(e,n))}function bH(e){const t=e.children.length>0?` { ${e.children.map(bH).join(", ")} } `:"";return`${e.value}${t}`}function NA(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,pa(t.queryParams,n.queryParams)||e.queryParamsSubject.next(n.queryParams),t.fragment!==n.fragment&&e.fragmentSubject.next(n.fragment),pa(t.params,n.params)||e.paramsSubject.next(n.params),function gye(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!pa(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.urlSubject.next(n.url),pa(t.data,n.data)||e.dataSubject.next(n.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function PA(e,t){const n=pa(e.params,t.params)&&function bye(e,t){return gd(e,t)&&e.every((n,i)=>pa(n.parameters,t[i].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||PA(e.parent,t.parent))}function yH(e){return"string"==typeof e.title||null===e.title}let MA=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=at,this.activateEvents=new Wt,this.deactivateEvents=new Wt,this.attachEvents=new Wt,this.detachEvents=new Wt,this.parentContexts=J(ig),this.location=J(Bo),this.changeDetector=J(ws),this.environmentInjector=J(jr),this.inputBinder=J(Yb,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:i,previousValue:r}=n.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new W(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new W(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new W(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new W(4013,!1);this._activatedRoute=n;const r=this.location,s=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new xA(n,a,r.injector);this.activated=r.createComponent(s,{index:r.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275dir=ye({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Hr]})}}return e})();class xA{__ngOutletInjector(t){return new xA(this.route,this.childContexts,t)}constructor(t,n,i){this.route=t,this.childContexts=n,this.parent=i}get(t,n){return t===_d?this.route:t===ig?this.childContexts:this.parent.get(t,n)}}const Yb=new re("");let SH=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:i}=n,r=pb([i.queryParams,i.params,i.data]).pipe(ha(([o,s,a],c)=>(a={...o,...s,...a},0===c?He(a):Promise.resolve(a)))).subscribe(o=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(n);const s=function mue(e){const t=mt(e);if(!t)return null;const n=new Xf(t);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}(i.component);if(s)for(const{templateName:a}of s.inputs)n.activatedComponentRef.setInput(a,o[a]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,r)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})();function rg(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=t.value;const r=function tSe(e,t,n){return t.children.map(i=>{for(const r of n.children)if(e.shouldReuseRoute(i.value,r.value.snapshot))return rg(e,i,r);return rg(e,i)})}(e,t,n);return new Os(i,r)}{if(e.shouldAttach(t.value)){const o=e.retrieve(t.value);if(null!==o){const s=o.route;return s.value._futureSnapshot=t.value,s.children=t.children.map(a=>rg(e,a)),s}}const i=function nSe(e){return new _d(new co(e.url),new co(e.params),new co(e.queryParams),new co(e.fragment),new co(e.data),e.outlet,e.component,e)}(t.value),r=t.children.map(o=>rg(e,o));return new Os(i,r)}}const CH="ngNavigationCancelingError";function TH(e,t){const{redirectTo:n,navigationBehaviorOptions:i}=Ch(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=wH(!1,bo.Redirect);return r.url=n,r.navigationBehaviorOptions=i,r}function wH(e,t){const n=new Error(`NavigationCancelingError: ${e||""}`);return n[CH]=!0,n.cancellationCode=t,n}function IH(e){return!!e&&e[CH]}let RH=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=sr({type:e,selectors:[["ng-component"]],standalone:!0,features:[jc],decls:1,vars:0,template:function(i,r){1&i&&pt(0,"router-outlet")},dependencies:[MA],encapsulation:2})}}return e})();function kA(e){const t=e.children&&e.children.map(kA),n=t?{...e,children:t}:{...e};return!n.component&&!n.loadComponent&&(t||n.loadChildren)&&n.outlet&&n.outlet!==at&&(n.component=RH),n}function ma(e){return e.outlet||at}function og(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class dSe{constructor(t,n,i,r,o){this.routeReuseStrategy=t,this.futureState=n,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(t){const n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,t),NA(this.futureState.root),this.activateChildRoutes(n,i,t)}deactivateChildRoutes(t,n,i){const r=Ih(n);t.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(t,n,i){const r=t.value,o=n?n.value:null;if(r===o)if(r.component){const s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(t,n,s.children)}else this.deactivateChildRoutes(t,n,i);else o&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const i=n.getContext(t.value.outlet),r=i&&t.value.component?i.children:n,o=Ih(t);for(const s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){const s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:s,route:t,contexts:a})}}deactivateRouteAndOutlet(t,n){const i=n.getContext(t.value.outlet),r=i&&t.value.component?i.children:n,o=Ih(t);for(const s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(t,n,i){const r=Ih(n);t.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new Zye(o.value.snapshot))}),t.children.length&&this.forwardEvent(new $ye(t.value.snapshot))}activateRoutes(t,n,i){const r=t.value,o=n?n.value:null;if(NA(r),r===o)if(r.component){const s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,n,s.children)}else this.activateChildRoutes(t,n,i);else if(r.component){const s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),NA(a.route.value),this.activateChildRoutes(t,null,s.children)}else{const a=og(r.snapshot);s.attachRef=null,s.route=r,s.injector=a,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(t,null,s.children)}}else this.activateChildRoutes(t,null,i)}}class AH{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class $b{constructor(t,n){this.component=t,this.route=n}}function uSe(e,t,n){const i=e._root;return sg(i,t?t._root:null,n,[i.value])}function Rh(e,t){const n=Symbol(),i=t.get(e,n);return i===n?"function"!=typeof e||function iee(e){return null!==K_(e)}(e)?t.get(e):e:i}function sg(e,t,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=Ih(t);return e.children.forEach(s=>{(function pSe(e,t,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=e.value,s=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const c=function fSe(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!gd(e.url,t.url);case"pathParamsOrQueryParamsChange":return!gd(e.url,t.url)||!pa(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!PA(e,t)||!pa(e.queryParams,t.queryParams);default:return!PA(e,t)}}(s,o,o.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new AH(i)):(o.data=s.data,o._resolvedData=s._resolvedData),sg(e,t,o.component?a?a.children:null:n,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new $b(a.outlet.component,s))}else s&&ag(t,a,r),r.canActivateChecks.push(new AH(i)),sg(e,null,o.component?a?a.children:null:n,i,r)})(s,o[s.value.outlet],n,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>ag(a,n.getContext(s),r)),r}function ag(e,t,n){const i=Ih(e),r=e.value;Object.entries(i).forEach(([o,s])=>{ag(s,r.component?t?t.children.getContext(o):null:t,n)}),n.canDeactivateChecks.push(new $b(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}function cg(e){return"function"==typeof e}function DH(e){return e instanceof Lb||"EmptyError"===e?.name}const Xb=Symbol("INITIAL_VALUE");function Ah(){return ha(e=>pb(e.map(t=>t.pipe(la(1),o4(Xb)))).pipe(Ft(t=>{for(const n of t)if(!0!==n){if(n===Xb)return Xb;if(!1===n||n instanceof yh)return n}return!0}),Yr(t=>t!==Xb),la(1)))}function OH(e){return function qQ(...e){return nx(e)}(er(t=>{if(Ch(t))throw TH(0,t)}),Ft(t=>!0===t))}class LA{constructor(t){this.segmentGroup=t||null}}class FA extends Error{constructor(t){super(),this.urlTree=t}}function Dh(e){return Fb(new LA(e))}class MSe{constructor(t,n){this.urlSerializer=t,this.urlTree=n}lineralizeSegments(t,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return He(i);if(r.numberOfChildren>1||!r.children[at])return Fb(new W(4e3,!1));r=r.children[at]}}applyRedirectCommands(t,n,i){const r=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),t,i);if(n.startsWith("/"))throw new FA(r);return r}applyRedirectCreateUrlTree(t,n,i,r){const o=this.createSegmentGroup(t,n.root,i,r);return new yh(o,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const i={};return Object.entries(t).forEach(([r,o])=>{if("string"==typeof o&&o.startsWith(":")){const a=o.substring(1);i[r]=n[a]}else i[r]=o}),i}createSegmentGroup(t,n,i,r){const o=this.createSegments(t,n.segments,i,r);let s={};return Object.entries(n.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(t,c,i,r)}),new gn(o,s)}createSegments(t,n,i,r){return n.map(o=>o.path.startsWith(":")?this.findPosParam(t,o,r):this.findOrReturn(o,i))}findPosParam(t,n,i){const r=i[n.path.substring(1)];if(!r)throw new W(4001,!1);return r}findOrReturn(t,n){let i=0;for(const r of n){if(r.path===t.path)return n.splice(i),r;i++}return t}}const UA={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function xSe(e,t,n,i,r){const o=VA(e,t,n);return o.matched?(i=function rSe(e,t){return e.providers&&!e._injector&&(e._injector=oE(e.providers,t,`Route: ${e.path}`)),e._injector??t}(t,i),function OSe(e,t,n,i){const r=t.canMatch;return r&&0!==r.length?He(r.map(s=>{const a=Rh(s,e);return Xc(function bSe(e){return e&&cg(e.canMatch)}(a)?a.canMatch(t,n):za(e,()=>a(t,n)))})).pipe(Ah(),OH()):He(!0)}(i,t,n).pipe(Ft(s=>!0===s?o:{...UA}))):He(o)}function VA(e,t,n){if("**"===t.path)return function kSe(e){return{matched:!0,parameters:e.length>0?X5(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}(n);if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{...UA}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const r=(t.matcher||mye)(n,e,t);if(!r)return{...UA};const o={};Object.entries(r.posParams??{}).forEach(([a,c])=>{o[a]=c.path});const s=r.consumed.length>0?{...o,...r.consumed[r.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:n.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function NH(e,t,n,i){return n.length>0&&function USe(e,t,n){return n.some(i=>Zb(e,t,i)&&ma(i)!==at)}(e,n,i)?{segmentGroup:new gn(t,FSe(i,new gn(n,e.children))),slicedSegments:[]}:0===n.length&&function VSe(e,t,n){return n.some(i=>Zb(e,t,i))}(e,n,i)?{segmentGroup:new gn(e.segments,LSe(e,n,i,e.children)),slicedSegments:n}:{segmentGroup:new gn(e.segments,e.children),slicedSegments:n}}function LSe(e,t,n,i){const r={};for(const o of n)if(Zb(e,t,o)&&!i[ma(o)]){const s=new gn([],{});r[ma(o)]=s}return{...i,...r}}function FSe(e,t){const n={};n[at]=t;for(const i of e)if(""===i.path&&ma(i)!==at){const r=new gn([],{});n[ma(i)]=r}return n}function Zb(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}class HSe{}class zSe{constructor(t,n,i,r,o,s,a){this.injector=t,this.configLoader=n,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new MSe(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(t){return new W(4002,`'${t.segmentGroup}'`)}recognize(){const t=NH(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(Ft(n=>{const i=new DA([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},at,this.rootComponentType,null,{}),r=new Os(i,n),o=new EH("",r),s=function kye(e,t,n=null,i=null){return cH(aH(e),t,n,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),this.inheritParamsAndData(o._root,null),{state:o,tree:s}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t,at).pipe(Eh(i=>{if(i instanceof FA)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof LA?this.noMatchError(i):i}))}inheritParamsAndData(t,n){const i=t.value,r=AA(i,n,this.paramsInheritanceStrategy);i.params=Object.freeze(r.params),i.data=Object.freeze(r.data),t.children.forEach(o=>this.inheritParamsAndData(o,i))}processSegmentGroup(t,n,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(t,n,i):this.processSegment(t,n,i,i.segments,r,!0).pipe(Ft(o=>o instanceof Os?[o]:[]))}processChildren(t,n,i){const r=[];for(const o of Object.keys(i.children))"primary"===o?r.unshift(o):r.push(o);return xi(r).pipe(Xm(o=>{const s=i.children[o],a=function cSe(e,t){const n=e.filter(i=>ma(i)===t);return n.push(...e.filter(i=>ma(i)!==t)),n}(n,o);return this.processSegmentGroup(t,a,s,o)}),function uye(e,t){return ci(function dye(e,t,n,i,r){return(o,s)=>{let a=n,c=t,l=0;o.subscribe(Gn(s,d=>{const u=l++;c=a?e(c,d,u):(a=!0,d),i&&s.next(c)},r&&(()=>{a&&s.next(c),s.complete()})))}}(e,t,arguments.length>=2,!0))}((o,s)=>(o.push(...s),o)),Ub(null),function hye(e,t){const n=arguments.length>=2;return i=>i.pipe(e?Yr((r,o)=>e(r,o,i)):Rc,gA(1),n?Ub(t):Y5(()=>new Lb))}(),tr(o=>{if(null===o)return Dh(i);const s=PH(o);return function KSe(e){e.sort((t,n)=>t.value.outlet===at?-1:n.value.outlet===at?1:t.value.outlet.localeCompare(n.value.outlet))}(s),He(s)}))}processSegment(t,n,i,r,o,s){return xi(n).pipe(Xm(a=>this.processSegmentAgainstRoute(a._injector??t,n,a,i,r,o,s).pipe(Eh(c=>{if(c instanceof LA)return He(null);throw c}))),md(a=>!!a),Eh(a=>{if(DH(a))return function jSe(e,t,n){return 0===t.length&&!e.children[n]}(i,r,o)?He(new HSe):Dh(i);throw a}))}processSegmentAgainstRoute(t,n,i,r,o,s,a){return function BSe(e,t,n,i){return!!(ma(e)===i||i!==at&&Zb(t,n,e))&&VA(t,e,n).matched}(i,r,o,s)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,r,i,o,s):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(t,r,n,i,o,s):Dh(r):Dh(r)}expandSegmentAgainstRouteUsingRedirect(t,n,i,r,o,s){const{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=VA(n,r,o);if(!a)return Dh(n);r.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const u=this.applyRedirects.applyRedirectCommands(c,r.redirectTo,l);return this.applyRedirects.lineralizeSegments(r,u).pipe(tr(h=>this.processSegment(t,i,n,h.concat(d),s,!1)))}matchSegmentAgainstRoute(t,n,i,r,o){const s=xSe(n,i,r,t);return"**"===i.path&&(n.children={}),s.pipe(ha(a=>a.matched?this.getChildConfig(t=i._injector??t,i,r).pipe(ha(({routes:c})=>{const l=i._loadedInjector??t,{consumedSegments:d,remainingSegments:u,parameters:h}=a,p=new DA(d,h,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function YSe(e){return e.data||{}}(i),ma(i),i.component??i._loadedComponent??null,i,function $Se(e){return e.resolve||{}}(i)),{segmentGroup:m,slicedSegments:f}=NH(n,d,u,c);if(0===f.length&&m.hasChildren())return this.processChildren(l,c,m).pipe(Ft(E=>null===E?null:new Os(p,E)));if(0===c.length&&0===f.length)return He(new Os(p,[]));const g=ma(i)===o;return this.processSegment(l,c,m,f,g?at:o,!0).pipe(Ft(E=>new Os(p,E instanceof Os?[E]:[])))})):Dh(n)))}getChildConfig(t,n,i){return n.children?He({routes:n.children,injector:t}):n.loadChildren?void 0!==n._loadedRoutes?He({routes:n._loadedRoutes,injector:n._loadedInjector}):function DSe(e,t,n,i){const r=t.canLoad;return void 0===r||0===r.length?He(!0):He(r.map(s=>{const a=Rh(s,e);return Xc(function gSe(e){return e&&cg(e.canLoad)}(a)?a.canLoad(t,n):za(e,()=>a(t,n)))})).pipe(Ah(),OH())}(t,n,i).pipe(tr(r=>r?this.configLoader.loadChildren(t,n).pipe(er(o=>{n._loadedRoutes=o.routes,n._loadedInjector=o.injector})):function PSe(e){return Fb(wH(!1,bo.GuardRejected))}())):He({routes:[],injector:t})}}function qSe(e){const t=e.value.routeConfig;return t&&""===t.path}function PH(e){const t=[],n=new Set;for(const i of e){if(!qSe(i)){t.push(i);continue}const r=t.find(o=>i.value.routeConfig===o.value.routeConfig);void 0!==r?(r.children.push(...i.children),n.add(r)):t.push(i)}for(const i of n){const r=PH(i.children);t.push(new Os(i.value,r))}return t.filter(i=>!n.has(i))}function MH(e){const t=e.children.map(n=>MH(n)).flat();return[e,...t]}function BA(e){return ha(t=>{const n=e(t);return n?xi(n).pipe(Ft(()=>t)):He(t)})}let xH=(()=>{class e{buildTitle(n){let i,r=n.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===at);return i}getResolvedTitleForRoute(n){return n.data[Zm]}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:()=>J(tCe),providedIn:"root"})}}return e})(),tCe=(()=>{class e extends xH{constructor(n){super(),this.title=n}updateTitle(n){const i=this.buildTitle(n);void 0!==i&&this.title.setTitle(i)}static{this.\u0275fac=function(i){return new(i||e)(Z(Bpe))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const Oh=new re("",{providedIn:"root",factory:()=>({})}),Nh=new re("");let jA=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=J(WV)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return He(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const i=Xc(n.loadComponent()).pipe(Ft(kH),er(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),_A(()=>{this.componentLoaders.delete(n)})),r=new q5(i,()=>new Tt).pipe(mA());return this.componentLoaders.set(n,r),r}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return He({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const o=function nCe(e,t,n,i){return Xc(e.loadChildren()).pipe(Ft(kH),tr(r=>r instanceof oF||Array.isArray(r)?He(r):xi(t.compileModuleAsync(r))),Ft(r=>{i&&i(e);let o,s,a=!1;return Array.isArray(r)?(s=r,!0):(o=r.create(n).injector,s=o.get(Nh,[],{optional:!0,self:!0}).flat()),{routes:s.map(kA),injector:o}}))}(i,this.compiler,n,this.onLoadEndListener).pipe(_A(()=>{this.childrenLoaders.delete(i)})),s=new q5(o,()=>new Tt).pipe(mA());return this.childrenLoaders.set(i,s),s}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function kH(e){return function iCe(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let HA=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:()=>J(rCe),providedIn:"root"})}}return e})(),rCe=(()=>{class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const LH=new re(""),FH=new re("");function oCe(e,t,n){const i=e.get(FH),r=e.get(Ut);return e.get(Le).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(l=>setTimeout(l));let o;const s=new Promise(l=>{o=l}),a=r.startViewTransition(()=>(o(),function sCe(e){return new Promise(t=>{cw(t,{injector:e})})}(e))),{onViewTransitionCreated:c}=i;return c&&za(e,()=>c({transition:a,from:t,to:n})),s})}let Jb=(()=>{class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Tt,this.transitionAbortSubject=new Tt,this.configLoader=J(jA),this.environmentInjector=J(jr),this.urlSerializer=J(Sh),this.rootContexts=J(ig),this.location=J(ch),this.inputBindingEnabled=null!==J(Yb,{optional:!0}),this.titleStrategy=J(xH),this.options=J(Oh,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=J(HA),this.createViewTransition=J(LH,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>He(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new qye(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Kye(r))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:i})}setupNavigations(n,i,r){return this.transitions=new co({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:ng,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Yr(o=>0!==o.id),Ft(o=>({...o,extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),ha(o=>{let s=!1,a=!1;return He(o).pipe(ha(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",bo.SupersededByNewNavigation),Wo;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const l=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!l&&"reload"!==(c.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const u="";return this.events.next(new wh(c.id,this.urlSerializer.serialize(c.rawUrl),u,Kb.IgnoredSameUrlNavigation)),c.resolve(null),Wo}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return He(c).pipe(ha(u=>{const h=this.transitions?.getValue();return this.events.next(new zb(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),h!==this.transitions?.getValue()?Wo:Promise.resolve(u)}),function XSe(e,t,n,i,r,o){return tr(s=>function GSe(e,t,n,i,r,o,s="emptyOnly"){return new zSe(e,t,n,i,r,s,o).recognize()}(e,t,n,i,s.extractedUrl,r,o).pipe(Ft(({state:a,tree:c})=>({...s,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),er(u=>{o.targetSnapshot=u.targetSnapshot,o.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:u.urlAfterRedirects};const h=new fH(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){const{id:u,extractedUrl:h,source:p,restoredState:m,extras:f}=c,g=new zb(u,this.urlSerializer.serialize(h),p,m);this.events.next(g);const E=vH(this.rootComponentType).snapshot;return this.currentTransition=o={...c,targetSnapshot:E,urlAfterRedirects:h,extras:{...f,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=h,He(o)}{const u="";return this.events.next(new wh(c.id,this.urlSerializer.serialize(c.extractedUrl),u,Kb.IgnoredByUrlHandlingStrategy)),c.resolve(null),Wo}}),er(c=>{const l=new Hye(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),Ft(c=>(this.currentTransition=o={...c,guards:uSe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)},o)),function ySe(e,t){return tr(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return 0===s.length&&0===o.length?He({...n,guardsResult:!0}):function SSe(e,t,n,i){return xi(e).pipe(tr(r=>function ASe(e,t,n,i,r){const o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return o&&0!==o.length?He(o.map(a=>{const c=og(t)??r,l=Rh(a,c);return Xc(function ESe(e){return e&&cg(e.canDeactivate)}(l)?l.canDeactivate(e,t,n,i):za(c,()=>l(e,t,n,i))).pipe(md())})).pipe(Ah()):He(!0)}(r.component,r.route,n,t,i)),md(r=>!0!==r,!0))}(s,i,r,e).pipe(tr(a=>a&&function mSe(e){return"boolean"==typeof e}(a)?function CSe(e,t,n,i){return xi(t).pipe(Xm(r=>fb(function wSe(e,t){return null!==e&&t&&t(new Yye(e)),He(!0)}(r.route.parent,i),function TSe(e,t){return null!==e&&t&&t(new Xye(e)),He(!0)}(r.route,i),function RSe(e,t,n){const i=t[t.length-1],o=t.slice(0,t.length-1).reverse().map(s=>function hSe(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(s)).filter(s=>null!==s).map(s=>K5(()=>He(s.guards.map(c=>{const l=og(s.node)??n,d=Rh(c,l);return Xc(function vSe(e){return e&&cg(e.canActivateChild)}(d)?d.canActivateChild(i,e):za(l,()=>d(i,e))).pipe(md())})).pipe(Ah())));return He(o).pipe(Ah())}(e,r.path,n),function ISe(e,t,n){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return He(!0);const r=i.map(o=>K5(()=>{const s=og(t)??n,a=Rh(o,s);return Xc(function _Se(e){return e&&cg(e.canActivate)}(a)?a.canActivate(t,e):za(s,()=>a(t,e))).pipe(md())}));return He(r).pipe(Ah())}(e,r.route,n))),md(r=>!0!==r,!0))}(i,o,e,t):He(a)),Ft(a=>({...n,guardsResult:a})))})}(this.environmentInjector,c=>this.events.next(c)),er(c=>{if(o.guardsResult=c.guardsResult,Ch(c.guardsResult))throw TH(0,c.guardsResult);const l=new Gye(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Yr(c=>!!c.guardsResult||(this.cancelNavigationTransition(c,"",bo.GuardRejected),!1)),BA(c=>{if(c.guards.canActivateChecks.length)return He(c).pipe(er(l=>{const d=new Wye(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),ha(l=>{let d=!1;return He(l).pipe(function ZSe(e,t){return tr(n=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return He(n);const o=new Set(r.map(c=>c.route)),s=new Set;for(const c of o)if(!s.has(c))for(const l of MH(c))s.add(l);let a=0;return xi(s).pipe(Xm(c=>o.has(c)?function JSe(e,t,n,i){const r=e.routeConfig,o=e._resolve;return void 0!==r?.title&&!yH(r)&&(o[Zm]=r.title),function QSe(e,t,n,i){const r=vA(e);if(0===r.length)return He({});const o={};return xi(r).pipe(tr(s=>function eCe(e,t,n,i){const r=og(t)??i,o=Rh(e,r);return Xc(o.resolve?o.resolve(t,n):za(r,()=>o(t,n)))}(e[s],t,n,i).pipe(md(),er(a=>{o[s]=a}))),gA(1),function pye(e){return Ft(()=>e)}(o),Eh(s=>DH(s)?Wo:Fb(s)))}(o,e,t,i).pipe(Ft(s=>(e._resolvedData=s,e.data=AA(e,e.parent,n).resolve,null)))}(c,i,e,t):(c.data=AA(c,c.parent,e).resolve,He(void 0))),er(()=>a++),gA(1),tr(c=>a===s.size?He(n):Wo))})}(this.paramsInheritanceStrategy,this.environmentInjector),er({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",bo.NoDataFromResolver)}}))}),er(l=>{const d=new zye(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),BA(c=>{const l=d=>{const u=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(d.routeConfig).pipe(er(h=>{d.component=h}),Ft(()=>{})));for(const h of d.children)u.push(...l(h));return u};return pb(l(c.targetSnapshot.root)).pipe(Ub(null),la(1))}),BA(()=>this.afterPreactivation()),ha(()=>{const{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?xi(d).pipe(Ft(()=>o)):He(o)}),Ft(c=>{const l=function eSe(e,t,n){const i=rg(e,t._root,n?n._root:void 0);return new _H(i,t)}(n.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o={...c,targetRouterState:l},this.currentNavigation.targetRouterState=l,o}),er(()=>{this.events.next(new TA)}),((e,t,n,i)=>Ft(r=>(new dSe(t,r.targetRouterState,r.currentRouterState,n,i).activate(e),r)))(this.rootContexts,n.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),la(1),er({next:c=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new cc(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{s=!0}}),mr(this.transitionAbortSubject.pipe(er(c=>{throw c}))),_A(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",bo.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Eh(c=>{if(a=!0,IH(c))this.events.next(new Th(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),function iSe(e){return IH(e)&&Ch(e.url)}(c)?this.events.next(new wA(c.url)):o.resolve(!1);else{this.events.next(new qb(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(n.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return Wo}))}))}cancelNavigationTransition(n,i,r){const o=new Th(n.id,this.urlSerializer.serialize(n.extractedUrl),i,r);this.events.next(o),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function aCe(e){return e!==ng}let cCe=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:()=>J(dCe),providedIn:"root"})}}return e})();class lCe{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}}let dCe=(()=>{class e extends lCe{static{this.\u0275fac=(()=>{let n;return function(r){return(n||(n=bi(e)))(r||e)}})()}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),UH=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:()=>J(uCe),providedIn:"root"})}}return e})(),uCe=(()=>{class e extends UH{constructor(){super(...arguments),this.location=J(ch),this.urlSerializer=J(Sh),this.options=J(Oh,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=J(HA),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new yh,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=vH(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(i=>{"popstate"===i.type&&n(i.url,i.state)})}handleRouterEvent(n,i){if(n instanceof zb)this.stateMemento=this.createStateMemento();else if(n instanceof wh)this.rawUrlTree=i.initialUrl;else if(n instanceof fH){if("eager"===this.urlUpdateStrategy&&!i.extras.skipLocationChange){const r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(r,i)}}else n instanceof TA?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):n instanceof Th&&(n.code===bo.GuardRejected||n.code===bo.NoDataFromResolver)?this.restoreHistory(i):n instanceof qb?this.restoreHistory(i,!0):n instanceof cc&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,i){const r=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",s)}else{const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",o)}}restoreHistory(n,i=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.currentUrlTree===n.finalUrl&&0===o&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}static{this.\u0275fac=(()=>{let n;return function(r){return(n||(n=bi(e)))(r||e)}})()}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var lg=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(lg||{});function VH(e,t){e.events.pipe(Yr(n=>n instanceof cc||n instanceof Th||n instanceof qb||n instanceof wh),Ft(n=>n instanceof cc||n instanceof wh?lg.COMPLETE:n instanceof Th&&(n.code===bo.Redirect||n.code===bo.SupersededByNewNavigation)?lg.REDIRECTING:lg.FAILED),Yr(n=>n!==lg.REDIRECTING),la(1)).subscribe(()=>{t()})}function hCe(e){throw e}const pCe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},fCe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let yo=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=J(xV),this.stateManager=J(UH),this.options=J(Oh,{optional:!0})||{},this.pendingTasks=J(Vu),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=J(Jb),this.urlSerializer=J(Sh),this.location=J(ch),this.urlHandlingStrategy=J(HA),this._events=new Tt,this.errorHandler=this.options.errorHandler||hCe,this.navigated=!1,this.routeReuseStrategy=J(cCe),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=J(Nh,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!J(Yb,{optional:!0}),this.eventsSubscription=new vi,this.isNgZoneEnabled=J(Le)instanceof Le&&Le.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(i=>{try{const r=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(null!==r&&null!==o)if(this.stateManager.handleRouterEvent(i,o),i instanceof Th&&i.code!==bo.Redirect&&i.code!==bo.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof cc)this.navigated=!0;else if(i instanceof wA){const s=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),a={info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||aCe(r.source)};this.scheduleNavigation(s,ng,null,a,{resolve:r.resolve,reject:r.reject,promise:r.promise})}(function gCe(e){return!(e instanceof TA||e instanceof wA)})(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ng,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",i)},0)})}navigateToSyncWithBrowser(n,i,r){const o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){const c={...r};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(o.state=c)}const a=this.parseUrl(n);this.scheduleNavigation(a,i,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(kA),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,i={}){const{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:s;let u,d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...o};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}null!==d&&(d=this.removeEmptyProps(d));try{u=aH(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),u=this.currentUrlTree.root}return cH(u,n,d,l??null)}navigateByUrl(n,i={skipLocationChange:!1}){const r=Ch(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,ng,null,i)}navigate(n,i={skipLocationChange:!1}){return function mCe(e){for(let t=0;t<e.length;t++)if(null==e[t])throw new W(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,i){let r;if(r=!0===i?{...pCe}:!1===i?{...fCe}:i,Ch(n))return J5(this.currentUrlTree,n,r);const o=this.parseUrl(n);return J5(this.currentUrlTree,o,r)}removeEmptyProps(n){return Object.entries(n).reduce((i,[r,o])=>(null!=o&&(i[r]=o),i),{})}scheduleNavigation(n,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,l;s?(a=s.resolve,c=s.reject,l=s.promise):l=new Promise((u,h)=>{a=u,c=h});const d=this.pendingTasks.add();return VH(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(u=>Promise.reject(u))}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();class BH{}let ECe=(()=>{class e{constructor(n,i,r,o,s){this.router=n,this.injector=r,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(Yr(n=>n instanceof cc),Xm(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const r=[];for(const o of i){o.providers&&!o._injector&&(o._injector=oE(o.providers,n,`Route: ${o.path}`));const s=o._injector??n,a=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&r.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&r.push(this.processRoutes(a,o.children??o._loadedRoutes))}return xi(r).pipe(mh())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(n,i):He(null);const o=r.pipe(tr(s=>null===s?He(void 0):(i._loadedRoutes=s.routes,i._loadedInjector=s.injector,this.processRoutes(s.injector??n,s.routes))));return i.loadComponent&&!i._loadedComponent?xi([o,this.loader.loadComponent(i)]).pipe(mh()):o})}static{this.\u0275fac=function(i){return new(i||e)(Z(yo),Z(WV),Z(jr),Z(BH),Z(jA))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const WA=new re("");let jH=(()=>{class e{constructor(n,i,r,o,s={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=r,this.zone=o,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=J(jr),s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof zb?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof cc?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof wh&&n.code===Kb.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof mH&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){var r=this;this.zone.runOutsideAngular(C(function*(){yield new Promise(o=>{setTimeout(()=>{o()}),cw(()=>{o()},{injector:r.environmentInjector})}),r.zone.run(()=>{r.transitions.events.next(new mH(n,"popstate"===r.lastSource?r.store[r.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(i){U0()}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac})}}return e})();function ga(e,t){return{\u0275kind:e,\u0275providers:t}}function GH(){const e=J(Bi);return t=>{const n=e.get(aa);if(t!==n.components[0])return;const i=e.get(yo),r=e.get(WH);1===e.get(zA)&&i.initialNavigation(),e.get(zH,null,Et.Optional)?.setUpPreloading(),e.get(WA,null,Et.Optional)?.init(),i.resetRootComponentType(n.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const WH=new re("",{factory:()=>new Tt}),zA=new re("",{providedIn:"root",factory:()=>1}),zH=new re("");function CCe(e){return ga(0,[{provide:zH,useExisting:ECe},{provide:BH,useExisting:e}])}function wCe(e){return ga(9,[{provide:LH,useValue:oCe},{provide:FH,useValue:{skipNextTransition:!!e?.skipInitialTransition,...e}}])}const KH=new re("ROUTER_FORROOT_GUARD"),ICe=[ch,{provide:Sh,useClass:EA},yo,ig,{provide:_d,useFactory:function HH(e){return e.routerState.root},deps:[yo]},jA,[]];let RCe=(()=>{class e{constructor(n){}static forRoot(n,i){return{ngModule:e,providers:[ICe,[],{provide:Nh,multi:!0,useValue:n},{provide:KH,useFactory:NCe,deps:[[yo,new Z_,new J_]]},{provide:Oh,useValue:i||{}},i?.useHash?{provide:od,useClass:bue}:{provide:od,useClass:kB},{provide:WA,useFactory:()=>{const e=J(Bhe),t=J(Le),n=J(Oh),i=J(Jb),r=J(Sh);return n.scrollOffset&&e.setOffset(n.scrollOffset),new jH(r,i,e,t,n)}},i?.preloadingStrategy?CCe(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?PCe(i):[],i?.bindToComponentInputs?ga(8,[SH,{provide:Yb,useExisting:SH}]).\u0275providers:[],i?.enableViewTransitions?wCe().\u0275providers:[],[{provide:qH,useFactory:GH},{provide:lI,multi:!0,useExisting:qH}]]}}static forChild(n){return{ngModule:e,providers:[{provide:Nh,multi:!0,useValue:n}]}}static{this.\u0275fac=function(i){return new(i||e)(Z(KH,8))}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({})}}return e})();function NCe(e){return"guarded"}function PCe(e){return["disabled"===e.initialNavigation?ga(3,[{provide:aI,multi:!0,useFactory:()=>{const t=J(yo);return()=>{t.setUpLocationChangeListener()}}},{provide:zA,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?ga(2,[{provide:zA,useValue:0},{provide:aI,multi:!0,deps:[Bi],useFactory:t=>{const n=t.get(vue,Promise.resolve());return()=>n.then(()=>new Promise(i=>{const r=t.get(yo),o=t.get(WH);VH(r,()=>{i(!0)}),t.get(Jb).afterPreactivation=()=>(i(!0),o.closed?He(void 0):o),r.initialNavigation()}))}}]).\u0275providers:[]]}const qH=new re(""),YH_configs={AppID:"67f11adf2f054480b431c8447ff85d91"};let xCe=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=sr({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(i,r){1&i&&pt(0,"router-outlet")},dependencies:[MA],changeDetection:0})}}return e})();function Ti(e){return"function"==typeof e}function $H(e){const n=e(i=>{Error.call(i),i.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const KA=$H(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function Qb(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class Ns{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const o of n)o.remove(this);else n.remove(this);const{initialTeardown:i}=this;if(Ti(i))try{i()}catch(o){t=o instanceof KA?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{JH(o)}catch(s){t=t??[],s instanceof KA?t=[...t,...s.errors]:t.push(s)}}if(t)throw new KA(t)}}add(t){var n;if(t&&t!==this)if(this.closed)JH(t);else{if(t instanceof Ns){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&Qb(n,t)}remove(t){const{_finalizers:n}=this;n&&Qb(n,t),t instanceof Ns&&t._removeParent(this)}}Ns.EMPTY=(()=>{const e=new Ns;return e.closed=!0,e})();const XH=Ns.EMPTY;function ZH(e){return e instanceof Ns||e&&"closed"in e&&Ti(e.remove)&&Ti(e.add)&&Ti(e.unsubscribe)}function JH(e){Ti(e)?e():e.unsubscribe()}const vd={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ey={setTimeout(e,t,...n){const{delegate:i}=ey;return i?.setTimeout?i.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=ey;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function QH(e){ey.setTimeout(()=>{const{onUnhandledError:t}=vd;if(!t)throw e;t(e)})}function qA(){}const kCe=YA("C",void 0,void 0);function YA(e,t,n){return{kind:e,value:t,error:n}}let Ed=null;function ty(e){if(vd.useDeprecatedSynchronousErrorHandling){const t=!Ed;if(t&&(Ed={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:i}=Ed;if(Ed=null,n)throw i}}else e()}class $A extends Ns{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,ZH(t)&&t.add(this)):this.destination=HCe}static create(t,n,i){return new ZA(t,n,i)}next(t){this.isStopped?JA(function FCe(e){return YA("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?JA(function LCe(e){return YA("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?JA(kCe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const VCe=Function.prototype.bind;function XA(e,t){return VCe.call(e,t)}class BCe{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(i){ny(i)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(i){ny(i)}else ny(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){ny(n)}}}class ZA extends $A{constructor(t,n,i){let r;if(super(),Ti(t)||!t)r={next:t??void 0,error:n??void 0,complete:i??void 0};else{let o;this&&vd.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&XA(t.next,o),error:t.error&&XA(t.error,o),complete:t.complete&&XA(t.complete,o)}):r=t}this.destination=new BCe(r)}}function ny(e){vd.useDeprecatedSynchronousErrorHandling?function UCe(e){vd.useDeprecatedSynchronousErrorHandling&&Ed&&(Ed.errorThrown=!0,Ed.error=e)}(e):QH(e)}function JA(e,t){const{onStoppedNotification:n}=vd;n&&ey.setTimeout(()=>n(e,t))}const HCe={closed:!0,next:qA,error:function jCe(e){throw e},complete:qA},QA="function"==typeof Symbol&&Symbol.observable||"@@observable";function eD(e){return e}let So=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const i=new e;return i.source=this,i.operator=n,i}subscribe(n,i,r){const o=function WCe(e){return e&&e instanceof $A||function GCe(e){return e&&Ti(e.next)&&Ti(e.error)&&Ti(e.complete)}(e)&&ZH(e)}(n)?n:new ZA(n,i,r);return ty(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return new(i=t6(i))((r,o)=>{const s=new ZA({next:a=>{try{n(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(n){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(n)}[QA](){return this}pipe(...n){return function e6(e){return 0===e.length?eD:1===e.length?e[0]:function(n){return e.reduce((i,r)=>r(i),n)}}(n)(this)}toPromise(n){return new(n=t6(n))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return e.create=t=>new e(t),e})();function t6(e){var t;return null!==(t=e??vd.Promise)&&void 0!==t?t:Promise}const zCe=$H(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let dg=(()=>{class e extends So{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const i=new n6(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new zCe}next(n){ty(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(n)}})}error(n){ty(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){ty(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:i,isStopped:r,observers:o}=this;return i||r?XH:(this.currentObservers=null,o.push(n),new Ns(()=>{this.currentObservers=null,Qb(o,n)}))}_checkFinalizedStatuses(n){const{hasError:i,thrownError:r,isStopped:o}=this;i?n.error(r):o&&n.complete()}asObservable(){const n=new So;return n.source=this,n}}return e.create=(t,n)=>new n6(t,n),e})();class n6 extends dg{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===i||i.call(n,t)}error(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===i||i.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,i;return null!==(i=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==i?i:XH}}function i6(e){return e&&Ti(e.schedule)}function r6(e){return i6(function tD(e){return e[e.length-1]}(e))?e.pop():void 0}function Zc(e){return this instanceof Zc?(this.v=e,this):new Zc(e)}function c6(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function oD(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=e[o]&&function(s){return new Promise(function(a,c){!function r(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}(a,c,(s=e[o](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const l6=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function d6(e){return Ti(e?.then)}function u6(e){return Ti(e[QA])}function h6(e){return Symbol.asyncIterator&&Ti(e?.[Symbol.asyncIterator])}function p6(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const f6=function vTe(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function m6(e){return Ti(e?.[f6])}function g6(e){return function a6(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function s(p){return function(m){return Promise.resolve(m).then(p,u)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(p,m){i[p]&&(r[p]=function(f){return new Promise(function(g,E){o.push([p,f,g,E])>1||c(p,f)})},m&&(r[p]=m(r[p])))}function c(p,m){try{!function l(p){p.value instanceof Zc?Promise.resolve(p.value.v).then(d,u):h(o[0][2],p)}(i[p](m))}catch(f){h(o[0][3],f)}}function d(p){c("next",p)}function u(p){c("throw",p)}function h(p,m){p(m),o.shift(),o.length&&c(o[0][0],o[0][1])}}(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:i,done:r}=yield Zc(n.read());if(r)return yield Zc(void 0);yield yield Zc(i)}}finally{n.releaseLock()}})}function _6(e){return Ti(e?.getReader)}function bd(e){if(e instanceof So)return e;if(null!=e){if(u6(e))return function ETe(e){return new So(t=>{const n=e[QA]();if(Ti(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(l6(e))return function bTe(e){return new So(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(d6(e))return function yTe(e){return new So(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,QH)})}(e);if(h6(e))return v6(e);if(m6(e))return function STe(e){return new So(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(_6(e))return function CTe(e){return v6(g6(e))}(e)}throw p6(e)}function v6(e){return new So(t=>{(function TTe(e,t){var n,i,r,o;return function o6(e,t,n,i){return new(n||(n=Promise))(function(o,s){function a(d){try{l(i.next(d))}catch(u){s(u)}}function c(d){try{l(i.throw(d))}catch(u){s(u)}}function l(d){d.done?o(d.value):function r(o){return o instanceof n?o:new n(function(s){s(o)})}(d.value).then(a,c)}l((i=i.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=c6(e);!(i=yield n.next()).done;)if(t.next(i.value),t.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=n.return)&&(yield o.call(n))}finally{if(r)throw r.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function Jc(e,t,n,i=0,r=!1){const o=t.schedule(function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(o),!r)return o}function Qc(e){return t=>{if(function wTe(e){return Ti(e?.lift)}(t))return t.lift(function(n){try{return e(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function lc(e,t,n,i,r){return new ITe(e,t,n,i,r)}class ITe extends $A{constructor(t,n,i,r,o,s){super(t),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=n?function(a){try{n(a)}catch(c){t.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function E6(e,t=0){return Qc((n,i)=>{n.subscribe(lc(i,r=>Jc(i,e,()=>i.next(r),t),()=>Jc(i,e,()=>i.complete(),t),r=>Jc(i,e,()=>i.error(r),t)))})}function b6(e,t=0){return Qc((n,i)=>{i.add(e.schedule(()=>n.subscribe(i),t))})}function y6(e,t){if(!e)throw new Error("Iterable cannot be null");return new So(n=>{Jc(n,t,()=>{const i=e[Symbol.asyncIterator]();Jc(n,t,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function S6(e,t){return t?function PTe(e,t){if(null!=e){if(u6(e))return function RTe(e,t){return bd(e).pipe(b6(t),E6(t))}(e,t);if(l6(e))return function DTe(e,t){return new So(n=>{let i=0;return t.schedule(function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())})})}(e,t);if(d6(e))return function ATe(e,t){return bd(e).pipe(b6(t),E6(t))}(e,t);if(h6(e))return y6(e,t);if(m6(e))return function OTe(e,t){return new So(n=>{let i;return Jc(n,t,()=>{i=e[f6](),Jc(n,t,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void n.error(s)}o?n.complete():n.next(r)},0,!0)}),()=>Ti(i?.return)&&i.return()})}(e,t);if(_6(e))return function NTe(e,t){return y6(g6(e),t)}(e,t)}throw p6(e)}(e,t):bd(e)}const C6=new So(e=>e.complete());function _a(e){return e<=0?()=>C6:Qc((t,n)=>{let i=0;t.subscribe(lc(n,r=>{++i<=e&&(n.next(r),e<=i&&n.complete())}))})}class T6{constructor(t){this.cdr=t,this.afterClosed=new dg,this.shown=!0}closeDialog(t){this.onAfterClosed(t)}onAfterClosed(t){this.shown=!1,this.cdr.markForCheck(),this.afterClosed.next(t)}}const iy_HIDDEN={opacity:0,"margin-top":"100%"},iy_SHOWN={opacity:1,"margin-top":0},w6=xR("fade",[Hm(":enter",[da(iy_HIDDEN),jm("250ms ease-in-out",da(iy_SHOWN))]),Hm(":leave",[da(iy_SHOWN),jm("250ms ease-in-out",da(iy_HIDDEN))])]);function FTe(e,t){if(1&e&&(rm(0),fr(1),om()),2&e){const n=Kt(2);Re(),fm(" Calling to ",n.data.user.name," ")}}function UTe(e,t){1&e&&fr(0),2&e&&fm(" ",Kt(2).data.user.name," is calling ")}function VTe(e,t){if(1&e){const n=Qa();rm(0),ue(1,"button",11),zt("click",function(){return Gr(n),Wr(Kt(2).onAcceptCall())}),ve(),om()}}function BTe(e,t){if(1&e){const n=Qa();ue(0,"div",2)(1,"div",3)(2,"div",4),pt(3,"img",5),ve(),ue(4,"p",6),an(5,FTe,2,1,"ng-container",7)(6,UTe,1,1,"ng-template",null,0,Jw),ve()(),ue(8,"div",8),an(9,VTe,2,0,"ng-container",9),ue(10,"span")(11,"button",10),zt("click",function(){return Gr(n),Wr(Kt().onDeclineCall())}),ve()()()()}if(2&e){const n=pm(7),i=Kt();wt("video-call--full-screen",i.fullScreen),ht("@fade",void 0),Re(3),ht("src",i.data.user.photoURL,w0),Re(2),ht("ngIf",i.data.outcome)("ngIfElse",n),Re(4),ht("ngIf",!i.data.outcome)}}let jTe=(()=>{class e extends T6{constructor(n){super(n),this.fullScreen=!1}ngOnInit(){this.play(`assets/${this.data.outcome?"outcome":"income"}.mp3`)}ngOnDestroy(){this.stop()}onAcceptCall(){this.fullScreen=!0,this.cdr.markForCheck(),this.afterClosed.next(this.data)}onDeclineCall(){this.play("assets/cancel.mp3"),setTimeout(()=>this.closeDialog(null),200)}play(n,i=!0){this.audio&&this.stop(),this.audio=new Audio(n),this.audio.loop=i,this.audio.load(),this.audio.play()}stop(){this.audio.pause(),this.audio.remove()}static{this.\u0275fac=function(i){return new(i||e)(H(ws))}}static{this.\u0275cmp=sr({type:e,selectors:[["ngx-video-call"]],inputs:{data:"data"},features:[Pt],decls:1,vars:1,consts:[["income",""],["class","video-call",3,"video-call--full-screen",4,"ngIf"],[1,"video-call"],[1,"video-call-user"],[1,"video-call-user__block","video-call-user__block--animated"],["alt","",1,"video-call-user__img",3,"src"],[1,"video-call-user__title"],[4,"ngIf","ngIfElse"],[1,"video-call__actions"],[4,"ngIf"],["aria-label","Decline",1,"video-call__button","video-call__button--decline",3,"click"],["aria-label","Accept",1,"video-call__button","video-call__button--accept",3,"click"]],template:function(i,r){1&i&&an(0,BTe,12,7,"div",1),2&i&&ht("ngIf",r.shown&&r.data)},dependencies:[Cm],styles:['[_nghost-%COMP%]{display:block;height:100vh;position:relative}.video-call[_ngcontent-%COMP%]{background-image:linear-gradient(#3f51b5,#313a42);background-size:cover;border-radius:10px;box-shadow:0 5px 10px #0000001a;display:flex;flex-direction:column;height:100%;justify-content:flex-end;left:50%;max-height:400px;max-width:400px;position:absolute;top:50%;transform:translate(-50%,-50%);width:100%;z-index:5;transition:.3s}.video-call--full-screen[_ngcontent-%COMP%]{background-image:linear-gradient(#22292f);border-radius:0;max-height:100%;max-width:100%}.video-call-user[_ngcontent-%COMP%]{left:50%;position:absolute;text-align:center;top:50%;transform:translate(-50%,-55%);z-index:1}.video-call-user__block[_ngcontent-%COMP%]{background:#fff;border-radius:50%;border:solid 5px #fff;height:180px;margin:0 auto;transform:scale(1);width:180px}.video-call-user__block--animated[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_play 2s ease infinite;backface-visibility:hidden}.video-call-user__img[_ngcontent-%COMP%]{border-radius:50%;height:100%;left:0;object-fit:cover;position:absolute;top:0;width:100%}.video-call-user__title[_ngcontent-%COMP%]{color:#fff;font-size:1.2em;font-weight:700;margin:15px 0 0}.video-call__actions[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:10px 0}.video-call__button[_ngcontent-%COMP%]{border-radius:50%;box-shadow:0 0 #3f51b500,0 .05em .1em #0003;border:0;cursor:pointer;display:block;font-size:40px;height:1em;margin:0 5px;position:relative;transform:translateZ(0) scale(1);width:1em;transition:.3s}.video-call__button[_ngcontent-%COMP%]:before, .video-call__button[_ngcontent-%COMP%]:after{content:"";position:absolute}.video-call__button[_ngcontent-%COMP%]:before{background-color:#ffffff1a;border-radius:50%;height:1em;left:0;opacity:1;top:0;transform:translateZ(0) scale(0);width:1em}.video-call__button[_ngcontent-%COMP%]:after{background-position:50% 50%;background-repeat:no-repeat;background-size:cover;background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTYuNiAxMC44YzEuNCAyLjggMy44IDUuMSA2LjYgNi42bDIuMi0yLjJjLjMtLjMuNy0uNCAxLS4yIDEuMS40IDIuMy42IDMuNi42LjUgMCAxIC40IDEgMVYyMGMwIC41LS41IDEtMSAxLTkuNCAwLTE3LTcuNi0xNy0xNyAwLS42LjQtMSAxLTFoMy41Yy41IDAgMSAuNCAxIDEgMCAxLjIuMiAyLjUuNiAzLjYuMS40IDAgLjctLjIgMWwtMi4zIDIuMnoiIGZpbGw9IiNmZmZmZmYiLz48L3N2Zz4=);height:.5em;left:.25em;top:.25em;transform:translateZ(0);width:.5em;transition:.3s}.video-call__button--accept[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_phone-outer 3s infinite;background-color:#3f51b5}.video-call__button--accept[_ngcontent-%COMP%]:before{animation:_ngcontent-%COMP%_phone-inner 3s infinite}.video-call__button--accept[_ngcontent-%COMP%]:after{animation:_ngcontent-%COMP%_phone-icon 3s infinite}.video-call__button--decline[_ngcontent-%COMP%]{background-color:#d73b3d}.video-call__button--decline[_ngcontent-%COMP%]:hover{background-color:#ce2a2c}.video-call__button--decline[_ngcontent-%COMP%]:after{top:.28em;transform:translateZ(0) rotate(135deg)}@keyframes _ngcontent-%COMP%_play{0%{transform:scale(1)}15%{box-shadow:0 0 0 5px #9b9da466}25%{box-shadow:0 0 0 10px #9b9da466,0 0 0 20px #9b9da433}25%{box-shadow:0 0 0 15px #9b9da466,0 0 0 30px #9b9da433}}@keyframes _ngcontent-%COMP%_phone-outer{0%{box-shadow:0 0 #3f51b500,0 .05em .1em #0003;transform:translateZ(0) scale(1)}33.3333%{box-shadow:0 0 #3f51b51a,0 .05em .1em #00000080;transform:translateZ(0) scale(1.1)}66.6666%{box-shadow:0 0 0 .5em #3f51b500,0 .05em .1em #0003;transform:translateZ(0) scale(1)}to{box-shadow:0 0 #3f51b500,0 .05em .1em #0003;transform:translateZ(0) scale(1)}}@keyframes _ngcontent-%COMP%_phone-inner{0%{opacity:1;transform:translateZ(0) scale(0)}33.3333%{opacity:1;transform:translateZ(0) scale(.9)}66.6666%{opacity:0;transform:translateZ(0) scale(0)}to{opacity:0;transform:translateZ(0) scale(0)}}@keyframes _ngcontent-%COMP%_phone-icon{0%{transform:translateZ(0)}2%{transform:translate3d(.01em,0,0)}4%{transform:translate3d(-.01em,0,0)}6%{transform:translate3d(.01em,0,0)}8%{transform:translate3d(-.01em,0,0)}10%{transform:translate3d(.01em,0,0)}12%{transform:translate3d(-.01em,0,0)}14%{transform:translate3d(.01em,0,0)}16%{transform:translate3d(-.01em,0,0)}18%{transform:translate3d(.01em,0,0)}20%{transform:translate3d(-.01em,0,0)}22%{transform:translate3d(.01em,0,0)}24%{transform:translate3d(-.01em,0,0)}26%{transform:translate3d(.01em,0,0)}28%{transform:translate3d(-.01em,0,0)}30%{transform:translate3d(.01em,0,0)}32%{transform:translate3d(-.01em,0,0)}34%{transform:translate3d(.01em,0,0)}36%{transform:translate3d(-.01em,0,0)}38%{transform:translate3d(.01em,0,0)}40%{transform:translate3d(-.01em,0,0)}42%{transform:translate3d(.01em,0,0)}44%{transform:translate3d(-.01em,0,0)}46%{transform:translateZ(0)}}'],data:{animation:[w6]},changeDetection:0})}}return e})();var Ph=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Sn=function(e){try{return!!e()}catch{return!0}},ry=!Sn(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}),I6=ry,R6=Function.prototype,sD=R6.call,GTe=I6&&R6.bind.bind(sD,sD),_n=I6?GTe:function(e){return function(){return sD.apply(e,arguments)}},Wi=_n({}.isPrototypeOf),oy=function(e){return e&&e.Math==Math&&e},Pn=oy("object"==typeof globalThis&&globalThis)||oy("object"==typeof window&&window)||oy("object"==typeof self&&self)||oy("object"==typeof Ph&&Ph)||function(){return this}()||Ph||Function("return this")(),A6=Function.prototype,D6=A6.apply,O6=A6.call,sy="object"==typeof Reflect&&Reflect.apply||(ry?O6.bind(D6):function(){return O6.apply(D6,arguments)}),N6=_n,zTe=N6({}.toString),KTe=N6("".slice),va=function(e){return KTe(zTe(e),8,-1)},qTe=va,YTe=_n,ug=function(e){if("Function"===qTe(e))return YTe(e)},aD="object"==typeof document&&document.all,ay={all:aD,IS_HTMLDDA:void 0===aD&&void 0!==aD},$Te=ay.all,zn=ay.IS_HTMLDDA?function(e){return"function"==typeof e||e===$Te}:function(e){return"function"==typeof e},hg={},Co=!Sn(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),cy=Function.prototype.call,Jn=ry?cy.bind(cy):function(){return cy.apply(cy,arguments)},ly={},P6={}.propertyIsEnumerable,M6=Object.getOwnPropertyDescriptor,ZTe=M6&&!P6.call({1:2},1);ly.f=ZTe?function(e){var t=M6(this,e);return!!t&&t.enumerable}:P6;var el,dy,tl=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},JTe=Sn,QTe=va,cD=Object,e0e=_n("".split),uy=JTe(function(){return!cD("z").propertyIsEnumerable(0)})?function(e){return"String"==QTe(e)?e0e(e,""):cD(e)}:cD,Mh=function(e){return null==e},t0e=Mh,n0e=TypeError,xh=function(e){if(t0e(e))throw n0e("Can't call method on "+e);return e},i0e=uy,r0e=xh,nl=function(e){return i0e(r0e(e))},x6=zn,o0e=ay.all,$r=ay.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:x6(e)||e===o0e}:function(e){return"object"==typeof e?null!==e:x6(e)},To={},lD=To,dD=Pn,s0e=zn,k6=function(e){return s0e(e)?e:void 0},Or=function(e,t){return arguments.length<2?k6(lD[e])||k6(dD[e]):lD[e]&&lD[e][t]||dD[e]&&dD[e][t]},il=typeof navigator<"u"&&String(navigator.userAgent)||"",uD=il,F6=Pn.process,U6=Pn.Deno,V6=F6&&F6.versions||U6&&U6.version,B6=V6&&V6.v8;B6&&(dy=(el=B6.split("."))[0]>0&&el[0]<4?1:+(el[0]+el[1])),!dy&&uD&&(!(el=uD.match(/Edge\/(\d+)/))||el[1]>=74)&&(el=uD.match(/Chrome\/(\d+)/))&&(dy=+el[1]);var yd=dy,j6=yd,c0e=Pn.String,kh=!!Object.getOwnPropertySymbols&&!Sn(function(){var e=Symbol();return!c0e(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&j6&&j6<41}),H6=kh&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,l0e=Or,d0e=zn,u0e=Wi,h0e=Object,pg=H6?function(e){return"symbol"==typeof e}:function(e){var t=l0e("Symbol");return d0e(t)&&u0e(t.prototype,h0e(e))},p0e=String,Lh=function(e){try{return p0e(e)}catch{return"Object"}},f0e=zn,m0e=Lh,g0e=TypeError,wo=function(e){if(f0e(e))return e;throw g0e(m0e(e)+" is not a function")},_0e=wo,v0e=Mh,hy=function(e,t){var n=e[t];return v0e(n)?void 0:_0e(n)},hD=Jn,pD=zn,fD=$r,E0e=TypeError,G6={exports:{}},W6=Pn,b0e=Object.defineProperty,z6="__core-js_shared__",mD=Pn[z6]||function(e,t){try{b0e(W6,e,{value:t,configurable:!0,writable:!0})}catch{W6[e]=t}return t}(z6,{}),K6=mD;(G6.exports=function(e,t){return K6[e]||(K6[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:"\xa9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Fh=G6.exports,S0e=xh,C0e=Object,Ea=function(e){return C0e(S0e(e))},T0e=Ea,w0e=_n({}.hasOwnProperty),fi=Object.hasOwn||function(e,t){return w0e(T0e(e),t)},I0e=_n,R0e=0,A0e=Math.random(),D0e=I0e(1..toString),gD=function(e){return"Symbol("+(void 0===e?"":e)+")_"+D0e(++R0e+A0e,36)},q6=fi,N0e=gD,P0e=kh,M0e=H6,Uh=Pn.Symbol,_D=Fh("wks"),x0e=M0e?Uh.for||Uh:Uh&&Uh.withoutSetter||N0e,cn=function(e){return q6(_D,e)||(_D[e]=P0e&&q6(Uh,e)?Uh[e]:x0e("Symbol."+e)),_D[e]},k0e=Jn,Y6=$r,$6=pg,L0e=hy,U0e=TypeError,V0e=cn("toPrimitive"),j0e=pg,py=function(e){var t=function(e,t){if(!Y6(e)||$6(e))return e;var n,i=L0e(e,V0e);if(i){if(void 0===t&&(t="default"),n=k0e(i,e,t),!Y6(n)||$6(n))return n;throw U0e("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var n,i;if("string"===t&&pD(n=e.toString)&&!fD(i=hD(n,e))||pD(n=e.valueOf)&&!fD(i=hD(n,e))||"string"!==t&&pD(n=e.toString)&&!fD(i=hD(n,e)))return i;throw E0e("Can't convert object to primitive value")}(e,t)}(e,"string");return j0e(t)?t:t+""},X6=$r,vD=Pn.document,H0e=X6(vD)&&X6(vD.createElement),ED=function(e){return H0e?vD.createElement(e):{}},G0e=ED,Z6=!Co&&!Sn(function(){return 7!=Object.defineProperty(G0e("div"),"a",{get:function(){return 7}}).a}),z0e=Jn,K0e=ly,q0e=tl,Y0e=nl,$0e=py,X0e=fi,Z0e=Z6,J6=Object.getOwnPropertyDescriptor;hg.f=Co?J6:function(e,t){if(e=Y0e(e),t=$0e(t),Z0e)try{return J6(e,t)}catch{}if(X0e(e,t))return q0e(!z0e(K0e.f,e,t),e[t])};var J0e=Sn,Q0e=zn,ewe=/#|\.prototype\./,fg=function(e,t){var n=nwe[twe(e)];return n==rwe||n!=iwe&&(Q0e(t)?J0e(t):!!t)},twe=fg.normalize=function(e){return String(e).replace(ewe,".").toLowerCase()},nwe=fg.data={},iwe=fg.NATIVE="N",rwe=fg.POLYFILL="P",Q6=fg,owe=wo,swe=ry,awe=ug(ug.bind),rl=function(e,t){return owe(e),void 0===t?e:swe?awe(e,t):function(){return e.apply(t,arguments)}},Yo={},e8=Co&&Sn(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),cwe=$r,lwe=String,dwe=TypeError,gr=function(e){if(cwe(e))return e;throw dwe(lwe(e)+" is not an object")},hwe=Z6,fy=gr,t8=py,fwe=TypeError,bD=Object.defineProperty,mwe=Object.getOwnPropertyDescriptor,yD="enumerable",SD="configurable",CD="writable";Yo.f=Co?e8?function(e,t,n){if(fy(e),t=t8(t),fy(n),"function"==typeof e&&"prototype"===t&&"value"in n&&CD in n&&!n[CD]){var i=mwe(e,t);i&&i[CD]&&(e[t]=n.value,n={configurable:SD in n?n[SD]:i[SD],enumerable:yD in n?n[yD]:i[yD],writable:!1})}return bD(e,t,n)}:bD:function(e,t,n){if(fy(e),t=t8(t),fy(n),hwe)try{return bD(e,t,n)}catch{}if("get"in n||"set"in n)throw fwe("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var gwe=Yo,_we=tl,ol=Co?function(e,t,n){return gwe.f(e,t,_we(1,n))}:function(e,t,n){return e[t]=n,e},my=Pn,vwe=sy,Ewe=ug,bwe=zn,ywe=hg.f,Swe=Q6,Vh=To,Cwe=rl,Bh=ol,n8=fi,Twe=function(e){var t=function(n,i,r){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,i)}return new e(n,i,r)}return vwe(e,this,arguments)};return t.prototype=e.prototype,t},it=function(e,t){var n,i,r,o,s,a,c,l,d,u=e.target,h=e.global,p=e.stat,m=e.proto,f=h?my:p?my[u]:(my[u]||{}).prototype,g=h?Vh:Vh[u]||Bh(Vh,u,{})[u],E=g.prototype;for(o in t)i=!(n=Swe(h?o:u+(p?".":"#")+o,e.forced))&&f&&n8(f,o),a=g[o],i&&(c=e.dontCallGetSet?(d=ywe(f,o))&&d.value:f[o]),s=i&&c?c:t[o],i&&typeof a==typeof s||(l=e.bind&&i?Cwe(s,my):e.wrap&&i?Twe(s):m&&bwe(s)?Ewe(s):s,(e.sham||s&&s.sham||a&&a.sham)&&Bh(l,"sham",!0),Bh(g,o,l),m&&(n8(Vh,r=u+"Prototype")||Bh(Vh,r,{}),Bh(Vh[r],o,s),e.real&&E&&(n||!E[o])&&Bh(E,o,s)))},wwe=Math.ceil,Iwe=Math.floor,Rwe=Math.trunc||function(e){var t=+e;return(t>0?Iwe:wwe)(t)},Awe=Rwe,TD=function(e){var t=+e;return t!=t||0===t?0:Awe(t)},Dwe=TD,Owe=Math.max,Nwe=Math.min,wD=function(e,t){var n=Dwe(e);return n<0?Owe(n+t,0):Nwe(n,t)},Pwe=TD,Mwe=Math.min,i8=function(e){return e>0?Mwe(Pwe(e),9007199254740991):0},xwe=i8,dc=function(e){return xwe(e.length)},kwe=nl,Lwe=wD,Fwe=dc,r8=function(e){return function(t,n,i){var r,o=kwe(t),s=Fwe(o),a=Lwe(i,s);if(e&&n!=n){for(;s>a;)if((r=o[a++])!=r)return!0}else for(;s>a;a++)if((e||a in o)&&o[a]===n)return e||a||0;return!e&&-1}},ID={includes:r8(!0),indexOf:r8(!1)},Uwe=ID.includes;it({target:"Array",proto:!0,forced:Sn(function(){return!Array(1).includes()})},{includes:function(e){return Uwe(this,e,arguments.length>1?arguments[1]:void 0)}});var Vwe=To,$o=function(e){return Vwe[e+"Prototype"]},Bwe=$o("Array").includes,jwe=$r,Hwe=va,Gwe=cn("match"),o8=function(e){var t;return jwe(e)&&(void 0!==(t=e[Gwe])?!!t:"RegExp"==Hwe(e))},Wwe=o8,zwe=TypeError,s8={};s8[cn("toStringTag")]="z";var RD="[object z]"===String(s8),Kwe=RD,qwe=zn,gy=va,Ywe=cn("toStringTag"),$we=Object,Xwe="Arguments"==gy(function(){return arguments}()),ba=Kwe?gy:function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(r,o){try{return r[o]}catch{}}(t=$we(e),Ywe))?n:Xwe?gy(t):"Object"==(i=gy(t))&&qwe(t.callee)?"Arguments":i},Zwe=ba,Jwe=String,Io=function(e){if("Symbol"===Zwe(e))throw TypeError("Cannot convert a Symbol value to a string");return Jwe(e)},Qwe=cn("match"),eIe=it,nIe=xh,a8=Io,rIe=_n("".indexOf);eIe({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[Qwe]=!1,"/./"[e](t)}catch{}}return!1}("includes")},{includes:function(e){return!!~rIe(a8(nIe(this)),a8(function(e){if(Wwe(e))throw zwe("The method doesn't accept regular expressions");return e}(e)),arguments.length>1?arguments[1]:void 0)}});var oIe=$o("String").includes,c8=Wi,sIe=Bwe,aIe=oIe,AD=Array.prototype,DD=String.prototype,Y=Vt(function(e){var t=e.includes;return e===AD||c8(AD,e)&&t===AD.includes?sIe:"string"==typeof e||e===DD||c8(DD,e)&&t===DD.includes?aIe:t}),lIe=wo,dIe=Ea,uIe=uy,hIe=dc,pIe=TypeError,l8=function(e){return function(t,n,i,r){lIe(n);var o=dIe(t),s=uIe(o),a=hIe(o),c=e?a-1:0,l=e?-1:1;if(i<2)for(;;){if(c in s){r=s[c],c+=l;break}if(c+=l,e?c<0:a<=c)throw pIe("Reduce of empty array with no initial value")}for(;e?c>=0:a>c;c+=l)c in s&&(r=n(r,s[c],c,o));return r}},fIe={left:l8(!1),right:l8(!0)},mIe=Sn,_y=function(e,t){var n=[][e];return!!n&&mIe(function(){n.call(null,t||function(){return 1},1)})},jh=typeof process<"u"&&"process"==va(process),gIe=fIe.left;it({target:"Array",proto:!0,forced:!jh&&yd>79&&yd<83||!_y("reduce")},{reduce:function(e){var t=arguments.length;return gIe(this,e,t,t>1?arguments[1]:void 0)}});var _Ie=$o("Array").reduce,vIe=Wi,EIe=_Ie,OD=Array.prototype,d8=function(e){var t=e.reduce;return e===OD||vIe(OD,e)&&t===OD.reduce?EIe:t},Ps=Vt(d8);let u8=!0,h8=!0;function vy(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function Sd(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(s,a){if(s!==t)return r.apply(this,arguments);const c=l=>{const d=n(l);d&&(a.handleEvent?a.handleEvent(d):a(d))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(a,c),r.apply(this,[s,c])};const o=i.removeEventListener;i.removeEventListener=function(s,a){if(s!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(a))return o.apply(this,arguments);const c=this._eventMap[t].get(a);return this._eventMap[t].delete(a),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[s,c])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(s){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),s&&this.addEventListener(t,this["_on"+t]=s)},enumerable:!0,configurable:!0})}function yIe(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(u8=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function SIe(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(h8=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function p8(){if("object"==typeof window){if(u8)return;typeof console<"u"&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function ND(e,t){h8&&console.warn(e+" is deprecated, please use "+t+" instead.")}function f8(e){return"[object Object]"===Object.prototype.toString.call(e)}function m8(e){var t;return f8(e)?Ps(t=Object.keys(e)).call(t,function(n,i){const r=f8(e[i]),o=r?m8(e[i]):e[i],s=r&&!Object.keys(o).length;return void 0===o||s?n:Object.assign(n,{[i]:o})},{}):e}function PD(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(i=>{i.endsWith("Id")?PD(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach(r=>{PD(e,e.get(r),n)})}))}function g8(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const o=[];return e.forEach(s=>{"track"===s.type&&s.trackIdentifier===t.id&&o.push(s)}),o.forEach(s=>{e.forEach(a=>{a.type===i&&a.trackId===s.id&&PD(e,a,r)})}),r}var CIe=gD,_8=Fh("keys"),Ey=function(e){return _8[e]||(_8[e]=CIe(e))},TIe=!Sn(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),wIe=fi,IIe=zn,RIe=Ea,AIe=TIe,v8=Ey("IE_PROTO"),MD=Object,DIe=MD.prototype,xD=AIe?MD.getPrototypeOf:function(e){var t=RIe(e);if(wIe(t,v8))return t[v8];var n=t.constructor;return IIe(n)&&t instanceof n?n.prototype:t instanceof MD?DIe:null},OIe=_n,NIe=wo,PIe=zn,MIe=String,xIe=TypeError,LIe=gr,UIe=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=function(e,t,n){try{return OIe(NIe(Object.getOwnPropertyDescriptor(e,"__proto__").set))}catch{}}(Object.prototype))(n,[]),t=n instanceof Array}catch{}return function(i,r){return LIe(i),function(e){if("object"==typeof e||PIe(e))return e;throw xIe("Can't set "+MIe(e)+" as a prototype")}(r),t?e(i,r):i.__proto__=r,i}}():void 0),by={},yy={},kD=fi,VIe=nl,BIe=ID.indexOf,jIe=yy,E8=_n([].push),b8=function(e,t){var n,i=VIe(e),r=0,o=[];for(n in i)!kD(jIe,n)&&kD(i,n)&&E8(o,n);for(;t.length>r;)kD(i,n=t[r++])&&(~BIe(o,n)||E8(o,n));return o},LD=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],HIe=b8,GIe=LD.concat("length","prototype");by.f=Object.getOwnPropertyNames||function(e){return HIe(e,GIe)};var mg={};mg.f=Object.getOwnPropertySymbols;var WIe=Or,zIe=by,KIe=mg,qIe=gr,YIe=_n([].concat),$Ie=WIe("Reflect","ownKeys")||function(e){var t=zIe.f(qIe(e)),n=KIe.f;return n?YIe(t,n(e)):t},y8=fi,XIe=$Ie,ZIe=hg,JIe=Yo,FD={},QIe=b8,eRe=LD,Sy=Object.keys||function(e){return QIe(e,eRe)},iRe=Yo,rRe=gr,oRe=nl,sRe=Sy;FD.f=Co&&!e8?Object.defineProperties:function(e,t){rRe(e);for(var n,i=oRe(t),r=sRe(t),o=r.length,s=0;o>s;)iRe.f(e,n=r[s++],i[n]);return e};var Cy,S8=Or("document","documentElement"),aRe=gr,cRe=FD,C8=LD,lRe=yy,dRe=S8,uRe=ED,UD="prototype",T8=Ey("IE_PROTO"),BD=function(){},w8=function(e){return"<script>"+e+"<\/script>"},I8=function(e){e.write(w8("")),e.close();var t=e.parentWindow.Object;return e=null,t},Ty=function(){try{Cy=new ActiveXObject("htmlfile")}catch{}var e,t;Ty=typeof document<"u"?document.domain&&Cy?I8(Cy):((t=uRe("iframe")).style.display="none",dRe.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(w8("document.F=Object")),e.close(),e.F):I8(Cy);for(var i=C8.length;i--;)delete Ty[UD][C8[i]];return Ty()};lRe[T8]=!0;var gg=Object.create||function(e,t){var n;return null!==e?(BD[UD]=aRe(e),n=new BD,BD[UD]=null,n[T8]=e):n=Ty(),void 0===t?n:cRe.f(n,t)},hRe=$r,pRe=ol,R8=Error,fRe=_n("".replace),mRe=String(R8("zxcasd").stack),A8=/\n\s*at [^:]*:[^\n]*/,gRe=A8.test(mRe),_Re=tl,vRe=!Sn(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",_Re(1,7)),7!==e.stack)}),ERe=ol,yRe=vRe,D8=Error.captureStackTrace,Cd={},SRe=Cd,CRe=cn("iterator"),TRe=Array.prototype,O8=function(e){return void 0!==e&&(SRe.Array===e||TRe[CRe]===e)},wRe=ba,N8=hy,IRe=Mh,RRe=Cd,ARe=cn("iterator"),wy=function(e){if(!IRe(e))return N8(e,ARe)||N8(e,"@@iterator")||RRe[wRe(e)]},DRe=Jn,ORe=wo,NRe=gr,PRe=Lh,MRe=wy,xRe=TypeError,jD=function(e,t){var n=arguments.length<2?MRe(e):t;if(ORe(n))return NRe(DRe(n,e));throw xRe(PRe(e)+" is not iterable")},kRe=Jn,P8=gr,LRe=hy,M8=function(e,t,n){var i,r;P8(e);try{if(!(i=LRe(e,"return"))){if("throw"===t)throw n;return n}i=kRe(i,e)}catch(o){r=!0,i=o}if("throw"===t)throw n;if(r)throw i;return P8(i),n},FRe=rl,URe=Jn,VRe=gr,BRe=Lh,jRe=O8,HRe=dc,x8=Wi,GRe=jD,WRe=wy,k8=M8,zRe=TypeError,Iy=function(e,t){this.stopped=e,this.result=t},L8=Iy.prototype,_g=function(e,t,n){var i,r,o,s,a,c,l,u=!(!n||!n.AS_ENTRIES),h=!(!n||!n.IS_RECORD),p=!(!n||!n.IS_ITERATOR),m=!(!n||!n.INTERRUPTED),f=FRe(t,n&&n.that),g=function(b){return i&&k8(i,"normal",b),new Iy(!0,b)},E=function(b){return u?(VRe(b),m?f(b[0],b[1],g):f(b[0],b[1])):m?f(b,g):f(b)};if(h)i=e.iterator;else if(p)i=e;else{if(!(r=WRe(e)))throw zRe(BRe(e)+" is not iterable");if(jRe(r)){for(o=0,s=HRe(e);s>o;o++)if((a=E(e[o]))&&x8(L8,a))return a;return new Iy(!1)}i=GRe(e,r)}for(c=h?e.next:i.next;!(l=URe(c,i)).done;){try{a=E(l.value)}catch(b){k8(i,"throw",b)}if("object"==typeof a&&a&&x8(L8,a))return a}return new Iy(!1)},KRe=Io,qRe=it,YRe=Wi,$Re=xD,Ry=UIe,F8=gg,HD=ol,GD=tl,QRe=_g,tAe=cn("toStringTag"),Ay=Error,nAe=[].push,Hh=function(e,t){var n,i=YRe(WD,this);Ry?n=Ry(Ay(),i?$Re(this):WD):(n=i?this:F8(WD),HD(n,tAe,"Error")),void 0!==t&&HD(n,"message",function(e,t){return void 0===e?arguments.length<2?"":t:KRe(e)}(t)),function(e,t,n,i){yRe&&(D8?D8(e,t):ERe(e,"stack",function(e,t){if(gRe&&"string"==typeof e&&!R8.prepareStackTrace)for(;t--;)e=fRe(e,A8,"");return e}(n,i)))}(n,Hh,n.stack,1),arguments.length>2&&function(e,t){hRe(t)&&"cause"in t&&pRe(e,"cause",t.cause)}(n,arguments[2]);var r=[];return QRe(e,nAe,{that:r}),HD(n,"errors",r),n};Ry?Ry(Hh,Ay):function(e,t,n){for(var i=XIe(t),r=JIe.f,o=ZIe.f,s=0;s<i.length;s++){var a=i[s];y8(e,a)||n&&y8(n,a)||r(e,a,o(t,a))}}(Hh,Ay,{name:!0});var WD=Hh.prototype=F8(Ay.prototype,{constructor:GD(1,Hh),message:GD(1,""),name:GD(1,"AggregateError")});qRe({global:!0,constructor:!0,arity:2},{AggregateError:Hh});var Dy,vg,Oy,U8=Pn.WeakMap,rAe=zn(U8)&&/native code/.test(String(U8)),oAe=$r,sAe=ol,zD=fi,aAe=Ey,cAe=yy,B8="Object already initialized",qD=Pn.TypeError;if(rAe||mD.state){var ya=mD.state||(mD.state=new(0,Pn.WeakMap));ya.get=ya.get,ya.has=ya.has,ya.set=ya.set,Dy=function(e,t){if(ya.has(e))throw qD(B8);return t.facade=e,ya.set(e,t),t},vg=function(e){return ya.get(e)||{}},Oy=function(e){return ya.has(e)}}else{var Gh=aAe("state");cAe[Gh]=!0,Dy=function(e,t){if(zD(e,Gh))throw qD(B8);return t.facade=e,sAe(e,Gh,t),t},vg=function(e){return zD(e,Gh)?e[Gh]:{}},Oy=function(e){return zD(e,Gh)}}var Td,j8,H8,wd={set:Dy,get:vg,has:Oy,enforce:function(e){return Oy(e)?vg(e):Dy(e,{})},getterFor:function(e){return function(t){var n;if(!oAe(t)||(n=vg(t)).type!==e)throw qD("Incompatible receiver, "+e+" required");return n}}},YD=Co,G8=Function.prototype,uAe=YD&&Object.getOwnPropertyDescriptor,$D=fi(G8,"name"),W8={EXISTS:$D,PROPER:$D&&"something"===function(){}.name,CONFIGURABLE:$D&&(!YD||YD&&uAe(G8,"name").configurable)},hAe=ol,sl=function(e,t,n,i){return i&&i.enumerable?e[t]=n:hAe(e,t,n),e},pAe=Sn,fAe=zn,mAe=$r,gAe=gg,z8=xD,_Ae=sl,XD=cn("iterator"),K8=!1;[].keys&&("next"in(H8=[].keys())?(j8=z8(z8(H8)))!==Object.prototype&&(Td=j8):K8=!0);var vAe=!mAe(Td)||pAe(function(){var e={};return Td[XD].call(e)!==e});fAe((Td=vAe?{}:gAe(Td))[XD])||_Ae(Td,XD,function(){return this});var q8={IteratorPrototype:Td,BUGGY_SAFARI_ITERATORS:K8},EAe=ba,yAe=RD,SAe=Yo.f,CAe=ol,TAe=fi,wAe=RD?{}.toString:function(){return"[object "+EAe(this)+"]"},Y8=cn("toStringTag"),al=function(e,t,n,i){if(e){var r=n?e:e.prototype;TAe(r,Y8)||SAe(r,Y8,{configurable:!0,value:t}),i&&!yAe&&CAe(r,"toString",wAe)}},IAe=q8.IteratorPrototype,RAe=gg,AAe=tl,DAe=al,OAe=Cd,NAe=function(){return this},ZD=function(e,t,n,i){var r=t+" Iterator";return e.prototype=RAe(IAe,{next:AAe(+!i,n)}),DAe(e,r,!1,!0),OAe[r]=NAe,e},PAe=it,MAe=Jn,kAe=ZD,LAe=xD,FAe=al,$8=sl,X8=Cd,VAe=W8.PROPER,Ny=q8.BUGGY_SAFARI_ITERATORS,JD=cn("iterator"),Py="values",J8="entries",BAe=function(){return this},Q8=function(e,t,n,i,r,o,s){kAe(n,t,i);var a,c,l,d=function(E){if(E===r&&f)return f;if(!Ny&&E in p)return p[E];switch(E){case"keys":case Py:case J8:return function(){return new n(this,E)}}return function(){return new n(this)}},u=t+" Iterator",h=!1,p=e.prototype,m=p[JD]||p["@@iterator"]||r&&p[r],f=!Ny&&m||d(r),g="Array"==t&&p.entries||m;if(g&&(a=LAe(g.call(new e)))!==Object.prototype&&a.next&&(FAe(a,u,!0,!0),X8[u]=BAe),VAe&&r==Py&&m&&m.name!==Py&&(h=!0,f=function(){return MAe(m,this)}),r)if(c={values:d(Py),keys:o?f:d("keys"),entries:d(J8)},s)for(l in c)(Ny||h||!(l in p))&&$8(p,l,c[l]);else PAe({target:t,proto:!0,forced:Ny||h},c);return s&&p[JD]!==f&&$8(p,JD,f,{name:r}),X8[t]=f,c},QD=function(e,t){return{value:e,done:t}},jAe=nl,eG=Cd,HAe=Q8,nG=QD,iG="Array Iterator",GAe=wd.set,WAe=wd.getterFor(iG);HAe(Array,"Array",function(e,t){GAe(this,{type:iG,target:jAe(e),index:0,kind:t})},function(){var e=WAe(this),t=e.target,n=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,nG(void 0,!0)):nG("keys"==n?i:"values"==n?t[i]:[i,t[i]],!1)},"values"),eG.Arguments=eG.Array;var zAe=Yo,My=function(e,t,n){return zAe.f(e,t,n)},KAe=Or,qAe=My,YAe=Co,rG=cn("species"),$Ae=Wi,XAe=TypeError,eO=function(e,t){if($Ae(t,e))return e;throw XAe("Incorrect invocation")},ZAe=zn,tO=mD,JAe=_n(Function.toString);ZAe(tO.inspectSource)||(tO.inspectSource=function(e){return JAe(e)});var oG=tO.inspectSource,QAe=_n,eDe=Sn,sG=zn,tDe=ba,nDe=oG,aG=function(){},iDe=[],cG=Or("Reflect","construct"),nO=/^\s*(?:class|function)\b/,rDe=QAe(nO.exec),oDe=!nO.exec(aG),Eg=function(e){if(!sG(e))return!1;try{return cG(aG,iDe,e),!0}catch{return!1}},lG=function(e){if(!sG(e))return!1;switch(tDe(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return oDe||!!rDe(nO,nDe(e))}catch{return!0}};lG.sham=!0;var bg,Wh,dG,iO,xy=!cG||eDe(function(){var e;return Eg(Eg.call)||!Eg(Object)||!Eg(function(){e=!0})||e})?lG:Eg,sDe=xy,aDe=Lh,cDe=TypeError,uG=gr,dDe=Mh,uDe=cn("species"),rO=function(e,t){var n,i=uG(e).constructor;return void 0===i||dDe(n=uG(i)[uDe])?t:function(e){if(sDe(e))return e;throw cDe(aDe(e)+" is not a constructor")}(n)},ky=_n([].slice),hDe=TypeError,zh=function(e,t){if(e<t)throw hDe("Not enough arguments");return e},hG=/(?:ipad|iphone|ipod).*applewebkit/i.test(il),Ro=Pn,pDe=sy,fDe=rl,pG=zn,mDe=fi,fG=Sn,mG=S8,gDe=ky,gG=ED,_De=zh,vDe=hG,EDe=jh,oO=Ro.setImmediate,sO=Ro.clearImmediate,bDe=Ro.process,aO=Ro.Dispatch,yDe=Ro.Function,_G=Ro.MessageChannel,SDe=Ro.String,cO=0,yg={},vG="onreadystatechange";fG(function(){bg=Ro.location});var lO=function(e){if(mDe(yg,e)){var t=yg[e];delete yg[e],t()}},dO=function(e){return function(){lO(e)}},EG=function(e){lO(e.data)},bG=function(e){Ro.postMessage(SDe(e),bg.protocol+"//"+bg.host)};oO&&sO||(oO=function(e){_De(arguments.length,1);var t=pG(e)?e:yDe(e),n=gDe(arguments,1);return yg[++cO]=function(){pDe(t,void 0,n)},Wh(cO),cO},sO=function(e){delete yg[e]},EDe?Wh=function(e){bDe.nextTick(dO(e))}:aO&&aO.now?Wh=function(e){aO.now(dO(e))}:_G&&!vDe?(iO=(dG=new _G).port2,dG.port1.onmessage=EG,Wh=fDe(iO.postMessage,iO)):Ro.addEventListener&&pG(Ro.postMessage)&&!Ro.importScripts&&bg&&"file:"!==bg.protocol&&!fG(bG)?(Wh=bG,Ro.addEventListener("message",EG,!1)):Wh=vG in gG("script")?function(e){mG.appendChild(gG("script"))[vG]=function(){mG.removeChild(this),lO(e)}}:function(e){setTimeout(dO(e),0)});var Ly={set:oO,clear:sO},yG=function(){this.head=null,this.tail=null};yG.prototype={add:function(e){var t={item:e,next:null},n=this.tail;n?n.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var Kh,uO,hO,pO,SG,CG=yG,CDe=/ipad|iphone|ipod/i.test(il)&&typeof Pebble<"u",TDe=/web0s(?!.*chrome)/i.test(il),Id=Pn,TG=rl,fO=Ly.set,IDe=CG,RDe=hG,ADe=CDe,DDe=TDe,mO=jh,wG=Id.MutationObserver||Id.WebKitMutationObserver,IG=Id.document,RG=Id.process,Fy=Id.Promise,AG=(0,hg.f)(Id,"queueMicrotask"),gO=AG&&AG.value;if(!gO){var Uy=new IDe,Vy=function(){var e,t;for(mO&&(e=RG.domain)&&e.exit();t=Uy.get();)try{t()}catch(n){throw Uy.head&&Kh(),n}e&&e.enter()};RDe||mO||DDe||!wG||!IG?!ADe&&Fy&&Fy.resolve?((pO=Fy.resolve(void 0)).constructor=Fy,SG=TG(pO.then,pO),Kh=function(){SG(Vy)}):mO?Kh=function(){RG.nextTick(Vy)}:(fO=TG(fO,Id),Kh=function(){fO(Vy)}):(uO=!0,hO=IG.createTextNode(""),new wG(Vy).observe(hO,{characterData:!0}),Kh=function(){hO.data=uO=!uO}),gO=function(e){Uy.head||Kh(),Uy.add(e)}}var DG=gO,qh=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},Rd=Pn.Promise,OG="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,ODe=!OG&&!jh&&"object"==typeof window&&"object"==typeof document,NDe=Pn,Sg=Rd,PDe=zn,MDe=Q6,xDe=oG,LDe=ODe,FDe=OG,_O=yd,NG=Sg&&Sg.prototype,UDe=cn("species"),PG=!1,MG=PDe(NDe.PromiseRejectionEvent),VDe=MDe("Promise",function(){var e=xDe(Sg),t=e!==String(Sg);if(!t&&66===_O||!NG.catch||!NG.finally)return!0;if(!_O||_O<51||!/native code/.test(e)){var n=new Sg(function(r){r(1)}),i=function(r){r(function(){},function(){})};if((n.constructor={})[UDe]=i,!(PG=n.then(function(){})instanceof i))return!0}return!t&&(LDe||FDe)&&!MG}),Cg={CONSTRUCTOR:VDe,REJECTION_EVENT:MG,SUBCLASSING:PG},Sa={},xG=wo,BDe=TypeError,jDe=function(e){var t,n;this.promise=new e(function(i,r){if(void 0!==t||void 0!==n)throw BDe("Bad Promise constructor");t=i,n=r}),this.resolve=xG(t),this.reject=xG(n)};Sa.f=function(e){return new jDe(e)};var vO,kG,t,HDe=it,By=jh,cl=Pn,Tg=Jn,GDe=sl,WDe=al,KDe=wo,EO=zn,qDe=$r,YDe=eO,$De=rO,LG=Ly.set,bO=DG,ZDe=qh,JDe=CG,FG=wd,yO=Rd,VG=Sa,jy="Promise",BG=Cg.CONSTRUCTOR,QDe=Cg.REJECTION_EVENT,SO=FG.getterFor(jy),eOe=FG.set,wg=yO,CO=yO&&yO.prototype,jG=cl.TypeError,TO=cl.document,wO=cl.process,IO=VG.f,nOe=IO,iOe=!!(TO&&TO.createEvent&&cl.dispatchEvent),HG="unhandledrejection",GG=function(e){var t;return!(!qDe(e)||!EO(t=e.then))&&t},WG=function(e,t){var n,i,r,o=t.value,s=1==t.state,a=s?e.ok:e.fail,c=e.resolve,l=e.reject,d=e.domain;try{a?(s||(2===t.rejection&&oOe(t),t.rejection=1),!0===a?n=o:(d&&d.enter(),n=a(o),d&&(d.exit(),r=!0)),n===e.promise?l(jG("Promise-chain cycle")):(i=GG(n))?Tg(i,n,c,l):c(n)):l(o)}catch(u){d&&!r&&d.exit(),l(u)}},zG=function(e,t){e.notified||(e.notified=!0,bO(function(){for(var n,i=e.reactions;n=i.get();)WG(n,e);e.notified=!1,t&&!e.rejection&&rOe(e)}))},KG=function(e,t,n){var i,r;iOe?((i=TO.createEvent("Event")).promise=t,i.reason=n,i.initEvent(e,!1,!0),cl.dispatchEvent(i)):i={promise:t,reason:n},!QDe&&(r=cl["on"+e])?r(i):e===HG&&function(e,t){try{1==arguments.length?console.error(e):console.error(e,t)}catch{}}("Unhandled promise rejection",n)},rOe=function(e){Tg(LG,cl,function(){var t,n=e.facade,i=e.value;if(qG(e)&&(t=ZDe(function(){By?wO.emit("unhandledRejection",i,n):KG(HG,n,i)}),e.rejection=By||qG(e)?2:1,t.error))throw t.value})},qG=function(e){return 1!==e.rejection&&!e.parent},oOe=function(e){Tg(LG,cl,function(){var t=e.facade;By?wO.emit("rejectionHandled",t):KG("rejectionhandled",t,e.value)})},Yh=function(e,t,n){return function(i){e(t,i,n)}},$h=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,zG(e,!0))},RO=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw jG("Promise can't be resolved itself");var i=GG(t);i?bO(function(){var r={done:!1};try{Tg(i,t,Yh(RO,r,e),Yh($h,r,e))}catch(o){$h(r,o,e)}}):(e.value=t,e.state=1,zG(e,!1))}catch(r){$h({done:!1},r,e)}}};BG&&(CO=(wg=function(e){YDe(this,CO),KDe(e),Tg(vO,this);var t=SO(this);try{e(Yh(RO,t),Yh($h,t))}catch(n){$h(t,n)}}).prototype,(vO=function(e){eOe(this,{type:jy,done:!1,notified:!1,parent:!1,reactions:new JDe,rejection:!1,state:0,value:void 0})}).prototype=GDe(CO,"then",function(e,t){var n=SO(this),i=IO($De(this,wg));return n.parent=!0,i.ok=!EO(e)||e,i.fail=EO(t)&&t,i.domain=By?wO.domain:void 0,0==n.state?n.reactions.add(i):bO(function(){WG(i,n)}),i.promise}),kG=function(){var e=new vO,t=SO(e);this.promise=e,this.resolve=Yh(RO,t),this.reject=Yh($h,t)},VG.f=IO=function(e){return e===wg||void 0===e?new kG(e):nOe(e)}),HDe({global:!0,constructor:!0,wrap:!0,forced:BG},{Promise:wg}),WDe(wg,jy,!1,!0),t=KAe(jy),YAe&&t&&!t[rG]&&qAe(t,rG,{configurable:!0,get:function(){return this}});var YG=cn("iterator"),$G=!1;try{var sOe=0,XG={next:function(){return{done:!!sOe++}},return:function(){$G=!0}};XG[YG]=function(){return this},Array.from(XG,function(){throw 2})}catch{}var aOe=Rd,Hy=Cg.CONSTRUCTOR||!function(e,t){if(!$G)return!1;var n=!1;try{var i={};i[YG]=function(){return{next:function(){return{done:n=!0}}}},function(e){aOe.all(e).then(void 0,function(){})}(i)}catch{}return n}(),lOe=Jn,dOe=wo,uOe=Sa,hOe=qh,pOe=_g;it({target:"Promise",stat:!0,forced:Hy},{all:function(e){var t=this,n=uOe.f(t),i=n.resolve,r=n.reject,o=hOe(function(){var s=dOe(t.resolve),a=[],c=0,l=1;pOe(e,function(d){var u=c++,h=!1;l++,lOe(s,t,d).then(function(p){h||(h=!0,a[u]=p,--l||i(a))},r)}),--l||i(a)});return o.error&&r(o.value),n.promise}}),it({target:"Promise",proto:!0,forced:Cg.CONSTRUCTOR,real:!0},{catch:function(e){return this.then(void 0,e)}});var gOe=Jn,_Oe=wo,vOe=Sa,EOe=qh,bOe=_g;it({target:"Promise",stat:!0,forced:Hy},{race:function(e){var t=this,n=vOe.f(t),i=n.reject,r=EOe(function(){var o=_Oe(t.resolve);bOe(e,function(s){gOe(o,t,s).then(n.resolve,i)})});return r.error&&i(r.value),n.promise}});var yOe=Jn,SOe=Sa;it({target:"Promise",stat:!0,forced:Cg.CONSTRUCTOR},{reject:function(e){var t=SOe.f(this);return yOe(t.reject,void 0,e),t.promise}});var COe=gr,TOe=$r,wOe=Sa,ZG=function(e,t){if(COe(e),TOe(t)&&t.constructor===e)return t;var n=wOe.f(e);return(0,n.resolve)(t),n.promise},IOe=it,ROe=Rd,AOe=Cg.CONSTRUCTOR,DOe=ZG,OOe=Or("Promise"),NOe=!AOe;IOe({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return DOe(NOe&&this===OOe?ROe:this,e)}});var POe=Jn,MOe=wo,xOe=Sa,kOe=qh,LOe=_g;it({target:"Promise",stat:!0,forced:Hy},{allSettled:function(e){var t=this,n=xOe.f(t),i=n.resolve,r=n.reject,o=kOe(function(){var s=MOe(t.resolve),a=[],c=0,l=1;LOe(e,function(d){var u=c++,h=!1;l++,POe(s,t,d).then(function(p){h||(h=!0,a[u]={status:"fulfilled",value:p},--l||i(a))},function(p){h||(h=!0,a[u]={status:"rejected",reason:p},--l||i(a))})}),--l||i(a)});return o.error&&r(o.value),n.promise}});var FOe=Jn,UOe=wo,VOe=Or,BOe=Sa,jOe=qh,HOe=_g,JG="No one promise resolved";it({target:"Promise",stat:!0,forced:Hy},{any:function(e){var t=this,n=VOe("AggregateError"),i=BOe.f(t),r=i.resolve,o=i.reject,s=jOe(function(){var a=UOe(t.resolve),c=[],l=0,d=1,u=!1;HOe(e,function(h){var p=l++,m=!1;d++,FOe(a,t,h).then(function(f){m||u||(u=!0,r(f))},function(f){m||u||(m=!0,c[p]=f,--d||o(new n(c,JG)))})}),--d||o(new n(c,JG))});return s.error&&o(s.value),i.promise}});var zOe=Or,KOe=zn,qOe=rO,QG=ZG,YOe=Rd&&Rd.prototype;it({target:"Promise",proto:!0,real:!0,forced:!!Rd&&Sn(function(){YOe.finally.call({then:function(){}},function(){})})},{finally:function(e){var t=qOe(this,zOe("Promise")),n=KOe(e);return this.then(n?function(i){return QG(t,e()).then(function(){return i})}:e,n?function(i){return QG(t,e()).then(function(){throw i})}:e)}});var DO=_n,$Oe=TD,XOe=Io,ZOe=xh,JOe=DO("".charAt),eW=DO("".charCodeAt),QOe=DO("".slice),tW=function(e){return function(t,n){var i,r,o=XOe(ZOe(t)),s=$Oe(n),a=o.length;return s<0||s>=a?e?"":void 0:(i=eW(o,s))<55296||i>56319||s+1===a||(r=eW(o,s+1))<56320||r>57343?e?JOe(o,s):i:e?QOe(o,s,s+2):r-56320+(i-55296<<10)+65536}},OO={codeAt:tW(!1),charAt:tW(!0)},eNe=OO.charAt,tNe=Io,nNe=Q8,iW=QD,rW="String Iterator",iNe=wd.set,rNe=wd.getterFor(rW);nNe(String,"String",function(e){iNe(this,{type:rW,string:tNe(e),index:0})},function(){var e,t=rNe(this),n=t.string,i=t.index;return i>=n.length?iW(void 0,!0):(e=eNe(n,i),t.index+=e.length,iW(e,!1))});var oNe=To.Promise,aNe=Pn,cNe=ba,lNe=ol,oW=Cd,sW=cn("toStringTag");for(var NO in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var aW=aNe[NO],PO=aW&&aW.prototype;PO&&cNe(PO)!==sW&&lNe(PO,sW,NO),oW[NO]=oW.Array}var cW=oNe,q=Vt(cW);const lW=p8;function dW(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(s){if("object"!=typeof s||s.mandatory||s.optional)return s;const a={};return Object.keys(s).forEach(c=>{if("require"===c||"advanced"===c||"mediaSource"===c)return;const l="object"==typeof s[c]?s[c]:{ideal:s[c]};void 0!==l.exact&&"number"==typeof l.exact&&(l.min=l.max=l.exact);const d=function(u,h){return u?u+h.charAt(0).toUpperCase()+h.slice(1):"deviceId"===h?"sourceId":h};if(void 0!==l.ideal){a.optional=a.optional||[];let u={};"number"==typeof l.ideal?(u[d("min",c)]=l.ideal,a.optional.push(u),u={},u[d("max",c)]=l.ideal,a.optional.push(u)):(u[d("",c)]=l.ideal,a.optional.push(u))}void 0!==l.exact&&"number"!=typeof l.exact?(a.mandatory=a.mandatory||{},a.mandatory[d("",c)]=l.exact):["min","max"].forEach(u=>{void 0!==l[u]&&(a.mandatory=a.mandatory||{},a.mandatory[d(u,c)]=l[u])})}),s.advanced&&(a.optional=(a.optional||[]).concat(s.advanced)),a},r=function(s,a){if(t.version>=61)return a(s);if((s=JSON.parse(JSON.stringify(s)))&&"object"==typeof s.audio){const c=function(l,d,u){d in l&&!(u in l)&&(l[u]=l[d],delete l[d])};c((s=JSON.parse(JSON.stringify(s))).audio,"autoGainControl","googAutoGainControl"),c(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=i(s.audio)}if(s&&"object"==typeof s.video){let c=s.video.facingMode;c=c&&("object"==typeof c?c:{ideal:c});const l=t.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||l)){let d;if(delete s.video.facingMode,"environment"===c.exact||"environment"===c.ideal?d=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(u=>{let h=(u=u.filter(p=>"videoinput"===p.kind)).find(p=>d.some(m=>{var f;return Y(f=p.label.toLowerCase()).call(f,m)}));return!h&&u.length&&Y(d).call(d,"back")&&(h=u[u.length-1]),h&&(s.video.deviceId=c.exact?{exact:h.deviceId}:{ideal:h.deviceId}),s.video=i(s.video),lW("chrome: "+JSON.stringify(s)),a(s)})}s.video=i(s.video)}return lW("chrome: "+JSON.stringify(s)),a(s)},o=function(s){return t.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(s,a,c){r(s,l=>{n.webkitGetUserMedia(l,a,d=>{c&&c(o(d))})})}.bind(n),n.mediaDevices.getUserMedia){const s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(a){return r(a,c=>s(c).then(l=>{if(c.audio&&!l.getAudioTracks().length||c.video&&!l.getVideoTracks().length)throw l.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return l},l=>q.reject(o(l))))}}}function uW(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function hW(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",i=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(s=>s.track&&s.track.id===i.track.id):{track:i.track};const o=new Event("track");o.track=i.track,o.receiver=r,o.transceiver={receiver:r},o.streams=[n.stream],this.dispatchEvent(o)}),n.stream.getTracks().forEach(i=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(s=>s.track&&s.track.id===i.id):{track:i};const o=new Event("track");o.track=i,o.receiver=r,o.transceiver={receiver:r},o.streams=[n.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Sd(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function pW(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(r,o){return{track:o,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===o.kind?r.createDTMFSender(o):null),this._dtmf},_pc:r}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(s,a){let c=r.apply(this,arguments);return c||(c=t(this,s),this._senders.push(c)),c};const o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(s){o.apply(this,arguments);const a=this._senders.indexOf(s);-1!==a&&this._senders.splice(a,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(r){this._senders=this._senders||[],n.apply(this,[r]),r.getTracks().forEach(o=>{this._senders.push(t(this,o))})};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(r){this._senders=this._senders||[],i.apply(this,[r]),r.getTracks().forEach(o=>{const s=this._senders.find(a=>a.track===o);s&&this._senders.splice(this._senders.indexOf(s),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const n=t.apply(this,[]);return n.forEach(i=>i._pc=this),n},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}}function fW(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[n,i,r]=arguments;if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);const o=function(a){const c={};return a.result().forEach(l=>{const d={id:l.id,timestamp:l.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[l.type]||l.type};l.names().forEach(u=>{d[u]=l.stat(u)}),c[d.id]=d}),c},s=function(a){return new Map(Object.keys(a).map(c=>[c,a[c]]))};return arguments.length>=2?t.apply(this,[function(c){i(s(o(c)))},n]):new q((a,c)=>{t.apply(this,[function(l){a(s(o(l)))},c])}).then(i,r)}}function mW(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const n=e.RTCPeerConnection.prototype.getSenders;n&&(e.RTCPeerConnection.prototype.getSenders=function(){const r=n.apply(this,[]);return r.forEach(o=>o._pc=this),r});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){const r=i.apply(this,arguments);return r._pc=this,r}),e.RTCRtpSender.prototype.getStats=function(){const r=this;return this._pc.getStats().then(o=>g8(o,r.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(r=>r._pc=this),i}),Sd(e,"track",i=>(i.receiver._pc=i.srcElement,i)),e.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(r=>g8(r,i.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const n=arguments[0];let i,r,o;return this.getSenders().forEach(s=>{s.track===n&&(i?o=!0:i=s)}),this.getReceivers().forEach(s=>(s.track===n&&(r?o=!0:r=s),s.track===n)),o||i&&r?q.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():r?r.getStats():q.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function gW(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(o,s){if(!s)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const a=t.apply(this,arguments);return this._shimmedLocalStreams[s.id]?-1===this._shimmedLocalStreams[s.id].indexOf(a)&&this._shimmedLocalStreams[s.id].push(a):this._shimmedLocalStreams[s.id]=[s,a],a};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(c=>{if(this.getSenders().find(d=>d.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const s=this.getSenders();n.apply(this,arguments);const a=this.getSenders().filter(c=>-1===s.indexOf(c));this._shimmedLocalStreams[o.id]=[o].concat(a)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],i.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(s=>{const a=this._shimmedLocalStreams[s].indexOf(o);-1!==a&&this._shimmedLocalStreams[s].splice(a,1),1===this._shimmedLocalStreams[s].length&&delete this._shimmedLocalStreams[s]}),r.apply(this,arguments)}}function _W(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return gW(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const c=n.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(l=>this._reverseStreams[l.id])};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(l=>{if(this.getSenders().find(u=>u.track===l))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){const l=new e.MediaStream(c.getTracks());this._streams[c.id]=l,this._reverseStreams[l.id]=c,c=l}i.apply(this,[c])};const r=e.RTCPeerConnection.prototype.removeStream;function o(c,l){let d=l.sdp;return Object.keys(c._reverseStreams||[]).forEach(u=>{const h=c._reverseStreams[u];d=d.replace(new RegExp(c._streams[h.id].id,"g"),h.id)}),new RTCSessionDescription({type:l.type,sdp:d})}e.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},e.RTCPeerConnection.prototype.addTrack=function(c,l){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const d=[].slice.call(arguments,1);if(1!==d.length||!d[0].getTracks().find(p=>p===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(p=>p.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const h=this._streams[l.id];if(h)h.addTrack(c),q.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const p=new e.MediaStream([c]);this._streams[l.id]=p,this._reverseStreams[p.id]=l,this.addStream(p)}return this.getSenders().find(p=>p.track===c)},["createOffer","createAnswer"].forEach(function(c){const l=e.RTCPeerConnection.prototype[c],d={[c](){const u=arguments;return arguments.length&&"function"==typeof arguments[0]?l.apply(this,[h=>{const p=o(this,h);u[0].apply(null,[p])},h=>{u[1]&&u[1].apply(null,h)},arguments[2]]):l.apply(this,arguments).then(h=>o(this,h))}};e.RTCPeerConnection.prototype[c]=d[c]});const s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(c,l){let d=l.sdp;return Object.keys(c._reverseStreams||[]).forEach(u=>{const h=c._reverseStreams[u],p=c._streams[h.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:l.type,sdp:d})}(this,arguments[0]),s.apply(this,arguments)):s.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const c=a.get.apply(this);return""===c.type?c:o(this,c)}}),e.RTCPeerConnection.prototype.removeTrack=function(c){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(c._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let l;this._streams=this._streams||{},Object.keys(this._streams).forEach(d=>{this._streams[d].getTracks().find(u=>c.track===u)&&(l=this._streams[d])}),l&&(1===l.getTracks().length?this.removeStream(this._reverseStreams[l.id]):l.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function MO(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const i=e.RTCPeerConnection.prototype[n],r={[n](){return arguments[0]=new("addIceCandidate"===n?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[n]=r[n]})}function vW(e,t){Sd(e,"negotiationneeded",n=>{const i=n.target;if(!(t.version<72||i.getConfiguration&&"plan-b"===i.getConfiguration().sdpSemantics)||"stable"===i.signalingState)return n})}var EW=Object.freeze({__proto__:null,fixNegotiationNeeded:vW,shimAddTrackRemoveTrack:_W,shimAddTrackRemoveTrackWithNative:gW,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(i=>{const r=n.video&&n.video.width,o=n.video&&n.video.height;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:n.video&&n.video.frameRate||3}},r&&(n.video.mandatory.maxWidth=r),o&&(n.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:pW,shimGetStats:fW,shimGetUserMedia:dW,shimMediaStream:uW,shimOnTrack:hW,shimPeerConnection:MO,shimSenderReceiverGetStats:mW});function bW(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(r,o,s){ND("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(r).then(o,s)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const r=function(s,a,c){a in s&&!(c in s)&&(s[c]=s[a],delete s[a])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(s){return"object"==typeof s&&"object"==typeof s.audio&&(s=JSON.parse(JSON.stringify(s)),r(s.audio,"autoGainControl","mozAutoGainControl"),r(s.audio,"noiseSuppression","mozNoiseSuppression")),o(s)},i&&i.prototype.getSettings){const s=i.prototype.getSettings;i.prototype.getSettings=function(){const a=s.apply(this,arguments);return r(a,"mozAutoGainControl","autoGainControl"),r(a,"mozNoiseSuppression","noiseSuppression"),a}}if(i&&i.prototype.applyConstraints){const s=i.prototype.applyConstraints;i.prototype.applyConstraints=function(a){return"audio"===this.kind&&"object"==typeof a&&(a=JSON.parse(JSON.stringify(a)),r(a,"autoGainControl","mozAutoGainControl"),r(a,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[a])}}}}function yW(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function xO(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const o=e.RTCPeerConnection.prototype[r],s={[r](){return arguments[0]=new("addIceCandidate"===r?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};e.RTCPeerConnection.prototype[r]=s[r]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[r,o,s]=arguments;return i.apply(this,[r||null]).then(a=>{if(t.version<53&&!o)try{a.forEach(c=>{c.type=n[c.type]||c.type})}catch(c){if("TypeError"!==c.name)throw c;a.forEach((l,d)=>{a.set(d,Object.assign({},l,{type:n[l.type]||l.type}))})}return a}).then(o,s)}}function SW(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=t.apply(this,[]);return i.forEach(r=>r._pc=this),i});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):q.resolve(new Map)}}function CW(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const n=t.apply(this,[]);return n.forEach(i=>i._pc=this),n}),Sd(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function TW(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(t){ND("removeStream","removeTrack"),this.getSenders().forEach(n=>{var i;n.track&&Y(i=t.getTracks()).call(i,n.track)&&this.removeTrack(n)})})}function wW(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function IW(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;void 0===n&&(n=[]),n=[...n];const i=n.length>0;i&&n.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const r=t.apply(this,arguments);if(i){const{sender:o}=r,s=o.getParameters();(!("encodings"in s)||1===s.encodings.length&&0===Object.keys(s.encodings[0]).length)&&(s.encodings=n,o.sendEncodings=n,this.setParametersPromises.push(o.setParameters(s).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return r})}function RW(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const n=t.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function AW(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?q.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function DW(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?q.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var OW=Object.freeze({__proto__:null,shimAddTransceiver:IW,shimCreateAnswer:DW,shimCreateOffer:AW,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,q.reject(i)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:RW,shimGetUserMedia:bW,shimOnTrack:yW,shimPeerConnection:xO,shimRTCDataChannel:wW,shimReceiverGetStats:CW,shimRemoveStream:TW,shimSenderGetStats:SW});function NW(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(n){var i;this._localStreams||(this._localStreams=[]),Y(i=this._localStreams).call(i,n)||this._localStreams.push(n),n.getAudioTracks().forEach(r=>t.call(this,r,n)),n.getVideoTracks().forEach(r=>t.call(this,r,n))},e.RTCPeerConnection.prototype.addTrack=function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return r&&r.forEach(s=>{var a;this._localStreams?Y(a=this._localStreams).call(a,s)||this._localStreams.push(s):this._localStreams=[s]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(t);if(-1===n)return;this._localStreams.splice(n,1);const i=t.getTracks();this.getSenders().forEach(r=>{Y(i).call(i,r.track)&&this.removeTrack(r)})})}}function PW(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(r=>{var o;if(this._remoteStreams||(this._remoteStreams=[]),Y(o=this._remoteStreams).call(o,r))return;this._remoteStreams.push(r);const s=new Event("addstream");s.stream=r,this.dispatchEvent(s)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(r=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(r)>=0)return;n._remoteStreams.push(r);const o=new Event("addstream");o.stream=r,n.dispatchEvent(o)})}),t.apply(n,arguments)}}}function MW(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(c,l){const u=n.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return l?(u.then(c,l),q.resolve()):u},t.createAnswer=function(c,l){const u=i.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return l?(u.then(c,l),q.resolve()):u};let a=function(c,l,d){const u=r.apply(this,[c]);return d?(u.then(l,d),q.resolve()):u};t.setLocalDescription=a,a=function(c,l,d){const u=o.apply(this,[c]);return d?(u.then(l,d),q.resolve()):u},t.setRemoteDescription=a,a=function(c,l,d){const u=s.apply(this,[c]);return d?(u.then(l,d),q.resolve()):u},t.addIceCandidate=a}function xW(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const n=t.mediaDevices,i=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=r=>i(kW(r))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(n,i,r){t.mediaDevices.getUserMedia(n).then(i,r)}.bind(t))}function kW(e){return e&&void 0!==e.video?Object.assign({},e,{video:m8(e.video)}):e}function LW(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(n,i){if(n&&n.iceServers){const r=[];for(let o=0;o<n.iceServers.length;o++){let s=n.iceServers[o];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(ND("RTCIceServer.url","RTCIceServer.urls"),s=JSON.parse(JSON.stringify(s)),s.urls=s.url,delete s.url,r.push(s)):r.push(n.iceServers[o])}n.iceServers=r}return new t(n,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function FW(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function UW(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(n){if(n){void 0!==n.offerToReceiveAudio&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const i=this.getTransceivers().find(o=>"audio"===o.receiver.track.kind);!1===n.offerToReceiveAudio&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==n.offerToReceiveAudio||i||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==n.offerToReceiveVideo&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const r=this.getTransceivers().find(o=>"video"===o.receiver.track.kind);!1===n.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==n.offerToReceiveVideo||r||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function VW(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var e,BW=Object.freeze({__proto__:null,shimAudioContext:VW,shimCallbacksAPI:MW,shimConstraints:kW,shimCreateOfferLegacy:UW,shimGetUserMedia:xW,shimLocalStreamsAPI:NW,shimRTCIceServerUrls:LW,shimRemoteStreamsAPI:PW,shimTrackEventTransceiver:FW}),jW="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",dNe=xh,uNe=Io,kO=jW,HW=_n("".replace),hNe=RegExp("^["+kO+"]+"),pNe=RegExp("(^|[^"+kO+"])["+kO+"]+$"),LO=function(e){return function(t){var n=uNe(dNe(t));return 1&e&&(n=HW(n,hNe,"")),2&e&&(n=HW(n,pNe,"$1")),n}},fNe={start:LO(1),end:LO(2),trim:LO(3)},mNe=W8.PROPER,GW=jW,_Ne=fNe.trim;it({target:"String",proto:!0,forced:(e="trim",Sn(function(){return!!GW[e]()||"\u200b\x85\u180e"!=="\u200b\x85\u180e"[e]()||mNe&&GW[e].name!==e}))},{trim:function(){return _Ne(this)}});var vNe=$o("String").trim,ENe=Wi,bNe=vNe,FO=String.prototype,ki=Vt(function(e){var t=e.trim;return"string"==typeof e||e===FO||ENe(FO,e)&&t===FO.trim?bNe:t}),WW={exports:{}};!function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(n){return n.trim().split("\n").map(i=>i.trim())},t.splitSections=function(n){return n.split("\nm=").map((i,r)=>(r>0?"m="+i:i).trim()+"\r\n")},t.getDescription=function(n){const i=t.splitSections(n);return i&&i[0]},t.getMediaSections=function(n){const i=t.splitSections(n);return i.shift(),i},t.matchPrefix=function(n,i){return t.splitLines(n).filter(r=>0===r.indexOf(i))},t.parseCandidate=function(n){let i;i=0===n.indexOf("a=candidate:")?n.substring(12).split(" "):n.substring(10).split(" ");const r={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let o=8;o<i.length;o+=2)switch(i[o]){case"raddr":r.relatedAddress=i[o+1];break;case"rport":r.relatedPort=parseInt(i[o+1],10);break;case"tcptype":r.tcpType=i[o+1];break;case"ufrag":r.ufrag=i[o+1],r.usernameFragment=i[o+1];break;default:void 0===r[i[o]]&&(r[i[o]]=i[o+1])}return r},t.writeCandidate=function(n){const i=[];i.push(n.foundation);const r=n.component;i.push("rtp"===r?1:"rtcp"===r?2:r),i.push(n.protocol.toUpperCase()),i.push(n.priority),i.push(n.address||n.ip),i.push(n.port);const o=n.type;return i.push("typ"),i.push(o),"host"!==o&&n.relatedAddress&&n.relatedPort&&(i.push("raddr"),i.push(n.relatedAddress),i.push("rport"),i.push(n.relatedPort)),n.tcpType&&"tcp"===n.protocol.toLowerCase()&&(i.push("tcptype"),i.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(i.push("ufrag"),i.push(n.usernameFragment||n.ufrag)),"candidate:"+i.join(" ")},t.parseIceOptions=function(n){return n.substring(14).split(" ")},t.parseRtpMap=function(n){let i=n.substring(9).split(" ");const r={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),r.name=i[0],r.clockRate=parseInt(i[1],10),r.channels=3===i.length?parseInt(i[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(n){let i=n.payloadType;void 0!==n.preferredPayloadType&&(i=n.preferredPayloadType);const r=n.channels||n.numChannels||1;return"a=rtpmap:"+i+" "+n.name+"/"+n.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(n){const i=n.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},t.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&"sendrecv"!==n.direction?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+"\r\n"},t.parseFmtp=function(n){const i={};let r;const o=n.substring(n.indexOf(" ")+1).split(";");for(let s=0;s<o.length;s++)r=o[s].trim().split("="),i[r[0].trim()]=r[1];return i},t.writeFmtp=function(n){let i="",r=n.payloadType;if(void 0!==n.preferredPayloadType&&(r=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const o=[];Object.keys(n.parameters).forEach(s=>{o.push(void 0!==n.parameters[s]?s+"="+n.parameters[s]:s)}),i+="a=fmtp:"+r+" "+o.join(";")+"\r\n"}return i},t.parseRtcpFb=function(n){const i=n.substring(n.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},t.writeRtcpFb=function(n){let i="",r=n.payloadType;return void 0!==n.preferredPayloadType&&(r=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(o=>{i+="a=rtcp-fb:"+r+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+"\r\n"}),i},t.parseSsrcMedia=function(n){const i=n.indexOf(" "),r={ssrc:parseInt(n.substring(7,i),10)},o=n.indexOf(":",i);return o>-1?(r.attribute=n.substring(i+1,o),r.value=n.substring(o+1)):r.attribute=n.substring(i+1),r},t.parseSsrcGroup=function(n){const i=n.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(r=>parseInt(r,10))}},t.getMid=function(n){const i=t.matchPrefix(n,"a=mid:")[0];if(i)return i.substring(6)},t.parseFingerprint=function(n){const i=n.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},t.getDtlsParameters=function(n,i){return{role:"auto",fingerprints:t.matchPrefix(n+i,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(n,i){let r="a=setup:"+i+"\r\n";return n.fingerprints.forEach(o=>{r+="a=fingerprint:"+o.algorithm+" "+o.value+"\r\n"}),r},t.parseCryptoLine=function(n){const i=n.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},t.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+("object"==typeof n.keyParams?t.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(n){if(0!==n.indexOf("inline:"))return null;const i=n.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},t.getCryptoParameters=function(n,i){return t.matchPrefix(n+i,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(n,i){const r=t.matchPrefix(n+i,"a=ice-ufrag:")[0],o=t.matchPrefix(n+i,"a=ice-pwd:")[0];return r&&o?{usernameFragment:r.substring(12),password:o.substring(10)}:null},t.writeIceParameters=function(n){let i="a=ice-ufrag:"+n.usernameFragment+"\r\na=ice-pwd:"+n.password+"\r\n";return n.iceLite&&(i+="a=ice-lite\r\n"),i},t.parseRtpParameters=function(n){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(n)[0].split(" ");i.profile=r[2];for(let s=3;s<r.length;s++){const a=r[s],c=t.matchPrefix(n,"a=rtpmap:"+a+" ")[0];if(c){const l=t.parseRtpMap(c),d=t.matchPrefix(n,"a=fmtp:"+a+" ");switch(l.parameters=d.length?t.parseFmtp(d[0]):{},l.rtcpFeedback=t.matchPrefix(n,"a=rtcp-fb:"+a+" ").map(t.parseRtcpFb),i.codecs.push(l),l.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(l.name.toUpperCase())}}}t.matchPrefix(n,"a=extmap:").forEach(s=>{i.headerExtensions.push(t.parseExtmap(s))});const o=t.matchPrefix(n,"a=rtcp-fb:* ").map(t.parseRtcpFb);return i.codecs.forEach(s=>{o.forEach(a=>{s.rtcpFeedback.find(c=>c.type===a.type&&c.parameter===a.parameter)||s.rtcpFeedback.push(a)})}),i},t.writeRtpDescription=function(n,i){let r="";r+="m="+n+" ",r+=i.codecs.length>0?"9":"0",r+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=i.codecs.map(s=>void 0!==s.preferredPayloadType?s.preferredPayloadType:s.payloadType).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",i.codecs.forEach(s=>{r+=t.writeRtpMap(s),r+=t.writeFmtp(s),r+=t.writeRtcpFb(s)});let o=0;return i.codecs.forEach(s=>{s.maxptime>o&&(o=s.maxptime)}),o>0&&(r+="a=maxptime:"+o+"\r\n"),i.headerExtensions&&i.headerExtensions.forEach(s=>{r+=t.writeExtmap(s)}),r},t.parseRtpEncodingParameters=function(n){const i=[],r=t.parseRtpParameters(n),o=-1!==r.fecMechanisms.indexOf("RED"),s=-1!==r.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(n,"a=ssrc:").map(h=>t.parseSsrcMedia(h)).filter(h=>"cname"===h.attribute),c=a.length>0&&a[0].ssrc;let l;const d=t.matchPrefix(n,"a=ssrc-group:FID").map(h=>h.substring(17).split(" ").map(p=>parseInt(p,10)));d.length>0&&d[0].length>1&&d[0][0]===c&&(l=d[0][1]),r.codecs.forEach(h=>{if("RTX"===h.name.toUpperCase()&&h.parameters.apt){let p={ssrc:c,codecPayloadType:parseInt(h.parameters.apt,10)};c&&l&&(p.rtx={ssrc:l}),i.push(p),o&&(p=JSON.parse(JSON.stringify(p)),p.fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},i.push(p))}}),0===i.length&&c&&i.push({ssrc:c});let u=t.matchPrefix(n,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,i.forEach(h=>{h.maxBitrate=u})),i},t.parseRtcpParameters=function(n){const i={},r=t.matchPrefix(n,"a=ssrc:").map(a=>t.parseSsrcMedia(a)).filter(a=>"cname"===a.attribute)[0];r&&(i.cname=r.value,i.ssrc=r.ssrc);const o=t.matchPrefix(n,"a=rtcp-rsize");i.reducedSize=o.length>0,i.compound=0===o.length;const s=t.matchPrefix(n,"a=rtcp-mux");return i.mux=s.length>0,i},t.writeRtcpParameters=function(n){let i="";return n.reducedSize&&(i+="a=rtcp-rsize\r\n"),n.mux&&(i+="a=rtcp-mux\r\n"),void 0!==n.ssrc&&n.cname&&(i+="a=ssrc:"+n.ssrc+" cname:"+n.cname+"\r\n"),i},t.parseMsid=function(n){let i;const r=t.matchPrefix(n,"a=msid:");if(1===r.length)return i=r[0].substring(7).split(" "),{stream:i[0],track:i[1]};const o=t.matchPrefix(n,"a=ssrc:").map(s=>t.parseSsrcMedia(s)).filter(s=>"msid"===s.attribute);return o.length>0?(i=o[0].value.split(" "),{stream:i[0],track:i[1]}):void 0},t.parseSctpDescription=function(n){const i=t.parseMLine(n),r=t.matchPrefix(n,"a=max-message-size:");let o;r.length>0&&(o=parseInt(r[0].substring(19),10)),isNaN(o)&&(o=65536);const s=t.matchPrefix(n,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:i.fmt,maxMessageSize:o};const a=t.matchPrefix(n,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:o}}},t.writeSctpDescription=function(n,i){let r=[];return r="DTLS/SCTP"!==n.protocol?["m="+n.kind+" 9 "+n.protocol+" "+i.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+i.port+"\r\n"]:["m="+n.kind+" 9 "+n.protocol+" "+i.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+i.port+" "+i.protocol+" 65535\r\n"],void 0!==i.maxMessageSize&&r.push("a=max-message-size:"+i.maxMessageSize+"\r\n"),r.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(n,i,r){let o;const s=void 0!==i?i:2;return o=n||t.generateSessionId(),"v=0\r\no="+(r||"thisisadapterortc")+" "+o+" "+s+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(n,i){const r=t.splitLines(n);for(let o=0;o<r.length;o++)switch(r[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[o].substring(2)}return i?t.getDirection(i):"sendrecv"},t.getKind=function(n){return t.splitLines(n)[0].split(" ")[0].substring(2)},t.isRejected=function(n){return"0"===n.split(" ",2)[1]},t.parseMLine=function(n){const i=t.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},t.parseOLine=function(n){const i=t.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},t.isValidSDP=function(n){if("string"!=typeof n||0===n.length)return!1;const i=t.splitLines(n);for(let r=0;r<i.length;r++)if(i[r].length<2||"="!==i[r].charAt(1))return!1;return!0},e.exports=t}(WW);var zW=WW.exports,Xh=Vt(zW),SNe=function HTe(e,t){return t.forEach(function(n){n&&"string"!=typeof n&&!Array.isArray(n)&&Object.keys(n).forEach(function(i){if("default"!==i&&!(i in e)){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}})}),Object.freeze(e)}({__proto__:null,default:Xh},[zW]);function Gy(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(n){if("object"==typeof n&&n.candidate&&0===n.candidate.indexOf("a=")&&((n=JSON.parse(JSON.stringify(n))).candidate=n.candidate.substr(2)),n.candidate&&n.candidate.length){const i=new t(n),r=Xh.parseCandidate(n.candidate),o=Object.assign(i,r);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(n)},e.RTCIceCandidate.prototype=t.prototype,Sd(e,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new e.RTCIceCandidate(n.candidate),writable:"false"}),n))}function UO(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Sd(e,"icecandidate",t=>{if(t.candidate){const n=Xh.parseCandidate(t.candidate.candidate);"relay"===n.type&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return t})}function Wy(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:a}=this.getConfiguration();"plan-b"===a&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(a){if(!a||!a.sdp)return!1;const c=Xh.splitSections(a.sdp);return c.shift(),c.some(l=>{const d=Xh.parseMLine(l);return d&&"application"===d.kind&&-1!==d.protocol.indexOf("SCTP")})}(arguments[0])){const a=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===c||c.length<2)return-1;const l=parseInt(c[1],10);return l!=l?-1:l}(arguments[0]),c=function(a){let c=65536;return"firefox"===t.browser&&(c=t.version<57?-1===a?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),c}(a),l=function(a,c){let l=65536;"firefox"===t.browser&&57===t.version&&(l=65535);const d=Xh.matchPrefix(a.sdp,"a=max-message-size:");return d.length>0?l=parseInt(d[0].substr(19),10):"firefox"===t.browser&&-1!==c&&(l=2147483637),l}(arguments[0],a);let d;d=0===c&&0===l?Number.POSITIVE_INFINITY:0===c||0===l?Math.max(c,l):Math.min(c,l);const u={};Object.defineProperty(u,"maxMessageSize",{get:()=>d}),this._sctp=u}return s.apply(this,arguments)}}function zy(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(i,r){const o=i.send;i.send=function(){const s=arguments[0];if("open"===i.readyState&&r.sctp&&(s.length||s.size||s.byteLength)>r.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return o.apply(i,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return t(i,this),i},Sd(e,"datachannel",i=>(t(i.channel,i.target),i))}function VO(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const i=t[n];t[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=r=>{const o=r.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const s=new Event("connectionstatechange",r);o.dispatchEvent(s)}return r},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function BO(e,t){if(!e.RTCPeerConnection||"chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&-1!==i.sdp.indexOf("\na=extmap-allow-mixed")){const r=i.sdp.split("\n").filter(o=>"a=extmap-allow-mixed"!==ki(o).call(o)).join("\n");e.RTCSessionDescription&&i instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:i.type,sdp:r}):i.sdp=r}return n.apply(this,arguments)}}function Ky(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?q.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),q.resolve())})}function qy(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if("object"!=typeof i||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer"}return i.sdp||"offer"!==i.type&&"answer"!==i.type?n.apply(this,[i]):("offer"===i.type?this.createOffer:this.createAnswer).apply(this).then(r=>n.apply(this,[r]))})}var CNe=Object.freeze({__proto__:null,removeExtmapAllowMixed:BO,shimAddIceCandidateNullOrEmpty:Ky,shimConnectionState:VO,shimMaxMessageSize:Wy,shimParameterlessSetLocalDescription:qy,shimRTCIceCandidate:Gy,shimRTCIceCandidateRelayProtocol:UO,shimSendThrowTypeError:zy});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=p8,i=function(o){const s={browser:null,version:null};if(void 0===o||!o.navigator)return s.browser="Not a browser.",s;const{navigator:a}=o;if(a.mozGetUserMedia)s.browser="firefox",s.version=vy(a.userAgent,/Firefox\/(\d+)\./,1);else if(a.webkitGetUserMedia||!1===o.isSecureContext&&o.webkitRTCPeerConnection)s.browser="chrome",s.version=vy(a.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!o.RTCPeerConnection||!a.userAgent.match(/AppleWebKit\/(\d+)\./))return s.browser="Not a supported browser.",s;s.browser="safari",s.version=vy(a.userAgent,/AppleWebKit\/(\d+)\./,1),s.supportsUnifiedPlan=o.RTCRtpTransceiver&&"currentDirection"in o.RTCRtpTransceiver.prototype}return s}(e),r={browserDetails:i,commonShim:CNe,extractVersion:vy,disableLog:yIe,disableWarnings:SIe,sdp:SNe};switch(i.browser){case"chrome":if(!EW||!MO||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(null===i.version)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=EW,Ky(e,i),qy(e),dW(e,i),uW(e),MO(e,i),hW(e),_W(e,i),pW(e),fW(e),mW(e),vW(e,i),Gy(e),UO(e),VO(e),Wy(e,i),zy(e),BO(e,i);break;case"firefox":if(!OW||!xO||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=OW,Ky(e,i),qy(e),bW(e,i),xO(e,i),yW(e),TW(e),SW(e),CW(e),wW(e),IW(e),RW(e),AW(e),DW(e),Gy(e),VO(e),Wy(e,i),zy(e);break;case"safari":if(!BW||!t.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=BW,Ky(e,i),qy(e),LW(e),UW(e),MW(e),NW(e),PW(e),FW(e),xW(e),VW(e),Gy(e),UO(e),Wy(e,i),zy(e),BO(e,i);break;default:n("Unsupported browser!")}}({window:typeof window>"u"?void 0:window});var TNe=$o("Array").keys,wNe=ba,INe=fi,RNe=Wi,ANe=TNe,jO=Array.prototype,DNe={DOMTokenList:!0,NodeList:!0},Xr=Vt(function(e){var t=e.keys;return e===jO||RNe(jO,e)&&t===jO.keys||INe(DNe,wNe(e))?ANe:t}),KW=Lh,NNe=TypeError,PNe=py,MNe=Yo,xNe=tl,Yy=function(e,t,n){var i=PNe(t);i in e?MNe.f(e,i,xNe(0,n)):e[i]=n},qW=wD,kNe=dc,LNe=Yy,FNe=Array,UNe=Math.max,HO=function(e,t,n){for(var i=kNe(e),r=qW(t,i),o=qW(void 0===n?i:n,i),s=FNe(UNe(o-r,0)),a=0;r<o;r++,a++)LNe(s,a,e[r]);return s.length=a,s},YW=HO,VNe=Math.floor,GO=function(e,t){var n=e.length,i=VNe(n/2);return n<8?BNe(e,t):jNe(e,GO(YW(e,0,i),t),GO(YW(e,i),t),t)},BNe=function(e,t){for(var n,i,r=e.length,o=1;o<r;){for(i=o,n=e[o];i&&t(e[i-1],n)>0;)e[i]=e[--i];i!==o++&&(e[i]=n)}return e},jNe=function(e,t,n,i){for(var r=t.length,o=n.length,s=0,a=0;s<r||a<o;)e[s+a]=s<r&&a<o?i(t[s],n[a])<=0?t[s++]:n[a++]:s<r?t[s++]:n[a++];return e},$W=GO,XW=il.match(/firefox\/(\d+)/i),HNe=!!XW&&+XW[1],GNe=/MSIE|Trident/.test(il),ZW=il.match(/AppleWebKit\/(\d+)\./),zNe=it,JW=_n,KNe=wo,qNe=Ea,QW=dc,YNe=function(e,t){if(!delete e[t])throw NNe("Cannot delete property "+KW(t)+" of "+KW(e))},ez=Io,WO=Sn,$Ne=$W,XNe=_y,tz=HNe,ZNe=GNe,nz=yd,iz=!!ZW&&+ZW[1],ll=[],rz=JW(ll.sort),JNe=JW(ll.push),QNe=WO(function(){ll.sort(void 0)}),ePe=WO(function(){ll.sort(null)}),tPe=XNe("sort"),oz=!WO(function(){if(nz)return nz<70;if(!(tz&&tz>3)){if(ZNe)return!0;if(iz)return iz<603;var e,t,n,i,r="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)ll.push({k:t+i,v:n})}for(ll.sort(function(o,s){return s.v-o.v}),i=0;i<ll.length;i++)t=ll[i].k.charAt(0),r.charAt(r.length-1)!==t&&(r+=t);return"DGBEFHACIJK"!==r}});zNe({target:"Array",proto:!0,forced:QNe||!ePe||!tPe||!oz},{sort:function(e){void 0!==e&&KNe(e);var t=qNe(this);if(oz)return void 0===e?rz(t):rz(t,e);var n,i,r=[],o=QW(t);for(i=0;i<o;i++)i in t&&JNe(r,t[i]);for($Ne(r,function(s){return function(a,c){return void 0===c?-1:void 0===a?1:void 0!==s?+s(a,c)||0:ez(a)>ez(c)?1:-1}}(e)),n=QW(r),i=0;i<n;)t[i]=r[i++];for(;i<o;)YNe(t,i++);return t}});var zO,KO,nPe=$o("Array").sort,iPe=Wi,rPe=nPe,qO=Array.prototype,Ig=Vt(function(e){var t=e.sort;return e===qO||iPe(qO,e)&&t===qO.sort?rPe:t}),YO={exports:{}};zO=YO,KO=YO.exports,function(e,t){var n="function",i="undefined",r="object",o="string",s="major",a="model",c="name",l="type",d="vendor",u="version",h="architecture",p="console",m="mobile",f="tablet",g="smarttv",E="wearable",b="embedded",T="Amazon",I="Apple",D="ASUS",O="BlackBerry",k="Browser",L="Chrome",V="Firefox",ee="Google",Ue="Microsoft",Dt="Motorola",dt="Opera",me="Samsung",P="Sharp",F="Sony",G="Xiaomi",U="Zebra",v="Facebook",w="Chromium OS",A="Mac OS",B=function(tn){for(var bn={},Ct=0;Ct<tn.length;Ct++)bn[tn[Ct].toUpperCase()]=tn[Ct];return bn},ge=function(tn,bn){return typeof tn===o&&-1!==Ze(bn).indexOf(Ze(tn))},Ze=function(tn){return tn.toLowerCase()},nt=function(tn,bn){if(typeof tn===o)return tn=tn.replace(/^\s\s*/,""),typeof bn===i?tn:tn.substring(0,350)},jn=function(tn,bn){for(var Ct,Fr,Ha,nn,ze,br,Fl=0;Fl<bn.length&&!ze;){var zs=bn[Fl],wQ=bn[Fl+1];for(Ct=Fr=0;Ct<zs.length&&!ze&&zs[Ct];)if(ze=zs[Ct++].exec(tn))for(Ha=0;Ha<wQ.length;Ha++)br=ze[++Fr],typeof(nn=wQ[Ha])===r&&nn.length>0?2===nn.length?this[nn[0]]=typeof nn[1]==n?nn[1].call(this,br):nn[1]:3===nn.length?this[nn[0]]=typeof nn[1]!==n||nn[1].exec&&nn[1].test?br?br.replace(nn[1],nn[2]):t:br?nn[1].call(this,br,nn[2]):t:4===nn.length&&(this[nn[0]]=br?nn[3].call(this,br.replace(nn[1],nn[2])):t):this[nn]=br||t;Fl+=2}},si=function(tn,bn){for(var Ct in bn)if(typeof bn[Ct]===r&&bn[Ct].length>0){for(var Fr=0;Fr<bn[Ct].length;Fr++)if(ge(bn[Ct][Fr],tn))return"?"===Ct?t:Ct}else if(ge(bn[Ct],tn))return"?"===Ct?t:Ct;return tn},Ic={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},kl={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[u,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[u,[c,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[c,u],[/opios[\/ ]+([\w\.]+)/i],[u,[c,dt+" Mini"]],[/\bopr\/([\w\.]+)/i],[u,[c,dt]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[c,u],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[u,[c,"UC"+k]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[u,[c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[u,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[u,[c,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[u,[c,"IE"]],[/yabrowser\/([\w\.]+)/i],[u,[c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure "+k],u],[/\bfocus\/([\w\.]+)/i],[u,[c,V+" Focus"]],[/\bopt\/([\w\.]+)/i],[u,[c,dt+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[u,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[u,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[u,[c,dt+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[u,[c,"MIUI "+k]],[/fxios\/([-\w\.]+)/i],[u,[c,V]],[/\bqihu|(qi?ho?o?|360)browser/i],[[c,"360 "+k]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 "+k],u],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],u],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[c,u],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[c],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[c,v],u],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[c,u],[/\bgsa\/([\w\.]+) .*safari\//i],[u,[c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[u,[c,L+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[c,L+" WebView"],u],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[u,[c,"Android "+k]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[c,u],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[u,[c,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[u,c],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[c,[u,si,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[c,u],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[c,"Netscape"],u],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[u,[c,V+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[c,u],[/(cobalt)\/([\w\.]+)/i],[c,[u,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,Ze]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[h,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[h,"armhf"]],[/windows (ce|mobile); ppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[h,/ower/,"",Ze]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[h,Ze]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[a,[d,me],[l,f]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[a,[d,me],[l,m]],[/\((ip(?:hone|od)[\w ]*);/i],[a,[d,I],[l,m]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[a,[d,I],[l,f]],[/(macintosh);/i],[a,[d,I]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[a,[d,P],[l,m]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[a,[d,"Huawei"],[l,f]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[a,[d,"Huawei"],[l,m]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[a,/_/g," "],[d,G],[l,m]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[a,/_/g," "],[d,G],[l,f]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[a,[d,"OPPO"],[l,m]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[a,[d,"Vivo"],[l,m]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[a,[d,"Realme"],[l,m]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[a,[d,Dt],[l,m]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[a,[d,Dt],[l,f]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[a,[d,"LG"],[l,f]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[a,[d,"LG"],[l,m]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[a,[d,"Lenovo"],[l,f]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[a,/_/g," "],[d,"Nokia"],[l,m]],[/(pixel c)\b/i],[a,[d,ee],[l,f]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[a,[d,ee],[l,m]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[a,[d,F],[l,m]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[a,"Xperia Tablet"],[d,F],[l,f]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[a,[d,"OnePlus"],[l,m]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[a,[d,T],[l,f]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[a,/(.+)/g,"Fire Phone $1"],[d,T],[l,m]],[/(playbook);[-\w\),; ]+(rim)/i],[a,d,[l,f]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[a,[d,O],[l,m]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[a,[d,D],[l,f]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[a,[d,D],[l,m]],[/(nexus 9)/i],[a,[d,"HTC"],[l,f]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[d,[a,/_/g," "],[l,m]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[a,[d,"Acer"],[l,f]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[a,[d,"Meizu"],[l,m]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,a,[l,m]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,a,[l,f]],[/(surface duo)/i],[a,[d,Ue],[l,f]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[a,[d,"Fairphone"],[l,m]],[/(u304aa)/i],[a,[d,"AT&T"],[l,m]],[/\bsie-(\w*)/i],[a,[d,"Siemens"],[l,m]],[/\b(rct\w+) b/i],[a,[d,"RCA"],[l,f]],[/\b(venue[\d ]{2,7}) b/i],[a,[d,"Dell"],[l,f]],[/\b(q(?:mv|ta)\w+) b/i],[a,[d,"Verizon"],[l,f]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[a,[d,"Barnes & Noble"],[l,f]],[/\b(tm\d{3}\w+) b/i],[a,[d,"NuVision"],[l,f]],[/\b(k88) b/i],[a,[d,"ZTE"],[l,f]],[/\b(nx\d{3}j) b/i],[a,[d,"ZTE"],[l,m]],[/\b(gen\d{3}) b.+49h/i],[a,[d,"Swiss"],[l,m]],[/\b(zur\d{3}) b/i],[a,[d,"Swiss"],[l,f]],[/\b((zeki)?tb.*\b) b/i],[a,[d,"Zeki"],[l,f]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],a,[l,f]],[/\b(ns-?\w{0,9}) b/i],[a,[d,"Insignia"],[l,f]],[/\b((nxa|next)-?\w{0,9}) b/i],[a,[d,"NextBook"],[l,f]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],a,[l,m]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],a,[l,m]],[/\b(ph-1) /i],[a,[d,"Essential"],[l,m]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[a,[d,"Envizen"],[l,f]],[/\b(trio[-\w\. ]+) b/i],[a,[d,"MachSpeed"],[l,f]],[/\btu_(1491) b/i],[a,[d,"Rotor"],[l,f]],[/(shield[\w ]+) b/i],[a,[d,"Nvidia"],[l,f]],[/(sprint) (\w+)/i],[d,a,[l,m]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[d,Ue],[l,m]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[a,[d,U],[l,f]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[a,[d,U],[l,m]],[/smart-tv.+(samsung)/i],[d,[l,g]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[d,me],[l,g]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,"LG"],[l,g]],[/(apple) ?tv/i],[d,[a,I+" TV"],[l,g]],[/crkey/i],[[a,L+"cast"],[d,ee],[l,g]],[/droid.+aft(\w)( bui|\))/i],[a,[d,T],[l,g]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[a,[d,P],[l,g]],[/(bravia[\w ]+)( bui|\))/i],[a,[d,F],[l,g]],[/(mitv-\w{5}) bui/i],[a,[d,G],[l,g]],[/Hbbtv.*(technisat) (.*);/i],[d,a,[l,g]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[d,nt],[a,nt],[l,g]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[l,g]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,a,[l,p]],[/droid.+; (shield) bui/i],[a,[d,"Nvidia"],[l,p]],[/(playstation [345portablevi]+)/i],[a,[d,F],[l,p]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[a,[d,Ue],[l,p]],[/((pebble))app/i],[d,a,[l,E]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[a,[d,I],[l,E]],[/droid.+; (glass) \d/i],[a,[d,ee],[l,E]],[/droid.+; (wt63?0{2,3})\)/i],[a,[d,U],[l,E]],[/(quest( 2| pro)?)/i],[a,[d,v],[l,E]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[l,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[a,[l,m]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[a,[l,f]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[l,f]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[l,m]],[/(android[-\w\. ]{0,9});.+buil/i],[a,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[u,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[u,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[c,u],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[u,c]],os:[[/microsoft (windows) (vista|xp)/i],[c,u],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[c,[u,si,Ic]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[c,"Windows"],[u,si,Ic]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[u,/_/g,"."],[c,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[c,A],[u,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[u,c],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[c,u],[/\(bb(10);/i],[u,[c,O]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[u,[c,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[u,[c,V+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[u,[c,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[u,[c,"watchOS"]],[/crkey\/([\d\.]+)/i],[u,[c,L+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[c,w],u],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[c,u],[/(sunos) ?([\w\.\d]*)/i],[[c,"Solaris"],u],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[c,u]]},Vo=function(tn,bn){if(typeof tn===r&&(bn=tn,tn=t),!(this instanceof Vo))return new Vo(tn,bn).getResult();var Ct=typeof e!==i&&e.navigator?e.navigator:t,Fr=tn||(Ct&&Ct.userAgent?Ct.userAgent:""),Ha=Ct&&Ct.userAgentData?Ct.userAgentData:t,nn=bn?function(ze,br){var Fl={};for(var zs in ze)Fl[zs]=br[zs]&&br[zs].length%2==0?br[zs].concat(ze[zs]):ze[zs];return Fl}(kl,bn):kl;return this.getBrowser=function(){var br,ze={};return ze[c]=t,ze[u]=t,jn.call(ze,Fr,nn.browser),ze[s]=typeof(br=ze[u])===o?br.replace(/[^\d\.]/g,"").split(".")[0]:t,Ct&&Ct.brave&&typeof Ct.brave.isBrave==n&&(ze[c]="Brave"),ze},this.getCPU=function(){var ze={};return ze[h]=t,jn.call(ze,Fr,nn.cpu),ze},this.getDevice=function(){var ze={};return ze[d]=t,ze[a]=t,ze[l]=t,jn.call(ze,Fr,nn.device),!ze[l]&&Ha&&Ha.mobile&&(ze[l]=m),"Macintosh"==ze[a]&&Ct&&typeof Ct.standalone!==i&&Ct.maxTouchPoints&&Ct.maxTouchPoints>2&&(ze[a]="iPad",ze[l]=f),ze},this.getEngine=function(){var ze={};return ze[c]=t,ze[u]=t,jn.call(ze,Fr,nn.engine),ze},this.getOS=function(){var ze={};return ze[c]=t,ze[u]=t,jn.call(ze,Fr,nn.os),!ze[c]&&Ha&&"Unknown"!=Ha.platform&&(ze[c]=Ha.platform.replace(/chrome os/i,w).replace(/macos/i,A)),ze},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Fr},this.setUA=function(ze){return Fr=typeof ze===o&&ze.length>350?nt(ze,350):ze,this},this.setUA(Fr),this};Vo.VERSION="0.7.34",Vo.BROWSER=B([c,u,s]),Vo.CPU=B([h]),Vo.DEVICE=B([a,d,l,p,m,g,f,E,b]),Vo.ENGINE=Vo.OS=B([c,u]),zO.exports&&(KO=zO.exports=Vo),KO.UAParser=Vo;var Ll=typeof e!==i&&(e.jQuery||e.Zepto);if(Ll&&!Ll.ua){var Zp=new Vo;Ll.ua=Zp.getResult(),Ll.ua.get=function(){return Zp.getUA()},Ll.ua.set=function(tn){Zp.setUA(tn);var bn=Zp.getResult();for(var Ct in bn)Ll.ua[Ct]=bn[Ct]}}}("object"==typeof window?window:Ph);var sPe=Vt(YO.exports),aPe=ba,cPe=fi,lPe=Mh,dPe=Cd,uPe=cn("iterator"),hPe=Object,fPe=Vt(function(e){if(lPe(e))return!1;var t=hPe(e);return void 0!==t[uPe]||"@@iterator"in t||cPe(dPe,aPe(t))});it({global:!0,forced:Pn.globalThis!==Pn},{globalThis:Pn});var sz=Vt(Pn),az=Ly.clear;it({global:!0,bind:!0,enumerable:!0,forced:Pn.clearImmediate!==az},{clearImmediate:az});var mPe="function"==typeof Bun&&Bun&&"string"==typeof Bun.version,cz=Pn,gPe=sy,_Pe=zn,vPe=mPe,bPe=ky,yPe=zh,SPe=cz.Function,CPe=/MSIE .\./.test(il)||vPe&&function(){var e=cz.Bun.version.split(".");return e.length<3||0==e[0]&&(e[1]<3||3==e[1]&&0==e[2])}(),TPe=it,lz=Pn,dz=Ly.set,uz=lz.setImmediate?function(e,t){return CPe?function(i,r){var o=yPe(arguments.length,1)>1,s=_Pe(i)?i:SPe(i),a=o?bPe(arguments,1):[],c=o?function(){gPe(s,this,a)}:s;return e(c)}:e}(dz):dz;TPe({global:!0,bind:!0,enumerable:!0,forced:lz.setImmediate!==uz},{setImmediate:uz});var hz=Vt(To.setImmediate),RPe=DG,APe=wo,DPe=zh,OPe=jh,NPe=Pn.process;it({global:!0,enumerable:!0,dontCallGetSet:!0},{queueMicrotask:function(e){DPe(arguments.length,1),APe(e);var t=OPe&&NPe.domain;RPe(t?t.bind(e):e)}});var pz=Vt(To.queueMicrotask);function fz(e,t){return function(){return e.apply(t,arguments)}}const{toString:PPe}=Object.prototype,{getPrototypeOf:XO}=Object,$y=(ZO=Object.create(null),e=>{const t=PPe.call(e);return ZO[t]||(ZO[t]=t.slice(8,-1).toLowerCase())});var ZO;const Ms=e=>(e=e.toLowerCase(),t=>$y(t)===e),Xy=e=>t=>typeof t===e,{isArray:Zh}=Array,Rg=Xy("undefined"),mz=Ms("ArrayBuffer"),MPe=Xy("string"),Ao=Xy("function"),gz=Xy("number"),Zy=e=>null!==e&&"object"==typeof e,Jy=e=>{if("object"!==$y(e))return!1;const t=XO(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||fPe(e))},xPe=Ms("Date"),kPe=Ms("File"),LPe=Ms("Blob"),FPe=Ms("FileList"),UPe=Ms("URLSearchParams"),[VPe,BPe,jPe,HPe]=["ReadableStream","Request","Response","Headers"].map(Ms);function Ag(e,t){let n,i,{allOwnKeys:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e)if("object"!=typeof e&&(e=[e]),Zh(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{const o=r?Object.getOwnPropertyNames(e):Object.keys(e),s=o.length;let a;for(n=0;n<s;n++)a=o[n],t.call(null,e[a],a,e)}}function _z(e,t){t=t.toLowerCase();const n=Object.keys(e);let i,r=n.length;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const Ad=void 0!==sz?sz:typeof self<"u"?self:typeof window<"u"?window:global,vz=e=>!Rg(e)&&e!==Ad,GPe=(JO=typeof Uint8Array<"u"&&XO(Uint8Array),e=>JO&&e instanceof JO);var JO;const WPe=Ms("HTMLFormElement"),Ez=(e=>{let{hasOwnProperty:t}=e;return(n,i)=>t.call(n,i)})(Object.prototype),zPe=Ms("RegExp"),bz=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};Ag(n,(r,o)=>{let s;!1!==(s=t(r,o,e))&&(i[o]=s||r)}),Object.defineProperties(e,i)},QO="abcdefghijklmnopqrstuvwxyz",yz="0123456789",Sz={DIGIT:yz,ALPHA:QO,ALPHA_DIGIT:QO+QO.toUpperCase()+yz},KPe=Ms("AsyncFunction"),Cz=(Tz="function"==typeof hz,wz=Ao(Ad.postMessage),Tz?hz:wz?(eN="axios@".concat(Math.random()),Qy=[],Ad.addEventListener("message",e=>{let{source:t,data:n}=e;t===Ad&&n===eN&&Qy.length&&Qy.shift()()},!1),e=>{Qy.push(e),Ad.postMessage(eN,"*")}):e=>setTimeout(e));var Tz,wz,eN,Qy;const qPe=void 0!==pz?pz.bind(Ad):typeof process<"u"&&process.nextTick||Cz;var z={isArray:Zh,isArrayBuffer:mz,isBuffer:function(e){return null!==e&&!Rg(e)&&null!==e.constructor&&!Rg(e.constructor)&&Ao(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Ao(e.append)&&("formdata"===(t=$y(e))||"object"===t&&Ao(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&mz(e.buffer),t},isString:MPe,isNumber:gz,isBoolean:e=>!0===e||!1===e,isObject:Zy,isPlainObject:Jy,isReadableStream:VPe,isRequest:BPe,isResponse:jPe,isHeaders:HPe,isUndefined:Rg,isDate:xPe,isFile:kPe,isBlob:LPe,isRegExp:zPe,isFunction:Ao,isStream:e=>Zy(e)&&Ao(e.pipe),isURLSearchParams:UPe,isTypedArray:GPe,isFileList:FPe,forEach:Ag,merge:function e(){const{caseless:t}=vz(this)&&this||{},n={},i=(r,o)=>{const s=t&&_z(n,o)||o;n[s]=Jy(n[s])&&Jy(r)?e(n[s],r):Jy(r)?e({},r):Zh(r)?r.slice():r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&Ag(arguments[r],i);return n},extend:function(e,t,n){let{allOwnKeys:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Ag(t,(r,o)=>{e[o]=n&&Ao(r)?fz(r,n):r},{allOwnKeys:i}),e},trim:e=>ki(e)?ki(e).call(e):e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,i)=>{let r,o,s;const a={};if(t=t||{},null==e)return t;do{for(r=Object.getOwnPropertyNames(e),o=r.length;o-- >0;)s=r[o],i&&!i(s,e,t)||a[s]||(t[s]=e[s],a[s]=!0);e=!1!==n&&XO(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:$y,kindOfTest:Ms,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length);const i=e.indexOf(t,n-=t.length);return-1!==i&&i===n},toArray:e=>{if(!e)return null;if(Zh(e))return e;let t=e.length;if(!gz(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=n.next())&&!i.done;){const r=i.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let n;const i=[];for(;null!==(n=e.exec(t));)i.push(n);return i},isHTMLForm:WPe,hasOwnProperty:Ez,hasOwnProp:Ez,reduceDescriptors:bz,freezeMethods:e=>{bz(e,(t,n)=>{if(Ao(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;Ao(e[n])&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},i=r=>{r.forEach(o=>{n[o]=!0})};return Zh(e)?i(e):i(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,i){return n.toUpperCase()+i}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:_z,global:Ad,isContextDefined:vz,ALPHABET:Sz,generateString:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sz.ALPHA_DIGIT,n="";const{length:i}=t;for(;e--;)n+=t[Math.random()*i|0];return n},isSpecCompliantForm:function(e){return!!(e&&Ao(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(i,r)=>{if(Zy(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[r]=i;const o=Zh(i)?[]:{};return Ag(i,(s,a)=>{const c=n(s,r+1);!Rg(c)&&(o[a]=c)}),t[r]=void 0,o}}return i};return n(e,0)},isAsyncFn:KPe,isThenable:e=>e&&(Zy(e)||Ao(e))&&Ao(e.then)&&Ao(e.catch),setImmediate:Cz,asap:qPe};function rt(e,t,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}z.inherits(rt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:z.toJSONObject(this.config),code:this.code,status:this.status}}});const Iz=rt.prototype,Rz={};function tN(e){return z.isPlainObject(e)||z.isArray(e)}function Az(e){return z.endsWith(e,"[]")?e.slice(0,-2):e}function Dz(e,t,n){return e?e.concat(t).map(function(i,r){return i=Az(i),!n&&r?"["+i+"]":i}).join(n?".":""):t}["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Rz[e]={value:e}}),Object.defineProperties(rt,Rz),Object.defineProperty(Iz,"isAxiosError",{value:!0}),rt.from=(e,t,n,i,r,o)=>{const s=Object.create(Iz);return z.toFlatObject(e,s,function(a){return a!==Error.prototype},a=>"isAxiosError"!==a),rt.call(s,e.message,t,n,i,r),s.cause=e,s.name=e.name,o&&Object.assign(s,o),s};const YPe=z.toFlatObject(z,{},null,function(e){return/^is[A-Z]/.test(e)});function eS(e,t,n){if(!z.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(n=z.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(h,p){return!z.isUndefined(p[h])})).metaTokens,r=n.visitor||l,o=n.dots,s=n.indexes,a=(n.Blob||typeof Blob<"u"&&Blob)&&z.isSpecCompliantForm(t);if(!z.isFunction(r))throw new TypeError("visitor must be a function");function c(h){if(null===h)return"";if(z.isDate(h))return h.toISOString();if(!a&&z.isBlob(h))throw new rt("Blob is not supported. Use a Buffer instead.");return z.isArrayBuffer(h)||z.isTypedArray(h)?a&&"function"==typeof Blob?new Blob([h]):Buffer.from(h):h}function l(h,p,m){let f=h;if(h&&!m&&"object"==typeof h)if(z.endsWith(p,"{}"))p=i?p:p.slice(0,-2),h=JSON.stringify(h);else if(z.isArray(h)&&z.isArray(g=h)&&!g.some(tN)||(z.isFileList(h)||z.endsWith(p,"[]"))&&(f=z.toArray(h)))return p=Az(p),f.forEach(function(g,E){!z.isUndefined(g)&&null!==g&&t.append(!0===s?Dz([p],E,o):null===s?p:p+"[]",c(g))}),!1;var g;return!!tN(h)||(t.append(Dz(m,p,o),c(h)),!1)}const d=[],u=Object.assign(YPe,{defaultVisitor:l,convertValue:c,isVisitable:tN});if(!z.isObject(e))throw new TypeError("data must be an object");return function h(p,m){if(!z.isUndefined(p)){if(-1!==d.indexOf(p))throw Error("Circular reference detected in "+m.join("."));d.push(p),z.forEach(p,function(f,g){!0===(!(z.isUndefined(f)||null===f)&&r.call(t,f,z.isString(g)?ki(g).call(g):g,m,u))&&h(f,m?m.concat(g):[g])}),d.pop()}}(e),t}function Oz(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function nN(e,t){this._pairs=[],e&&eS(e,this,t)}const Nz=nN.prototype;function $Pe(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Pz(e,t,n){if(!t)return e;const i=n&&n.encode||$Pe,r=n&&n.serialize;let o;if(o=r?r(t,n):z.isURLSearchParams(t)?t.toString():new nN(t,n).toString(i),o){const s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}Nz.append=function(e,t){this._pairs.push([e,t])},Nz.toString=function(e){const t=e?function(n){return e.call(this,n,Oz)}:Oz;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};var Mz=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){z.forEach(this.handlers,function(t){null!==t&&e(t)})}},xz={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},kz={exports:{}},Lz=Yo.f;it({target:"Object",stat:!0,forced:Object.defineProperty!==Lz,sham:!Co},{defineProperty:Lz});var Fz=To.Object,JPe=kz.exports=function(e,t,n){return Fz.defineProperty(e,t,n)};Fz.defineProperty.sham&&(JPe.sham=!0);var Uz=Vt(kz.exports),QPe=va,Dg=Array.isArray||function(e){return"Array"==QPe(e)},eMe=TypeError,Vz=Dg,tMe=xy,nMe=$r,iMe=cn("species"),Bz=Array,jz=function(e,t){return new(function(e){var t;return Vz(e)&&(tMe(t=e.constructor)&&(t===Bz||Vz(t.prototype))||nMe(t)&&null===(t=t[iMe]))&&(t=void 0),void 0===t?Bz:t}(e))(0===t?0:t)},oMe=Sn,sMe=yd,aMe=cn("species"),Hz=function(e){return sMe>=51||!oMe(function(){var t=[];return(t.constructor={})[aMe]=function(){return{foo:1}},1!==t[e](Boolean).foo})},cMe=it,lMe=Sn,dMe=Dg,uMe=$r,hMe=Ea,pMe=dc,Gz=function(e){if(e>9007199254740991)throw eMe("Maximum allowed index exceeded");return e},Wz=Yy,fMe=jz,mMe=Hz,gMe=yd,zz=cn("isConcatSpreadable"),_Me=gMe>=51||!lMe(function(){var e=[];return e[zz]=!1,e.concat()[0]!==e}),vMe=function(e){if(!uMe(e))return!1;var t=e[zz];return void 0!==t?!!t:dMe(e)};cMe({target:"Array",proto:!0,arity:1,forced:!_Me||!mMe("concat")},{concat:function(e){var t,n,i,r,o,s=hMe(this),a=fMe(s,0),c=0;for(t=-1,i=arguments.length;t<i;t++)if(vMe(o=-1===t?s:arguments[t]))for(r=pMe(o),Gz(c+r),n=0;n<r;n++,c++)n in o&&Wz(a,c,o[n]);else Gz(c+1),Wz(a,c++,o);return a.length=c,a}});var Kz={},EMe=va,bMe=nl,qz=by.f,yMe=HO,Yz="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Kz.f=function(e){return Yz&&"Window"==EMe(e)?function(t){try{return qz(t)}catch{return yMe(Yz)}}(e):qz(bMe(e))};var Jh={};Jh.f=cn;var $z=To,CMe=fi,TMe=Jh,wMe=Yo.f,Qn=function(e){var t=$z.Symbol||($z.Symbol={});CMe(t,e)||wMe(t,e,{value:TMe.f(e)})},IMe=Jn,RMe=Or,AMe=cn,DMe=sl,Xz=function(){var e=RMe("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,i=AMe("toPrimitive");t&&!t[i]&&DMe(t,i,function(r){return IMe(n,this)},{arity:1})},OMe=rl,NMe=uy,PMe=Ea,MMe=dc,xMe=jz,Zz=_n([].push),dl=function(e){var t=1==e,n=2==e,i=3==e,r=4==e,o=6==e,s=7==e,a=5==e||o;return function(c,l,d,u){for(var h,p,m=PMe(c),f=NMe(m),g=OMe(l,d),E=MMe(f),b=0,T=u||xMe,I=t?T(c,E):n||s?T(c,0):void 0;E>b;b++)if((a||b in f)&&(p=g(h=f[b],b,m),e))if(t)I[b]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return b;case 2:Zz(I,h)}else switch(e){case 4:return!1;case 7:Zz(I,h)}return o?-1:i||r?r:I}},Jz={forEach:dl(0),map:dl(1),filter:dl(2),some:dl(3),every:dl(4),find:dl(5),findIndex:dl(6),filterReject:dl(7)},tS=it,iN=Pn,rN=Jn,kMe=_n,Qh=Co,ep=kh,LMe=Sn,zi=fi,FMe=Wi,oN=gr,nS=nl,sN=py,UMe=Io,aN=tl,Og=gg,Qz=Sy,VMe=by,e9=Kz,BMe=mg,t9=hg,n9=Yo,jMe=FD,i9=ly,r9=sl,HMe=My,cN=Fh,o9=yy,s9=gD,GMe=cn,WMe=Jh,zMe=Qn,KMe=Xz,qMe=al,a9=wd,iS=Jz.forEach,Zr=Ey("hidden"),rS="Symbol",Ng="prototype",YMe=a9.set,c9=a9.getterFor(rS),xs=Object[Ng],tp=iN.Symbol,oS=tp&&tp[Ng],$Me=iN.TypeError,lN=iN.QObject,l9=t9.f,Dd=n9.f,d9=e9.f,XMe=i9.f,u9=kMe([].push),uc=cN("symbols"),Pg=cN("op-symbols"),ZMe=cN("wks"),dN=!lN||!lN[Ng]||!lN[Ng].findChild,uN=Qh&&LMe(function(){return 7!=Og(Dd({},"a",{get:function(){return Dd(this,"a",{value:7}).a}})).a})?function(e,t,n){var i=l9(xs,t);i&&delete xs[t],Dd(e,t,n),i&&e!==xs&&Dd(xs,t,i)}:Dd,hN=function(e,t){var n=uc[e]=Og(oS);return YMe(n,{type:rS,tag:e,description:t}),Qh||(n.description=t),n},sS=function(e,t,n){e===xs&&sS(Pg,t,n),oN(e);var i=sN(t);return oN(n),zi(uc,i)?(n.enumerable?(zi(e,Zr)&&e[Zr][i]&&(e[Zr][i]=!1),n=Og(n,{enumerable:aN(0,!1)})):(zi(e,Zr)||Dd(e,Zr,aN(1,{})),e[Zr][i]=!0),uN(e,i,n)):Dd(e,i,n)},pN=function(e,t){oN(e);var n=nS(t),i=Qz(n).concat(m9(n));return iS(i,function(r){Qh&&!rN(h9,n,r)||sS(e,r,n[r])}),e},h9=function(e){var t=sN(e),n=rN(XMe,this,t);return!(this===xs&&zi(uc,t)&&!zi(Pg,t))&&(!(n||!zi(this,t)||!zi(uc,t)||zi(this,Zr)&&this[Zr][t])||n)},p9=function(e,t){var n=nS(e),i=sN(t);if(n!==xs||!zi(uc,i)||zi(Pg,i)){var r=l9(n,i);return!r||!zi(uc,i)||zi(n,Zr)&&n[Zr][i]||(r.enumerable=!0),r}},f9=function(e){var t=d9(nS(e)),n=[];return iS(t,function(i){zi(uc,i)||zi(o9,i)||u9(n,i)}),n},m9=function(e){var t=e===xs,n=d9(t?Pg:nS(e)),i=[];return iS(n,function(r){!zi(uc,r)||t&&!zi(xs,r)||u9(i,uc[r])}),i};ep||(r9(oS=(tp=function(){if(FMe(oS,this))throw $Me("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?UMe(arguments[0]):void 0,t=s9(e),n=function(i){this===xs&&rN(n,Pg,i),zi(this,Zr)&&zi(this[Zr],t)&&(this[Zr][t]=!1),uN(this,t,aN(1,i))};return Qh&&dN&&uN(xs,t,{configurable:!0,set:n}),hN(t,e)})[Ng],"toString",function(){return c9(this).tag}),r9(tp,"withoutSetter",function(e){return hN(s9(e),e)}),i9.f=h9,n9.f=sS,jMe.f=pN,t9.f=p9,VMe.f=e9.f=f9,BMe.f=m9,WMe.f=function(e){return hN(GMe(e),e)},Qh&&HMe(oS,"description",{configurable:!0,get:function(){return c9(this).description}})),tS({global:!0,constructor:!0,wrap:!0,forced:!ep,sham:!ep},{Symbol:tp}),iS(Qz(ZMe),function(e){zMe(e)}),tS({target:rS,stat:!0,forced:!ep},{useSetter:function(){dN=!0},useSimple:function(){dN=!1}}),tS({target:"Object",stat:!0,forced:!ep,sham:!Qh},{create:function(e,t){return void 0===t?Og(e):pN(Og(e),t)},defineProperty:sS,defineProperties:pN,getOwnPropertyDescriptor:p9}),tS({target:"Object",stat:!0,forced:!ep},{getOwnPropertyNames:f9}),KMe(),qMe(tp,rS),o9[Zr]=!0;var g9=kh&&!!Symbol.for&&!!Symbol.keyFor,JMe=it,QMe=Or,e1e=fi,t1e=Io,_9=Fh,n1e=g9,fN=_9("string-to-symbol-registry"),i1e=_9("symbol-to-string-registry");JMe({target:"Symbol",stat:!0,forced:!n1e},{for:function(e){var t=t1e(e);if(e1e(fN,t))return fN[t];var n=QMe("Symbol")(t);return fN[t]=n,i1e[n]=t,n}});var r1e=it,o1e=fi,s1e=pg,a1e=Lh,c1e=g9,v9=Fh("symbol-to-string-registry");r1e({target:"Symbol",stat:!0,forced:!c1e},{keyFor:function(e){if(!s1e(e))throw TypeError(a1e(e)+" is not a symbol");if(o1e(v9,e))return v9[e]}});var E9=Dg,l1e=zn,b9=va,d1e=Io,y9=_n([].push),u1e=it,S9=Or,C9=sy,h1e=Jn,Mg=_n,T9=Sn,w9=zn,I9=pg,R9=ky,f1e=kh,m1e=String,ul=S9("JSON","stringify"),aS=Mg(/./.exec),A9=Mg("".charAt),g1e=Mg("".charCodeAt),_1e=Mg("".replace),v1e=Mg(1..toString),E1e=/[\uD800-\uDFFF]/g,D9=/^[\uD800-\uDBFF]$/,O9=/^[\uDC00-\uDFFF]$/,N9=!f1e||T9(function(){var e=S9("Symbol")();return"[null]"!=ul([e])||"{}"!=ul({a:e})||"{}"!=ul(Object(e))}),P9=T9(function(){return'"\\udf06\\ud834"'!==ul("\udf06\ud834")||'"\\udead"'!==ul("\udead")}),b1e=function(e,t){var n=R9(arguments),i=function(e){if(l1e(e))return e;if(E9(e)){for(var t=e.length,n=[],i=0;i<t;i++){var r=e[i];"string"==typeof r?y9(n,r):"number"!=typeof r&&"Number"!=b9(r)&&"String"!=b9(r)||y9(n,d1e(r))}var o=n.length,s=!0;return function(a,c){if(s)return s=!1,c;if(E9(this))return c;for(var l=0;l<o;l++)if(n[l]===a)return c}}}(t);if(w9(i)||void 0!==e&&!I9(e))return n[1]=function(r,o){if(w9(i)&&(o=h1e(i,this,m1e(r),o)),!I9(o))return o},C9(ul,null,n)},y1e=function(e,t,n){var i=A9(n,t-1),r=A9(n,t+1);return aS(D9,e)&&!aS(O9,r)||aS(O9,e)&&!aS(D9,i)?"\\u"+v1e(g1e(e,0),16):e};ul&&u1e({target:"JSON",stat:!0,arity:3,forced:N9||P9},{stringify:function(e,t,n){var i=R9(arguments),r=C9(N9?b1e:ul,null,i);return P9&&"string"==typeof r?_1e(r,E1e,y1e):r}});var M9=mg,S1e=Ea;it({target:"Object",stat:!0,forced:!kh||Sn(function(){M9.f(1)})},{getOwnPropertySymbols:function(e){var t=M9.f;return t?t(S1e(e)):[]}}),Qn("asyncIterator"),Qn("hasInstance"),Qn("isConcatSpreadable"),Qn("iterator"),Qn("match"),Qn("matchAll"),Qn("replace"),Qn("search"),Qn("species"),Qn("split");var C1e=Xz;Qn("toPrimitive"),C1e();var T1e=Or,w1e=al;Qn("toStringTag"),w1e(T1e("Symbol"),"Symbol"),Qn("unscopables"),al(Pn.JSON,"JSON",!0);var I1e=To.Symbol,A1e=Yo.f,x9=cn("metadata"),k9=Function.prototype;void 0===k9[x9]&&A1e(k9,x9,{value:null}),Qn("dispose"),Qn("metadata");var D1e=I1e;Qn("asyncDispose");var O1e=_n,mN=Or("Symbol"),N1e=mN.keyFor,P1e=O1e(mN.prototype.valueOf),L9=mN.isRegisteredSymbol||function(e){try{return void 0!==N1e(P1e(e))}catch{return!1}};it({target:"Symbol",stat:!0},{isRegisteredSymbol:L9});for(var M1e=Fh,F9=Or,x1e=_n,k1e=pg,L1e=cn,cS=F9("Symbol"),U9=cS.isWellKnownSymbol,V9=F9("Object","getOwnPropertyNames"),F1e=x1e(cS.prototype.valueOf),B9=M1e("wks"),gN=0,j9=V9(cS),U1e=j9.length;gN<U1e;gN++)try{var H9=j9[gN];k1e(cS[H9])&&L1e(H9)}catch{}var G9=function(e){if(U9&&U9(e))return!0;try{for(var t=F1e(e),n=0,i=V9(B9),r=i.length;n<r;n++)if(B9[i[n]]==t)return!0}catch{}return!1};it({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:G9}),Qn("matcher"),Qn("observable"),it({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:L9}),it({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:G9}),Qn("metadataKey"),Qn("patternMatch"),Qn("replaceAll");var np=Vt(D1e),W9=Vt(Jh.f("iterator"));function xg(e){return xg="function"==typeof np&&"symbol"==typeof W9?function(t){return typeof t}:function(t){return t&&"function"==typeof np&&t.constructor===np&&t!==np.prototype?"symbol":typeof t},xg(e)}var V1e=Vt(Jh.f("toPrimitive"));function y(e,t,n){return(t=function B1e(e){var t=function(n,i){if("object"!==xg(n)||null===n)return n;var r=n[V1e];if(void 0!==r){var o=r.call(n,"string");if("object"!==xg(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(e);return"symbol"===xg(t)?t:String(t)}(t))in e?Uz(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j1e=Sn,H1e=cn("iterator"),_N=!j1e(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n=new URLSearchParams("a=1&a=2"),i="";return e.pathname="c%20d",t.forEach(function(r,o){t.delete("b"),i+=o+r}),n.delete("a",2),!e.toJSON||!n.has("a",1)||n.has("a",2)||!t.size&&!0||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[H1e]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==i||"x"!==new URL("http://x",void 0).host}),G1e=sl,vN=it,ip=Pn,lS=Jn,Ca=_n,rp=Co,z9=_N,K9=sl,W1e=My,K1e=al,q1e=ZD,EN=wd,q9=eO,bN=zn,Y1e=fi,$1e=rl,X1e=ba,Z1e=gr,Y9=$r,Nr=Io,J1e=gg,$9=tl,yN=jD,Q1e=wy,op=zh,exe=$W,txe=cn("iterator"),kg="URLSearchParams",X9=kg+"Iterator",Z9=EN.set,Xo=EN.getterFor(kg),nxe=EN.getterFor(X9),ixe=Object.getOwnPropertyDescriptor,SN=function(e){if(!rp)return ip[e];var t=ixe(ip,e);return t&&t.value},J9=SN("fetch"),dS=SN("Request"),Lg=SN("Headers"),CN=dS&&dS.prototype,Q9=Lg&&Lg.prototype,rxe=ip.RegExp,oxe=ip.TypeError,e7=ip.decodeURIComponent,sxe=ip.encodeURIComponent,axe=Ca("".charAt),t7=Ca([].join),Od=Ca([].push),TN=Ca("".replace),cxe=Ca([].shift),n7=Ca([].splice),i7=Ca("".split),lxe=Ca("".slice),dxe=/\+/g,r7=Array(4),uxe=function(e){return r7[e-1]||(r7[e-1]=rxe("((?:%[\\da-f]{2}){"+e+"})","gi"))},hxe=function(e){try{return e7(e)}catch{return e}},o7=function(e){var t=TN(e,dxe," "),n=4;try{return e7(t)}catch{for(;n;)t=TN(t,uxe(n--),hxe);return t}},pxe=/[!'()~]|%20/g,fxe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},mxe=function(e){return fxe[e]},s7=function(e){return TN(sxe(e),pxe,mxe)},wN=q1e(function(e,t){Z9(this,{type:X9,iterator:yN(Xo(e).entries),kind:t})},"Iterator",function(){var e=nxe(this),t=e.kind,n=e.iterator.next(),i=n.value;return n.done||(n.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),n},!0),a7=function(e){this.entries=[],this.url=null,void 0!==e&&(Y9(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===axe(e,0)?lxe(e,1):e:Nr(e)))};a7.prototype={type:kg,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,i,r,o,s,a,c=Q1e(e);if(c)for(n=(t=yN(e,c)).next;!(i=lS(n,t)).done;){if(o=(r=yN(Z1e(i.value))).next,(s=lS(o,r)).done||(a=lS(o,r)).done||!lS(o,r).done)throw oxe("Expected sequence with length 2");Od(this.entries,{key:Nr(s.value),value:Nr(a.value)})}else for(var l in e)Y1e(e,l)&&Od(this.entries,{key:l,value:Nr(e[l])})},parseQuery:function(e){if(e)for(var t,n,i=i7(e,"&"),r=0;r<i.length;)(t=i[r++]).length&&(n=i7(t,"="),Od(this.entries,{key:o7(cxe(n)),value:o7(t7(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],i=0;i<t.length;)e=t[i++],Od(n,s7(e.key)+"="+s7(e.value));return t7(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var uS=function(){q9(this,sp);var e=Z9(this,new a7(arguments.length>0?arguments[0]:void 0));rp||(this.size=e.entries.length)},sp=uS.prototype;if(function(e,t,n){for(var i in t)n&&n.unsafe&&e[i]?e[i]=t[i]:G1e(e,i,t[i],n)}(sp,{append:function(e,t){var n=Xo(this);op(arguments.length,2),Od(n.entries,{key:Nr(e),value:Nr(t)}),rp||this.length++,n.updateURL()},delete:function(e){for(var t=Xo(this),n=op(arguments.length,1),i=t.entries,r=Nr(e),o=n<2?void 0:arguments[1],s=void 0===o?o:Nr(o),a=0;a<i.length;){var c=i[a];if(c.key!==r||void 0!==s&&c.value!==s)a++;else if(n7(i,a,1),void 0!==s)break}rp||(this.size=i.length),t.updateURL()},get:function(e){var t=Xo(this).entries;op(arguments.length,1);for(var n=Nr(e),i=0;i<t.length;i++)if(t[i].key===n)return t[i].value;return null},getAll:function(e){var t=Xo(this).entries;op(arguments.length,1);for(var n=Nr(e),i=[],r=0;r<t.length;r++)t[r].key===n&&Od(i,t[r].value);return i},has:function(e){for(var t=Xo(this).entries,n=op(arguments.length,1),i=Nr(e),r=n<2?void 0:arguments[1],o=void 0===r?r:Nr(r),s=0;s<t.length;){var a=t[s++];if(a.key===i&&(void 0===o||a.value===o))return!0}return!1},set:function(e,t){var n=Xo(this);op(arguments.length,1);for(var i,r=n.entries,o=!1,s=Nr(e),a=Nr(t),c=0;c<r.length;c++)(i=r[c]).key===s&&(o?n7(r,c--,1):(o=!0,i.value=a));o||Od(r,{key:s,value:a}),rp||(this.size=r.length),n.updateURL()},sort:function(){var e=Xo(this);exe(e.entries,function(t,n){return t.key>n.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,n=Xo(this).entries,i=$1e(e,arguments.length>1?arguments[1]:void 0),r=0;r<n.length;)i((t=n[r++]).value,t.key,this)},keys:function(){return new wN(this,"keys")},values:function(){return new wN(this,"values")},entries:function(){return new wN(this,"entries")}},{enumerable:!0}),K9(sp,txe,sp.entries,{name:"entries"}),K9(sp,"toString",function(){return Xo(this).serialize()},{enumerable:!0}),rp&&W1e(sp,"size",{get:function(){return Xo(this).entries.length},configurable:!0,enumerable:!0}),K1e(uS,kg),vN({global:!0,constructor:!0,forced:!z9},{URLSearchParams:uS}),!z9&&bN(Lg)){var gxe=Ca(Q9.has),_xe=Ca(Q9.set),c7=function(e){if(Y9(e)){var t,n=e.body;if(X1e(n)===kg)return t=e.headers?new Lg(e.headers):new Lg,gxe(t,"content-type")||_xe(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),J1e(e,{body:$9(0,Nr(n)),headers:$9(0,t)})}return e};if(bN(J9)&&vN({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return J9(e,arguments.length>1?c7(arguments[1]):{})}}),bN(dS)){var IN=function(e){return q9(this,CN),new dS(e,arguments.length>1?c7(arguments[1]):{})};CN.constructor=IN,IN.prototype=CN,vN({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:IN})}}var vxe={URLSearchParams:uS,getState:Xo},l7=Vt(To.URLSearchParams),Exe={isBrowser:!0,classes:{URLSearchParams:void 0!==l7?l7:nN,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const RN=typeof window<"u"&&typeof document<"u",AN="object"==typeof navigator&&navigator||void 0,bxe=RN&&(!AN||["ReactNative","NativeScript","NS"].indexOf(AN.product)<0),yxe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Sxe=RN&&window.location.href||"http://localhost";function d7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function u7(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d7(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d7(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var Jr=u7(u7({},Object.freeze({__proto__:null,hasBrowserEnv:RN,hasStandardBrowserEnv:bxe,hasStandardBrowserWebWorkerEnv:yxe,navigator:AN,origin:Sxe})),Exe),Cxe=gr,Txe=Jn,wxe=fi,Ixe=Wi,Rxe=function(){var e=Cxe(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},h7=RegExp.prototype,p7=function(e){var t=e.flags;return void 0!==t||"flags"in h7||wxe(e,"flags")||!Ixe(h7,e)?t:Txe(Rxe,e)},Axe=OO.charAt,f7=Jn,Dxe=gr,Oxe=zn,Nxe=va,Pxe=/./.exec,Mxe=TypeError,xxe=it,m7=Jn,g7=ug,kxe=ZD,hS=QD,_7=xh,v7=i8,Fg=Io,Lxe=gr,Fxe=Mh,Uxe=va,Vxe=o8,E7=p7,Bxe=hy,jxe=Sn,Hxe=rO,b7=wd,zxe=cn("matchAll"),y7="RegExp String",S7=y7+" Iterator",Kxe=b7.set,qxe=b7.getterFor(S7),Yxe=TypeError,DN=g7("".indexOf),pS=g7("".matchAll),ON=!!pS&&!jxe(function(){pS("a",/./)}),$xe=kxe(function(e,t,n,i){Kxe(this,{type:S7,regexp:e,string:t,global:n,unicode:i,done:!1})},y7,function(){var e=qxe(this);if(e.done)return hS(void 0,!0);var t=e.regexp,n=e.string,i=function(e,t){var n=e.exec;if(Oxe(n)){var i=f7(n,e,t);return null!==i&&Dxe(i),i}if("RegExp"===Nxe(e))return f7(Pxe,e,t);throw Mxe("RegExp#exec called on incompatible receiver")}(t,n);return null===i?(e.done=!0,hS(void 0,!0)):e.global?(""===Fg(i[0])&&(t.lastIndex=function(e,t,n){return t+(n?Axe(e,t).length:1)}(n,v7(t.lastIndex),e.unicode)),hS(i,!1)):(e.done=!0,hS(i,!1))}),C7=function(e){var t,n,i,r=Lxe(this),o=Fg(e),s=Hxe(r,RegExp),a=Fg(E7(r));return t=new s(s===RegExp?r.source:r,a),n=!!~DN(a,"g"),i=!!~DN(a,"u"),t.lastIndex=v7(r.lastIndex),new $xe(t,o,n,i)};xxe({target:"String",proto:!0,forced:ON},{matchAll:function(e){var t,n,i,r,o=_7(this);if(Fxe(e)){if(ON)return pS(o,e)}else{if(Vxe(e)&&(t=Fg(_7(E7(e))),!~DN(t,"g")))throw Yxe("`.matchAll` does not allow non-global regexes");if(ON)return pS(o,e);if(void 0===(i=Bxe(e,zxe))&&"RegExp"==Uxe(e)&&(i=C7),i)return m7(i,e,o)}return n=Fg(o),r=new RegExp(e,"g"),m7(C7,r,n)}});var Xxe=$o("String").matchAll,Zxe=Wi,Jxe=Xxe,NN=String.prototype,eke=Vt(function(e){var t=e.matchAll;return"string"==typeof e||e===NN||Zxe(NN,e)&&t===NN.matchAll?Jxe:t});function T7(e){function t(n,i,r,o){let s=n[o++];if("__proto__"===s)return!0;const a=Number.isFinite(+s),c=o>=n.length;return s=!s&&z.isArray(r)?r.length:s,c?(r[s]=z.hasOwnProp(r,s)?[r[s],i]:i,!a):(r[s]&&z.isObject(r[s])||(r[s]=[]),t(n,i,r[s],o)&&z.isArray(r[s])&&(r[s]=function(l){const d={},u=Object.keys(l);let h;const p=u.length;let m;for(h=0;h<p;h++)m=u[h],d[m]=l[m];return d}(r[s])),!a)}if(z.isFormData(e)&&z.isFunction(e.entries)){const n={};return z.forEachEntry(e,(i,r)=>{var o;t((o=i,eke(z).call(z,/\w+|\[(\w*)]/g,o).map(s=>"[]"===s[0]?"":s[1]||s[0])),r,n,0)}),n}return null}const PN={transitional:xz,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,r=z.isObject(e);if(r&&z.isHTMLForm(e)&&(e=new FormData(e)),z.isFormData(e))return i?JSON.stringify(T7(e)):e;if(z.isArrayBuffer(e)||z.isBuffer(e)||z.isStream(e)||z.isFile(e)||z.isBlob(e)||z.isReadableStream(e))return e;if(z.isArrayBufferView(e))return e.buffer;if(z.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return(s=e,a=this.formSerializer,eS(s,new Jr.classes.URLSearchParams,Object.assign({visitor:function(c,l,d,u){return Jr.isNode&&z.isBuffer(c)?(this.append(l,c.toString("base64")),!1):u.defaultVisitor.apply(this,arguments)}},a))).toString();if((o=z.isFileList(e))||n.indexOf("multipart/form-data")>-1){const s=this.env&&this.env.FormData;return eS(o?{"files[]":e}:e,s&&new s,this.formSerializer)}}var s,a;return r||i?(t.setContentType("application/json",!1),function(s,a,c){if(z.isString(s))try{return(0,JSON.parse)(s),ki(z).call(z,s)}catch(l){if("SyntaxError"!==l.name)throw l}return(0,JSON.stringify)(s)}(e)):e}],transformResponse:[function(e){const t=this.transitional||PN.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(z.isResponse(e)||z.isReadableStream(e))return e;if(e&&z.isString(e)&&(n&&!this.responseType||i)){const r=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(o){if(r)throw"SyntaxError"===o.name?rt.from(o,rt.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Jr.classes.FormData,Blob:Jr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};z.forEach(["delete","get","head","post","put","patch"],e=>{PN.headers[e]={}});var MN=PN;const tke=z.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),w7=Symbol("internals");function Ug(e){var t;return e&&ki(t=String(e)).call(t).toLowerCase()}function fS(e){return!1===e||null==e?e:z.isArray(e)?e.map(fS):String(e)}function xN(e,t,n,i,r){return z.isFunction(i)?i.call(this,t,n):(r&&(t=n),z.isString(t)?z.isString(i)?-1!==t.indexOf(i):z.isRegExp(i)?i.test(t):void 0:void 0)}class mS{constructor(t){t&&this.set(t)}set(t,n,i){const r=this;function o(c,l,d){const u=Ug(l);if(!u)throw new Error("header name must be a non-empty string");const h=z.findKey(r,u);(!h||void 0===r[h]||!0===d||void 0===d&&!1!==r[h])&&(r[h||l]=fS(c))}const s=(c,l)=>z.forEach(c,(d,u)=>o(d,u,l));if(z.isPlainObject(t)||t instanceof this.constructor)s(t,n);else if(z.isString(t)&&(t=ki(t).call(t))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(ki(a=t).call(a)))s((c=>{const l={};let d,u,h;return c&&c.split("\n").forEach(function(p){var m,f;h=p.indexOf(":"),d=ki(m=p.substring(0,h)).call(m).toLowerCase(),u=ki(f=p.substring(h+1)).call(f),!d||l[d]&&tke[d]||("set-cookie"===d?l[d]?l[d].push(u):l[d]=[u]:l[d]=l[d]?l[d]+", "+u:u)}),l})(t),n);else if(z.isHeaders(t))for(const[c,l]of t.entries())o(l,c,i);else null!=t&&o(n,t,i);var a;return this}get(t,n){if(t=Ug(t)){const i=z.findKey(this,t);if(i){const r=this[i];if(!n)return r;if(!0===n)return function(o){const s=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let c;for(;c=a.exec(o);)s[c[1]]=c[2];return s}(r);if(z.isFunction(n))return n.call(this,r,i);if(z.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Ug(t)){const i=z.findKey(this,t);return!(!i||void 0===this[i]||n&&!xN(0,this[i],i,n))}return!1}delete(t,n){const i=this;let r=!1;function o(s){if(s=Ug(s)){const a=z.findKey(i,s);!a||n&&!xN(0,i[a],a,n)||(delete i[a],r=!0)}}return z.isArray(t)?t.forEach(o):o(t),r}clear(t){const n=Object.keys(this);let i=n.length,r=!1;for(;i--;){const o=n[i];t&&!xN(0,this[o],o,t,!0)||(delete this[o],r=!0)}return r}normalize(t){const n=this,i={};return z.forEach(this,(r,o)=>{var s;const a=z.findKey(i,o);if(a)return n[a]=fS(r),void delete n[o];const c=t?ki(l=o).call(l).toLowerCase().replace(/([a-z\d])(\w*)/g,(d,u,h)=>u.toUpperCase()+h):ki(s=String(o)).call(s);var l;c!==o&&delete n[o],n[c]=fS(r),i[c]=!0}),this}concat(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.constructor.concat(this,...n)}toJSON(t){const n=Object.create(null);return z.forEach(this,(i,r)=>{null!=i&&!1!==i&&(n[r]=t&&z.isArray(i)?i.join(", "):i)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(t=>{let[n,i]=t;return n+": "+i}).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const n=new this(t);for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[w7]=this[w7]={accessors:{}}).accessors,i=this.prototype;function r(o){const s=Ug(o);n[s]||(function(a,c){const l=z.toCamelCase(" "+c);["get","set","has"].forEach(d=>{Object.defineProperty(a,d+l,{value:function(u,h,p){return this[d].call(this,c,u,h,p)},configurable:!0})})}(i,o),n[s]=!0)}return z.isArray(t)?t.forEach(r):r(t),this}}mS.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),z.reduceDescriptors(mS.prototype,(e,t)=>{let{value:n}=e,i=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(r){this[i]=r}}}),z.freezeMethods(mS);var ks=mS;function kN(e,t){const n=this||MN,i=t||n,r=ks.from(i.headers);let o=i.data;return z.forEach(e,function(s){o=s.call(n,o,r.normalize(),t?t.status:void 0)}),r.normalize(),o}function I7(e){return!(!e||!e.__CANCEL__)}function ap(e,t,n){rt.call(this,e??"canceled",rt.ERR_CANCELED,t,n),this.name="CanceledError"}function R7(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new rt("Request failed with status code "+n.status,[rt.ERR_BAD_REQUEST,rt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}z.inherits(ap,rt,{__CANCEL__:!0});const gS=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,i=0;const r=function(o,s){o=o||10;const a=new Array(o),c=new Array(o);let l,d=0,u=0;return s=void 0!==s?s:1e3,function(h){const p=Date.now(),m=c[u];l||(l=p),a[d]=h,c[d]=p;let f=u,g=0;for(;f!==d;)g+=a[f++],f%=o;if(d=(d+1)%o,d===u&&(u=(u+1)%o),p-l<s)return;const E=m&&p-m;return E?Math.round(1e3*g/E):void 0}}(50,250);return function(o,s){let a,c,l=0,d=1e3/s;const u=function(h){l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),a=null,c&&(clearTimeout(c),c=null),o.apply(null,h)};return[function(){const h=Date.now(),p=h-l;for(var m=arguments.length,f=new Array(m),g=0;g<m;g++)f[g]=arguments[g];p>=d?u(f,h):(a=f,c||(c=setTimeout(()=>{c=null,u(a)},d-p)))},()=>a&&u(a)]}(o=>{const s=o.loaded,a=o.lengthComputable?o.total:void 0,c=s-i,l=r(c);i=s,e({loaded:s,total:a,progress:a?s/a:void 0,bytes:c,rate:l||void 0,estimated:l&&a&&s<=a?(a-s)/l:void 0,event:o,lengthComputable:null!=a,[t?"download":"upload"]:!0})},n)},A7=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},D7=e=>function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return z.asap(()=>e(...n))};var nke=Jr.hasStandardBrowserEnv?function(){const e=Jr.navigator&&/(msie|trident)/i.test(Jr.navigator.userAgent),t=document.createElement("a");let n;function i(r){let o=r;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=i(window.location.href),function(r){const o=z.isString(r)?i(r):r;return o.protocol===n.protocol&&o.host===n.host}}():function(){return!0},ike=Jr.hasStandardBrowserEnv?{write(e,t,n,i,r,o){const s=[e+"="+encodeURIComponent(t)];z.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),z.isString(i)&&s.push("path="+i),z.isString(r)&&s.push("domain="+r),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function O7(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?(n=e,(i=t)?n.replace(/\/?\/$/,"")+"/"+i.replace(/^\/+/,""):n):t;var n,i}function N7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}const P7=e=>e instanceof ks?function(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?N7(Object(i),!0).forEach(function(r){y(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):N7(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}({},e):e;function Nd(e,t){t=t||{};const n={};function i(l,d,u){return z.isPlainObject(l)&&z.isPlainObject(d)?z.merge.call({caseless:u},l,d):z.isPlainObject(d)?z.merge({},d):z.isArray(d)?d.slice():d}function r(l,d,u){return z.isUndefined(d)?z.isUndefined(l)?void 0:i(void 0,l,u):i(l,d,u)}function o(l,d){if(!z.isUndefined(d))return i(void 0,d)}function s(l,d){return z.isUndefined(d)?z.isUndefined(l)?void 0:i(void 0,l):i(void 0,d)}function a(l,d,u){return u in t?i(l,d):u in e?i(void 0,l):void 0}const c={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(l,d)=>r(P7(l),P7(d),!0)};return z.forEach(Object.keys(Object.assign({},e,t)),function(l){const d=c[l]||r,u=d(e[l],t[l],l);z.isUndefined(u)&&d!==a||(n[l]=u)}),n}var M7=e=>{const t=Nd({},e);let n,{data:i,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:s,headers:a,auth:c}=t;if(t.headers=a=ks.from(a),t.url=Pz(O7(t.baseURL,t.url),e.params,e.paramsSerializer),c&&a.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),z.isFormData(i))if(Jr.hasStandardBrowserEnv||Jr.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(!1!==(n=a.getContentType())){const[l,...d]=n?n.split(";").map(u=>ki(u).call(u)).filter(Boolean):[];a.setContentType([l||"multipart/form-data",...d].join("; "))}if(Jr.hasStandardBrowserEnv&&(r&&z.isFunction(r)&&(r=r(t)),r||!1!==r&&nke(t.url))){const l=o&&s&&ike.read(s);l&&a.set(o,l)}return t},rke=typeof XMLHttpRequest<"u"&&function(e){return new q(function(t,n){const i=M7(e);let r=i.data;const o=ks.from(i.headers).normalize();let s,a,c,l,d,{responseType:u,onUploadProgress:h,onDownloadProgress:p}=i;function m(){l&&l(),d&&d(),i.cancelToken&&i.cancelToken.unsubscribe(s),i.signal&&i.signal.removeEventListener("abort",s)}let f=new XMLHttpRequest;function g(){if(!f)return;const b=ks.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());R7(function(T){t(T),m()},function(T){n(T),m()},{data:u&&"text"!==u&&"json"!==u?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:b,config:e,request:f}),f=null}f.open(i.method.toUpperCase(),i.url,!0),f.timeout=i.timeout,"onloadend"in f?f.onloadend=g:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(g)},f.onabort=function(){f&&(n(new rt("Request aborted",rt.ECONNABORTED,e,f)),f=null)},f.onerror=function(){n(new rt("Network Error",rt.ERR_NETWORK,e,f)),f=null},f.ontimeout=function(){let b=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";i.timeoutErrorMessage&&(b=i.timeoutErrorMessage),n(new rt(b,(i.transitional||xz).clarifyTimeoutError?rt.ETIMEDOUT:rt.ECONNABORTED,e,f)),f=null},void 0===r&&o.setContentType(null),"setRequestHeader"in f&&z.forEach(o.toJSON(),function(b,T){f.setRequestHeader(T,b)}),z.isUndefined(i.withCredentials)||(f.withCredentials=!!i.withCredentials),u&&"json"!==u&&(f.responseType=i.responseType),p&&([c,d]=gS(p,!0),f.addEventListener("progress",c)),h&&f.upload&&([a,l]=gS(h),f.upload.addEventListener("progress",a),f.upload.addEventListener("loadend",l)),(i.cancelToken||i.signal)&&(s=b=>{f&&(n(!b||b.type?new ap(null,e,f):b),f.abort(),f=null)},i.cancelToken&&i.cancelToken.subscribe(s),i.signal&&(i.signal.aborted?s():i.signal.addEventListener("abort",s)));const E=function(b){const T=/^([-+\w]{1,25})(:?\/\/|:)/.exec(b);return T&&T[1]||""}(i.url);E&&-1===Jr.protocols.indexOf(E)?n(new rt("Unsupported protocol "+E+":",rt.ERR_BAD_REQUEST,e)):f.send(r||null)})},oke=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let i,r=new AbortController;const o=function(l){if(!i){i=!0,a();const d=l instanceof Error?l:this.reason;r.abort(d instanceof rt?d:new ap(d instanceof Error?d.message:d))}};let s=t&&setTimeout(()=>{s=null,o(new rt("timeout ".concat(t," of ms exceeded"),rt.ETIMEDOUT))},t);const a=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(o):l.removeEventListener("abort",o)}),e=null)};e.forEach(l=>l.addEventListener("abort",o));const{signal:c}=r;return c.unsubscribe=()=>z.asap(a),c}},ske=cW,ake=Sa;it({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var e=ake.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var cke=Sa,lke=qh;it({target:"Promise",stat:!0,forced:!0},{try:function(e){var t=cke.f(this),n=lke(e);return(n.error?t.reject:t.resolve)(n.value),t.promise}});var LN=Vt(ske),x7=Jh.f("asyncIterator"),dke=Vt(x7);function FN(e,t){this.v=e,this.k=t}function Vg(e){var t,n;function i(o,s){try{var a=e[o](s),c=a.value,l=c instanceof FN;LN.resolve(l?c.v:c).then(function(d){if(l){var u="return"===o?"return":"next";if(!c.k||d.done)return i(u,d);d=e[u](d).value}r(a.done?"return":"normal",d)},function(d){i("throw",d)})}catch(d){r("throw",d)}}function r(o,s){switch(o){case"return":t.resolve({value:s,done:!0});break;case"throw":t.reject(s);break;default:t.resolve({value:s,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(o,s){return new LN(function(a,c){var l={key:o,arg:s,resolve:a,reject:c,next:null};n?n=n.next=l:(t=n=l,i(o,s))})},"function"!=typeof e.return&&(this.return=void 0)}function Do(e){return function(){return new Vg(e.apply(this,arguments))}}function Ne(e){return new FN(e,0)}function _S(e){var t={},n=!1;function i(r,o){return n=!0,{done:!1,value:new FN(o=new LN(function(s){s(e[r](o))}),1)}}return t[void 0!==np&&W9||"@@iterator"]=function(){return this},t.next=function(r){return n?(n=!1,r):i("next",r)},"function"==typeof e.throw&&(t.throw=function(r){if(n)throw n=!1,r;return i("throw",r)}),"function"==typeof e.return&&(t.return=function(r){return n?(n=!1,r):i("return",r)}),t}Vg.prototype["function"==typeof np&&dke||"@@asyncIterator"]=function(){return this},Vg.prototype.next=function(e){return this._invoke("next",e)},Vg.prototype.throw=function(e){return this._invoke("throw",e)},Vg.prototype.return=function(e){return this._invoke("return",e)};var UN=Vt(x7);function VN(e){var t,n,i,r=2;for(typeof Symbol<"u"&&(n=UN,i=Symbol.iterator);r--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new vS(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function vS(e){function t(n){if(Object(n)!==n)return q.reject(new TypeError(n+" is not an object."));var i=n.done;return q.resolve(n.value).then(function(r){return{value:r,done:i}})}return(vS=function(n){this.s=n,this.n=n.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(n){var i=this.s.return;return void 0===i?q.resolve({value:n,done:!0}):t(i.apply(this.s,arguments))},throw:function(n){var i=this.s.return;return void 0===i?q.reject(n):t(i.apply(this.s,arguments))}},new vS(e)}const uke=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,r=0;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},hke=function(){var e=Do(function*(t,n){var i,r=!1,o=!1;try{for(var s,a=VN(pke(t));r=!(s=yield Ne(a.next())).done;r=!1){const c=s.value;yield*_S(VN(uke(c,n)))}}catch(c){o=!0,i=c}finally{try{r&&null!=a.return&&(yield Ne(a.return()))}finally{if(o)throw i}}});return function(t,n){return e.apply(this,arguments)}}(),pke=function(){var e=Do(function*(t){if(t[UN])return void(yield*_S(VN(t)));const n=t.getReader();try{for(;;){const{done:i,value:r}=yield Ne(n.read());if(i)break;yield r}}finally{yield Ne(n.cancel())}});return function(t){return e.apply(this,arguments)}}(),k7=(e,t,n,i)=>{const r=hke(e,t);let o,s=0,a=c=>{o||(o=!0,i&&i(c))};return new ReadableStream({pull:c=>C(function*(){try{const{done:l,value:d}=yield r.next();if(l)return a(),void c.close();if(n){let h=s+=d.byteLength;n(h)}c.enqueue(new Uint8Array(d))}catch(l){throw a(l),l}})(),cancel:c=>(a(c),r.return())},{highWaterMark:2})};function L7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function F7(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L7(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L7(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}const ES="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,U7=ES&&"function"==typeof ReadableStream,fke=ES&&("function"==typeof TextEncoder?(V7=new TextEncoder,e=>V7.encode(e)):function(){var e=C(function*(t){return new Uint8Array(yield new Response(t).arrayBuffer())});return function(t){return e.apply(this,arguments)}}());var V7;const B7=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return!!e(...n)}catch{return!1}},mke=U7&&B7(()=>{let e=!1;const t=new Request(Jr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),BN=U7&&B7(()=>z.isReadableStream(new Response("").body)),bS={stream:BN&&(e=>e.body)};var j7;ES&&(j7=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!bS[e]&&(bS[e]=z.isFunction(j7[e])?t=>t[e]():(t,n)=>{throw new rt("Response type '".concat(e,"' is not supported"),rt.ERR_NOT_SUPPORT,n)})}));const gke=function(){var e=C(function*(t,n){return z.toFiniteNumber(t.getContentLength())??(r=C(function*(o){return null==o?0:z.isBlob(o)?o.size:z.isSpecCompliantForm(o)?(yield new Request(Jr.origin,{method:"POST",body:o}).arrayBuffer()).byteLength:z.isArrayBufferView(o)||z.isArrayBuffer(o)?o.byteLength:(z.isURLSearchParams(o)&&(o+=""),z.isString(o)?(yield fke(o)).byteLength:void 0)}),function(o){return r.apply(this,arguments)})(n);var r});return function(n,i){return e.apply(this,arguments)}}();var _ke=ES&&function(){var e=C(function*(t){let{url:n,method:i,data:r,signal:o,cancelToken:s,timeout:a,onDownloadProgress:c,onUploadProgress:l,responseType:d,headers:u,withCredentials:h="same-origin",fetchOptions:p}=M7(t);d=d?(d+"").toLowerCase():"text";let m,f=oke([o,s&&s.toAbortSignal()],a);const g=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let E;try{if(l&&mke&&"get"!==i&&"head"!==i&&0!==(E=yield gke(u,r))){let O,k=new Request(n,{method:"POST",body:r,duplex:"half"});if(z.isFormData(r)&&(O=k.headers.get("content-type"))&&u.setContentType(O),k.body){const[L,V]=A7(E,gS(D7(l)));r=k7(k.body,65536,L,V)}}z.isString(h)||(h=h?"include":"omit");const b="credentials"in Request.prototype;m=new Request(n,F7(F7({},p),{},{signal:f,method:i.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:b?h:void 0}));let T=yield fetch(m);const I=BN&&("stream"===d||"response"===d);if(BN&&(c||I&&g)){const O={};["status","statusText","headers"].forEach(ee=>{O[ee]=T[ee]});const k=z.toFiniteNumber(T.headers.get("content-length")),[L,V]=c&&A7(k,gS(D7(c),!0))||[];T=new Response(k7(T.body,65536,L,()=>{V&&V(),g&&g()}),O)}d=d||"text";let D=yield bS[z.findKey(bS,d)||"text"](T,t);return!I&&g&&g(),yield new q((O,k)=>{R7(O,k,{data:D,headers:ks.from(T.headers),status:T.status,statusText:T.statusText,config:t,request:m})})}catch(b){throw g&&g(),b&&"TypeError"===b.name&&/fetch/i.test(b.message)?Object.assign(new rt("Network Error",rt.ERR_NETWORK,t,m),{cause:b.cause||b}):rt.from(b,b&&b.code,t,m)}});return function(t){return e.apply(this,arguments)}}();const jN={http:null,xhr:rke,fetch:_ke};z.forEach(jN,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const H7=e=>"- ".concat(e),vke=e=>z.isFunction(e)||null===e||!1===e;var G7_getAdapter=e=>{e=z.isArray(e)?e:[e];const{length:t}=e;let n,i;const r={};for(let o=0;o<t;o++){let s;if(n=e[o],i=n,!vke(n)&&(i=jN[(s=String(n)).toLowerCase()],void 0===i))throw new rt("Unknown adapter '".concat(s,"'"));if(i)break;r[s||"#"+o]=i}if(!i){const o=Object.entries(r).map(s=>{let[a,c]=s;return"adapter ".concat(a," ")+(!1===c?"is not supported by the environment":"is not available in the build")});throw new rt("There is no suitable adapter to dispatch the request "+(t?o.length>1?"since :\n"+o.map(H7).join("\n"):" "+H7(o[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return i};function HN(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ap(null,e)}function W7(e){return HN(e),e.headers=ks.from(e.headers),e.data=kN.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),G7_getAdapter(e.adapter||MN.adapter)(e).then(function(t){return HN(e),t.data=kN.call(e,e.transformResponse,t),t.headers=ks.from(t.headers),t},function(t){return I7(t)||(HN(e),t&&t.response&&(t.response.data=kN.call(e,e.transformResponse,t.response),t.response.headers=ks.from(t.response.headers))),q.reject(t)})}const GN={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{GN[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const K7={};GN.transitional=function(e,t,n){function i(r,o){return"[Axios v1.7.7] Transitional option '"+r+"'"+o+(n?". "+n:"")}return(r,o,s)=>{if(!1===e)throw new rt(i(o," has been removed"+(t?" in "+t:"")),rt.ERR_DEPRECATED);return t&&!K7[o]&&(K7[o]=!0,console.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,o,s)}};var WN={assertOptions:function(e,t,n){if("object"!=typeof e)throw new rt("options must be an object",rt.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;for(;r-- >0;){const o=i[r],s=t[o];if(s){const a=e[o],c=void 0===a||s(a,o,e);if(!0!==c)throw new rt("option "+o+" must be "+c,rt.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new rt("Unknown option "+o,rt.ERR_BAD_OPTION)}},validators:GN};const hl=WN.validators;let yS=class{constructor(e){this.defaults=e,this.interceptors={request:new Mz,response:new Mz}}request(e,t){var n=this;return C(function*(){try{return yield n._request(e,t)}catch(i){if(i instanceof Error){let r;Error.captureStackTrace?Error.captureStackTrace(r={}):r=new Error;const o=r.stack?r.stack.replace(/^.+\n/,""):"";try{i.stack?o&&!String(i.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(i.stack+="\n"+o):i.stack=o}catch{}}throw i}})()}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Nd(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:r}=t;void 0!==n&&WN.assertOptions(n,{silentJSONParsing:hl.transitional(hl.boolean),forcedJSONParsing:hl.transitional(hl.boolean),clarifyTimeoutError:hl.transitional(hl.boolean)},!1),null!=i&&(z.isFunction(i)?t.paramsSerializer={serialize:i}:WN.assertOptions(i,{encode:hl.function,serialize:hl.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=r&&z.merge(r.common,r[t.method]);r&&z.forEach(["delete","get","head","post","put","patch","common"],p=>{delete r[p]}),t.headers=ks.concat(o,r);const s=[];let a=!0;this.interceptors.request.forEach(function(p){"function"==typeof p.runWhen&&!1===p.runWhen(t)||(a=a&&p.synchronous,s.unshift(p.fulfilled,p.rejected))});const c=[];let l;this.interceptors.response.forEach(function(p){c.push(p.fulfilled,p.rejected)});let d,u=0;if(!a){const p=[W7.bind(this),void 0];for(p.unshift.apply(p,s),p.push.apply(p,c),d=p.length,l=q.resolve(t);u<d;)l=l.then(p[u++],p[u++]);return l}d=s.length;let h=t;for(u=0;u<d;){const p=s[u++],m=s[u++];try{h=p(h)}catch(f){m.call(this,f);break}}try{l=W7.call(this,h)}catch(p){return q.reject(p)}for(u=0,d=c.length;u<d;)l=l.then(c[u++],c[u++]);return l}getUri(e){return Pz(O7((e=Nd(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}};z.forEach(["delete","get","head","options"],function(e){yS.prototype[e]=function(t,n){return this.request(Nd(n||{},{method:e,url:t,data:(n||{}).data}))}}),z.forEach(["post","put","patch"],function(e){function t(n){return function(i,r,o){return this.request(Nd(o||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:r}))}}yS.prototype[e]=t(),yS.prototype[e+"Form"]=t(!0)});var SS=yS;class zN{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let n;this.promise=new q(function(r){n=r});const i=this;this.promise.then(r=>{if(!i._listeners)return;let o=i._listeners.length;for(;o-- >0;)i._listeners[o](r);i._listeners=null}),this.promise.then=r=>{let o;const s=new q(a=>{i.subscribe(a),o=a}).then(r);return s.cancel=function(){i.unsubscribe(o)},s},t(function(r,o,s){i.reason||(i.reason=new ap(r,o,s),n(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);-1!==n&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=i=>{t.abort(i)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new zN(function(n){t=n}),cancel:t}}}var Eke=zN;const KN={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(KN).forEach(e=>{let[t,n]=e;KN[n]=t});var bke=KN;const wi=function e(t){const n=new SS(t),i=fz(SS.prototype.request,n);return z.extend(i,SS.prototype,n,{allOwnKeys:!0}),z.extend(i,n,null,{allOwnKeys:!0}),i.create=function(r){return e(Nd(t,r))},i}(MN);wi.Axios=SS,wi.CanceledError=ap,wi.CancelToken=Eke,wi.isCancel=I7,wi.VERSION="1.7.7",wi.toFormData=eS,wi.AxiosError=rt,wi.Cancel=wi.CanceledError,wi.all=function(e){return q.all(e)},wi.spread=function(e){return function(t){return e.apply(null,t)}},wi.isAxiosError=function(e){return z.isObject(e)&&!0===e.isAxiosError},wi.mergeConfig=Nd,wi.AxiosHeaders=ks,wi.formToJSON=e=>T7(z.isHTMLForm(e)?new FormData(e):e),wi.getAdapter=G7_getAdapter,wi.HttpStatusCode=bke,wi.default=wi;var nr=wi;const yke=()=>{};function Bg(){const e={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:yke};return e.promise=new q((t,n)=>{e.resolve=i=>{e.isFinished||(e.isResolved=!0,e.isFinished=!0,t(i),e.value=i)},e.reject=i=>{e.isFinished||(e.isRejected=!0,e.isFinished=!0,n(i))}}),e}const CS=new Map,TS=new Map,Ta=new Map;let kn=function(e){return e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.HARMONY_OS="HarmonyOS",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.CHROMIUM_OS="Chromium OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot",e}({}),Ye=function(e){return e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger",e}({});const qN=new sPe;let Ls=qN.getResult(),YN=null;function xe(e){if(!YN){e&&qN.setUA(e),Ls=qN.getResult();const t=function(a){if("Blink"===a.engine.name&&"WeChat"!==a.browser.name)return Ye.CHROME;switch(a.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return Ye.CHROME;case"Safari":case"Mobile Safari":return Ye.SAFARI;case"Edge":return Ye.EDGE;case"Firefox":return Ye.FIREFOX;case"QQ":case"QQBrowser":return Ye.QQ;case"Opera":return Ye.OPERA;case"WeChat":return Ye.WECHAT;default:return a.browser.name||""}}(Ls),n=q7(Ls),i="Windows"===(a=Ls).os.name?a.os.version?a.os.name+" "+a.os.version:a.os.name:a.os.name||"",r=Ls.os.version,o=q7(Ls,!1),s=Ls.device.type;if(!(t&&n&&i&&r))return{name:t,version:n,os:i,osVersion:r,browserVersion:o,deviceType:s};YN={name:t,version:n,os:i,osVersion:r,browserVersion:o,deviceType:s}}var a;return YN}function q7(e){let t;return t="Blink"===e.engine.name?e.engine.version||"":e.browser.version||"",arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?t:t.split(".")[0]}function wS(){return xe().os}function Y7(){const e=xe();return"".concat(e.os," ").concat(e.osVersion)}function IS(){const e=xe();return!!("WebKit"===Ls.engine.name&&e.os===kn.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==Ye.SAFARI||Ki()&&e.name!==Ye.SAFARI)}function pl(){return xe().name===Ye.CHROME}function ei(){return xe().name===Ye.SAFARI}function $7(){return xe().name===Ye.EDGE}function Bt(){return xe().name===Ye.FIREFOX}function Ki(){return xe().os===kn.IOS}function $N(e){const t=xe();return!(t.name!==Ye.CHROME||!t.osVersion)&&Number(t.version)>=e}function X7(e){const t=xe();return!(t.name!==Ye.CHROME||!t.osVersion)&&Number(t.version)<e}function Z7(e){const t=xe();return!(t.name!==Ye.EDGE||!t.osVersion)&&Number(t.version)>=e}function J7(e){const t=xe();return!(t.name!==Ye.SAFARI||!t.osVersion)&&Number(t.version)>=e}function Q7(e,t,n){const i=xe();if(i.os!==kn.IOS||!i.osVersion)return!1;const r=i.osVersion.split(".");return n?t&&Number(r[0])===e&&Number(r[1])<t||Number(r[0])<e:t?Number(r[0])===e&&Number(r[1])<=t||Number(r[0])<e:Number(r[0])<=e}function eK(e,t,n){const i=xe();if(i.name!==Ye.SAFARI||!i.osVersion||!i.browserVersion)return!1;const r=i.browserVersion.split(".");return n?t&&Number(r[0])===e&&Number(r[1])<t||Number(r[0])<e:t?Number(r[0])===e&&Number(r[1])<=t||Number(r[0])<e:Number(r[0])<=e}function tK(e){const t=xe();return!(t.name!==Ye.OPERA||!t.osVersion)&&Number(t.version)>=e}function nK(){const e=xe();if(e.os!==kn.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])<14||14===Number(t[0])&&Number(t[1])<=6}function cp(){const e=xe();if(e.os!==kn.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])}function XN(){const e=xe();if(e.os!==kn.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 16===Number(t[0])}function iK(){const e=xe();if(e.os!==kn.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=1}function Zo(){return ei()&&navigator.maxTouchPoints>0}function rK(){return xe().name===Ye.WECHAT}function oK(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function ZN(){const e=wS();return function(){const{deviceType:t}=xe();return"mobile"===t||"tablet"===t}()||e===kn.ANDROID||e===kn.IOS||e===kn.HARMONY_OS}function fl(){const e=xe();return e.name!==Ye.EDGE&&e.name!==Ye.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function RS(){return wS()===kn.ANDROID}function jg(){const e=xe();return RS()&&(e.name===Ye.CHROME||e.name===Ye.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function St(e,t,n){return(t="symbol"==typeof(r=function(o,s){if("object"!=typeof o||!o)return o;var a=o[Symbol.toPrimitive];if(void 0!==a){var c=a.call(o,"string");if("object"!=typeof c)return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(t))?r:r+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;var r}function sK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sK(Object(n),!0).forEach(function(i){St(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sK(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}let S=function(e){return e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",e.DATACHANNEL_FAILED="DATACHANNEL_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",e.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",e.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",e.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",e.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",e.PROHIBITED_OPERATION="PROHIBITED_OPERATION",e.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",e.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",e}({}),M=class extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;super(t),St(this,"code",void 0),St(this,"message",void 0),St(this,"data",void 0),St(this,"name","AgoraRTCException"),this.code=e,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=n}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),"\n").concat(this.stack):"".concat(this.stack)}print(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error",t=arguments.length>1?arguments[1]:void 0;return"error"===e&&(t||console).error(this.toString()),"warning"===e&&(t||console).warn(this.toString()),this}throw(e){throw this.print("error",e),this}};function hc(e,t){if("boolean"!=typeof e)throw new M(S.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function Mn(e,t,n){if(!Y(n).call(n,e))throw new M(S.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(n)))}function ot(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;if(e<n||e>i||(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&("number"!=typeof(r=e)||r%1!=0))throw new M(S.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(n,", ").concat(i,"]. integer only"));var r}function JN(e,t){if("number"!=typeof e){if(!(e.min||e.max||e.ideal||e.exact))throw new M(S.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));void 0!==e.min&&ot(e.min,"".concat(t,".min"),0,1/0),void 0!==e.max&&ot(e.max,"".concat(t,".max"),1,1/0),void 0!==e.exact&&ot(e.exact,"".concat(t,".exact"),1,1/0),void 0!==e.ideal&&ot(e.ideal,"".concat(t,".ideal"),1,1/0)}else ot(e,t,1,1/0)}function Kn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(null==e)throw new M(S.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!aK(e,n,i,r))throw new M(S.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(n,",").concat(i,"].").concat(r?" ASCII characters only.":""))}function pc(e,t){if(!Array.isArray(e))throw new M(S.INVALID_PARAMS,"".concat(t," should be an array"))}function Mt(e){return null==e}function aK(e){return"string"==typeof e&&e.length<=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:255)&&e.length>=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)&&(!(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])||function(r){if("string"!=typeof r)return!1;for(let o=0;o<r.length;o+=1){const s=r.charCodeAt(o);if(s<0||s>255)return!1}return!0}(e))}var Hg=function(e){return e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE",e}(Hg||{}),QN=function(e){return e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",e}(QN||{});const cK=new class{constructor(){St(this,"_clientSize",null),St(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),St(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),St(this,"getStyle",e=>window.getComputedStyle(e,null)),St(this,"checkCssVisibleProperty",e=>{var t;let n=!0;const i=this.getStyle(e),{display:r,visibility:o,opacity:s,filter:a}=i;return("none"===r||Y(t=["hidden","collapse"]).call(t,o)||Number(s)<.1)&&(n=!1),!!n&&(a&&a.split(" ").filter(c=>{var l;const d=c.split("(")[0];return Y(l=["brightness","blur","opacity"]).call(l,d)}).map(c=>{const[l,d]=c.split(/\(|\)/);return[l,Number(d.match(/^[0-9\.]+/))]}).forEach(c=>{const[l,d]=c;switch(l){case"brightness":(d<.1||d>3)&&(n=!1);break;case"blur":d>3&&(n=!1);break;case"opacity":d<.1&&(n=!1)}}),n)}),St(this,"checkPropertyUpToAllParentNodes",(e,t)=>{let n=!0,i=!0,o=e;for(;o&&i;)t(o)||(n=!1,i=!1),o=o.parentElement,o||(i=!1);return n}),St(this,"checkActualCssVisibleIncludeInherit",e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty)),St(this,"getSizeAboutClient",e=>{const{width:t,height:n,left:i,right:r,top:o,bottom:s}=e.getBoundingClientRect(),a=this.getClientWidth(),c=this.getClientHeight();return{width:t,height:n,left:i,right:r,top:o,bottom:s,clientWidth:a,clientHeight:c,clientMin:Math.min(a,c)}}),St(this,"checkActualSize",()=>{const{width:e,height:t,clientMin:n}=this._clientSize;return this.checkSizeIsVisible(e,t,n)}),St(this,"elementFromPoint",(e,t)=>document.elementFromPoint?document.elementFromPoint(e,t):null),St(this,"checkCoverForAPoint",(e,t,n)=>{const i=this.elementFromPoint(e,t);return null!==i&&i!==n}),St(this,"getPointPositionList",()=>{const{width:e,height:t,left:n,top:i}=this._clientSize,r=e/6,o=t/6,s=[],a=10**6;for(let c=0;c<5;c++)for(let l=0;l<5;l++)s.push({x:(n*a+(0===c?.1:4===c?(r*c*a-1e5)/a:r*c)*a)/a,y:(i*a+(0===l?.1:4===l?(o*l*a-1e5)/a:o*l)*a)/a});return[...s]}),St(this,"checkElementCover",e=>this.getPointPositionList().map(t=>this.checkCoverForAPoint(t.x,t.y,e)).filter(t=>!!t).length>6),St(this,"checkSizeIsVisible",(e,t,n)=>(e>50||n/e<=10)&&(t>50||n/t<=10)),St(this,"checkSizeOfPartInClient",()=>{const{left:e,right:t,top:n,bottom:i,clientHeight:r,clientWidth:o,clientMin:s}=this._clientSize;let a,c,l,d;if(e<0)a=0;else{if(!(e<o))return!1;a=e}if(t<0)return!1;if(c=t<o?t:o,n<0)l=0;else{if(!(n<r))return!1;l=n}return!(i<0)&&(d=i<r?i:r,this.checkSizeIsVisible(c-a,d-l,s))}),St(this,"returnHiddenResult",e=>(this._clientSize=null,{visible:!1,reason:e})),St(this,"checkOneElementVisible",e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(Hg.COVERED);{const t=this.checkActualSize(),n=this.checkSizeOfPartInClient();return t&&!n?this.returnHiddenResult(Hg.POSITION):t?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(Hg.SIZE)}}return this.returnHiddenResult(Hg.STYLE)}return this.returnHiddenResult(QN.UNMOUNTED)}return this.returnHiddenResult(QN.INVALID_HTML_ELEMENT)}),St(this,"checkElementIsMountedOnDom",e=>this.checkPropertyUpToAllParentNodes(e,t=>"HTML"!==t.nodeName.toUpperCase()?null!==t.parentElement:!!document.documentElement))}};function eP(e){return(new TextEncoder).encode(e)}const lK=function(e,t){const n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n},tP=function(){var e=C(function*(t){return function(n,i){let r="";return new Uint8Array(n).forEach(o=>{r+=o.toString(16).padStart(2,"0")}),r}(yield crypto.subtle.digest("SHA-256",eP(t)))});return function(n){return e.apply(this,arguments)}}();class xt{constructor(){St(this,"_events",{}),St(this,"addListener",this.on)}getListeners(t){return this._events[t]?this._events[t].map(n=>n.listener):[]}on(t,n){this._events[t]||(this._events[t]=[]);const i=this._events[t];-1===this._indexOfListener(i,n)&&i.push({listener:n,once:!1})}once(t,n){this._events[t]||(this._events[t]=[]);const i=this._events[t];-1===this._indexOfListener(i,n)&&i.push({listener:n,once:!0})}off(t,n){if(!this._events[t])return;const i=this._events[t],r=this._indexOfListener(i,n);-1!==r&&i.splice(r,1),0===this._events[t].length&&delete this._events[t]}removeAllListeners(t){t?delete this._events[t]:this._events={}}emit(t){this._events[t]||(this._events[t]=[]);const n=this._events[t].map(s=>s);for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];for(let s=0;s<n.length;s+=1){const a=n[s];a.once&&this.off(t,a.listener),a.listener.apply(this,r||[])}}safeEmit(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];[...this._events[t]||[]].forEach(o=>{o.once&&this.off(t,o.listener);try{o.listener.apply(this,i)}catch(s){console.error("safeEmit event:".concat(t," error ").concat(s?.toString()))}})}_indexOfListener(t,n){let i=t.length;for(;i--;)if(t[i].listener===n)return i;return-1}}let Gg=null;function dK(){if(Gg)return Gg;if(window.electron)return Gg=window.electron;if(!window.require)return null;try{return Gg=window.require("electron"),Gg}catch{return null}}let Cn=function(e){return e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.PRELOAD="PRELOAD",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",e.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",e.IMAGE_MODERATION_UPLOAD="imageModerationUpload",e}({}),jt=function(e){return e.TRACER="tracer",e}({});function uK(e){return ot(e.timeout,"config.timeout",0,1e5),ot(e.timeoutFactor,"config.timeoutFactor",0,100,!1),ot(e.maxRetryCount,"config.maxRetryConfig",0,1/0),ot(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let Ske=function(e){return e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",e}({}),Qe=function(e){return e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.FALLBACK="FALLBACK",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.LICENSE_MISSING="LICENSE_MISSING",e.LICENSE_EXPIRED="LICENSE_EXPIRED",e.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",e.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",e.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",e.LICENSE_ILLEGAL="LICENSE_ILLEGAL",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e}({});function AS(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach(t=>{if(!t.urls)throw Error()})}catch{return!1}return!0}function hK(e){return Kn(e.turnServerURL,"turnServerURL"),Kn(e.username,"username"),Kn(e.password,"password"),e.udpport&&ot(e.udpport,"udpport",1,99999,!0),e.forceturn&&hc(e.forceturn,"forceturn"),e.security&&hc(e.security,"security"),e.tcpport&&ot(e.tcpport,"tcpport",1,99999,!0),!0}function pK(e){return void 0!==e.level&&Mn(e.level,"level",[1,2,3]),void 0!==e.delay&&ot(e.delay,"delay",0,3e3,!0),!0}let Ae=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list",e.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",e.CONTENT_INSPECT_ERROR="content-inspect-error",e.CONTENT_INSPECT_RESULT="content-inspect-result",e.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",e}({}),ti=function(e){return e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK",e}({}),Pr=function(e){return e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({}),lp=function(e){return e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({});function ni(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return 0===e.getListeners(t).length?q.reject(new M(S.UNEXPECTED_ERROR,"can not emit promise")):new q((o,s)=>{e.emit(t,...i,o,s)})}function ct(e,t){if(0===e.getListeners(t).length)return q.resolve();for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return ni(e,t,...i)}function Oo(e,t){if(0===e.getListeners(t).length)return null;for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return Wg(e,t,...i)}function Wg(e,t){let n=null,i=null;for(var r=arguments.length,o=new Array(r>2?r-2:0),s=2;s<r;s++)o[s-2]=arguments[s];if(e.emit(t,...o,a=>{n=a},a=>{i=a}),null!==i)throw i;if(null===n)throw new M(S.UNEXPECTED_ERROR,"handler is not sync");return n}const ln=new class extends xt{set networkState(e){this.emit(lp.NETWORK_STATE_CHANGE,e,this._networkState),e===Pr.ONLINE?this.emit(lp.ONLINE):e===Pr.OFFLINE&&(this.onlineWaiter=new q(t=>{this.once(lp.ONLINE,()=>{this.onlineWaiter=void 0,t(Pr.ONLINE)})}),this.emit(lp.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}get isOnline(){return this._networkState===Pr.ONLINE}constructor(){super(),St(this,"_moduleName","network-indicator"),St(this,"_networkState",Pr.ONLINE),St(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Pr.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Pr.OFFLINE})}};function DS(e,t){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}function dp(e){const t=[];return e.forEach(n=>{-1===t.indexOf(n)&&t.push(n)}),t}function OS(e){void 0!==q?q.resolve().then(e):setTimeout(e,0)}function dn(e){return JSON.parse(JSON.stringify(e))}function Pd(e){try{return dn(e)}catch{return e}}const fK={};function ml(e,t){fK[t]||(fK[t]=!0,e())}function Md(e){const t=window.atob(e),n=new Uint8Array(new ArrayBuffer(t.length));for(let i=0;i<t.length;i+=1)n[i]=t.charCodeAt(i);return n}function gl(e){let t="";for(let n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}function mK(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=(new TextEncoder).encode(e);if(n.length>t)n=n.slice(0,t);else if(n.length<t){const i=new Uint8Array(t);i.set(n),n=i}return n}function gK(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=Ps(t).call(t,(s,a)=>s+a.length,0),r=new Uint8Array(new ArrayBuffer(i));let o=0;return t.forEach(s=>{r.set(s,o),o+=s.length}),r}function wa(e){return window.TextEncoder?(new TextEncoder).encode(e).length:e.length}function _K(e){let t=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&e.realFormData&&(e=e.realFormData),e.forEach(n=>{t+="string"==typeof n?wa(n):n.size}),t+138}function Cke(e){const t=new M(S.TIMEOUT,"timeout");return new q((n,i)=>{window.setTimeout(()=>i(t),e)})}function qn(e){return new q(t=>{window.setTimeout(t,e)})}function gt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const n=Math.random().toString(16).substr(2,e).toLowerCase();return n.length===e?"".concat(t).concat(n):"".concat(t).concat(n)+gt(e-n.length,"")}function up(){return gt(32,"").toUpperCase()}const NS=()=>{},vK=new class{constructor(){St(this,"fnMap",new Map)}throttleByKey(e,t,n,i){for(var r=arguments.length,o=new Array(r>4?r-4:0),s=4;s<r;s++)o[s-4]=arguments[s];if(this.fnMap.has(t)){const a=this.fnMap.get(t);if(a.threshold!==n){a.fn(...a.args),clearTimeout(a.timer);const c=window.setTimeout(()=>{const l=this.fnMap.get(t);l&&l.fn(...l.args),this.fnMap.delete(t)},n);this.fnMap.set(t,{fn:e,threshold:n,timer:c,args:o,skipFn:i})}else a.skipFn&&a.skipFn(...a.args),this.fnMap.set(t,te(te({},a),{},{fn:e,args:o,skipFn:i}))}else{const a=window.setTimeout(()=>{const c=this.fnMap.get(t);c&&c.fn(...c.args),this.fnMap.delete(t)},n);this.fnMap.set(t,{fn:e,threshold:n,timer:a,args:o,skipFn:i})}}},EK=vK.throttleByKey.bind(vK);function bK(e){return"object"==typeof e&&null!==e&&!(e instanceof RegExp)}function nP(e,t){if(!bK(e)||!bK(t)||Array.isArray(e)&&!Array.isArray(t)||!Array.isArray(e)&&Array.isArray(t))return t;if(Array.isArray(t)&&Array.isArray(e)){const n=[...e];for(let i=0;i<t.length;i++)n[i]=nP(e[i],t[i]);return n}{const n=te({},e);for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=Object.prototype.hasOwnProperty.call(e,i)?nP(e[i],t[i]):t[i]);return n}}function yK(e,t){let n=[0];if(t&&(n=new Array(t).fill(0)),0===e)return n;let i=0;for(;e>0&&(n[i]=255&e,e>>=8,i++,!t||i!==t););return n}function iP(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function SK(e){const t="0123456789abcdef";function n(T){let I,D="";for(I=0;I<=3;I++)D+=t.charAt(T>>8*I+4&15)+t.charAt(T>>8*I&15);return D}function i(T,I){const D=(65535&T)+(65535&I);return(T>>16)+(I>>16)+(D>>16)<<16|65535&D}function r(T,I,D,O,k,L){return i((V=i(i(I,T),i(O,L)))<<(ee=k)|V>>>32-ee,D);var V,ee}function o(T,I,D,O,k,L,V){return r(I&D|~I&O,T,I,k,L,V)}function s(T,I,D,O,k,L,V){return r(I&O|D&~O,T,I,k,L,V)}function a(T,I,D,O,k,L,V){return r(I^D^O,T,I,k,L,V)}function c(T,I,D,O,k,L,V){return r(D^(I|~O),T,I,k,L,V)}const l=function(T){let I;const D=1+(T.length+8>>6),O=new Array(16*D);for(I=0;I<16*D;I++)O[I]=0;for(I=0;I<T.length;I++)O[I>>2]|=T.charCodeAt(I)<<I%4*8;return O[I>>2]|=128<<I%4*8,O[16*D-2]=8*T.length,O}(e);let d,u,h,p,m,f=1732584193,g=-271733879,E=-1732584194,b=271733878;for(d=0;d<l.length;d+=16)u=f,h=g,p=E,m=b,f=o(f,g,E,b,l[d+0],7,-680876936),b=o(b,f,g,E,l[d+1],12,-389564586),E=o(E,b,f,g,l[d+2],17,606105819),g=o(g,E,b,f,l[d+3],22,-1044525330),f=o(f,g,E,b,l[d+4],7,-176418897),b=o(b,f,g,E,l[d+5],12,1200080426),E=o(E,b,f,g,l[d+6],17,-1473231341),g=o(g,E,b,f,l[d+7],22,-45705983),f=o(f,g,E,b,l[d+8],7,1770035416),b=o(b,f,g,E,l[d+9],12,-1958414417),E=o(E,b,f,g,l[d+10],17,-42063),g=o(g,E,b,f,l[d+11],22,-1990404162),f=o(f,g,E,b,l[d+12],7,1804603682),b=o(b,f,g,E,l[d+13],12,-40341101),E=o(E,b,f,g,l[d+14],17,-1502002290),g=o(g,E,b,f,l[d+15],22,1236535329),f=s(f,g,E,b,l[d+1],5,-165796510),b=s(b,f,g,E,l[d+6],9,-1069501632),E=s(E,b,f,g,l[d+11],14,643717713),g=s(g,E,b,f,l[d+0],20,-373897302),f=s(f,g,E,b,l[d+5],5,-701558691),b=s(b,f,g,E,l[d+10],9,38016083),E=s(E,b,f,g,l[d+15],14,-660478335),g=s(g,E,b,f,l[d+4],20,-405537848),f=s(f,g,E,b,l[d+9],5,568446438),b=s(b,f,g,E,l[d+14],9,-1019803690),E=s(E,b,f,g,l[d+3],14,-187363961),g=s(g,E,b,f,l[d+8],20,1163531501),f=s(f,g,E,b,l[d+13],5,-1444681467),b=s(b,f,g,E,l[d+2],9,-51403784),E=s(E,b,f,g,l[d+7],14,1735328473),g=s(g,E,b,f,l[d+12],20,-1926607734),f=a(f,g,E,b,l[d+5],4,-378558),b=a(b,f,g,E,l[d+8],11,-2022574463),E=a(E,b,f,g,l[d+11],16,1839030562),g=a(g,E,b,f,l[d+14],23,-35309556),f=a(f,g,E,b,l[d+1],4,-1530992060),b=a(b,f,g,E,l[d+4],11,1272893353),E=a(E,b,f,g,l[d+7],16,-155497632),g=a(g,E,b,f,l[d+10],23,-1094730640),f=a(f,g,E,b,l[d+13],4,681279174),b=a(b,f,g,E,l[d+0],11,-358537222),E=a(E,b,f,g,l[d+3],16,-722521979),g=a(g,E,b,f,l[d+6],23,76029189),f=a(f,g,E,b,l[d+9],4,-640364487),b=a(b,f,g,E,l[d+12],11,-421815835),E=a(E,b,f,g,l[d+15],16,530742520),g=a(g,E,b,f,l[d+2],23,-995338651),f=c(f,g,E,b,l[d+0],6,-198630844),b=c(b,f,g,E,l[d+7],10,1126891415),E=c(E,b,f,g,l[d+14],15,-1416354905),g=c(g,E,b,f,l[d+5],21,-57434055),f=c(f,g,E,b,l[d+12],6,1700485571),b=c(b,f,g,E,l[d+3],10,-1894986606),E=c(E,b,f,g,l[d+10],15,-1051523),g=c(g,E,b,f,l[d+1],21,-2054922799),f=c(f,g,E,b,l[d+8],6,1873313359),b=c(b,f,g,E,l[d+15],10,-30611744),E=c(E,b,f,g,l[d+6],15,-1560198380),g=c(g,E,b,f,l[d+13],21,1309151649),f=c(f,g,E,b,l[d+4],6,-145523070),b=c(b,f,g,E,l[d+11],10,-1120210379),E=c(E,b,f,g,l[d+2],15,718787259),g=c(g,E,b,f,l[d+9],21,-343485551),f=i(f,u),g=i(g,h),E=i(E,p),b=i(b,m);return n(f)+n(g)+n(E)+n(b)}let Tke=1,PS=console,mi=class{static setLogger(e){PS=e}constructor(e){St(this,"lockingPromise",q.resolve()),St(this,"locks",0),St(this,"name",""),St(this,"lockId",void 0),this.lockId=Tke++,e&&(this.name=e),PS.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(e){let t;this.locks+=1,PS.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat("string"==typeof e?e:""));const n=new q(r=>{t=()=>{this.locks-=1,PS.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat("string"==typeof e?e:"")),r()}}),i=this.lockingPromise.then(()=>t);return this.lockingPromise=this.lockingPromise.then(()=>n),i}};function hp(e,t){return function(n,i,r){const o=r.value;if("function"!=typeof o)throw new Error("Cannot use mutex on object property.");return r.value=C(function*(){const s=this[t];if(!s)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(e));const a=yield s.lock("From ".concat(e,".").concat(i));try{for(var c=arguments.length,l=new Array(c),d=0;d<c;d++)l[d]=arguments[d];return yield o.apply(this,l)}finally{a()}}),r}}const vn={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function rP(e,t){const n=Math.floor(t.timeout*Math.pow(t.timeoutFactor,e));return Math.min(t.maxRetryTimeout,n)}function Fs(e,t,n,i){const r=Object.assign({},vn,i);let o=r.timeout;const s=function(){var l=C(function*(){var d;yield(d=o,new q(u=>{window.setTimeout(u,d)})),o*=r.timeoutFactor,o=Math.min(r.maxRetryTimeout,o)});return function(){return l.apply(this,arguments)}}();let a=!1;const c=new q(function(){var l=C(function*(d,u){t=t||(()=>!1),n=n||(()=>!0);for(let h=0;h<r.maxRetryCount;h+=1){if(a)return u(new M(S.OPERATION_ABORTED));try{const p=yield e();if(!t(p,h)||h+1===r.maxRetryCount)return d(p);yield s()}catch(p){if(!n(p,h)||h+1===r.maxRetryCount)return u(p);yield s()}}});return function(d,u){return l.apply(this,arguments)}}());return c.cancel=()=>a=!0,c}class CK{constructor(t){St(this,"input",[]),St(this,"size",void 0),this.size=t}add(t){this.input.push(t),this.input.length>this.size&&this.input.splice(0,1)}mean(){var t;return 0===this.input.length?0:Ps(t=this.input).call(t,(n,i)=>n+i)/this.input.length}}let MS,xS=0,oP=0;function sP(e,t,n,i){return new q((r,o)=>{t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),xS+=wa(t.data)):n&&(t.data.size?xS+=t.data.size:t.data instanceof FormData?xS+=_K(t.data):xS+=wa(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,nr.request(t).then(s=>{"string"==typeof s.data?oP+=wa(s.data):s.data instanceof ArrayBuffer||s.data instanceof Uint8Array?oP+=s.data.byteLength:oP+=wa(JSON.stringify(s.data)),i&&r({data:s.data,headers:s.headers}),r(s.data)}).catch(s=>{nr.isCancel(s)?o(new M(S.OPERATION_ABORTED,"cancel token canceled")):o("ECONNABORTED"===s.code?new M(S.NETWORK_TIMEOUT,s.message):s.response?new M(S.NETWORK_RESPONSE_ERROR,s.response.status):new M(S.NETWORK_ERROR,s.message))})})}function wke(e,t){return aP.apply(this,arguments)}function aP(){return aP=C(function*(e,t){const n=new Blob([t.data],{type:"buffer"});return yield sP(e,te(te({},t),{},{data:n,headers:{"Content-Type":"application/octet-stream"}}),!0)}),aP.apply(this,arguments)}const TK=()=>void 0!==window.isSecureContext,No=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(t&&t[1]&&t[2]){const i=t[2];return"".concat(t[1],".").concat(i)}return"4.0.0.999"}("4.22.1"),cP=function(){try{return!0===JSON.parse("true")}catch{return!0}}();let xd=function(e){return e.Default="default",e.Auto="auto",e.Relay="relay",e.SdRtn="sd-rtn",e}({});const ii=function(){const e="us".concat("erna","me"),t="pa".concat("sswo","rd"),n=["t","s","t"];n.splice(1,0,"e");const i=n.join(""),r=[];for(let a=0;a<6;a++)r.push("1");const o=r.join(""),s={};return s[e]=i,s[t]=o,Object.assign(s,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=ii;const lP={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},dP="v4.22.1-0-g1c8e27e9(9/19/2024, 2:23:30 PM)",Jt=te(te({PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:lP,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,CUSTOM_ADAPTATION_DEFAULT_MODE:"",ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,ENABLE_PRELOAD:!0,DISABLE_SCREEN_SHARE_REMB:!1},{ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,USE_PUB_RTX:!0,USE_SUB_RTX:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_DATASTREAM_2:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,USE_XR:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,ENABLE_PREALLOC_PC:!1,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:2,ENABLE_PRE_SUB:!1,ENABLE_AUT_FEEDBACK:!1}),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0});function st(e,t,n){var i,r,o;Y(i=Object.keys(Jt)).call(i,e)&&(!n&&Y(r=Object.keys(_l)).call(r,e)||(Jt[e]=t,"ENABLE_VIDEO_SEI"===e&&!0===t&&(Jt.ENABLE_ENCODED_TRANSFORM=!0),"USE_NEW_NETWORK_CONFIG"===e&&t&&(Jt.USE_NEW_NETWORK_CONFIG=o=!!t,o&&(Jt.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],Jt.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],Jt.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],Jt.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],Jt.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",Jt.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",Jt.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),"ENABLE_PRE_SUB"===e&&t&&(Jt.ENABLE_INSTANT_VIDEO=!0,Jt.ENABLE_PREALLOC_PC=!0),"ENABLE_SVC"===e&&t&&(Jt.ENABLE_AUT_CC=!0)))}function R(e){return Jt[e]}cP||(Jt.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Jt.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Jt.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Jt.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Jt.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Jt.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Jt.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Jt.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Jt.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Jt.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Jt.AREAS=["NORTH_AMERICA","OVERSEA"]);const _l={};var Ce=function(e){return e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_DC_ID="SET_DC_id",e.SET_UID="SET_UID",e.SET_INT_UID="SET_INT_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.AVOID_JOIN_START="AVOID_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",e.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",e.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS",e.SET_USE_P2P="SET_USE_P2P",e.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",e}(Ce||{});class Ike{constructor(t,n,i,r){St(this,"state",void 0),this.state={codec:t,audioCodec:n,mode:i,clientId:r,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:xd.Default}}dispatch(t){this.state=function(n,i){switch(i.type){case Ce.SET_SESSION_ID:return te(te({},n),{},{sessionId:i.sessionId});case Ce.SET_P2P_ID:return te(te({},n),{},{p2pId:i.p2pId});case Ce.SET_UID:return te(te({},n),{},{uid:i.uid});case Ce.SET_INT_UID:return te(te({},n),{},{intUid:i.intUid});case Ce.SET_PUB_ID:return te(te({},n),{},{pubId:i.pubId});case Ce.KEY_METRIC_CLIENT_CREATED:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{clientCreated:i.metric})});case Ce.KEY_METRIC_JOIN_START:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{joinStart:i.metric})});case Ce.AVOID_JOIN_START:return te(te({},n),{},{avoidJoinStart:i.avoidJoinStart});case Ce.KEY_METRIC_JOIN_END:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{joinEnd:i.metric})});case Ce.KEY_METRIC_REQUEST_AP_START:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{requestAPStart:i.metric})});case Ce.KEY_METRIC_REQUEST_AP_END:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{requestAPEnd:i.metric})});case Ce.KEY_METRIC_JOIN_GATEWAY_START:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{joinGatewayStart:i.metric})});case Ce.KEY_METRIC_JOIN_GATEWAY_END:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{joinGatewayEnd:i.metric})});case Ce.KEY_METRIC_PEER_CONNECTION_START:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{peerConnectionStart:i.metric})});case Ce.KEY_METRIC_PEER_CONNECTION_END:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{peerConnectionEnd:i.metric})});case Ce.KEY_METRIC_DESCRIPTION_START:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{descriptionStart:i.metric})});case Ce.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{signalChannelOpen:i.metric})});case Ce.KEY_METRIC_ICE_CONNECTION_END:return te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{iceConnectionEnd:i.metric})});case Ce.KEY_METRIC_PUBLISH:{const r=n.keyMetrics.publish,o=r.findIndex(s=>s.trackId===i.metric.trackId);return-1!==o?(r[o]=te(te({},r[o]),i.metric),te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{publish:[...r]})})):te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{publish:[...n.keyMetrics.publish,i.metric]})})}case Ce.KEY_METRIC_SUBSCRIBE:{const r=n.keyMetrics.subscribe,o=r.findIndex(s=>s.userId===i.metric.userId&&s.type===i.metric.type);return-1!==o?(r[o]=te(te({},r[o]),i.metric),te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{subscribe:[...r]})})):te(te({},n),{},{keyMetrics:te(te({},n.keyMetrics),{},{subscribe:[...n.keyMetrics.subscribe,i.metric]})})}case Ce.SET_CLOUD_PROXY_SERVER_MODE:return n.cloudProxyServerMode=i.mode,n;case Ce.RECORD_JOIN_CHANNEL_SERVICE:return"number"!=typeof i.index?n.joinChannelServiceRecords=[...n.joinChannelServiceRecords,i.record]:(n.joinChannelServiceRecords[i.index]=te(te({},n.joinChannelServiceRecords[i.index]),i.record),n.joinChannelServiceRecords=[...n.joinChannelServiceRecords]),n;case Ce.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return n.joinChannelServiceRecords=[],n;case Ce.RESET_KEY_METRICS:return n.keyMetrics={publish:[],subscribe:[]},n;case Ce.SET_USE_P2P:return te(te({},n),{},{useP2P:i.val});case Ce.SET_TRANSPORT_TYPE:return te(te({},n),{},{p2pTransport:i.val});default:return n}}(this.state,t)}set sessionId(t){this.dispatch({type:Ce.SET_SESSION_ID,sessionId:t})}get sessionId(){return this.state.sessionId}set codec(t){this.state.codec=t}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(t){this.dispatch({type:Ce.SET_P2P_ID,p2pId:t})}get p2pId(){return this.state.p2pId}set dcId(t){this.dispatch({type:Ce.SET_DC_ID,dcId:t})}get dcId(){return this.state.dcId}set uid(t){this.dispatch({type:Ce.SET_UID,uid:t})}get uid(){return this.state.uid}set intUid(t){this.dispatch({type:Ce.SET_INT_UID,intUid:t})}get intUid(){return this.state.intUid}set pubId(t){this.dispatch({type:Ce.SET_PUB_ID,pubId:t})}get pubId(){return this.state.pubId}set cloudProxyServerMode(t){this.dispatch({type:Ce.SET_CLOUD_PROXY_SERVER_MODE,mode:t})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(t){this.dispatch({type:Ce.SET_USE_P2P,val:t})}get useP2P(){return this.state.useP2P}set p2pTransport(t){this.dispatch({type:Ce.SET_TRANSPORT_TYPE,val:t})}get p2pTransport(){return this.state.p2pTransport}clientCreated(){this.dispatch({type:Ce.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:Ce.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:Ce.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:Ce.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:Ce.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:Ce.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:Ce.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:Ce.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:Ce.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:Ce.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:Ce.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:Ce.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(t,n,i,r){this.dispatch({type:Ce.KEY_METRIC_PUBLISH,metric:te(te({trackId:t,type:n},i&&{publishStart:i}),r&&{publishEnd:r})})}subscribe(t,n,i,r,o,s,a){this.dispatch({type:Ce.KEY_METRIC_SUBSCRIBE,metric:te(te(te(te(te({userId:t,type:n},i&&{subscribeStart:i}),r&&{subscribeEnd:r}),o&&{firstFrame:o}),s&&{streamAdded:s}),a&&{firstDecoded:a})})}massSubscribe(t,n,i,r){t.forEach(o=>{this.dispatch({type:Ce.KEY_METRIC_SUBSCRIBE,metric:te(te(te({userId:o.userId,type:o.type},n&&{subscribeStart:n}),i&&{subscribeEnd:i}),r&&{firstFrame:r})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(t,n){"gateway"===t.service&&Array.isArray(t.urls)&&(t.urls=t.urls.map(i=>i.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return"number"!=typeof n?(this.dispatch({type:Ce.RECORD_JOIN_CHANNEL_SERVICE,record:te(te({},t),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(n<0||n>=this.state.joinChannelServiceRecords.length||this.dispatch({type:Ce.RECORD_JOIN_CHANNEL_SERVICE,record:t,index:n}),n)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:Ce.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:Ce.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(t){this.dispatch({type:Ce.AVOID_JOIN_START,avoidJoinStart:t})}}let kS=function(e){return e.h264="h264",e.h265="h265",e.vp8="vp8",e.vp9="vp9",e.av1="av1",e}({});!function(e){e.opus="opus",e.pcma="pcma",e.pcmu="pcmu",e.g722="g722"}({});let Ake=0;function $t(e,t,n){return(t="symbol"==typeof(r=function(o,s){if("object"!=typeof o||!o)return o;var a=o[Symbol.toPrimitive];if(void 0!==a){var c=a.call(o,"string");if("object"!=typeof c)return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(t))?r:r+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;var r}function RK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?RK(Object(n),!0).forEach(function(i){$t(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RK(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}const AK=new class extends xt{constructor(){super(...arguments),$t(this,"currentUploadLogID",0)}reportLogUploadError(e){const{errorRange:t}=e;t[t.length-1]&&t[t.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=t[t.length-1],this.emit("REPORT_LOG_UPLOAD",e))}};class Dke{constructor(t){$t(this,"logger",void 0),$t(this,"prefixLists",[]),this.logger=t}debug(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.logger.debug(...this.prefixLists,...n)}info(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.logger.info(...this.prefixLists,...n)}warning(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.logger.warning(...this.prefixLists,...n)}error(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.logger.error(...this.prefixLists,...n)}prefix(t){return this.prefixLists.push(t),this}popPrefix(){return this.prefixLists.pop(),this}}function uP(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function DK(){const e=new Date,t=/((\d+:){2}\d+)/.exec((new Date).toUTCString());return t?t?.[0]+":"+e.getUTCMilliseconds():e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const Po={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},LS=Date.now(),zg=e=>{for(const t in Po)if(Object.prototype.hasOwnProperty.call(Po,t)&&Po[t]===e)return t;return"DEFAULT"},_=new class{constructor(){$t(this,"proxyServerURL",void 0),$t(this,"logLevel",Po.DEBUG),$t(this,"uploadState","collecting"),$t(this,"uploadLogWaitingList",[]),$t(this,"uploadLogUploadingList",[]),$t(this,"uploadErrorCount",0),$t(this,"currentLogID",0),$t(this,"url",void 0),$t(this,"extLog",(e,t)=>{this.appendLogToWaitingList(e,...t)})}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=[Po.DEBUG].concat(t);this.log.apply(this,i)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=[Po.INFO].concat(t);this.log.apply(this,i)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=[Po.WARNING].concat(t);this.log.apply(this,i)}warn(){this.warning(...arguments)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=[Po.ERROR].concat(t);this.log.apply(this,i)}upload(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=[Po.DEBUG].concat(t);this.uploadLog.apply(this,i)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){st("UPLOAD_LOG",!0)}disableLogUpload(){st("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new Dke(this).prefix(e)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Date.now()-LS<100)return void setTimeout(()=>{this.log(...t)},Date.now()-LS);const i=Math.max(0,Math.min(4,t[0]));if(t[0]=uP()+" Agora-SDK [".concat(zg(i),"]:"),this.appendLogToWaitingList(i,...t),i<this.logLevel)return;const r=uP()+" %cAgora-SDK [".concat(zg(i),"]:");let o=[];if(!R("USE_NEW_LOG"))switch(i){case Po.DEBUG:o=[r,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,o);break;case Po.INFO:o=[r,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,o);break;case Po.WARNING:o=[r,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,o);break;case Po.ERROR:o=[r,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,o)}}uploadLog(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Date.now()-LS<100)return void setTimeout(()=>{this.uploadLog(...t)},Date.now()-LS);const i=Math.max(0,Math.min(4,t[0]));t[0]=uP()+" Agora-SDK [".concat(zg(i),"]:"),this.appendLogToWaitingList(i,...t)}appendLogToWaitingList(e){if(!R("UPLOAD_LOG"))return;for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];Array.isArray(n[0])?n[0][0]=DK()+" Agora-SDK [".concat(zg(e),"]:"):n[0]=DK()+" Agora-SDK [".concat(zg(e),"]:");let r="";n.forEach(o=>{"object"==typeof o&&(o=JSON.stringify(o)),r+="".concat(o," ")}),this.uploadLogWaitingList.push({payload_str:r,log_level:e,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}uploadLogs(){var e=this;return C(function*(){const t=e.uploadLogUploadingList,n={sdk_version:No,process_id:R("PROCESS_ID"),payload:JSON.stringify(t)};return Fs(C(function*(){const i=yield nr.post(e.url||(e.proxyServerURL?"https://".concat(e.proxyServerURL,"/ls/?h=").concat(R("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(R("LOG_UPLOAD_SERVER"),"/upload/v1")),n,{responseType:"text"});if("OK"!==i.data){const r=new Error("unexpected upload log response");throw r.response=i,r}}),()=>(e.uploadLogUploadingList=[],!1),i=>{const r={status:-1,message:i.message,errorRange:t.map(o=>o.log_item_id)};return i.response?(r.status=i.response.status,r.data=i.response.data,r.headers=i.response.headers):i.request&&(r.status=i.request.status),AK.reportLogUploadError(r),!0},{timeout:R("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:R("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})})()}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,R("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),R("UPLOAD_LOG_INTERVAL"))}).catch(e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),R("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),R("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var OK;function Oke(e){return Kn(e.reportId,"params.reportId",0,100,!1),Kn(e.category,"params.category",0,100,!1),Kn(e.event,"params.event",0,100,!1),Kn(e.label,"params.label",0,100,!1),ot(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(OK={}).FREE="free",OK.UPLOADING="uploading",function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}({});const Nke={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let Yn=function(e){return e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics",e.PC_STATS="pc_stats",e.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",e}({}),kt=function(e){return e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",e.PC_STATS="io.agora.pb.Wrtc.PCStats",e.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",e}({});!function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}({});let Pke=function(e){return e[e.SESSION=26]="SESSION",e[e.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",e[e.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",e[e.JOIN_GATEWAY=28]="JOIN_GATEWAY",e[e.PUBLISH=30]="PUBLISH",e[e.SUBSCRIBE=29]="SUBSCRIBE",e[e.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",e[e.STREAM_SWITCH=32]="STREAM_SWITCH",e[e.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",e[e.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",e[e.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",e[e.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",e[e.API_INVOKE=41]="API_INVOKE",e[e.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",e[e.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",e[e.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",e[e.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",e[e.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",e[e.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",e[e.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",e[e.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",e[e.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",e[e.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",e[e.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",e[e.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",e[e.USER_ANALYTICS=1e4]="USER_ANALYTICS",e[e.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",e}({});function le(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n,i){const r=i.value;if("function"==typeof r){const o=e.className||t.__className__||("AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name);i.value=function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];let l=a;if(e.argsMap)try{l=e.argsMap(this,...a)}catch(u){_.warning(u),l=[]}try{JSON.stringify(l)}catch{_.warning("arguments for method ".concat(o,".").concat(String(n)," not serializable for apiInvoke.")),l=[]}const d=(e.report||ne).reportApiInvoke(this._sessionId||null,{name:"".concat(o,".").concat(String(n)),options:l,tag:jt.TRACER,reportResult:e.reportResult},e.throttleTime);try{const u=r.apply(this,a);return u instanceof q?u.then(h=>(d.onSuccess(e.reportResult&&h),h)).catch(h=>{throw d.onError(h),h}):(d.onSuccess(e.reportResult&&u),u)}catch(u){throw d.onError(u),u}}}return i}}const ne=new class{constructor(){var e=this;$t(this,"baseInfoMap",new Map),$t(this,"proxyServer",void 0),$t(this,"eventUploadTimer",void 0),$t(this,"setSessionIdTimer",void 0),$t(this,"url",void 0),$t(this,"sids",new Set),$t(this,"backupUrl",void 0),$t(this,"_appId",void 0),$t(this,"keyEventUploadPendingItems",[]),$t(this,"normalEventUploadPendingItems",[]),$t(this,"apiInvokeUploadPendingItems",[]),$t(this,"apiInvokeCount",0),$t(this,"ltsList",[]),$t(this,"lastSendNormalEventTime",Date.now()),$t(this,"customReportCounterTimer",void 0),$t(this,"customReportCount",0),$t(this,"extApiInvoke",function(){var t=C(function*(n){for(const i of n){const r=_e(_e({},i),{},{sid:null,invokeId:++e.apiInvokeCount,tag:jt.TRACER});e.sendApiInvoke(r)}});return function(n){return t.apply(this,arguments)}}()),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),R("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),R("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(e){return this.baseInfoMap.get(e)}adjustSessionStartTime(e){if(!this.baseInfoMap.has(e)&&!this.baseInfoMap.get(e))return void _.error("adjust session ".concat(e," start time, sid is not exist or info is undefined"));const t=this.baseInfoMap.get(e),n=Date.now(),i=t.startTime;t.startTime=n,_.debug("rewrite session ".concat(e," startTime: ").concat(n," , ").concat(n-i,"ms")),this.baseInfoMap.set(e,t)}setAppId(e){this._appId=e}reportApiInvoke(e,t,n){t.timeout=t.timeout||6e4,t.reportResult=void 0===t.reportResult||t.reportResult;const i=Date.now();this.apiInvokeCount+=1;const r=this.apiInvokeCount,o=()=>({tag:t.tag,invokeId:r,sid:e,name:t.name,apiInvokeTime:i,options:t.options,states:t.states||null}),s=!!R("SHOW_REPORT_INVOKER_LOG");s&&_.info("".concat(t.name," start"),t.options);let a=!1;qn(t.timeout).then(()=>{a||(this.sendApiInvoke(_e(_e({},o()),{},{error:S.API_INVOKE_TIMEOUT,success:!1})),_.debug("".concat(t.name," timeout")))});const c=new M(S.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:l=>{const d=()=>{if(a)throw c;return a=!0,this.sendApiInvoke(_e(_e({},o()),{},{success:!0},t.reportResult&&{result:l})),s&&_.info("".concat(t.name," onSuccess")),l};return n?EK(d,t.name+"Success",n,()=>a=!0):d()},onError:l=>{const d=()=>{if(a)throw l;a=!0,this.sendApiInvoke(_e(_e({},o()),{},{success:!1,error:l})),s&&_.info("".concat(t.name," onFailure"),l.toString())};return n?EK(d,t.name+"Error",n,()=>a=!0):d()}}}sessionInit(e,t){if(this.baseInfoMap.has(e))return;const n=Date.now(),i=this.createBaseInfo(e,n);i.cname=t.cname;const r=Object.assign({},{willUploadConsoleLog:R("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:cP?"global":"oversea",areas:R("AREAS")&&R("AREAS").join(",")},t.extend),{stringUid:o,channelProfile:s,channelMode:a,isABTestSuccess:c,lsid:l,clientRole:d}=t,u=Date.now(),h=_e(_e({},i),{},{eventType:Yn.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,buildFormat:t.buildFormat,build:dP,lts:u,elapse:u-n,extend:JSON.stringify(r),mode:t.mode,process:R("PROCESS_ID"),appType:R("APP_TYPE"),success:!0,version:No,stringUid:o,channelProfile:s,channelMode:a,isABTestSuccess:c,lsid:l,clientType:Y(p=window.navigator.userAgent).call(p,"AgoraWebView")?42:20,clientRole:d,serviceId:R("PROCESS_ID"),extensionID:R("PLUGIN_INFO").join(",")||""});var p;this.send({type:kt.SESSION,data:h},!0)}joinChooseServer(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e({},i),{},{eventType:Yn.JOIN_CHOOSE_SERVER,lts:r,eventElapse:t.elapse||r-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:r-n.startTime,success:t.succ,chooseServerAddrList:JSON.stringify(t.serverList),uid:t.uid?parseInt(t.uid):null,cid:t.cid?parseInt(t.cid):null,chooseServerIp:t.csIp||"",opid:t.opid,unilbsServerIds:t.unilbsServerIds,extend:t.extend||void 0,isHttp3:t.isHttp3,corssRegionTagReq:t.corssRegionTagReq||void 0,corssRegionTagRes:t.corssRegionTagRes||void 0});this.send({type:kt.JOIN_CHOOSE_SERVER,data:o},!0)}reqUserAccount(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e({},i),{},{eventType:Yn.REQ_USER_ACCOUNT,lts:r,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:t.elapse||r-n.startTime,eventElapse:r-t.lts,extend:JSON.stringify(t.extend)});this.send({type:kt.REQ_USER_ACCOUNT,data:o},!0)}joinGateway(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info;t.vid&&(i.vid=t.vid),i.uid=t.uid,i.cid=t.cid;const r=Date.now(),{firstSuccess:o,avoidJoinStartTime:s}=t,a=r-(o&&s?s:n.startTime),c=_e(_e({},i),{},{eventType:Yn.JOIN_GATEWAY,lts:r,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,errorMsg:t.errorMsg||"",elapse:a,eventElapse:r-t.lts,firstSuccess:o,signalChannel:t.signalChannel,preload:t.preload?1:0});t.succ&&(n.lastJoinSuccessTime=r),this.send({type:kt.JOIN_GATEWAY,data:c},!0)}joinChannelTimeout(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=Date.now(),r=_e(_e({},n.info),{},{lts:i,timeout:t,elapse:i-n.startTime});this.send({type:kt.JOIN_CHANNEL_TIMEOUT,data:r},!0)}publish(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e({},i),{},{eventType:Yn.PUBLISH,lts:r,eventElapse:t.eventElapse,elapse:r-n.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid});this.send({type:kt.PUBLISH,data:o},!0)}subscribe(e,t,n){const i=this.baseInfoMap.get(e);if(!i)return;const r=i.info,o=Date.now(),s=_e(_e({},r),{},{eventType:Yn.SUBSCRIBE,lts:o,eventElapse:t.eventElapse,elapse:o-i.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid,preSsrc:t.preSsrc?1:0},n&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof t.peerid?s.peerSuid=t.peerid:s.peer=t.peerid,this.send({type:kt.SUBSCRIBE,data:s},!0)}wsCompressorInit(e){var t;const n=[...Xr(t=this.baseInfoMap).call(t)],r=this.baseInfoMap.get(n.length?n[0]:"UnableToGetSid");if(!r)return;const o=r.info,s=Date.now(),a=_e(_e({},o),{},{eventType:Yn.WS_COMPRESSOR_INIT,lts:s,eventElapse:e.eventElapse,elapse:s-r.startTime,status:e.status?1:2});this.send({type:kt.WS_COMPRESSOR_INIT,data:a},!0)}firstRemoteVideoDecode(e,t,n,i){const r=this.baseInfoMap.get(e);if(!r)return;const o=r.info,s=Date.now(),a=_e(_e(_e({},o),i),{},{elapse:s-r.startTime,eventType:t,lts:s,firstDecodeFrame:Math.max((i.firstFrame||s)-r.startTime,0),apEnd:Math.max(i.apEnd-r.startTime,0),apStart:Math.max(i.apStart-r.startTime,0),joinGwEnd:Math.max(i.joinGwEnd-r.startTime,0),joinGwStart:Math.max(i.joinGwStart-r.startTime,0),pcEnd:Math.max(i.pcEnd-r.startTime,0),pcStart:Math.max(i.pcStart-r.startTime,0),subscriberEnd:Math.max(i.subscriberEnd-r.startTime,0),subscriberStart:Math.max(i.subscriberStart-r.startTime,0),videoAddNotify:Math.max(i.videoAddNotify-r.startTime,0)});this.send({type:n,data:a},!0)}firstRemoteFrame(e,t,n,i){const r=this.baseInfoMap.get(e);if(!r)return;const o=r.info,s=Date.now(),a=_e(_e(_e({},o),i),{},{elapse:s-r.startTime,eventType:t,lts:s});this.send({type:n,data:a},!0)}pcStats(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e(_e({},i),t),{},{vid:void 0===i.vid?0:Number(i.vid),elapse:r-n.startTime,eventType:Yn.PC_STATS,lts:r,preallocation:t.preallocation?1:0});this.send({type:kt.PC_STATS,data:o},!0)}updateRemoteRTPCapabilities(e,t){if(e){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e(_e({},i),t),{},{vid:void 0===i.vid?0:Number(i.vid),eventType:Yn.UPDATE_REMOTE_RTPCAPABILITIES,lts:r});this.send({type:kt.UPDATE_REMOTE_RTPCAPABILITIES,data:o},!0)}}onGatewayStream(e,t,n,i){const r=this.baseInfoMap.get(e);if(!r)return;const o=r.info,s=Date.now(),a=_e(_e(_e({},o),i),{},{eventType:t,lts:s});this.send({type:n,data:a},!0)}streamSwitch(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e({},i),{},{eventType:Yn.STREAM_SWITCH,lts:r,isDual:t.isdual,elapse:r-n.startTime,success:t.succ});this.send({type:kt.STREAM_SWITCH,data:o},!0)}requestProxyAppCenter(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e({},i),{},{eventType:Yn.REQUEST_PROXY_APPCENTER,lts:r,eventElapse:r-t.lts,elapse:r-n.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:kt.REQUEST_PROXY_APPCENTER,data:o},!0)}requestProxyWorkerManager(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e({},i),{},{eventType:Yn.REQUEST_PROXY_WORKER_MANAGER,lts:r,eventElapse:r-t.lts,elapse:r-n.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:kt.REQUEST_PROXY_WORKER_MANAGER,data:o},!0)}setProxyServer(e){this.proxyServer=e,_.debug(e?"reportProxyServerurl: ".concat(e):"disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e({},i),{},{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:t.audioPublishDuration>0?1:-1,videotag:t.videoPublishDuration>0?1:-1,lts:r,elapse:r-n.startTime,joinChannelSuccessElapse:r-(n.lastJoinSuccessTime||r),peerPublishDurationVideo:t.videoPublishDuration,peerPublishDurationAudio:t.audioPublishDuration});this.send({type:kt.PEER_PUBLISH_STATUS,data:o},!0)}workerEvent(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now();(function(o,s,a){const c=o[s];if(!c||"string"!=typeof c)return[o];o[s]="";const l=wa(JSON.stringify(o));let d=0;const u=[];let h=0;for(let p=0;p<c.length;p++)h+=c.charCodeAt(p)<=127?1:3,h<=1300-l||(u[u.length]=te(te({},o),{},{[s]:c.substring(d,p)}),d=p,h=c.charCodeAt(p)<=127?1:3);return d!==c.length-1&&(u[u.length]=te(te({},o),{},{[s]:c.substring(d)})),u})(_e(_e(_e({},i),t),{},{elapse:r-n.startTime,lts:r,productType:"WebRTC"}),"payload").forEach(o=>this.send({type:kt.WORKER_EVENT,data:o},!0))}apworkerEvent(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e(_e({},i),t),{},{elapse:r-n.startTime,lts:r});this.send({type:kt.AP_WORKER_EVENT,data:o},!0)}joinWebProxyAP(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e(_e({},i),t),{},{elapse:r-n.startTime,lts:r,extend:t.extend||void 0});this.send({type:kt.JOIN_WEB_PROXY_AP,data:o},!0)}WebSocketQuit(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const i=n.info,r=Date.now(),o=_e(_e(_e({},i),t),{},{elapse:r-n.startTime,lts:r});this.send({type:kt.WEBSOCKET_QUIT,data:o},!0)}sendCustomReportMessage(e,t){var n=this;return C(function*(){if(n.customReportCount+=t.length,n.customReportCount>R("CUSTOM_REPORT_LIMIT"))throw new M(S.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);n.customReportCounterTimer||(n.customReportCounterTimer=window.setInterval(()=>{n.customReportCount=0},5e3));const i=Date.now(),r=t.map(o=>({type:kt.USER_ANALYTICS,data:_e(_e({sid:e},o),{},{lts:i})}));try{R("NEW_REPORT_SERVER")?yield n.postDataToStatsCollector2(r):yield n.postDataToStatsCollector(r)}catch(o){throw _.error("send custom report message failed",o.toString()),new M(S.CUSTOM_REPORT_SEND_FAILED,o.message)}})()}sendApiInvoke(e){const t=R("NOT_REPORT_EVENT");if(e.tag&&Y(t)&&Y(t).call(t,e.tag))return!1;if(null===e.sid)return this.apiInvokeUploadPendingItems.push(e),!1;const n=this.baseInfoMap.get(e.sid);if(!n)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:i,uid:r,cid:o}=n.info;let s;if(e.lts=e.lts||Date.now(),e.error)if(e.error instanceof M){const{code:c,message:l}=e.error;s=c||l||e.error.toString()}else s=e.error.toString();const a={invokeId:e.invokeId,sid:e.sid,cname:i,cid:o,uid:r,lts:e.lts,success:e.success,elapse:e.lts-n.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?s:void 0,errorMsg:e.error?JSON.stringify(e.error):void 0};return this.send({type:kt.API_INVOKE,data:a},!1),!0}addSid(e){this.sids.add(e)}removeSid(e){this.sids.delete(e)}appendSessionId(){const e=this.apiInvokeUploadPendingItems;if(0===e.length)return;const t=Array.from(this.sids).find(n=>null!==n);t&&e.forEach(n=>{n&&(n.sid=t,this.sendApiInvoke(Object.assign({},n)))}),e.length=0}send(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>R("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,t){const n=[],i=[];for(;e.length;){const o=e.shift();n.length<20?n.push(o):i.push(o)}e.push(...i);for(const o of[...n]){var r;-1!==this.ltsList.indexOf(o.data.lts)?(o.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(o.data.lts)):(this.ltsList.push(o.data.lts),Ig(r=this.ltsList).call(r,(s,a)=>s-a))}return t||(this.lastSendNormalEventTime=Date.now()),R("ENABLE_EVENT_REPORT")&&n.length&&(R("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(n):this.postDataToStatsCollector(n)).catch((o=>s=>{R("EVENT_REPORT_RETRY")&&(t?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(o):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(o),this.normalEventUploadPendingItems.length>R("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-R("NORMAL_EVENT_QUEUE_CAPACITY")),_.warning("report: drop normal events"))))})(n)),e}postDataToStatsCollector2(e){var t=this;return C(function*(){ln.networkState===Pr.OFFLINE&&(yield q.race([ln.onlineWaiter,qn(2*vn.maxRetryTimeout)]));const n=o=>{let s=new Uint8Array;return o.forEach(a=>{const c=eP(JSON.stringify(a.data)),l=new ArrayBuffer(5),d=(h=>{let p=0;return Object.entries(kt).forEach(m=>{let[f,g]=m;g===h.type&&(p=Pke[f])}),p})(a),u=new DataView(l);u.setUint16(0,c.byteLength,!0),u.setUint8(2,255&d),u.setUint8(3,d>>>8&255),u.setUint8(4,d>>>16&255),s=lK(s,new Uint8Array(l)),s=lK(s,c)}),s},i="event";let r=t.proxyServer?"https://".concat(t.proxyServer,"/rs/?h=").concat(R("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(i):"https://".concat(R("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(i);for(let o=0;o<2;o+=1){1===o&&(r=t.proxyServer?"https://".concat(t.proxyServer,"/rs/?h=").concat(R("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(i):"https://".concat(R("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(i));try{yield sP(r,{timeout:1e4,data:n(e),headers:_e(_e({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},t._appId&&{appid:t._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(s){if(1===o)throw s;continue}return}})()}postDataToStatsCollector(e){var t=arguments,n=this;return C(function*(){let i=t.length>1&&void 0!==t[1]&&t[1];const r={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:e.map(a=>JSON.stringify(a)),vid:(a=>{const c=a&&a.data.sid&&n.baseInfoMap.get(a.data.sid);return c&&c.info.vid&&+c.info.vid||0})(e[0])};ln.networkState===Pr.OFFLINE&&(yield q.race([ln.onlineWaiter,qn(2*vn.maxRetryTimeout)]));const o=i?"/events/proto-raws":"/events/messages";let s=n.url||(n.proxyServer?"https://".concat(n.proxyServer,"/rs/?h=").concat(R("EVENT_REPORT_DOMAIN"),"&p=").concat(R("STATS_COLLECTOR_PORT"),"&d=").concat(o):"https://".concat(R("EVENT_REPORT_DOMAIN"),":").concat(R("STATS_COLLECTOR_PORT")).concat(o));for(let a=0;a<2;a+=1){1===a&&(s=n.backupUrl||(n.proxyServer?"https://".concat(n.proxyServer,"/rs/?h=").concat(R("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(R("STATS_COLLECTOR_PORT"),"&d=").concat(o):"https://".concat(R("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(R("STATS_COLLECTOR_PORT")).concat(o)));try{i?yield wke(s,{timeout:1e4,data:r}):yield sP(s,{timeout:1e4,data:r})}catch(c){if(1===a)throw c;continue}return}})()}createBaseInfo(e,t){const n=Object.assign({},Nke);return n.sid=e,this.baseInfoMap.set(e,{info:n,startTime:t}),n}reportResourceTiming(e,t){const n=performance.getEntriesByName(e),i=n[n.length-1];i&&this.reportApiInvoke(t,{name:"Client.resourceTiming",options:i,tag:jt.TRACER}).onSuccess()}};AK.on("REPORT_LOG_UPLOAD",e=>{e.networkState=ln.networkState,ne.reportApiInvoke(null,{name:"logUploadError",options:e,tag:jt.TRACER}).onSuccess("logUploadError")});class N extends M{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",arguments.length>2?arguments[2]:void 0),$t(this,"name","AgoraRTCException")}print(){return super.print(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error",_)}throw(){super.throw(_)}}const Mke=["CHINA","GLOBAL"],NK=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],kd=[];function Ld(e,t){return!!t&&kd.some(n=>n.uid===e&&n.channelName===t)}var xke=Jz.forEach,PK=_y("forEach")?[].forEach:function(e){return xke(this,e,arguments.length>1?arguments[1]:void 0)};it({target:"Array",proto:!0,forced:[].forEach!=PK},{forEach:PK});var kke=$o("Array").forEach,Lke=ba,Fke=fi,Uke=Wi,Vke=kke,hP=Array.prototype,Bke={DOMTokenList:!0,NodeList:!0},Hke=Vt(function(e){var t=e.forEach;return e===hP||Uke(hP,e)&&t===hP.forEach||Fke(Bke,Lke(e))?Vke:t}),Gke=Ea,MK=Sy;it({target:"Object",stat:!0,forced:Sn(function(){MK(1)})},{keys:function(e){return MK(Gke(e))}});var xK=Vt(To.Object.keys),Wke=Vt(d8),zke=it,Kke=Dg,qke=_n([].reverse),kK=[1,2];zke({target:"Array",proto:!0,forced:String(kK)===String(kK.reverse())},{reverse:function(){return Kke(this)&&(this.length=this.length),qke(this)}});var Yke=$o("Array").reverse,$ke=Wi,Xke=Yke,pP=Array.prototype,LK=function(e){var t=e.reverse;return e===pP||$ke(pP,e)&&t===pP.reverse?Xke:t},Jke=Vt(LK),Qke=it,FK=Dg,eLe=xy,tLe=$r,UK=wD,nLe=dc,iLe=nl,rLe=Yy,oLe=cn,sLe=ky,aLe=Hz("slice"),cLe=oLe("species"),fP=Array,lLe=Math.max;Qke({target:"Array",proto:!0,forced:!aLe},{slice:function(e,t){var n,i,r,o=iLe(this),s=nLe(o),a=UK(e,s),c=UK(void 0===t?s:t,s);if(FK(o)&&((eLe(n=o.constructor)&&(n===fP||FK(n.prototype))||tLe(n)&&null===(n=n[cLe]))&&(n=void 0),n===fP||void 0===n))return sLe(o,a,c);for(i=new(void 0===n?fP:n)(lLe(c-a,0)),r=0;a<c;a++,r++)a in o&&rLe(i,r,o[a]);return i.length=r,i}});var dLe=$o("Array").slice,uLe=Wi,hLe=dLe,mP=Array.prototype,fLe=Vt(function(e){var t=e.slice;return e===mP||uLe(mP,e)&&t===mP.slice?hLe:t});function Q(e,t,n,i,r){var o,s,a,c={};return Hke(o=xK(i)).call(o,function(l){c[l]=i[l]}),c.enumerable=!!c.enumerable,c.configurable=!!c.configurable,("value"in c||c.initializer)&&(c.writable=!0),c=Wke(s=Jke(a=fLe(n).call(n)).call(a)).call(s,function(l,d){return d(e,t,l)||l},c),r&&void 0!==c.initializer&&(c.value=c.initializer?c.initializer.call(r):void 0,c.initializer=void 0),void 0===c.initializer&&(Uz(e,t,c),c=null),c}let gP=function(e){return e.L1T1="L1T1",e.L1T2="L1T2",e.L1T3="L1T3",e.L1T3_KEY="L1T3_KEY",e.L2T1_KEY="L2T1_KEY",e.L2T2_KEY="L2T2_KEY",e.L2T3_KEY="L2T3_KEY",e.L3T1_KEY="L3T1_KEY",e.L3T2_KEY="L3T2_KEY",e.L3T3_KEY="L3T3_KEY",e}({}),Qr=function(e){return e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver",e}({}),FS=function(e){return e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",e}({}),_P=function(e){return e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR",e}({}),Jo=function(e){return e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",e}({}),qi=function(e){return e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",e}({}),ce=function(e){return e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",e[e.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",e[e.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",e[e.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",e[e.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",e[e.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",e}({}),_t=function(e){return e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed",e}({}),he=function(e){return e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response",e.PRE_CONNECT_PC="pre_connect_pc",e.P2P_CONNECTION="p2p_connection",e.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",e.P2P_SUBSCRIBE="p2p_subscribe",e.P2P_UNSUBSCRIBE="p2p_unsubscribe",e.P2P_EXCHANGE_SDP="p2p_exchange_sdp",e.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",e.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",e.RECOVER_NOTIFICATION="recover_notification",e}({}),pe=function(e){return e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.PUBLISH_DATASTREAM="publish_datastream",e.UNPUBLISH="unpublish",e.UNPUBLISH_DATASTREAM="unpublish_datastream",e.SUBSCRIBE="subscribe",e.PRE_SUBSCRIBE="pre_subscribe",e.SUBSCRIBE_DATASTREAM="subscribe_datastream",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile",e.SET_PARAMETER="set_parameter",e.SET_RTM2_FLAG="set_rtm2_flag",e}({}),Kg=function(e){return e.WRTC_STATS="wrtc_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.EXTENSION_USAGE_STATS="extension_usage_stats",e}({}),Te=function(e){return e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_USER_LICENSE_BANNED="on_user_license_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",e.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",e.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list",e}({}),Yi=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({}),fe=function(e){return e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",e}({});function US(e){if("string"!=typeof e||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw _.error("Invalid Channel Name ".concat(e)),new N(S.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function VS(e){if(!function(t){return"number"==typeof t&&Math.floor(t)===t&&0<=t&&t<=4294967295}(e)&&!aK(e,1,255))throw new N(S.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");"string"==typeof e&&_.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let Ia=function(e){return e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e}({});const mLe={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},vP={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function EP(e,t){Kn(e.url,"".concat(t,".url"),1,1e3,!1),Mt(e.x)||ot(e.x,"".concat(t,".x"),0,1e4),Mt(e.y)||ot(e.y,"".concat(t,".y"),0,1e4),Mt(e.width)||ot(e.width,"".concat(t,".width"),0,1e4),Mt(e.height)||ot(e.height,"".concat(t,".height"),0,1e4),Mt(e.zOrder)||ot(e.zOrder,"".concat(t,".zOrder"),0,255),Mt(e.alpha)||ot(e.alpha,"".concat(t,".alpha"),0,1,!1)}const gLe={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let vl=function(e){return e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address",e}({}),bP=function(e){return e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",e}({}),Tn=function(e){return e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",e}({});function VK(e){if(!e.channelName)throw new N(S.INVALID_PARAMS,"invalid channelName in info");if("number"!=typeof e.uid)throw new N(S.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&Kn(e.token,"info.token",1,2047),VS(e.uid),US(e.channelName),!0}let $i=function(e){return e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile",e}({}),fc=function(e){return e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",e}({}),_r=function(e){return e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",e}({}),fp=function(e){return e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",e}({}),$e=function(e){return e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low",e}({}),ri=function(e){return e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response",e.RESET_CONNECTION_EVENTS="reset-connection-events",e.PRE_CONNECT_PC="pre-connect_pc",e}({}),BS=function(e){return e.P2P_DISCONNECTED="P2P_DISCONNECTED",e.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",e.TIMEOUT="TIMEOUT",e.UNKNOWN_REASON="UNKNOWN_REASON",e}({}),Ln=function(e){return e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data",e[e.DataStream0=256]="DataStream0",e[e.DataStream1=512]="DataStream1",e[e.DataStream2=1024]="DataStream2",e[e.DataStream3=2048]="DataStream3",e[e.DataStream4=4096]="DataStream4",e[e.DataStream5=8192]="DataStream5",e[e.DataStream6=16384]="DataStream6",e[e.DataStream7=32768]="DataStream7",e}({}),We=function(e){return e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="EXTENSIONS",e}({});const BK=[We.AFRICA,We.ASIA,We.CHINA,We.EUROPE,We.GLOBAL,We.INDIA,We.JAPAN,We.NORTH_AMERICA,We.OCEANIA,We.OVERSEA,We.SOUTH_AMERICA];let gi=function(e){return e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="GLOBAL",e}({});const jS={CHINA:{},ASIA:{CODE:gi.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:gi.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:gi.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:gi.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:gi.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:gi.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:gi.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:gi.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:gi.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:gi.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:gi.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:gi.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:gi.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};cP&&(jS.CHINA={CODE:gi.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let yP=function(e){return e.UPDATE_BITRATE_LIMIT="update_bitrate_limit",e}({});class jK extends xt{constructor(t,n){super(),y(this,"onICEConnectionStateChange",void 0),y(this,"onConnectionStateChange",void 0),y(this,"onDTLSTransportStateChange",void 0),y(this,"onDTLSTransportError",void 0),y(this,"onICETransportStateChange",void 0),y(this,"onFirstAudioReceived",void 0),y(this,"onFirstVideoReceived",void 0),y(this,"onFirstAudioDecoded",void 0),y(this,"onFirstVideoDecoded",void 0),y(this,"onFirstVideoDecodedTimeout",void 0),y(this,"onSelectedLocalCandidateChanged",void 0),y(this,"onSelectedRemoteCandidateChanged",void 0),y(this,"getLocalVideoStats",void 0)}}class HK extends jK{constructor(t,n){super(t,n),y(this,"establishPromise",void 0)}}let ie=function(e){return e.VIDEO="video",e.AUDIO="audio",e}({}),Mr=function(e){return e[e.UDP=0]="UDP",e[e.TCP=1]="TCP",e[e.RELAY=2]="RELAY",e}({}),mc=function(e){return e[e.FIRST_CONNECTION=0]="FIRST_CONNECTION",e[e.TCP_RESTART=1]="TCP_RESTART",e[e.RELAY_RESTART=2]="RELAY_RESTART",e[e.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",e[e.OLD_RESTART=11]="OLD_RESTART",e[e.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",e}({}),j=function(e){return e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack",e}({}),Xe=function(e){return e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected",e}({}),de=function(e){return e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestRePublishDataChannel="requestRePublishDataChannel",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.RequestUpload="requestUpload",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange",e.RequestLowStreamParameter="RequestLowStreamParameter",e.QueryClientConnectionState="QueryClientConnectionState",e.LocalCandidate="LocalCandidate",e.RequestP2PMuteLocal="requestP2PMuteLocal",e.RequestP2PUnPublish="RequestP2PUnPublish",e.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",e.RequestP2PMuteRemote="RequestP2PMuteRemote",e.RequestP2PRestartICE="RequestP2PRestartICE",e}({}),Qo=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),es=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),Vn=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),GK=function(e){return e.CONNECTED="transmitter:connected",e.RECONNECTING="transmitter:reconnecting",e.WILL_RECONNECT="transmitter:will_reconnect",e.CLOSED="transmitter:closed",e.FAILED="transmitter:failed",e.ON_MESSAGE="transmitter:on_message",e.REQUEST_NEW_URLS="transmitter:request_new_urls",e.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",e.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",e.FAILBACK="transmitter:failback",e.PRE_CONNECT_PC="transmitter:pre_connect_pc",e}({}),Ra=function(e){return e.CAMERA_CHANGED="camera-changed",e.MICROPHONE_CHANGED="microphone-changed",e.PLAYBACK_DEVICE_CHANGED="playback-device-changed",e.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",e.AUTOPLAY_FAILED="autoplay-failed",e.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",e.SECURITY_POLICY_VIOLATION="security-policy-violation",e}({}),Mo=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),Us=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),mp=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),Qt=function(e){return e.CALL="call",e.CANDIDATE="candidate",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.CONTROL="control",e.RESTART_ICE="restart_ice",e.ACK="ack",e.RESPONSE="response",e.JOIN="join",e.CHECK="check",e}({}),gp=function(e){return e.ABORT="abort",e}({}),El=function(e){return e.MUTE_LOCAL_AUDIO="mute_local_audio",e.MUTE_LOCAL_VIDEO="mute_local_video",e.UNMUTE_LOCAL_AUDIO="unmute_local_audio",e.UNMUTE_LOCAL_VIDEO="unmute_local_video",e}({}),_Le=function(e){return e.P2P_TOKEN_TIMEOUT="p2p_token_timeout",e.P2P_TOKEN_CHANGED="p2p_token_changed",e}({});const vLe={[FS.ACCESS_POINT]:{[qi.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[qi.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[qi.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[qi.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[qi.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[qi.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[qi.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[FS.UNILBS]:{[Jo.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[Jo.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[Jo.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[Jo.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[Jo.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[Jo.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[Jo.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[Jo.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[Jo.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[Jo.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[Jo.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[Jo.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[FS.STRING_UID_ALLOCATOR]:{[_P.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[_P.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[_P.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function _p(e){const t=vLe[Math.floor(e/1e4)];if(!t)return{desc:"unknown error",retry:!1};const n=t[e%1e4];if(!n){if(Math.floor(e/1e4)===FS.ACCESS_POINT){const i=e%1e4;if("1"===i.toString()[0])return{desc:e.toString(),retry:!1};if("2"===i.toString()[0])return{desc:e.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return n}const ELe={[ce.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[ce.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[ce.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[ce.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[ce.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[ce.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[ce.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[ce.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[ce.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[ce.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[ce.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[ce.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[ce.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[ce.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[ce.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[ce.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[ce.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[ce.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[ce.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[ce.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[ce.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[ce.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[ce.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[ce.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[ce.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[ce.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[ce.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[ce.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[ce.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[ce.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[ce.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[ce.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[ce.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[ce.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[ce.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[ce.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[ce.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[ce.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[ce.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[ce.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[ce.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[ce.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[ce.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[ce.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[ce.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[ce.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[ce.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[ce.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[ce.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[ce.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[ce.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[ce.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[ce.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[ce.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[ce.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[ce.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[ce.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[ce.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[ce.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[ce.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[ce.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[ce.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[ce.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function qg(e){return ELe[e]||{desc:"UNKNOWN_ERROR_".concat(e),action:"failed"}}function WK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function SP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WK(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WK(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function zK(e){return e.every(t=>t.readyState===WebSocket.CLOSED||t.readyState===WebSocket.CLOSING)}function KK(e,t){if("string"==typeof e)return e;const{proxy:n,host:i,port:r}=e;if(t){const o=R("JOIN_GATEWAY_FALLBACK_PORT")||443;return 443===o?"wss://".concat(i,"/ws/?p=").concat(Number(r)+150):"wss://".concat(i,":").concat(o,"/ws/?p=").concat(Number(r)+150)}return n?"wss://".concat(n,"/ws/?h=").concat(i,"&p=").concat(r):"wss://".concat(i,":").concat(r)}const bLe=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,yLe=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,SLe=/wss:\/\/(.+):([0-9]+)\/?/,CLe=/wss:\/\/(.[^\/]+)\/?/;let TLe=0;class wLe{constructor(t,n){y(this,"id",0),y(this,"store",void 0),y(this,"recordIndex",void 0),y(this,"websockets",[]),y(this,"try443PortDuration",2e3),y(this,"forceCloseWSDuration",5e3),y(this,"try443PortTimeout",null),y(this,"forceCloseTimeout",null),y(this,"isTry443PortFailed",!1),y(this,"isNormalPortFailed",!1),y(this,"useDoubleDomain",!1),y(this,"useProxy",!1),y(this,"startTime",Date.now()),this.id=++TLe,this.try443PortDuration=R("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=t||5e3,this.store=n}closeAllWebsockets(){this.websockets.forEach(t=>{t.onopen=null,t.onclose=null,t.onmessage=null,t.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout)}logger(){var t;const n=Date.now()-this.startTime;for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];_.debug("[choose-best-ws ".concat(null===(t=this.store)||void 0===t?void 0:t.clientId," ").concat(this.id,"] ").concat(n,"ms:"),...r)}createWebSocket(t,n,i){this.logger("createWebSocket:",t,{isTry443Port:n,hasTimeoutDetection:i});const r=R("GATEWAY_DOMAINS"),o=Date.now(),s=[],a=r.find(d=>{var u;return Y(u=t.host).call(u,d)});a||(this.useDoubleDomain=!1);const c=[];if(this.useDoubleDomain)r.forEach(d=>{c.push(KK(SP(SP({},t),{},{host:t.host.replace(a,d)}),n))});else{const d=SP({},t);if(n&&a){const u=r.find(h=>h!==a);u&&(d.host=d.host.replace(a,u))}c.push(KK(d,n))}try{c.forEach(d=>{const u=new WebSocket(d);u.binaryType="arraybuffer",s.push(u),this.logger("ws is connecting:",u.url)})}catch(d){if(this.logger("ws create failed"),s.forEach(u=>u.close()),s.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(t,n,i);if(!n&&443!==Number(t.port))return this.createWebSocket(t,!0,i);throw new N(S.WS_ERR,"init websocket failed! Error: ".concat(d.toString()))}const l=Bg();return this.store&&this.store.recordJoinChannelService({urls:s.map(d=>d.url),service:"gateway"},this.recordIndex),s.forEach(d=>{d.onopen=()=>{this.logger("onopen: ws ".concat(d.url," open cost ").concat(Date.now()-o,"ms")),this.websockets.forEach(u=>{u!==d&&(u.onopen=null,u.onclose=null,u.onmessage=null,u.close(),this.logger("close backup websocket: ".concat(u.url)))}),this.websockets.length=0,l.resolve(d)},d.onclose=u=>{this.logger("onclose: ws ".concat(d.url," closed cost ").concat(Date.now()-o,"ms state: ").concat(d.readyState)),n?this.isTry443PortFailed=zK(s):this.isNormalPortFailed=zK(s),this.logger("443: ".concat(this.useProxy?"not try":this.isTry443PortFailed?"failed":"trying"," 47xx: ").concat(this.isNormalPortFailed?"failed":"trying")),(n&&this.isTry443PortFailed||!n&&(this.isTry443PortFailed||this.useProxy)&&this.isNormalPortFailed)&&(this.logger("onclose: all websocket is closed, ".concat(u.reason)),l.reject({code:u.code,reason:BS.A_ROUND_WS_FAILED}))},d.onmessage=u=>this.logger("".concat(d.url," onmessage: ").concat(u.data))}),this.websockets.push(...s),i||(()=>{const d=()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",l.isResolved),this.websockets.forEach(u=>u.readyState!==WebSocket.OPEN&&u.close())};if(n||this.useProxy)return this.logger("add 5s timeout at ".concat(n?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(d,this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{if(this.logger("2s timeout, isWebsocket created: ",l.isResolved),l.isResolved)return d();xe().os===kn.MAC_OS&&Bt()&&d(),this.createWebSocket(t,!0,!0).then(u=>l.resolve(u)).catch(u=>{this.isNormalPortFailed&&l.reject(u),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(d,this.forceCloseWSDuration)},this.try443PortDuration)})(),l.promise}chooseBestWebsocket(t,n,i,r){return this.useDoubleDomain=!!n,"string"==typeof t&&(t=function(o){let s,a,c;return[,s,a,c]=o.match(bLe)||[],s||([,a,c]=o.match(yLe)||[]),a&&c||([,a,c]=o.match(SLe)||[]),a&&c||([,a]=o.match(CLe)||[]),a||_.warning("un-destructible url: ",o),{proxy:s,host:a,port:c||"443"}}(t)),this.recordIndex=r,this.useProxy=!!t.proxy,i&&this.useProxy&&(_.warn("cannot use 443 only when use proxy"),i=!1),this.createWebSocket(t,!!i,!1).finally(()=>this.clearTimeout())}}function qK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}class YK extends xt{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(t){var n;Y(n=["tryNext","recover"]).call(n,t)&&this.resetReconnectCount(t),this._reconnectMode=t}get state(){return this._state}set state(t){t!==this._state&&(this._state=t,"reconnecting"===this._state?this.emit(fe.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(fe.CONNECTED):"closed"===this._state?this.emit(fe.CLOSED):"failed"===this._state&&this.emit(fe.FAILED))}resetReconnectCount(t){_.debug("websocket reset reconnect count, reason: "+t),this.reconnectCount=0}constructor(t,n){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;super(),y(this,"connectionID",0),y(this,"currentURLIndex",0),y(this,"urls",[]),y(this,"_reconnectMode","tryNext"),y(this,"reconnectReason",void 0),y(this,"_initMutex",new mi("websocket")),y(this,"name",void 0),y(this,"_state","closed"),y(this,"reconnectInterrupter",void 0),y(this,"websocket",void 0),y(this,"retryConfig",void 0),y(this,"reconnectCount",0),y(this,"forceCloseTimeout",5e3),y(this,"onlineReconnectListener",void 0),y(this,"useCompress",void 0),y(this,"tryDoubleDomain",!1),y(this,"use443PortOnly",!1),y(this,"wsInflateLength",0),y(this,"wsDeflateLength",0),y(this,"closeEstablishingWs",()=>{}),y(this,"store",void 0),y(this,"joinGatewayRecordIndex",void 0),this.store=s,this.name=t,this.retryConfig=function(u){for(var h=1;h<arguments.length;h++){var p=null!=arguments[h]?arguments[h]:{};h%2?qK(Object(p),!0).forEach(function(m){y(u,m,p[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(p)):qK(Object(p)).forEach(function(m){Object.defineProperty(u,m,Object.getOwnPropertyDescriptor(p,m))})}return u}({},n),this.useCompress=i,this.tryDoubleDomain=r,this.use443PortOnly=o;const{timeout:a,timeoutFactor:c}=n,l=Math.max(300,Math.floor(3*a/5)),d=Math.max(1.2,Math.floor(8*c)/10);Pr.ONLINE&&(this.retryConfig.timeout=l,this.retryConfig.timeoutFactor=d),ln.on(lp.NETWORK_STATE_CHANGE,(u,h)=>{u!==h&&(this.resetReconnectCount("network state change: ".concat(h," -> ").concat(u)),u===Pr.ONLINE?(this.retryConfig.timeout=l,this.retryConfig.timeoutFactor=d):(this.retryConfig.timeout=a,this.retryConfig.timeoutFactor=c))})}getConnection(){return this.websocket||void 0}init(t){var n=arguments,i=this;return C(function*(){let r=n.length>1&&void 0!==n[1]?n[1]:5e3;const o=yield i._initMutex.lock();i.forceCloseTimeout=r,i.urls=t,i.state="connecting";try{const s=Bg(),a=i.urls[i.currentURLIndex];R("ENABLE_PREALLOC_PC")&&i.emit(GK.PRE_CONNECT_PC),i.createWebSocketConnection(a).then(s.resolve).catch(s.reject),i.once(fe.CLOSED,()=>{s.reject(new M(S.WS_DISCONNECT))}),i.once(fe.CONNECTED,s.resolve),yield s.promise}catch{}finally{o()}})()}close(t,n){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const i=this.websocket;n?setTimeout(()=>i.close(),500):i.close(),this.websocket=void 0}this.state=t?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(t,n){if(!this.websocket)return void _.warning("[".concat(this.name,"] can not reconnect, no websocket"));void 0!==t&&(this.reconnectMode=t),_.debug("[".concat(this.name,"] reconnect is triggered initiative")),"number"==typeof this.joinGatewayRecordIndex&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(n)]},this.joinGatewayRecordIndex);const i=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),i&&i.bind(this.websocket)({code:9999,reason:n})}sendMessage(t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new M(S.WS_ABORT,"websocket is not ready");try{n||(t=JSON.stringify(t)),this.websocket.send(t)}catch(i){throw new M(S.WS_ERR,"send websocket message error"+i.toString())}}setWsInflateData(t){this.wsDeflateLength=this.wsDeflateLength+t.originLength,this.wsInflateLength=this.wsInflateLength+t.compressedLength}getWsInflateData(){const t=this.wsInflateLength,n=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:t,wsDeflateLength:n}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}createWebSocketConnection(t){var n=this;return C(function*(){var i;const r=Bg();n.connectionID+=1,n.joinGatewayRecordIndex=void 0;const o=u=>{var h;null===(h=n.store)||void 0===h||h.signalChannelOpen(),_.debug("[".concat(n.name,"] websocket opened:"),u),n.reconnectMode="retry",n.state="connected",n.resetReconnectCount("opened"),r.resolve()},s=function(){var u=C(function*(h){var p;if(_.debug("[".concat(n.name,"] websocket close ").concat(null===(p=n.websocket)||void 0===p?void 0:p.url,", code: ").concat(h.code,", reason: ").concat(h.reason,", current mode: ").concat(n.reconnectMode)),n.reconnectCount>=n.retryConfig.maxRetryCount)r.reject(new M(S.WS_DISCONNECT,"websocket close: ".concat(h.code))),n.close();else{"connected"===n.state&&(n.reconnectReason=h.reason,n.state="reconnecting");const m=Oo(n,fe.WILL_RECONNECT,n.reconnectMode,h.reason)||n.reconnectMode,f=yield n.reconnectWithAction(m);if("closed"===n.state)return void _.debug("[".concat(n.connectionID,"] ws is closed, no need to reconnect"));if(!f)return r.reject(new M(S.WS_DISCONNECT,"websocket reconnect failed: ".concat(h.code))),n.close(!0);r.resolve()}});return function(p){return u.apply(this,arguments)}}(),a=u=>{n.emit(fe.ON_MESSAGE,u)},c=u=>{_.warn("[".concat(n.connectionID,"] ws open error ").concat(u))};n.websocket&&(n.websocket.onclose=null,n.websocket.close()),R("GATEWAY_WSS_ADDRESS")&&n.name.startsWith("gateway")&&(t=R("GATEWAY_WSS_ADDRESS")),_.debug("[".concat(n.name,"] start connect, url:"),t);const l=null===(i=n.store)||void 0===i?void 0:i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var d;const u=yield n.chooseBestWebsocketConnection(t);n.websocket=u,o&&o(n.websocket.url),n.websocket.onclose=s,n.websocket.onmessage=a,n.websocket.onerror=c,null===(d=n.store)||void 0===d||d.recordJoinChannelService({endTs:Date.now(),status:"success"},l),n.joinGatewayRecordIndex=l}catch(u){const h="closed"===n.state,p=u instanceof M,m=p&&u.code===S.WS_ABORT,f=p&&u.code===S.WS_ERR,g=p?u.message:u&&(u.reason||u.toString());_.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(g)),n.store&&n.store.recordJoinChannelService({endTs:Date.now(),status:m?"aborted":"error",errors:[u]},l),h||f?(r.reject(h?new M(S.WS_DISCONNECT,"websocket is closed: ".concat(g)):new M(S.WS_ERR,"init websocket failed: ".concat(g))),f&&_.error("[".concat(n.name,"] init websocket failed: ").concat(g))):s&&s(u)}return r.promise})()}reconnectWithAction(t){var n=arguments,i=this;return C(function*(){let r=!(n.length>1&&void 0!==n[1])||n[1];if(i.reconnectCount>=i.retryConfig.maxRetryCount||0===i.urls.length||"closed"===i.state)return!1;_.warning("[choose-best-ws] action: =>",t),i.onlineReconnectListener||ln.isOnline||!ln.onlineWaiter||(i.onlineReconnectListener=ln.onlineWaiter.then(()=>{i.onlineReconnectListener=void 0}));let o=!0;if(i.reconnectInterrupter=()=>o=!1,r){const c=rP(i.reconnectCount,i.retryConfig);_.debug("[".concat(i.name,"] wait ").concat(c,"ms to reconnect websocket, mode: ").concat(t)),yield q.race([qn(c),i.onlineReconnectListener||new q(()=>{})])}if("closed"===i._state||!o)return!1;i.reconnectCount+=1;const s=function(){var c=C(function*(l,d){i.emit(fe.RECONNECT_CREATE_CONNECTION,d),yield i.createWebSocketConnection(l)});return function(d,u){return c.apply(this,arguments)}}();try{if("retry"===t)i.emit(fe.RECONNECT_WAITTING_FINISH,t),yield s(i.urls[i.currentURLIndex],t);else if("tryNext"===t){if(i.currentURLIndex+=1,i.currentURLIndex>=i.urls.length)return i.reconnectWithAction("recover",!1);_.debug("[".concat(i.name,"] websocket url length: ").concat(i.urls.length," current index: ").concat(i.currentURLIndex)),i.emit(fe.RECONNECT_WAITTING_FINISH,t),yield s(i.urls[i.currentURLIndex],t)}else"recover"===t&&(_.debug("[".concat(i.name,"] request new urls")),i.resetReconnectCount("recover mode"),i.emit(fe.RECONNECT_WAITTING_FINISH,t),i.urls=yield ni(i,fe.REQUEST_NEW_URLS),i.currentURLIndex=0,yield s(i.urls[i.currentURLIndex],t))}catch(c){var a;_.error("[".concat(i.name,"] reconnect failed ").concat(c&&c.toString()));const l=null==c||null===(a=c.data)||void 0===a?void 0:a.desc;return Array.isArray(l)&&Y(l).call(l,"dynamic key expired")?(i.emit(fe.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):i.reconnectWithAction(t,r)}return!0})()}}class CP extends YK{constructor(t,n){super(t,n,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0)}chooseBestWebsocketConnection(t,n){var i=this;return C(function*(){const r=Bg(),o=new wLe(i.forceCloseTimeout,i.store);i.closeEstablishingWs=()=>{_.debug("[choose-best-ws] close establishing websockets"),o.closeAllWebsockets(),r.reject(new M(S.WS_ABORT,"choose best websocket aborted"))};const s=R("GATEWAY_DOMAINS");return _.debug("[choose-best-ws] currentDomain: ",t,", domains: ",s,"total: ".concat(i.urls.length),"current: ".concat(i.currentURLIndex+1)),o.chooseBestWebsocket(t,i.tryDoubleDomain,i.use443PortOnly,n).then(r.resolve).catch(r.reject),r.promise.finally(()=>{i.closeEstablishingWs=void 0})})()}}class Yg extends YK{constructor(t,n){super(t,n,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0)}chooseBestWebsocketConnection(t,n){var i=this;return C(function*(){return new q((r,o)=>{let s=!1;const a=[];i.closeEstablishingWs=()=>{_.debug("[choose-best-ws] close establishing websockets"),a.forEach(f=>{f.onclose=null,f.onopen=null,f.onmessage=null,f.close()}),o(new M(S.WS_ABORT,"choose best websocket aborted"))};const c=R("GATEWAY_DOMAINS");let l;const d=t.indexOf("?h="),u=c.find(f=>-1!==d?Y(t).call(t,f,d):Y(t).call(t,f));_.debug("[choose-best-ws] currentDomain: ",u,", domains: ",c);let h=!i.tryDoubleDomain||!u;if(!h&&u){var p;const f=Date.now();try{c.forEach(g=>{const E=-1===d?t.replace(u,g):t.substr(0,d)+t.substr(d).replace(u,g),b=new WebSocket(E);b.binaryType="arraybuffer",a.push(b),_.debug("[choose-best-ws] ws is connecting:",b.url)})}catch{for(_.debug("[choose-best-ws] ws create failed, fallback to single url"),a.forEach(E=>E.close());a.length;)a.pop();h=!0}null===(p=i.store)||void 0===p||p.recordJoinChannelService({urls:a.map(g=>g.url),service:"gateway"},n),a.forEach(g=>{g.onopen=()=>{if(s)return;const E=Date.now()-f;_.debug("[choose-best-ws] ws open cost ".concat(E,"ms")),a.filter(b=>b!==g).forEach(b=>{_.debug("[choose-best-ws]close backup websocket: ".concat(b.url)),b.close()}),s=!0,r(g)},g.onclose=E=>{l=E,!s&&(a.find(b=>!(b.readyState===WebSocket.CLOSED||b.readyState===WebSocket.CLOSING))||(_.debug("[choose-best-ws] all websocket is closed"),s=!0,o(l)))},g.onmessage=E=>{_.debug("[choose-best-ws]".concat(g.url," onmessage: ").concat(E.data))}}),qn(i.forceCloseTimeout).then(()=>{a.forEach(g=>{g.readyState!==WebSocket.OPEN&&g.close()})})}if(h){var m;let f;_.debug("[choose-best-ws] use single url: ",t),null===(m=i.store)||void 0===m||m.recordJoinChannelService({urls:[t],service:"gateway"},n);try{f=new WebSocket(t),a.push(f),f.binaryType="arraybuffer"}catch(g){const E=new M(S.WS_ERR,"init websocket failed! Error: ".concat(g.toString()));return _.error("[".concat(i.name,"]").concat(E)),void o(E)}f.onopen=()=>{r(f)},f.onclose=g=>{o(g)},f.onmessage=g=>{_.debug("[choose-best-ws]".concat(f.url," onmessage: ").concat(g.data))},qn(i.forceCloseTimeout).then(()=>{f&&f.readyState!==WebSocket.OPEN&&f.close()})}}).then(r=>(i.closeEstablishingWs=void 0,r)).catch(r=>{throw i.closeEstablishingWs=void 0,r})})()}}class ILe extends xt{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===_t.CONNECTED?this.emit(he.WS_CONNECTED):t===_t.RECONNECTING?this.emit(he.WS_RECONNECTING,this._websocketReconnectReason):t===_t.CLOSED&&this.emit(he.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(t,n){super(),y(this,"_disconnectedReason",void 0),y(this,"_websocketReconnectReason",void 0),y(this,"_connectionState",_t.CLOSED),y(this,"reconnectToken",void 0),y(this,"websocket",void 0),y(this,"openConnectionTime",void 0),y(this,"clientId",void 0),y(this,"lastMsgTime",Date.now()),y(this,"uploadCache",[]),y(this,"uploadCacheInterval",void 0),y(this,"rttRolling",new CK(5)),y(this,"pingpongTimer",void 0),y(this,"wsInflateDataTimer",void 0),y(this,"pingpongTimeoutCount",0),y(this,"joinResponse",void 0),y(this,"multiIpOption",void 0),y(this,"initError",void 0),y(this,"spec",void 0),y(this,"store",void 0),y(this,"onWebsocketMessage",i=>{if(i.data instanceof ArrayBuffer)return void this.emit(he.ON_BINARY_DATA,i.data);const r=JSON.parse(i.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(r,"_id")){const o="res-@".concat(r._id);this.emit(o,r._result,r._message)}else if(Object.prototype.hasOwnProperty.call(r,"_type")){if(this.emit(r._type,r._message),r._type===Te.ON_NOTIFICATION&&this.handleNotification(r._message),r._type===Te.ON_USER_BANNED)switch(r._message.error_code){case 14:this.close(Qe.UID_BANNED);break;case 15:this.close(Qe.IP_BANNED);break;case 16:this.close(Qe.CHANNEL_BANNED)}if(r._type===Te.ON_USER_LICENSE_BANNED)switch(r._message.error_code){case ce.ERR_LICENSE_MISSING:this.close(Qe.LICENSE_MISSING);break;case ce.ERR_LICENSE_EXPIRED:this.close(Qe.LICENSE_EXPIRED);break;case ce.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Qe.LICENSE_MINUTES_EXCEEDED);break;case ce.ERR_LICENSE_PERIOD_INVALID:this.close(Qe.LICENSE_PERIOD_INVALID);break;case ce.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Qe.LICENSE_MULTIPLE_SDK_SERVICE);break;case ce.ERR_LICENSE_ILLEGAL:this.close(Qe.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=n,this.websocket=new CP("gateway-".concat(this.clientId),this.spec.retryConfig,!0,R("JOIN_GATEWAY_USE_DUAL_DOMAIN"),R("JOIN_GATEWAY_USE_443PORT_ONLY"),n),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===_t.CONNECTED&&this.reconnect("retry",ti.OFFLINE)})}request(t,n,i,r){var o=this;return C(function*(){const s=gt(6,""),a={_id:s,_type:t,_message:n},c=o.websocket.connectionID,l=()=>new q((f,g)=>{if(o.connectionState===_t.CONNECTED)return f();const E=()=>{o.off(he.WS_CLOSED,b),f()},b=()=>{o.off(he.WS_CONNECTED,E),g(new N(S.WS_ABORT))};o.once(he.WS_CONNECTED,E),o.once(he.WS_CLOSED,b),t!==pe.PUBLISH&&t!==pe.PUBLISH_DATASTREAM&&t!==pe.SUBSCRIBE&&t!==pe.SUBSCRIBE_DATASTREAM&&t!==pe.UNSUBSCRIBE&&t!==pe.UNSUBSCRIBE_DATASTREAM&&t!==pe.UNPUBLISH&&t!==pe.UNPUBLISH_DATASTREAM&&t!==pe.CONTROL&&t!==pe.RESTART_ICE||o.once(he.DISCONNECT_P2P,()=>{g(new N(S.DISCONNECT_P2P))}),t!==pe.PUBLISH&&t!==pe.RESTART_ICE||o.once(he.ABORT_P2P_EXECUTION,()=>{g(new N(S.DISCONNECT_P2P))})});if(o.connectionState!==_t.CONNECTING&&o.connectionState!==_t.RECONNECTING||t===pe.JOIN||t===pe.REJOIN||(yield l()),o.websocket.sendMessage(a,!0),r)return;const d=new q((f,g)=>{let E=!1;const b=(I,D)=>{E=!0,f({isSuccess:"success"===I,message:D||{}}),o.off(he.WS_CLOSED,T),o.off(he.WS_RECONNECTING,T),o.emit(he.REQUEST_SUCCESS,t,n)};o.once("res-@".concat(s),b);const T=()=>{g(new N(S.WS_ABORT,"type: ".concat(t))),o.off(he.WS_CLOSED,T),o.off(he.WS_RECONNECTING,T),o.off("res-@".concat(s),b)};o.once(he.WS_CLOSED,T),o.once(he.WS_RECONNECTING,T),qn(R("SIGNAL_REQUEST_TIMEOUT")).then(()=>{o.websocket.connectionID!==c||E||(_.warning("[".concat(o.clientId,"] ws request timeout, type: ").concat(t)),o.emit(he.REQUEST_TIMEOUT,t,n))})});let u=null;try{u=yield d}catch(f){if(o.connectionState===_t.CLOSED||t===pe.LEAVE)throw new N(S.WS_ABORT);return!o.spec.forceWaitGatewayResponse||i?f.throw():t===pe.JOIN||t===pe.REJOIN?null:(yield l(),yield o.request(t,n))}if(u.isSuccess)return u.message;const h=Number(u.message.error_code||u.message.code),p=qg(h),m=new N(S.UNEXPECTED_RESPONSE,"".concat(p.desc,": ").concat(u.message.error_str),{code:h,data:u.message,desc:p.desc});return"success"===p.action?u.message:(_.warning("[".concat(o.clientId,"] [").concat(o.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(h,", message: ").concat(p.desc,", action: ").concat(p.action)),h===ce.ERR_TOO_MANY_BROADCASTERS?((t===pe.JOIN||t===pe.REJOIN)&&(o.initError=m,o.close()),m.throw()):"failed"===p.action?m.throw():"quit"===p.action?(o.initError=m,o.close(),m.throw()):(h===ce.ERR_JOIN_BY_MULTI_IP?(o.multiIpOption=u.message.option,_.warning("[".concat(o.clientId,"] detect multi ip, recover")),o.reconnect("recover",ti.MULTI_IP)):o.reconnect(p.action,ti.SERVER_ERROR),t===pe.JOIN||t===pe.REJOIN?null:yield o.request(t,n)))})()}waitMessage(t,n){return new q(i=>{const r=o=>{(!n||n(o))&&(this.off(t,r),i(o))};this.on(t,r)})}uploadWRTCStats(t){if(!this.store.sessionId)return void _.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const n={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:t};this.upload(Kg.WRTC_STATS,n)}upload(t,n){const i={_type:t,_message:n};try{this.websocket.sendMessage(i)}catch{const o=R("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(i),this.uploadCache.length>o&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==_t.CONNECTED)return;const s=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(s._type,s._message)},R("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,n){this.websocket.sendMessage({_type:t,_message:n})}init(t,n){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new q((i,r)=>{this.once(he.WS_CONNECTED,()=>i(this.joinResponse)),this.once(he.WS_CLOSED,()=>r(this.initError||new N(S.WS_ABORT))),this.connectionState=_t.CONNECTING,this.websocket.init(t).catch(r),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=t||Qe.LEAVE,this.connectionState=_t.CLOSED,_.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}join(){var t=this;return C(function*(){if(!t.joinResponse){t.emit(he.ABORT_P2P_EXECUTION);const n=yield ni(t,he.REQUEST_JOIN_INFO),i=yield t.request(pe.JOIN,n);if(!i)return t.emit(he.REPORT_JOIN_GATEWAY,BS.TIMEOUT,t.url||""),!1;t.joinResponse=i,t.emit(he.JOIN_RESPONSE,t.joinResponse),t.reconnectToken=t.joinResponse.rejoin_token}return t.connectionState=_t.CONNECTED,t.pingpongTimer&&window.clearInterval(t.pingpongTimer),t.pingpongTimer=window.setInterval(t.handlePingPong.bind(t),3e3),!0})()}rejoin(){var t=this;return C(function*(){if(!t.reconnectToken)throw new N(S.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const n=Wg(t,he.REQUEST_REJOIN_INFO);n.token=t.reconnectToken;const i=yield t.request(pe.REJOIN,n);return!!i&&(t.connectionState=_t.CONNECTED,t.pingpongTimer&&window.clearInterval(t.pingpongTimer),t.pingpongTimer=window.setInterval(t.handlePingPong.bind(t),3e3),i.peers&&i.peers.forEach(r=>{t.emit(Te.ON_USER_ONLINE,{uid:r.uid}),r.audio&&t.emit(Te.ON_ADD_AUDIO_STREAM,{uid:r.uid,uint_id:r.uint_id,audio:!0,ssrcId:r.audio_ssrc}),r.video&&t.emit(Te.ON_ADD_VIDEO_STREAM,{uid:r.uid,uint_id:r.uint_id,video:!0,ssrcId:r.video_ssrc}),t.emit(r.audio_mute?Te.MUTE_AUDIO:Te.UNMUTE_AUDIO,{uid:r.uid}),t.emit(r.video_mute?Te.MUTE_VIDEO:Te.UNMUTE_VIDEO,{uid:r.uid}),t.emit(r.audio_enable_local?Te.ENABLE_LOCAL_AUDIO:Te.DISABLE_LOCAL_AUDIO,{uid:r.uid}),t.emit(r.video_enable_local?Te.ENABLE_LOCAL_VIDEO:Te.DISABLE_LOCAL_VIDEO,{uid:r.uid}),r.audio||r.video||t.emit(Te.ON_REMOVE_STREAM,{uid:r.uid,uint_id:r.uint_id})}),!0)})()}reconnect(t,n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,n)}handleNotification(t){_.debug("[".concat(this.clientId,"] receive notification: "),t);const n=qg(t.code);if(28===t.code&&"detail"in t&&(_.info("[".concat(this.clientId,"] receive recover notification: "),t.detail),this.emit(he.RECOVER_NOTIFICATION,t.detail)),"success"!==n.action){if("failed"!==n.action)return"quit"===n.action?("ERR_REPEAT_JOIN_CHANNEL"===n.desc&&this.close(Qe.UID_BANNED),void this.close()):void this.reconnect(n.action,ti.SERVER_ERROR);_.error("[".concat(this.clientId,"] ignore error: "),n.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=R("PING_PONG_TIME_OUT"),n=Date.now();this.pingpongTimeoutCount>=t&&(_.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(n-this.lastMsgTime,"ms")),n-this.lastMsgTime>R("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",ti.TIMEOUT):this.request(pe.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const i=Date.now()-n;this.rttRolling.add(i),R("REPORT_STATS")&&this.send(pe.PING_BACK,{pingpongElapse:i})}).catch(i=>{})}handleWsInflateData(){const{wsInflateLength:t,wsDeflateLength:n}=this.websocket.getWsInflateData();0!==t&&0!==n&&this.upload(Kg.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:n,ws_inflate_length:t})}handleWebsocketEvents(){this.websocket.on(fe.RECONNECT_WAITTING_FINISH,t=>{this.emit(he.WS_RECONNECT_WAITTING_FINISH,t)}),this.websocket.on(fe.RECONNECT_CREATE_CONNECTION,t=>{this.emit(he.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(fe.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(fe.CLOSED,()=>{this.connectionState=_t.CLOSED}),this.websocket.on(fe.FAILED,()=>{this._disconnectedReason=Qe.NETWORK_ERROR,this.connectionState=_t.CLOSED}),this.websocket.on(fe.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState=this.connectionState===_t.CONNECTED?_t.RECONNECTING:_t.CONNECTING}),this.websocket.on(fe.WILL_RECONNECT,(t,n,i)=>{const r=Wg(this,he.IS_P2P_DISCONNECTED),o=r||"retry"!==t;r&&"retry"===t&&(_.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),t="tryNext",n=BS.P2P_DISCONNECTED),o&&(_.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(t)),this.emit(he.REPORT_JOIN_GATEWAY,n||BS.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(he.DISCONNECT_P2P)),i(t)}),this.websocket.on(fe.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(t=>{_.warning("[".concat(this.clientId,"] rejoin failed ").concat(t)),this.reconnect("tryNext",ti.SERVER_ERROR)}):this.join().catch(t=>{if(this.emit(he.REPORT_JOIN_GATEWAY,t,this.url||""),t instanceof N){if(t.code===S.UNEXPECTED_RESPONSE&&t.data.code===ce.ERR_NO_AUTHORIZED)return this.initError=new N(S.CAN_NOT_GET_GATEWAY_SERVER,"AgoraRTCError CAN_NOT_GET_GATEWAY_SERVER: dynamic key expired"),_.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",ti.SERVER_ERROR);_.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",ti.SERVER_ERROR):(this.initError=t,this.close())}})}),this.websocket.on(fe.REQUEST_NEW_URLS,(t,n)=>{ni(this,he.REQUEST_RECOVER,this.multiIpOption).then(t).catch(n)}),this.websocket.on(fe.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(Te.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(GK.PRE_CONNECT_PC,()=>{this.emit(he.PRE_CONNECT_PC)})}}let un=function(e){return e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",e}({});function $K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function HS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$K(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$K(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function vp(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(R("TURN_DOMAIN")):(_.info("Unidentified as ip: ".concat(e,", use as host")),e)}function TP(e,t){e.addresses||(e.addresses=[]);const n=function(a,c){if(R("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return a.map(u=>{let{ip:h,port:p}=u;return{address:"".concat(h,":").concat(p)}});const l=R("GATEWAY_DOMAINS");let d=l[1]&&Y(c).call(c,l[1])?1:0;return a.map(u=>{let{domain_prefix:h,port:p,ip:m}=u;if(h)return{address:"".concat(h,".").concat(l[d++%l.length],":").concat(p)};const f=/^[\.\:\d]+$/.test(m),g=f?"".concat(m.replace(/[^\d]/g,"-"),".").concat(l[d++%l.length],":").concat(p):"".concat(m,":").concat(p);return f||_.info("Unidentified as ip: ".concat(m,", use as host")),{ip:m,port:p,address:g}})}(e.addresses,t),i=Array.isArray(e.detail)&&e.detail[18];if(i&&"string"==typeof i){const a=i.split(";");for(let c=0;c<a.length;c++){var r;const l=ki(r=a[c]).call(r);n[c]&&l&&(n[c].ip6=l)}}const o=e.detail&&e.detail.candidate;let s;if(o){const[a,c]=o.split(":");a&&c&&(s={port:Number(c),ip:a,address:"".concat(a,":").concat(c)})}return{gatewayAddrs:n,apGatewayAddress:s,uid:e.uid,cid:e.cid,cert:e.cert,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function xr(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function XK(e){const t=e._encoderConfig;if(!t)return{};const n={resolution:t.width&&t.height?"".concat(xr(t.width),"x").concat(xr(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return"number"==typeof t.frameRate?(n.maxFrameRate=t.frameRate,n.minFrameRate=t.frameRate):t.frameRate&&(n.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,n.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),n}function ZK(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function $g(e,t){let n,i,r;switch(t){case un.CHOOSE_SERVER:i=4096,r="choose server";break;case un.CLOUD_PROXY:i=1048576,r="proxy";break;case un.CLOUD_PROXY_5:i=4194304,r="proxy5";break;case un.CLOUD_PROXY_FALLBACK:i=4194310,r="proxy fallback";break;default:throw new N(S.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach(o=>{o.buffer&&o.buffer.flag===i&&(n={code:o.buffer.code,addresses:(o.buffer.edges_services||[]).map(s=>HS(HS({},s),{},{ticket:o.buffer.cert})),server_ts:e.enter_ts,uid:o.buffer.uid,cid:o.buffer.cid,cname:o.buffer.cname,detail:HS(HS({},o.buffer.detail),e.detail),flag:o.buffer.flag,opid:e.opid,cert:o.buffer.cert})}),!n)throw new N(S.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(r," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return n}function JK(e,t){return wP.apply(this,arguments)}function wP(){return wP=C(function*(e,t){return yield q.all(e.addresses.map(function(){var n=C(function*(i){return{address:vp(i.ip),tcpport:i.port,udpport:i.port,username:t&&R("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():ii.username,password:t&&R("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?yield tP(t.toString()):ii.password}});return function(i){return n.apply(this,arguments)}}()))}),wP.apply(this,arguments)}function IP(e,t){const n=t.getMediaStreamTrack(!0).getSettings(),i=t.videoHeight||n.height,r=t.videoWidth||n.width;return i&&r?Math.max(Math.min(i,r)/Math.min(xr(e.height),xr(e.width)),1):(_.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function bl(e){let{candidateType:t,relayProtocol:n,type:i,address:r,port:o,protocol:s}=e;return"local-candidate"===i?{candidateType:t,relayProtocol:n,protocol:s}:{candidateType:t,relayProtocol:n,address:r,port:o,protocol:s}}var ts,RLe=Vt(LK),ALe=$o("Array").values,DLe=ba,OLe=fi,NLe=Wi,PLe=ALe,RP=Array.prototype,MLe={DOMTokenList:!0,NodeList:!0},gc=Vt(function(e){var t=e.values;return e===RP||NLe(RP,e)&&t===RP.values||OLe(MLe,DLe(e))?PLe:t}),QK=Co,LLe=Jn,FLe=Sn,AP=Sy,ULe=mg,VLe=ly,BLe=Ea,jLe=uy,Ep=Object.assign,eq=Object.defineProperty,HLe=_n([].concat),GLe=!Ep||FLe(function(){if(QK&&1!==Ep({b:1},Ep(eq({},"a",{enumerable:!0,get:function(){eq(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(r){t[r]=r}),7!=Ep({},e)[n]||AP(Ep({},t)).join("")!=i})?function(e,t){for(var n=BLe(e),i=arguments.length,r=1,o=ULe.f,s=VLe.f;i>r;)for(var a,c=jLe(arguments[r++]),l=o?HLe(AP(c),o(c)):AP(c),d=l.length,u=0;d>u;)a=l[u++],QK&&!LLe(s,c,a)||(n[a]=c[a]);return n}:Ep,WLe=gr,zLe=M8,KLe=rl,qLe=Jn,YLe=Ea,$Le=function(e,t,n,i){try{return i?t(WLe(n)[0],n[1]):t(n)}catch(r){zLe(e,"throw",r)}},XLe=O8,ZLe=xy,JLe=dc,tq=Yy,QLe=jD,e2e=wy,nq=Array,Fd=_n,DP=2147483647,t2e=/[^\0-\u007E]/,iq=/[.\u3002\uFF0E\uFF61]/g,rq="Overflow: input needs wider integers to process",oq=RangeError,n2e=Fd(iq.exec),bp=Math.floor,OP=String.fromCharCode,sq=Fd("".charCodeAt),aq=Fd([].join),yl=Fd([].push),i2e=Fd("".replace),r2e=Fd("".split),o2e=Fd("".toLowerCase),cq=function(e){return e+22+75*(e<26)},s2e=function(e,t,n){var i=0;for(e=n?bp(e/700):e>>1,e+=bp(e/t);e>455;)e=bp(e/35),i+=36;return bp(i+36*e/(e+38))},a2e=function(e){var n,i,t=[],r=(e=function(E){for(var b=[],T=0,I=E.length;T<I;){var D=sq(E,T++);if(D>=55296&&D<=56319&&T<I){var O=sq(E,T++);56320==(64512&O)?yl(b,((1023&D)<<10)+(1023&O)+65536):(yl(b,D),T--)}else yl(b,D)}return b}(e)).length,o=128,s=0,a=72;for(n=0;n<e.length;n++)(i=e[n])<128&&yl(t,OP(i));var c=t.length,l=c;for(c&&yl(t,"-");l<r;){var d=DP;for(n=0;n<e.length;n++)(i=e[n])>=o&&i<d&&(d=i);var u=l+1;if(d-o>bp((DP-s)/u))throw oq(rq);for(s+=(d-o)*u,o=d,n=0;n<e.length;n++){if((i=e[n])<o&&++s>DP)throw oq(rq);if(i==o){for(var h=s,p=36;;){var m=p<=a?1:p>=a+26?26:p-a;if(h<m)break;var f=h-m,g=36-m;yl(t,OP(cq(m+f%g))),h=bp(f/g),p+=36}yl(t,OP(cq(h))),a=s2e(s,u,l==c),s=0,l++}}s++,o++}return aq(t,"")},c2e=it,NP=Co,l2e=_N,PP=Pn,lq=rl,ns=_n,GS=sl,is=My,d2e=eO,MP=fi,xP=GLe,yp=function(e){var t=YLe(e),n=ZLe(this),i=arguments.length,r=i>1?arguments[1]:void 0,o=void 0!==r;o&&(r=KLe(r,i>2?arguments[2]:void 0));var s,a,c,l,d,u,h=e2e(t),p=0;if(!h||this===nq&&XLe(h))for(s=JLe(t),a=n?new this(s):nq(s);s>p;p++)u=o?r(t[p],p):t[p],tq(a,p,u);else for(d=(l=QLe(t,h)).next,a=n?new this:[];!(c=qLe(d,l)).done;p++)u=o?$Le(l,r,[c.value,p],!0):c.value,tq(a,p,u);return a.length=p,a},Vs=HO,u2e=OO.codeAt,_c=Io,p2e=al,f2e=zh,dq=vxe,m2e=wd.set,WS=wd.getterFor("URL"),g2e=dq.URLSearchParams,_2e=dq.getState,Xg=PP.URL,kP=PP.TypeError,zS=PP.parseInt,v2e=Math.floor,hq=Math.pow,rs=ns("".charAt),Bs=ns(/./.exec),Zg=ns([].join),E2e=ns(1..toString),b2e=ns([].pop),Sp=ns([].push),LP=ns("".replace),y2e=ns([].shift),S2e=ns("".split),Jg=ns("".slice),KS=ns("".toLowerCase),C2e=ns([].unshift),FP="Invalid scheme",Ud="Invalid host",pq="Invalid port",fq=/[a-z]/i,T2e=/[\d+-.a-z]/i,UP=/\d/,w2e=/^0x/i,I2e=/^[0-7]+$/,R2e=/^\d+$/,mq=/^[\da-f]+$/i,A2e=/[\0\t\n\r #%/:<>?@[\\\]^|]/,D2e=/[\0\t\n\r #/:<>?@[\\\]^|]/,O2e=/^[\u0000-\u0020]+/,N2e=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,P2e=/[\t\n\r]/g,Qg=function(e){var t,n,i,r;if("number"==typeof e){for(t=[],n=0;n<4;n++)C2e(t,e%256),e=v2e(e/256);return Zg(t,".")}if("object"==typeof e){for(t="",i=function(o){for(var s=null,a=1,c=null,l=0,d=0;d<8;d++)0!==o[d]?(l>a&&(s=c,a=l),c=null,l=0):(null===c&&(c=d),++l);return l>a&&(s=c,a=l),s}(e),n=0;n<8;n++)r&&0===e[n]||(r&&(r=!1),i===n?(t+=n?":":"::",r=!0):(t+=E2e(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},qS={},gq=xP({},qS,{" ":1,'"':1,"<":1,">":1,"`":1}),_q=xP({},gq,{"#":1,"?":1,"{":1,"}":1}),VP=xP({},_q,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Sl=function(e,t){var n=u2e(e,0);return n>32&&n<127&&!MP(t,e)?e:encodeURIComponent(e)},YS={ftp:21,file:null,http:80,https:443,ws:80,wss:443},e_=function(e,t){var n;return 2==e.length&&Bs(fq,rs(e,0))&&(":"==(n=rs(e,1))||!t&&"|"==n)},vq=function(e){var t;return e.length>1&&e_(Jg(e,0,2))&&(2==e.length||"/"===(t=rs(e,2))||"\\"===t||"?"===t||"#"===t)},M2e=function(e){return"."===e||"%2e"===KS(e)},BP={},Eq={},jP={},bq={},yq={},HP={},Sq={},Cq={},$S={},XS={},GP={},WP={},zP={},KP={},Tq={},qP={},Cp={},Aa={},wq={},Vd={},vc={},YP=function(e,t,n){var i,r,o,s=_c(e);if(t){if(r=this.parse(s))throw kP(r);this.searchParams=null}else{if(void 0!==n&&(i=new YP(n,!0)),r=this.parse(s,null,i))throw kP(r);(o=_2e(new g2e)).bindURL(this),this.searchParams=o}};YP.prototype={type:"URL",parse:function(e,t,n){var i,r,o,s,a,c=this,l=t||BP,d=0,u="",h=!1,p=!1,m=!1;for(e=_c(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=LP(e,O2e,""),e=LP(e,N2e,"$1")),e=LP(e,P2e,""),i=yp(e);d<=i.length;){switch(r=i[d],l){case BP:if(!r||!Bs(fq,r)){if(t)return FP;l=jP;continue}u+=KS(r),l=Eq;break;case Eq:if(r&&(Bs(T2e,r)||"+"==r||"-"==r||"."==r))u+=KS(r);else{if(":"!=r){if(t)return FP;u="",l=jP,d=0;continue}if(t&&(c.isSpecial()!=MP(YS,u)||"file"==u&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=u,t)return void(c.isSpecial()&&YS[c.scheme]==c.port&&(c.port=null));u="","file"==c.scheme?l=KP:c.isSpecial()&&n&&n.scheme==c.scheme?l=bq:c.isSpecial()?l=Cq:"/"==i[d+1]?(l=yq,d++):(c.cannotBeABaseURL=!0,Sp(c.path,""),l=wq)}break;case jP:if(!n||n.cannotBeABaseURL&&"#"!=r)return FP;if(n.cannotBeABaseURL&&"#"==r){c.scheme=n.scheme,c.path=Vs(n.path),c.query=n.query,c.fragment="",c.cannotBeABaseURL=!0,l=vc;break}l="file"==n.scheme?KP:HP;continue;case bq:if("/"!=r||"/"!=i[d+1]){l=HP;continue}l=$S,d++;break;case yq:if("/"==r){l=XS;break}l=Aa;continue;case HP:if(c.scheme=n.scheme,r==ts)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Vs(n.path),c.query=n.query;else if("/"==r||"\\"==r&&c.isSpecial())l=Sq;else if("?"==r)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Vs(n.path),c.query="",l=Vd;else{if("#"!=r){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Vs(n.path),c.path.length--,l=Aa;continue}c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=Vs(n.path),c.query=n.query,c.fragment="",l=vc}break;case Sq:if(!c.isSpecial()||"/"!=r&&"\\"!=r){if("/"!=r){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,l=Aa;continue}l=XS}else l=$S;break;case Cq:if(l=$S,"/"!=r||"/"!=rs(u,d+1))continue;d++;break;case $S:if("/"!=r&&"\\"!=r){l=XS;continue}break;case XS:if("@"==r){h&&(u="%40"+u),h=!0,o=yp(u);for(var f=0;f<o.length;f++){var g=o[f];if(":"!=g||m){var E=Sl(g,VP);m?c.password+=E:c.username+=E}else m=!0}u=""}else if(r==ts||"/"==r||"?"==r||"#"==r||"\\"==r&&c.isSpecial()){if(h&&""==u)return"Invalid authority";d-=yp(u).length+1,u="",l=GP}else u+=r;break;case GP:case WP:if(t&&"file"==c.scheme){l=qP;continue}if(":"!=r||p){if(r==ts||"/"==r||"?"==r||"#"==r||"\\"==r&&c.isSpecial()){if(c.isSpecial()&&""==u)return Ud;if(t&&""==u&&(c.includesCredentials()||null!==c.port))return;if(s=c.parseHost(u))return s;if(u="",l=Cp,t)return;continue}"["==r?p=!0:"]"==r&&(p=!1),u+=r}else{if(""==u)return Ud;if(s=c.parseHost(u))return s;if(u="",l=zP,t==WP)return}break;case zP:if(!Bs(UP,r)){if(r==ts||"/"==r||"?"==r||"#"==r||"\\"==r&&c.isSpecial()||t){if(""!=u){var b=zS(u,10);if(b>65535)return pq;c.port=c.isSpecial()&&b===YS[c.scheme]?null:b,u=""}if(t)return;l=Cp;continue}return pq}u+=r;break;case KP:if(c.scheme="file","/"==r||"\\"==r)l=Tq;else{if(!n||"file"!=n.scheme){l=Aa;continue}if(r==ts)c.host=n.host,c.path=Vs(n.path),c.query=n.query;else if("?"==r)c.host=n.host,c.path=Vs(n.path),c.query="",l=Vd;else{if("#"!=r){vq(Zg(Vs(i,d),""))||(c.host=n.host,c.path=Vs(n.path),c.shortenPath()),l=Aa;continue}c.host=n.host,c.path=Vs(n.path),c.query=n.query,c.fragment="",l=vc}}break;case Tq:if("/"==r||"\\"==r){l=qP;break}n&&"file"==n.scheme&&!vq(Zg(Vs(i,d),""))&&(e_(n.path[0],!0)?Sp(c.path,n.path[0]):c.host=n.host),l=Aa;continue;case qP:if(r==ts||"/"==r||"\\"==r||"?"==r||"#"==r){if(!t&&e_(u))l=Aa;else if(""==u){if(c.host="",t)return;l=Cp}else{if(s=c.parseHost(u))return s;if("localhost"==c.host&&(c.host=""),t)return;u="",l=Cp}continue}u+=r;break;case Cp:if(c.isSpecial()){if(l=Aa,"/"!=r&&"\\"!=r)continue}else if(t||"?"!=r)if(t||"#"!=r){if(r!=ts&&(l=Aa,"/"!=r))continue}else c.fragment="",l=vc;else c.query="",l=Vd;break;case Aa:if(r==ts||"/"==r||"\\"==r&&c.isSpecial()||!t&&("?"==r||"#"==r)){if(".."===(a=KS(a=u))||"%2e."===a||".%2e"===a||"%2e%2e"===a?(c.shortenPath(),"/"==r||"\\"==r&&c.isSpecial()||Sp(c.path,"")):M2e(u)?"/"==r||"\\"==r&&c.isSpecial()||Sp(c.path,""):("file"==c.scheme&&!c.path.length&&e_(u)&&(c.host&&(c.host=""),u=rs(u,0)+":"),Sp(c.path,u)),u="","file"==c.scheme&&(r==ts||"?"==r||"#"==r))for(;c.path.length>1&&""===c.path[0];)y2e(c.path);"?"==r?(c.query="",l=Vd):"#"==r&&(c.fragment="",l=vc)}else u+=Sl(r,_q);break;case wq:"?"==r?(c.query="",l=Vd):"#"==r?(c.fragment="",l=vc):r!=ts&&(c.path[0]+=Sl(r,qS));break;case Vd:t||"#"!=r?r!=ts&&("'"==r&&c.isSpecial()?c.query+="%27":c.query+="#"==r?"%23":Sl(r,qS)):(c.fragment="",l=vc);break;case vc:r!=ts&&(c.fragment+=Sl(r,gq))}d++}},parseHost:function(e){var t,n,i;if("["==rs(e,0)){if("]"!=rs(e,e.length-1)||!(t=function(r){var o,s,a,c,l,d,u,h=[0,0,0,0,0,0,0,0],p=0,m=null,f=0,g=function(){return rs(r,f)};if(":"==g()){if(":"!=rs(r,1))return;f+=2,m=++p}for(;g();){if(8==p)return;if(":"!=g()){for(o=s=0;s<4&&Bs(mq,g());)o=16*o+zS(g(),16),f++,s++;if("."==g()){if(0==s||(f-=s,p>6))return;for(a=0;g();){if(c=null,a>0){if(!("."==g()&&a<4))return;f++}if(!Bs(UP,g()))return;for(;Bs(UP,g());){if(l=zS(g(),10),null===c)c=l;else{if(0==c)return;c=10*c+l}if(c>255)return;f++}h[p]=256*h[p]+c,2!=++a&&4!=a||p++}if(4!=a)return;break}if(":"==g()){if(f++,!g())return}else if(g())return;h[p++]=o}else{if(null!==m)return;f++,m=++p}}if(null!==m)for(d=p-m,p=7;0!=p&&d>0;)u=h[p],h[p--]=h[m+d-1],h[m+--d]=u;else if(8!=p)return;return h}(Jg(e,1,-1))))return Ud;this.host=t}else if(this.isSpecial()){if(e=function(e){var t,n,i=[],r=r2e(i2e(o2e(e),iq,"."),".");for(t=0;t<r.length;t++)yl(i,n2e(t2e,n=r[t])?"xn--"+a2e(n):n);return aq(i,".")}(e),Bs(A2e,e)||null===(t=function(r){var o,s,a,c,l,d,u,h=S2e(r,".");if(h.length&&""==h[h.length-1]&&h.length--,(o=h.length)>4)return r;for(s=[],a=0;a<o;a++){if(""==(c=h[a]))return r;if(l=10,c.length>1&&"0"==rs(c,0)&&(l=Bs(w2e,c)?16:8,c=Jg(c,8==l?1:2)),""===c)d=0;else{if(!Bs(10==l?R2e:8==l?I2e:mq,c))return r;d=zS(c,l)}Sp(s,d)}for(a=0;a<o;a++)if(d=s[a],a==o-1){if(d>=hq(256,5-o))return null}else if(d>255)return null;for(u=b2e(s),a=0;a<s.length;a++)u+=s[a]*hq(256,3-a);return u}(e)))return Ud;this.host=t}else{if(Bs(D2e,e))return Ud;for(t="",n=yp(e),i=0;i<n.length;i++)t+=Sl(n[i],qS);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return MP(YS,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&e_(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,i=e.password,r=e.host,o=e.port,s=e.path,a=e.query,c=e.fragment,l=t+":";return null!==r?(l+="//",e.includesCredentials()&&(l+=n+(i?":"+i:"")+"@"),l+=Qg(r),null!==o&&(l+=":"+o)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?s[0]:s.length?"/"+Zg(s,"/"):"",null!==a&&(l+="?"+a),null!==c&&(l+="#"+c),l},setHref:function(e){var t=this.parse(e);if(t)throw kP(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new Tp(e.path[0]).origin}catch{return"null"}return"file"!=e&&this.isSpecial()?e+"://"+Qg(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(_c(e)+":",BP)},getUsername:function(){return this.username},setUsername:function(e){var t=yp(_c(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=Sl(t[n],VP)}},getPassword:function(){return this.password},setPassword:function(e){var t=yp(_c(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=Sl(t[n],VP)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?Qg(e):Qg(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,GP)},getHostname:function(){var e=this.host;return null===e?"":Qg(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,WP)},getPort:function(){var e=this.port;return null===e?"":_c(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=_c(e))?this.port=null:this.parse(e,zP))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+Zg(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Cp))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=_c(e))?this.query=null:("?"==rs(e,0)&&(e=Jg(e,1)),this.query="",this.parse(e,Vd)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=_c(e))?("#"==rs(e,0)&&(e=Jg(e,1)),this.fragment="",this.parse(e,vc)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Tp=function(e){var t=d2e(this,kr),n=f2e(arguments.length,1)>1?arguments[1]:void 0,i=m2e(t,new YP(e,!1,n));NP||(t.href=i.serialize(),t.origin=i.getOrigin(),t.protocol=i.getProtocol(),t.username=i.getUsername(),t.password=i.getPassword(),t.host=i.getHost(),t.hostname=i.getHostname(),t.port=i.getPort(),t.pathname=i.getPathname(),t.search=i.getSearch(),t.searchParams=i.getSearchParams(),t.hash=i.getHash())},kr=Tp.prototype,os=function(e,t){return{get:function(){return WS(this)[e]()},set:t&&function(n){return WS(this)[t](n)},configurable:!0,enumerable:!0}};if(NP&&(is(kr,"href",os("serialize","setHref")),is(kr,"origin",os("getOrigin")),is(kr,"protocol",os("getProtocol","setProtocol")),is(kr,"username",os("getUsername","setUsername")),is(kr,"password",os("getPassword","setPassword")),is(kr,"host",os("getHost","setHost")),is(kr,"hostname",os("getHostname","setHostname")),is(kr,"port",os("getPort","setPort")),is(kr,"pathname",os("getPathname","setPathname")),is(kr,"search",os("getSearch","setSearch")),is(kr,"searchParams",os("getSearchParams")),is(kr,"hash",os("getHash","setHash"))),GS(kr,"toJSON",function(){return WS(this).serialize()},{enumerable:!0}),GS(kr,"toString",function(){return WS(this).serialize()},{enumerable:!0}),Xg){var Iq=Xg.createObjectURL,Rq=Xg.revokeObjectURL;Iq&&GS(Tp,"createObjectURL",lq(Iq,Xg)),Rq&&GS(Tp,"revokeObjectURL",lq(Rq,Xg))}p2e(Tp,"URL"),c2e({global:!0,constructor:!0,forced:!l2e,sham:!NP},{URL:Tp});var x2e=it,k2e=Sn,L2e=zh,Aq=Io,F2e=_N,Dq=Or("URL");x2e({target:"URL",stat:!0,forced:!(F2e&&k2e(function(){Dq.canParse()}))},{canParse:function(e){var t=L2e(arguments.length,1),n=Aq(e),i=t<2||void 0===arguments[1]?void 0:Aq(arguments[1]);try{return!!new Dq(n,i)}catch{return!1}}});var Oq=Vt(To.URL);const $n={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function Fe(){return $n}function Nq(){return"setSinkId"in HTMLAudioElement.prototype&&(!R("RESTRICTION_SET_PLAYBACK_DEVICE")||(pl()||$7())&&!ZN())}function Pq(){return!$n.supportUnifiedPlan||R("CHROME_FORCE_PLAN_B")&&fl()}let Xn=function(e){return e.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",e.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change",e}({});function wp(e,t,n){return{sampleRate:e,stereo:t,bitrate:n}}function Pe(e,t,n,i,r){return{width:e,height:t,frameRate:n,bitrateMin:i,bitrateMax:r}}function ss(e,t,n,i,r){return{width:{max:e},height:{max:t},frameRate:n,bitrateMin:i,bitrateMax:r}}function $P(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}const U2e={"90p":Pe(160,90),"90p_1":Pe(160,90),"120p":Pe(160,120,15,30,65),"120p_1":Pe(160,120,15,30,65),"120p_3":Pe(120,120,15,30,50),"120p_4":Pe(212,120),"180p":Pe(320,180,15,30,140),"180p_1":Pe(320,180,15,30,140),"180p_3":Pe(180,180,15,30,100),"180p_4":Pe(240,180,15,30,120),"240p":Pe(320,240,15,40,200),"240p_1":Pe(320,240,15,40,200),"240p_3":Pe(240,240,15,40,140),"240p_4":Pe(424,240,15,40,220),"360p":Pe(640,360,15,80,400),"360p_1":Pe(640,360,15,80,400),"360p_3":Pe(360,360,15,80,260),"360p_4":Pe(640,360,30,80,600),"360p_6":Pe(360,360,30,80,400),"360p_7":Pe(480,360,15,80,320),"360p_8":Pe(480,360,30,80,490),"360p_9":Pe(640,360,15,80,800),"360p_10":Pe(640,360,24,80,800),"360p_11":Pe(640,360,24,80,1e3),"480p":Pe(640,480,15,100,500),"480p_1":Pe(640,480,15,100,500),"480p_2":Pe(640,480,30,100,1e3),"480p_3":Pe(480,480,15,100,400),"480p_4":Pe(640,480,30,100,750),"480p_6":Pe(480,480,30,100,600),"480p_8":Pe(848,480,15,100,610),"480p_9":Pe(848,480,30,100,930),"480p_10":Pe(640,480,10,100,400),"720p":Pe(1280,720,15,120,1130),"720p_auto":Pe(1280,720,30,900,3e3),"720p_1":Pe(1280,720,15,120,1130),"720p_2":Pe(1280,720,30,120,2e3),"720p_3":Pe(1280,720,30,120,1710),"720p_5":Pe(960,720,15,120,910),"720p_6":Pe(960,720,30,120,1380),"1080p":Pe(1920,1080,15,120,2080),"1080p_1":Pe(1920,1080,15,120,2080),"1080p_2":Pe(1920,1080,30,120,3e3),"1080p_3":Pe(1920,1080,30,120,3150),"1080p_5":Pe(1920,1080,60,120,4780),"1440p":Pe(2560,1440,30,120,4850),"1440p_1":Pe(2560,1440,30,120,4850),"1440p_2":Pe(2560,1440,60,120,7350),"4k":Pe(3840,2160,30,120,8910),"4k_1":Pe(3840,2160,30,120,8910),"4k_3":Pe(3840,2160,60,120,13500)},V2e={"480p":ss(640,480,5),"480p_1":ss(640,480,5),"480p_2":ss(640,480,30),"480p_3":ss(640,480,15),"720p":ss(1280,720,5),"720p_auto":Pe(1280,720,30,900,3e3),"720p_1":ss(1280,720,5),"720p_2":ss(1280,720,30),"720p_3":ss(1280,720,15),"1080p":ss(1920,1080,5),"1080p_1":ss(1920,1080,5),"1080p_2":ss(1920,1080,30),"1080p_3":ss(1920,1080,15)},B2e={"1SL1TL":$P(1,1),"3SL3TL":$P(3,3),"2SL3TL":$P(2,3)};function Da(e){return e||(e="480p_1"),"string"==typeof e?Object.assign({},U2e[e]):e}function XP(e){return"string"==typeof e?Object.assign({},V2e[e]):e}function ZS(e){return"string"==typeof e?Object.assign({},B2e[e]):e}const j2e={speech_low_quality:wp(16e3,!1),speech_standard:wp(32e3,!1,18),music_standard:wp(48e3,!1),standard_stereo:wp(48e3,!0,56),high_quality:wp(48e3,!1,128),high_quality_stereo:wp(48e3,!0,192)};function JS(e){return"string"==typeof e?Object.assign({},j2e[e]):e}const Ip=[];function Mq(e){return Mn(e,"mediaSource",["screen","window","application"]),!0}let X=function(e){return e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_RTC_STATS="@get_rtc_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track",e}({}),ft=function(e){return e.SCREEN_TRACK="screen_track",e.CUSTOM_TRACK="custome_track",e.LOW_STREAM="low_stream",e.SCREEN_LOW_TRACK="screen_low_track",e}({}),Rp=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e}({}),H2e=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",e}({}),G2e=function(e){return e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY",e[e.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",e}({}),Bd=function(e){return e.TRANSCEIVER_UPDATED="transceiver-updated",e.SEI_TO_SEND="sei-to-send",e.SEI_RECEIVED="sei-received",e.TRACK_UPDATED="track-updated",e}({}),Ap=function(e){return e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed",e}({}),Dp=function(e){return e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.VIDEO_STATE_CHANGED="video-state-changed",e}({}),Op=function(e){return e.AUDIO="audio",e.VIDEO="video",e.DATA="data",e}({}),eo=function(e){return e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source",e}({});const ZP={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},JP={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},xq={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},W2e={uplinkNetworkQuality:0,downlinkNetworkQuality:0},kq={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let Xi=function(e){return e.ON_TRACK="on_track",e.ON_NODE="on_node",e}({}),to=function(e){return e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints",e}({}),t_=function(e){return e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND",e}({}),jd=function(e){return e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",e}({}),Li=function(e){return e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata",e}({}),Oa=function(e){return e[e.VideoStateStopped=0]="VideoStateStopped",e[e.VideoStateStarting=1]="VideoStateStarting",e[e.VideoStateDecoding=2]="VideoStateDecoding",e[e.VideoStateFrozen=3]="VideoStateFrozen",e}({});const QP={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let QS=function(e){return e.OPEN="open",e.MESSAGE="message",e.CLOSE="close",e.CLOSING="closing",e.ERROR="error",e}({});function Me(e,t,n,i,r){var o,s,a={};return Object.keys(i).forEach(function(c){a[c]=i[c]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=Ps(o=RLe(s=n.slice()).call(s)).call(o,function(c,l){return l(e,t,c)||c},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}function x(e,t,n){return(t="symbol"==typeof(r=function(o,s){if("object"!=typeof o||!o)return o;var a=o[Symbol.toPrimitive];if(void 0!==a){var c=a.call(o,"string");if("object"!=typeof c)return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(t))?r:r+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;var r}function Lq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lq(Object(n),!0).forEach(function(i){x(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lq(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}class Fq extends xt{set _mediaStreamTrack(t){t!==this.mediaStreamTrack&&(this.safeEmit(Bd.TRACK_UPDATED,t),this.mediaStreamTrack=t)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(t,n){super(),x(this,"trackMediaType",void 0),x(this,"_ID",void 0),x(this,"_rtpTransceiver",void 0),x(this,"_lowRtpTransceiver",void 0),x(this,"_hints",[]),x(this,"_isClosed",!1),x(this,"_originMediaStreamTrack",void 0),x(this,"mediaStreamTrack",void 0),x(this,"_external",{}),this._ID=n||gt(8,"track-"),this._originMediaStreamTrack=t,this.mediaStreamTrack=t,Y(Ip).call(Ip,this)||Ip.push(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(t){return t||ml(()=>{var n;ne.reportApiInvoke(null,{name:Cn.GET_MEDIA_STREAM_TRACK,options:[],tag:jt.TRACER}).onSuccess((null===(n=this._mediaStreamTrack)||void 0===n?void 0:n.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(t){return t===Rp.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(t){const n=Ip.indexOf(t);-1!==n&&Ip.splice(n,1)}(this),this.emit(Ap.CLOSED),this.removeAllListeners(Bd.SEI_RECEIVED)}_updateRtpTransceiver(t,n){if(n===Rp.LOW_STREAM){if(this._lowRtpTransceiver===t)return;this._lowRtpTransceiver=t}else{if(this._rtpTransceiver===t)return;this._rtpTransceiver=t}this.emit(Bd.TRANSCEIVER_UPDATED,t,n)}}class Np extends Fq{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(t,n){super(t,n),x(this,"_enabled",!0),x(this,"_muted",!1),x(this,"_isExternalTrack",!1),x(this,"_isClosed",!1),x(this,"_enabledMutex",void 0),x(this,"processor",void 0),x(this,"_processorContext",void 0),x(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new mi("".concat(this.getTrackId())),t.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var t,n;return null!==(t=null===(n=this._originMediaStreamTrack)||void 0===n?void 0:n.label)&&void 0!==t?t:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,_.debug("[".concat(this.getTrackId(),"] close")),this.emit(X.NEED_CLOSE),super.close())}_updateOriginMediaStreamTrack(t,n){var i=arguments,r=this;return C(function*(){r._isExternalTrack=i.length>2&&void 0!==i[2]&&i[2],t!==r._originMediaStreamTrack&&(r._originMediaStreamTrack&&(r._originMediaStreamTrack.removeEventListener("ended",r._handleTrackEnded),n&&r._originMediaStreamTrack.stop()),t.addEventListener("ended",r._handleTrackEnded),r._originMediaStreamTrack=t,r._muted&&(r._originMediaStreamTrack.enabled=!1),r._mediaStreamTrack=r._originMediaStreamTrack,r._updatePlayerSource(),yield ct(r,X.NEED_REPLACE_TRACK,r),r.processor&&r._processorContext&&r.processor.updateInput({track:r._originMediaStreamTrack,context:r._processorContext}))})()}_getDefaultPlayerConfig(){return{}}onTrackEnded(){_.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Ap.TRACK_ENDED)}stateCheck(t,n){if(_.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(t,": ").concat(n,"]")),hc(n,t),this._enabled&&this._muted&&"enabled"===t&&!1===n)throw new M(S.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",_);if(!this._enabled&&!this._muted&&"muted"===t&&!0===n)throw new M(S.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",_)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():q.resolve([])}}const Uq=window.AudioContext||window.webkitAudioContext;let no=null;const tt=new class extends xt{constructor(){var e;super(...arguments),e=this,x(this,"prevState",void 0),x(this,"curState",void 0),x(this,"currentTime",void 0),x(this,"currentTimeStuckAt",void 0),x(this,"interruptDetectorTrack",void 0),x(this,"onLocalAudioTrackMute",()=>{_.info("ios15-interruption-start"),this.emit(Xn.IOS_15_16_INTERRUPTION_START)}),x(this,"onLocalAudioTrackUnmute",C(function*(){_.info("ios15-interruption-end"),"running"!==e.curState||e.duringInterruption?_.info("ios15-interruption-end-canceled"):(no&&(yield no.suspend()),e.emit(Xn.IOS_15_16_INTERRUPTION_END))}))}get duringInterruption(){return"running"===this.prevState&&"interrupted"===this.curState}bindInterruptDetectorTrack(e){_.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){_.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Pp(){if(!no){if(function(){if(!Uq)return void _.error("your browser is not support web audio");_.info("create audio context");const e=Rt({},R("WEBAUDIO_INIT_OPTIONS"));_.debug("audio context init option:",JSON.stringify(e)),no=new Uq(e),tt.curState=no.state,no.onstatechange=()=>{tt.prevState=tt.curState,tt.curState=no?no.state:void 0;const{prevState:t,curState:n}=tt,i="running"===n,r="interrupted"===n,o="running"===t,s="suspended"===t,a="interrupted"===t,c=xe().osVersion;(Ki()||Zo())&&o&&r&&(_.info("ios".concat(c,"-interruption-start")),tt.emit(Xn.IOS_INTERRUPTION_START)),(Ki()||Zo())&&(s||a)&&i&&(_.info("ios".concat(c,"-interruption-end")),tt.emit(Xn.IOS_INTERRUPTION_END)),t!==n&&tt.emit(Xn.STATE_CHANGE,n,t)},setInterval(()=>{var t;const n=null===(t=no)||void 0===t?void 0:t.currentTime;tt.currentTime!==n?(tt.currentTimeStuckAt&&(_.debug("AudioContext current time resume at ".concat(n)),tt.currentTimeStuckAt=void 0),tt.currentTime=n):(n!==tt.currentTimeStuckAt&&(ne.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:n},tag:jt.TRACER}).onSuccess(),_.warning("AudioContext current time stuck at ".concat(n))),tt.currentTimeStuckAt=n)},5e3),function(){var t=C(function*(n){const i=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let r,o=!1,s=!1,a=!1;function c(g){"running"===n.state?l(!1):Ki()||Zo()?"suspended"===n.state&&(l(!0),g&&n.resume().then(d,d)):"closed"!==n.state&&(l(!0),g&&n.resume().then(d,d))}function l(g){if(o!==g){o=g;for(let E=0,b=i;E<b.length;E+=1){const T=b[E];g?window.addEventListener(T,u,{capture:!0,passive:!0}):window.removeEventListener(T,u,{capture:!0,passive:!0})}}}function d(){c(!1)}function u(){c(!0)}function h(g){if(!a)if(r.paused)if(g){let E;p(!1),a=!0;try{E=r.play(),E?E.then(m,m):(r.addEventListener("playing",m),r.addEventListener("abort",m),r.addEventListener("error",m))}catch{m()}}else p(!0);else p(!1)}function p(g){if(s!==g){s=g;for(let E=0,b=i;E<b.length;E++){const T=b[E];g?window.addEventListener(T,f,{capture:!0,passive:!0}):window.removeEventListener(T,f,{capture:!0,passive:!0})}}}function m(){r.removeEventListener("playing",m),r.removeEventListener("abort",m),r.removeEventListener("error",m),a=!1,h(!1)}function f(){h(!0)}if(Ki()){const g=n.createMediaStreamDestination(),E=document.createElement("div");E.innerHTML="<audio x-webkit-airplay='deny'></audio>",r=E.children.item(0),r.controls=!1,r.disableRemotePlayback=!0,r.preload="auto",r.srcObject=g.stream,h(!0)}tt.on(Xn.STATE_CHANGE,function(){c(!0)}),c(!1)});return function(n){return t.apply(this,arguments)}}()(no)}(),!no)throw new M(S.NOT_SUPPORTED,"can not create audio context");return no}return no}function Hd(e){if(function(){if(null!==eM)return eM;const i=Pp(),r=i.createBufferSource(),o=i.createGain(),s=i.createGain();r.connect(o),r.connect(s),r.disconnect(o);let a=!1;try{r.disconnect(o)}catch{a=!0}return r.disconnect(),eM=a,a}())return;const t=e.connect,n=e.disconnect;e.connect=(i,r,o)=>{var s;return e._inputNodes||(e._inputNodes=[]),Y(s=e._inputNodes).call(s,i)||(i instanceof AudioNode?(e._inputNodes.push(i),t.call(e,i,r,o)):t.call(e,i,r)),e},e.disconnect=(i,r,o)=>{n.call(e),i?DS(e._inputNodes,i):e._inputNodes=[];for(const s of e._inputNodes)t.call(e,s)}}let eM=null;function tM(e,t){let n=!1;const i=1/t;if(R("DISABLE_WEBAUDIO")){const r=window.setInterval(()=>{n?window.clearInterval(r):e(performance.now()/1e3)},1e3*i)}else{const r=Pp();let o=r.createGain();o.gain.value=0,o.connect(r.destination);const s=()=>{if(n)return void(o=null);const a=r.createOscillator();a.onended=s,a.connect(o),a.start(0),a.stop(r.currentTime+i),e(r.currentTime)};s()}return()=>{n=!0}}class Vq{constructor(){x(this,"context",void 0),x(this,"analyserNode",void 0),x(this,"sourceNode",void 0),this.context=Pp(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(t){if(t!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=t,t?.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||Ki()||Zo()||"running"!==this.context.state&&this.context.resume(),!this.analyserNode))return 0;const t=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(t);else{const i=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(i);for(let r=0;r<t.length;++r)t[r]=i[r]/128-1}const n=Ps(t).call(t,(i,r)=>i+r*r,0)/t.length;return Math.max(10*Math.log10(n)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var t,n;null===(t=this.sourceNode)||void 0===t||t.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,null===(n=this.sourceNode)||void 0===n||n.connect(this.analyserNode)}catch{_.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class Bq extends xt{get processSourceNode(){return this.sourceNode}set processedNode(t){var n;if(!this.isDestroyed&&this._processedNode!==t){try{var i;null===(i=this.sourceNode)||void 0===i||i.disconnect(this.outputNode)}catch{}null===(n=this._processedNode)||void 0===n||n.disconnect(),this._processedNode=t,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),x(this,"outputNode",void 0),x(this,"outputTrack",void 0),x(this,"isPlayed",!1),x(this,"sourceNode",void 0),x(this,"context",void 0),x(this,"audioBufferNode",void 0),x(this,"destNode",void 0),x(this,"audioOutputLevel",0),x(this,"volumeLevelAnalyser",void 0),x(this,"_processedNode",void 0),x(this,"playNode",void 0),x(this,"isDestroyed",!1),x(this,"onNoAudioInput",void 0),x(this,"isNoAudioInput",!1),x(this,"_noAudioInputCount",0),this.context=Pp(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),Hd(this.outputNode),this.volumeLevelAnalyser=new Vq}startGetAudioBuffer(t){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(t),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=n=>{this.emit(eo.ON_AUDIO_BUFFER,function(i){for(let r=0;r<i.outputBuffer.numberOfChannels;r+=1){const o=i.outputBuffer.getChannelData(r);for(let s=0;s<o.length;s+=1)o[s]=0}return i.inputBuffer}(n))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!Fe().webAudioMediaStreamDest)throw new M(S.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(t){"running"!==this.context.state&&OS(()=>{tt.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=t||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}checkHasAudioInput(){var t=arguments,n=this;return C(function*(){let i=t.length>0&&void 0!==t[0]?t[0]:0;if(i>5)return n.isNoAudioInput=!0,n.onNoAudioInput&&n.onNoAudioInput(),!1;Ki()||Zo()?"suspended"===n.context.state&&n.context.resume():"running"!==n.context.state&&n.context.resume();const r=n.volumeLevelAnalyser.getAnalyserNode();let o;r.getFloatTimeDomainData?(o=new Float32Array(r.fftSize),r.getFloatTimeDomainData(o)):(o=new Uint8Array(r.fftSize),r.getByteTimeDomainData(o));let s=!1;for(let a=0;a<o.length;a++)0!==o[a]&&(s=!0);return s?(n.isNoAudioInput=!1,!0):(yield qn(200),(yield n.checkHasAudioInput(i?i+1:1))&&s)})()}getAudioVolume(){return this.outputNode.gain.value}setVolume(t){this.outputNode.gain.setValueAtTime(t,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var t,n;null===(t=this.processedNode)||void 0===t||t.disconnect(),null===(n=this.sourceNode)||void 0===n||n.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var t;this.processedNode?null===(t=this.processedNode)||void 0===t||t.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class jq extends Bq{get isFreeze(){return!1}constructor(t,n,i){var r,o;if(super(),r=this,x(this,"sourceNode",void 0),x(this,"track",void 0),x(this,"clonedTrack",void 0),x(this,"audioElement",void 0),x(this,"isCurrentTrackCloned",!1),x(this,"isRemoteTrack",!1),x(this,"originVolumeLevelAnalyser",void 0),x(this,"rebuildWebAudio",C(function*(){if(_.debug("ready to rebuild web audio, state:",r.context.state),r.isNoAudioInput&&(yield r.checkHasAudioInput()),!r.isNoAudioInput||r.isDestroyed)return document.body.removeEventListener("click",r.rebuildWebAudio,!0),void _.debug("rebuild web audio success, current volume status",r.getAccurateVolumeLevel());r.context.resume().then(()=>_.info("resume success")),_.debug("rebuild web audio because of ios 12 bugs"),r.disconnect();const c=r.track;r.track=r.track.clone(),r.isCurrentTrackCloned?c.stop():r.isCurrentTrackCloned=!0;const l=new MediaStream([r.track]);r.sourceNode=r.context.createMediaStreamSource(l),Hd(r.sourceNode),r.volumeLevelAnalyser.rebuildAnalyser();const d=r.outputNode.gain.value;r.outputNode=r.context.createGain(),r.outputNode.gain.setValueAtTime(d,r.context.currentTime),Hd(r.outputNode),r.emit(eo.UPDATE_SOURCE),r.connect(),r.audioElement.srcObject=l,r.isPlayed&&r.play(r.playNode),r.checkHasAudioInput()})),"audio"!==t.kind)throw new M(S.UNEXPECTED_ERROR);this.track=t;const s=new MediaStream([this.track]);if(this.isRemoteTrack=!!n,this.sourceNode=this.context.createMediaStreamSource(s),Hd(this.sourceNode),i){const c=i.clone();c.enabled=!0,this.clonedTrack=c,_.debug("create an unmuted track ".concat(c.id," from the original track ").concat(i.id," to get the volume"));const l=this.context.createMediaStreamSource(new MediaStream([c]));Hd(l),this.originVolumeLevelAnalyser=new Vq,this.originVolumeLevelAnalyser.updateSource(l)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=s;const a=xe();n&&a.os===kn.IOS&&Number(null===(o=a.osVersion)||void 0===o?void 0:o.split(".")[0])<15&&(tt.on(Xn.STATE_CHANGE,()=>{"suspended"===this.context.state?document.body.addEventListener("click",this.rebuildWebAudio,!0):"running"===this.context.state&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(c=>{c||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(t){this.sourceNode.disconnect(),this.track=t,this.isCurrentTrackCloned=!1;const n=new MediaStream([t]);this.sourceNode=this.context.createMediaStreamSource(n),Hd(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(eo.UPDATE_SOURCE),this.audioElement.srcObject=n}destroy(){var t;this.audioElement.srcObject=null,this.audioElement.remove(),tt.off("state-change",this.rebuildWebAudio),null===(t=this.originVolumeLevelAnalyser)||void 0===t||t.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(t){return this.context.createMediaStreamSource(new MediaStream([t]))}updateOriginTrack(t){const n=t.clone();n.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=n),_.debug("create an unmuted track ".concat(n.id," from the original track ").concat(t.id," to get the volume"));const i=this.context.createMediaStreamSource(new MediaStream([n]));Hd(i),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(i)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}function Hq(e,t,n){return nM.apply(this,arguments)}function nM(){return nM=C(function*(e,t,n){const i=(o,s)=>o?"number"!=typeof o?o.max||o.exact||o.ideal||o.min||s:o:s,r={audio:!!n&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:i(t.height,1080),maxWidth:i(t.width,1920)}}};return t.frameRate&&"number"!=typeof t.frameRate?(r.video.mandatory.maxFrameRate=t.frameRate.max,r.video.mandatory.minFrameRate=t.frameRate.min):"number"==typeof t.frameRate&&(r.video.mandatory.maxFrameRate=t.frameRate),yield navigator.mediaDevices.getUserMedia(r)}),nM.apply(this,arguments)}function iM(){return iM=C(function*(e,t){const n=yield Gq(e.mediaSource),{sourceId:i,audio:r}=yield function(o){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new q((a,c)=>{const l=document.createElement("div");l.innerText="share screen",l.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const d=document.createElement("div");d.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const u=document.createElement("div");u.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",u.setAttribute("style","height: 12%;");const h=document.createElement("div");h.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const p=document.createElement("div");p.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const m=document.createElement("button");m.innerHTML="cancel",m.setAttribute("style","width: 85px;"),m.onclick=()=>{document.body.removeChild(E);const b=new Error("NotAllowedError");b.name="NotAllowedError",c(b)};let f=s;const g=document.createElement("div");if(s){const b=document.createElement("input");b.setAttribute("type","checkbox");const T=document.createElement("span");b.setAttribute("style","margin-right: 6px;"),T.innerText="Share audio",b.checked=f,b.onchange=()=>{f=b.checked},g.appendChild(b),g.appendChild(T)}p.appendChild(g),p.appendChild(m),d.appendChild(u),d.appendChild(h),d.appendChild(p);const E=document.createElement("div");E.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),E.appendChild(l),E.appendChild(d),document.body.appendChild(E),o.map(b=>{if(b.id){const T=document.createElement("div");T.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let I=b.thumbnail;try{const{width:D}=I.getSize();D>1920&&(I=I.resize({width:1920}))}catch(D){throw D&&D.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),D}T.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+I.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+b.name.replace(/[\u00A0-\u9999<>\&]/g,function(D){return"&#"+D.charCodeAt(0)+";"})+"</span>",T.onclick=()=>{document.body.removeChild(E),a({sourceId:b.id,audio:f})},h.appendChild(T)}})})}(n,t);return yield Hq(i,e,r)}),iM.apply(this,arguments)}function Gq(e){return rM.apply(this,arguments)}function rM(){return rM=C(function*(e){let t=["window","screen"];"application"!==e&&"window"!==e||(t=["window"]),"screen"===e&&(t=["screen"]);const n=dK();if(!n)throw console.error("failed to fetch electron, please mount it to window"),new M(S.ELECTRON_IS_NULL);let i=null;try{var r;i=(null===(r=n.desktopCapturer)||void 0===r?void 0:r.getSources({types:t}))||n.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch{i=null}i&&i.then||(i=new q((o,s)=>{n.desktopCapturer.getSources({types:t},(a,c)=>{a?s(a):o(c)})}));try{return yield i}catch(o){throw new M(S.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,o.toString())}}),rM.apply(this,arguments)}const oM=new mi("safari");let Wq=!1,zq=!1;function io(e,t){return sM.apply(this,arguments)}function sM(){return sM=C(function*(e,t){let n=0,i=null;for(;n<2;)try{i=yield K2e(e,t,n>0);break}catch(r){if(r instanceof M)throw _.error("[".concat(t,"] ").concat(r.toString())),r;const o=eC(r.name||r.code||r,r.message);if(o.code===S.MEDIA_OPTION_INVALID){_.debug("[".concat(t,"] detect media option invalid, retry")),n+=1,yield qn(500);continue}throw _.error("[".concat(t,"] ").concat(o.toString())),o}if(!i)throw new M(S.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return i}),sM.apply(this,arguments)}function K2e(e,t,n){return aM.apply(this,arguments)}function aM(){return aM=C(function*(e,t,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new M(S.NOT_SUPPORTED,"can not find getUserMedia");n&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const i=Fe(),r=new MediaStream;if(e.audioSource&&r.addTrack(e.audioSource),e.videoSource&&r.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return _.debug("Using Video Source/ Audio Source"),r;if(e.screen)if(dK())Mp(r,e.screen.sourceId?yield Hq(e.screen.sourceId,e.screen,e.screenAudio):yield function z2e(e,t){return iM.apply(this,arguments)}(e.screen,e.screenAudio));else if(pl()&&e.screen.extensionId&&e.screen.mandatory){if(!i.getStreamFromExtension)throw new M(S.NOT_SUPPORTED,"This browser does not support screen sharing");_.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));const h=yield(s=e.screen.extensionId,a=t,new q((p,m)=>{try{chrome.runtime.sendMessage(s,{getStream:!0},f=>{if(!f||!f.streamId)return _.error("[".concat(a,"] No response from Chrome Plugin. Plugin not installed properly"),f),void m(new M(S.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));p(f.streamId)})}catch(f){_.error("[".concat(a,"] AgoraRTC screensharing plugin is not accessible(").concat(s,")"),f.toString()),m(new M(S.CHROME_PLUGIN_NOT_INSTALL))}}));e.screen.mandatory.chromeMediaSourceId=h,Mp(r,yield navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(i.getDisplayMedia){var o;e.screen.mediaSource&&Mq(e.screen.mediaSource);const h={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:null!==(o=e.screen.displaySurface)&&void 0!==o?o:"screen"===e.screen.mediaSource?"monitor":e.screen.mediaSource},{selfBrowserSurface:p,surfaceSwitching:m,systemAudio:f}=e.screen,g={selfBrowserSurface:p,surfaceSwitching:m,systemAudio:f};!p&&delete g.selfBrowserSurface,!m&&delete g.surfaceSwitching,!f&&delete g.systemAudio,_.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:h,audio:!!e.screenAudio,controls:g})),Mp(r,yield navigator.mediaDevices.getDisplayMedia(Rt({video:h,audio:!!e.screenAudio},g)))}else{if(!Bt())throw _.error("[".concat(t,"] This browser does not support screenSharing")),new M(S.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&Mq(e.screen.mediaSource);const h={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};_.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(h))),Mp(r,yield navigator.mediaDevices.getUserMedia(h))}}var s,a;if(!e.video&&!e.audio)return r;let c={video:e.video,audio:e.audio},l=R("MEDIA_DEVICE_CONSTRAINTS");if(l)try{"string"==typeof l&&(l=JSON.parse(l)),c=nP(c,l)}catch{}_.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(c)),xe();let d,u=null;(ei()||Ki()||IS())&&(u=yield oM.lock());try{d=yield navigator.mediaDevices.getUserMedia(c)}catch(h){throw u&&u(),h}return c.audio&&(Wq=!0),c.video&&(zq=!0),Mp(r,d),u&&u(),r}),aM.apply(this,arguments)}function eC(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new M(S.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new M(S.DEVICE_NOT_FOUND,"".concat(e,": ").concat(t));case"NotSupportedError":return new M(S.NOT_SUPPORTED,"".concat(e,": ").concat(t));case"NotReadableError":return new M(S.NOT_READABLE,"".concat(e,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new M(S.PERMISSION_DENIED,"".concat(e,": ").concat(t));case"ConstraintNotSatisfiedError":return new M(S.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(t));default:return _.error("getUserMedia unexpected error",e),new M(S.UNEXPECTED_ERROR,"".concat(e,": ").concat(t))}}function Mp(e,t){const n=e.getVideoTracks()[0],i=e.getAudioTracks()[0],r=t.getVideoTracks()[0],o=t.getAudioTracks()[0];o&&(i&&e.removeTrack(i),e.addTrack(o)),r&&(n&&e.removeTrack(n),e.addTrack(r))}const ro=new class extends xt{get state(){return this._state}set state(e){e!==this._state&&(this.emit(jd.STATE_CHANGE,e),this._state=e)}constructor(){super(),x(this,"_state",t_.IDLE),x(this,"isAccessMicrophonePermission",!1),x(this,"isAccessCameraPermission",!1),x(this,"lastAccessMicrophonePermission",!1),x(this,"lastAccessCameraPermission",!1),x(this,"checkdeviceMatched",!1),x(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(R("ENUMERATE_DEVICES_INTERVAL")||(RS()||wS()===kn.HARMONY_OS)&&fl())&&this.updateDevicesInfo()},R("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(e=>_.error(e.toString()))}enumerateDevices(e,t){var n=arguments,i=this;return C(function*(){let r=n.length>2&&void 0!==n[2]&&n[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new M(S.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const o=yield navigator.mediaDevices.enumerateDevices(),s=i.checkMediaDeviceInfoIsOk(o);let a=!i.isAccessMicrophonePermission&&e,c=!i.isAccessCameraPermission&&t;s.audio&&(a=!1),s.video&&(c=!1);let l=null,d=null,u=null;if(!r&&(a||c)){if(oM.isLocked&&(_.debug("[device manager] wait GUM lock"),(yield oM.lock())(),_.debug("[device manager] GUM unlock")),Wq&&(a=!1,i.isAccessMicrophonePermission=!0),zq&&(c=!1,i.isAccessCameraPermission=!0),_.debug("[device manager] check media device permissions",e,t,a,c),a&&c){try{u=yield navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(h){const p=eC(h.name||h.code||h,h.message);if(p.code===S.PERMISSION_DENIED)throw p;_.warning("getUserMedia failed in getDevices",p)}i.isAccessCameraPermission=!0,i.isAccessMicrophonePermission=!0}else if(a){try{l=yield navigator.mediaDevices.getUserMedia({audio:e})}catch(h){const p=eC(h.name||h.code||h,h.message);if(p.code===S.PERMISSION_DENIED)throw p;_.warning("getUserMedia failed in getDevices",p)}i.isAccessMicrophonePermission=!0}else if(c){try{d=yield navigator.mediaDevices.getUserMedia({video:t})}catch(h){const p=eC(h.name||h.code||h,h.message);if(p.code===S.PERMISSION_DENIED)throw p;_.warning("getUserMedia failed in getDevices",p)}i.isAccessCameraPermission=!0}_.debug("[device manager] mic permission",e,"cam permission",t)}try{const h=yield navigator.mediaDevices.enumerateDevices();return l&&l.getTracks().forEach(p=>p.stop()),d&&d.getTracks().forEach(p=>p.stop()),u&&u.getTracks().forEach(p=>p.stop()),l=null,d=null,u=null,h}catch(h){return l&&l.getTracks().forEach(p=>p.stop()),d&&d.getTracks().forEach(p=>p.stop()),u&&u.getTracks().forEach(p=>p.stop()),l=null,d=null,u=null,new M(S.ENUMERATE_DEVICES_FAILED,h.toString()).throw()}})()}getRecordingDevices(){var e=arguments,t=this;return C(function*(){let n=e.length>0&&void 0!==e[0]&&e[0];return(yield t.enumerateDevices(!0,!1,n)).filter(i=>"audioinput"===i.kind)})()}getCamerasDevices(){var e=arguments,t=this;return C(function*(){let n=e.length>0&&void 0!==e[0]&&e[0];return(yield t.enumerateDevices(!1,!0,n)).filter(i=>"videoinput"===i.kind)})()}getSpeakers(){var e=arguments,t=this;return C(function*(){let n=e.length>0&&void 0!==e[0]&&e[0];return(yield t.enumerateDevices(!0,!1,n)).filter(i=>"audiooutput"===i.kind)})()}searchDeviceIdByName(e){let t=null;return this.deviceInfoMap.forEach(n=>{n.device.label===e&&(t=n.device.deviceId)}),t}getDeviceById(e){var t=this;return C(function*(){const n=(yield t.enumerateDevices(!0,!0,!0)).find(i=>i.deviceId===e);if(!n)throw new M(S.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return n})()}init(){var e=this;return C(function*(){e.state=t_.INITING;try{yield e.updateDevicesInfo(),e.state=t_.INITEND}catch(t){throw _.warning("Device Detection functionality cannot start properly.",t.toString()),e.state=t_.IDLE,("boolean"==typeof isSecureContext?isSecureContext:"https:"===location.protocol||"file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname||"::1"===location.hostname)||new M(S.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),t}})()}updateDevicesInfo(){var e=this;return C(function*(){const t=yield e.enumerateDevices(!0,!0,!0),n=Date.now(),i=[];if(t[0]&&t[0].label&&!1===e.checkdeviceMatched){e.checkdeviceMatched=!0;const o=t.find(a=>"audioinput"===a.kind&&"default"===a.deviceId),s=t.find(a=>"audiooutput"===a.kind&&"default"===a.deviceId);o&&s?s.groupId===o.groupId?_.debug("[device-check] default input ".concat(o.label," and output ").concat(s.label," is the same group")):_.warning("[device-check] default input ".concat(o.label," and output ").concat(s.label," is not the same group")):_.debug("[device-check] default input or output not found")}const r=e.checkMediaDeviceInfoIsOk(t);if(t.forEach(o=>{if(!o.deviceId)return;const s=e.deviceInfoMap.get("".concat(o.kind,"_").concat(o.deviceId));if("ACTIVE"!==(s?s.state:"INACTIVE")){const a={initAt:n,updateAt:n,device:o,state:"ACTIVE"};e.deviceInfoMap.set("".concat(o.kind,"_").concat(o.deviceId),a),i.push(a)}s&&(s.updateAt=n)}),e.deviceInfoMap.forEach((o,s)=>{"ACTIVE"===o.state&&o.updateAt!==n&&(o.state="INACTIVE",i.push(o))}),e.state!==t_.INITEND)return r.audio&&(e.lastAccessMicrophonePermission=!0,e.isAccessMicrophonePermission=!0),void(r.video&&(e.lastAccessCameraPermission=!0,e.isAccessCameraPermission=!0));i.forEach(o=>{switch(o.device.kind){case"audioinput":e.lastAccessMicrophonePermission&&e.isAccessMicrophonePermission&&e.emit(jd.RECORDING_DEVICE_CHANGED,o);break;case"videoinput":e.lastAccessCameraPermission&&e.isAccessCameraPermission&&e.emit(jd.CAMERA_DEVICE_CHANGED,o);break;case"audiooutput":e.lastAccessMicrophonePermission&&e.isAccessMicrophonePermission&&e.emit(jd.PLAYOUT_DEVICE_CHANGED,o)}}),r.audio&&(e.lastAccessMicrophonePermission=!0,e.isAccessMicrophonePermission=!0),r.video&&(e.lastAccessCameraPermission=!0,e.isAccessCameraPermission=!0)})()}checkMediaDeviceInfoIsOk(e){const t=e.filter(r=>"audioinput"===r.kind),n=e.filter(r=>"videoinput"===r.kind),i={audio:!1,video:!1};for(const r of t)if(r.label&&r.deviceId){i.audio=!0;break}for(const r of n)if(r.label&&r.deviceId){i.video=!0;break}return i}};let cM=!1;const oo=new class extends xt{constructor(){super(...arguments),x(this,"onAutoplayFailed",void 0),x(this,"onAudioAutoplayFailed",void 0)}};function Kq(){if(xe(),!cM){const e=t=>{t.preventDefault(),cM=!1,jg()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};cM=!0,jg()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),_.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),oo.onAutoplayFailed?oo.onAutoplayFailed():_.warning(oo.onAudioAutoplayFailed?"AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.\n\n  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .":"We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.\n\n  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.\n\n  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."),oo.emit("autoplay-failed")}}function qq(e,t,n,i){if(!e)return;const r=ne.getBaseInfoBySessionId(e);if(!r)return;const o=r.info,s=Date.now(),a=Rt(Rt({},o),{},{vid:void 0===o.vid?0:Number(o.vid),lts:s,elapse:s-r.startTime,cbRegistered:oo.onAutoplayFailed||oo.onAudioAutoplayFailed?1:-1,errorMsg:n,mediaType:t,trackId:i,extend:void 0});ne.send({type:kt.AUTOPLAY_FAILED,data:a},!0)}const q2e=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],ir=new class{constructor(){x(this,"onAutoplayFailed",void 0),x(this,"elementMap",new Map),x(this,"elementStateMap",new Map),x(this,"elementsNeedToResume",[]),x(this,"sinkIdMap",new Map),x(this,"autoResumeAfterInterruption",e=>{Array.from(this.elementMap.entries()).forEach(t=>{let[n,i]=t;const r=this.elementStateMap.get(n),o=i.srcObject.getAudioTracks()[0],s=o&&o.readyState;if(_.debug("resume after interrupted, ele: ".concat(r," audio: ").concat(s," ").concat(e)),"live"===s){if(e)return i.pause(),void i.play();if("running"===tt.curState)return cp()?(i.pause(),void i.play()):void(r&&"paused"===r&&i.play())}})}),x(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(e=>{let[t,n]=e;const i=n.srcObject.getAudioTracks()[0];i&&"live"===i.readyState&&(_.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),n.pause(),n.play())})}),this.autoResumeAudioElement(),tt.on(Xn.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),tt.on(Xn.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),tt.on(Xn.STATE_CHANGE,()=>{Ki()&&"suspended"===tt.prevState&&"running"===tt.curState&&this.autoResumeAfterInterruption()})}setSinkID(e,t){var n=this;return C(function*(){const i=n.elementMap.get(e);if(n.sinkIdMap.set(e,t),i)try{yield i.setSinkId(t)}catch(r){throw new M(S.PERMISSION_DENIED,"can not set sink id: "+r.toString())}})()}play(e,t,n,i){if(this.elementMap.has(t))return;const r=document.createElement("audio");r.autoplay=!0,r.srcObject=new MediaStream([e]),this.bindAudioElementEvents(t,r),this.elementMap.set(t,r),this.elementStateMap.set(t,Li.INIT),this.setVolume(t,n);const o=this.sinkIdMap.get(t);if(o)try{r.setSinkId(o).catch(a=>{_.warning("[".concat(t,"] set sink id failed"),a.toString())})}catch(a){_.warning("[".concat(t,"] set sink id failed"),a.toString())}const s=r.play();s&&s.then&&s.catch(a=>{i&&qq(i,"audio",a.message,t),_.warning("audio element play warning",a.toString()),this.elementMap.has(t)&&"NotAllowedError"===a.name&&(_.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(r),OS(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),Kq()}))})}updateTrack(e,t){const n=this.elementMap.get(e);n&&(n.srcObject=new MediaStream([t]))}isPlaying(e){return this.elementMap.has(e)&&"playing"===this.elementStateMap.get(e)}setVolume(e,t){const n=this.elementMap.get(e);n&&(t=Math.max(0,Math.min(100,t)),n.volume=t/100)}stop(e){const t=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!t)return;const n=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(n,1),t.srcObject=null,t.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,t){q2e.forEach(n=>{t.addEventListener(n,i=>{const r=this.elementStateMap.get(e),o="pause"===i.type?"paused":i.type;if(_.debug("[".concat(e,"] audio-element-status change ").concat(r," => ").concat(o)),"error"===i.type){const s=t?.error;s&&_.error("[".concat(e,"] media error, code: ").concat(s.code,", message: ").concat(s.message))}this.elementStateMap.set(e,o)})})}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach(t=>{t.play().then(n=>{_.debug("Auto resume audio element success")}).catch(n=>{_.warning("Auto resume audio element failed!",n)})}),this.elementsNeedToResume=[]};new q(t=>{document.body?t():window.addEventListener("load",()=>t())}).then(()=>{jg()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0))})}};function en(){return function(e,t,n){const i=n.value;return"function"==typeof i&&(n.value=function(){this._isClosed&&new M(S.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",_);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];const a=i.apply(this,o);return a instanceof q?new q((c,l)=>{a.then(c).catch(l)}):a}),n}}class Yq extends xt{constructor(t){super(),x(this,"name","VideoProcessorDestination"),x(this,"ID","0"),x(this,"_source",void 0),x(this,"videoContext",void 0),x(this,"inputTrack",void 0),this.videoContext=t}get kind(){return"video"}get enabled(){return!0}pipe(){throw new M(S.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new M(S.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(t){if(t.context!==this.videoContext)throw new Error("ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.\nProbably you are making pipeline like this:\nvideoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).");t.track&&t.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=t.track,this.emit(Xi.ON_TRACK,t.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(Xi.ON_TRACK,void 0)}}class $q extends xt{set chained(t){this._chained=t}get chained(){return this._chained}constructor(t,n){super(),x(this,"constraintsMap",new Map),x(this,"statsRegistry",[]),x(this,"usageRegistry",[]),x(this,"trackId",void 0),x(this,"direction",void 0),x(this,"_chained",!1),this.trackId=t,this.direction=n}getConstraints(){var t=this;return C(function*(){return yield ni(t,to.REQUEST_CONSTRAINTS)})()}requestApplyConstraints(t,n){var i=this;return C(function*(){var r;return _.info("processor ".concat(n.name," requestApplyConstraints for ").concat(i.trackId)),t&&i.constraintsMap.set(n,t),ct(i,to.REQUEST_UPDATE_CONSTRAINTS,Array.from(gc(r=i.constraintsMap).call(r)))})()}requestRevertConstraints(t){var n=this;return C(function*(){var i;if(n.constraintsMap.has(t))return _.info("processor ".concat(t.name," requestRevertConstraints for ").concat(n.trackId)),n.constraintsMap.delete(t),ct(n,to.REQUEST_UPDATE_CONSTRAINTS,Array.from(gc(i=n.constraintsMap).call(i)))})()}registerStats(t,n,i){this.statsRegistry.find(r=>r.processorID===t.ID&&r.processorName===t.name&&r.type===n)||this.statsRegistry.push({processorName:t.name,processorID:t.ID,type:n,cb:i})}unregisterStats(t,n){const i=this.statsRegistry.findIndex(r=>r.processorID===t.ID&&r.processorName===t.name&&r.type===n);-1!==i&&this.statsRegistry.splice(i,1)}gatherStats(){const t=[];for(const{processorID:n,processorName:i,type:r,cb:o}of this.statsRegistry)try{const s=o();t.push({processorID:n,processorName:i,type:r,stats:s})}catch(s){_.error(new M(S.UNEXPECTED_ERROR,s.message))}return t}registerUsage(t,n){this.usageRegistry.find(i=>i.processorID===t.ID&&i.processorName===t.name)||this.usageRegistry.push({processorID:t.ID,processorName:t.name,cb:n})}unregisterUsage(t){const n=this.usageRegistry.findIndex(i=>i.processorID===t.ID&&i.processorName===t.name);-1!==n&&this.usageRegistry.splice(n,1)}gatherUsage(){var t=this;return C(function*(){const n=[];if(!t.chained)return[];for(const{cb:i}of t.usageRegistry)try{let r=i();r instanceof q&&(r=yield r),n.push(Rt(Rt({},r),{},{direction:t.direction}))}catch(r){_.error("gather extension usage error",r)}return n})()}getDirection(){return this.direction}}class Xq extends xt{constructor(t){super(),x(this,"name","AudioProcessorDestination"),x(this,"ID","0"),x(this,"inputTrack",void 0),x(this,"inputNode",void 0),x(this,"audioProcessorContext",void 0),x(this,"_source",void 0),this.audioProcessorContext=t}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new M(S.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new M(S.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(Xi.ON_TRACK,void 0),this.emit(Xi.ON_NODE,void 0)}updateInput(t){if(t.context!==this.audioProcessorContext)throw new Error("ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.\n        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).");t.track&&this.inputTrack!==t.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=t.track,this.emit(Xi.ON_TRACK,this.inputTrack)),t.node&&this.inputNode!==t.node&&(this.audioProcessorContext.chained=!0,this.inputNode=t.node,this.emit(Xi.ON_NODE,this.inputNode))}}class Zq extends xt{set chained(t){this._chained=t}get chained(){return this._chained}constructor(t,n,i){super(),x(this,"constraintsMap",new Map),x(this,"statsRegistry",[]),x(this,"audioContext",void 0),x(this,"trackId",void 0),x(this,"direction",void 0),x(this,"usageRegistry",[]),x(this,"_chained",!1),this.audioContext=t,this.trackId=n,this.direction=i}getConstraints(){var t=this;return C(function*(){return ni(t,to.REQUEST_CONSTRAINTS)})()}getAudioContext(){return this.audioContext}requestApplyConstraints(t,n){var i=this;return C(function*(){var r;return _.info("processor ".concat(n.name," requestApplyConstraints for ").concat(i.trackId)),t&&i.constraintsMap.set(n,t),ct(i,to.REQUEST_UPDATE_CONSTRAINTS,Array.from(gc(r=i.constraintsMap).call(r)))})()}requestRevertConstraints(t){var n=this;return C(function*(){var i;if(n.constraintsMap.has(t))return n.constraintsMap.delete(t),ct(n,to.REQUEST_UPDATE_CONSTRAINTS,Array.from(gc(i=n.constraintsMap).call(i)))})()}registerStats(t,n,i){this.statsRegistry.find(r=>r.processorID===t.ID&&r.processorName===t.name&&r.type===n)||this.statsRegistry.push({processorName:t.name,processorID:t.ID,type:n,cb:i})}unregisterStats(t,n){const i=this.statsRegistry.findIndex(r=>r.processorID===t.ID&&r.processorName===t.name&&r.type===n);-1!==i&&this.statsRegistry.splice(i,1)}gatherStats(){const t=[];for(const{processorID:n,processorName:i,type:r,cb:o}of this.statsRegistry)try{const s=o();t.push({processorID:n,processorName:i,type:r,stats:s})}catch(s){_.error(new M(S.UNEXPECTED_ERROR,s.message))}return t}registerUsage(t,n){this.usageRegistry.find(i=>i.processorID===t.ID&&i.processorName===t.name)||this.usageRegistry.push({processorID:t.ID,processorName:t.name,cb:n})}unregisterUsage(t){const n=this.usageRegistry.findIndex(i=>i.processorID===t.ID&&i.processorName===t.name);-1!==n&&this.usageRegistry.splice(n,1)}gatherUsage(){var t=this;return C(function*(){const n=[];if(!t.chained)return[];for(const{cb:i}of t.usageRegistry)try{let r=i();r instanceof q&&(r=yield r),n.push(Rt(Rt({},r),{},{direction:t.direction}))}catch(r){_.error("gather extension usage error",r)}return n})()}getDirection(){return this.direction}}class lM extends xt{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),x(this,"context",void 0),x(this,"processSourceNode",void 0),x(this,"outputTrack",void 0),x(this,"processedNode",void 0),x(this,"clonedTrack",void 0),x(this,"outputNode",void 0),this.outputNode=new Y2e}setVolume(){}createOutputTrack(){throw new M(S.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class Y2e{disconnect(){}connect(){}}function Jq(e){return new q((t,n)=>{let i=!1;const r=document.createElement("video");r.setAttribute("autoplay",""),r.setAttribute("muted",""),r.muted=!0,r.autoplay=!0,r.setAttribute("playsinline",""),r.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(r);const o=Ki()?"canplay":"playing";r.addEventListener(o,()=>{const s=r.videoWidth,a=r.videoHeight;!s&&Bt()||(i=!0,r.srcObject=null,r.remove(),t([s,a]))}),r.srcObject=new MediaStream([e]),r.play().catch(NS),setTimeout(()=>{i||(r.srcObject=null,r.remove(),t([r.videoWidth,r.videoHeight]))},4e3)})}function tC(e){const t={};e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId});const n=Da(e.encoderConfig);return null!=n.width&&(t.width=n.width),null!=n.height&&(t.height=n.height),!oK()&&n.frameRate&&(t.frameRate=n.frameRate),$7()&&"object"==typeof t.frameRate&&(t.frameRate.max=60),Bt()&&(t.frameRate={ideal:30,max:30}),t}function Qq(e){const t={};if(oK()||(void 0!==e.AGC&&(t.autoGainControl=e.AGC),void 0!==e.AEC&&(t.echoCancellation=e.AEC),void 0!==e.ANS&&(t.noiseSuppression=e.ANS,pl()&&e.ANS&&(t.googHighpassFilter=e.ANS))),e.encoderConfig){const n=JS(e.encoderConfig);t.channelCount=n.stereo?2:1,t.sampleRate=n.sampleRate,t.sampleSize=n.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),RS()&&(t.sampleRate=void 0),t}const eY=function(){var e=C(function*(t,n,i){return yield(r=C(function*(o,s,a){const c=function(u){const h=[];for(let p=0;p<u.length;p+=2)h.push(parseInt(u.slice(p,p+2),16));return Uint8Array.from(h)}(SK(""+s+a)).slice(0,16),l=c.slice(0,12),d=yield window.crypto.subtle.importKey("raw",c,"AES-GCM",!0,["encrypt"]);return new Uint8Array(yield window.crypto.subtle.encrypt({name:"AES-GCM",iv:l},d,o))}),function(o,s,a){return r.apply(this,arguments)})(t.buffer,n,i);var r});return function(n,i,r){return e.apply(this,arguments)}}(),dM=e=>{const t=document.createElement("canvas");return t.width=2,t.height=2,new q((n,i)=>{t.toBlob(function(){var r=C(function*(o){if(t.remove(),o){const s=yield tY(o);n({buffer:s,width:t.width,height:t.height})}else i(new M(S.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))});return function(o){return r.apply(this,arguments)}}(),e,1)})},tY=function(){var e=C(function*(t){const n=yield t.arrayBuffer();return new Uint8Array(n)});return function(n){return e.apply(this,arguments)}}();var nY,iY,rY,oY,sY,aY,cY,lY,dY,uY,hY,pY,fY,mY,gY,_Y,vY,EY,Ot,bY,yY,SY,CY,TY,wY,Na,IY,RY,AY,DY,OY,NY,PY,MY,xY,kY,LY,FY,UY,oi;let Ht=(nY=le({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),iY=le({argsMap:(e,t)=>[e.getTrackId(),t]}),rY=en(),oY=hp("LocalAudioTrack","_enabledMutex"),sY=le({argsMap:(e,t)=>[e.getTrackId(),t]}),aY=en(),cY=hp("LocalAudioTrack","_enabledMutex"),lY=le({argsMap:(e,t)=>[e.getTrackId(),t]}),dY=en(),uY=en(),hY=en(),pY=le({argsMap:e=>[e.getTrackId()]}),fY=en(),mY=le({argsMap:e=>[e.getTrackId()]}),gY=en(),_Y=le({argsMap:e=>[e.getTrackId()]}),vY=le({argsMap:(e,t)=>[e.getTrackId(),t.name]}),EY=le({argsMap:e=>[e.getTrackId()]}),Me((Ot=class extends Np{get _source(){return this.initWebAudio()}set _source(e){this._trackSource=e}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?ir.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(e,t,n,i){super(e,n),x(this,"trackMediaType",Op.AUDIO),x(this,"_encoderConfig",void 0),x(this,"_trackSource",void 0),x(this,"_enabled",!0),x(this,"_volume",100),x(this,"_useAudioElement",!0),x(this,"_bypassWebAudio",!1),x(this,"processor",void 0),x(this,"_processorContext",void 0),x(this,"_processorDestination",void 0),x(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=t,this._getOriginVolumeLevel=!!i,this._trackSource=new lM,R("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),R("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),ei()&&!no?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(e){ot(e,"volume",0,1e3),this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&ir.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void _.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const t=this._source.createOutputTrack();this._mediaStreamTrack!==t&&(this._mediaStreamTrack=t,ct(this,X.NEED_REPLACE_TRACK,this).then(()=>{_.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(n=>{_.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),n)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}setPlaybackDevice(e){var t=this;return C(function*(){if(!t._useAudioElement||!Nq())throw new M(S.NOT_SUPPORTED,"your browser does not support setting the audio output device");yield ir.setSinkID(t.getTrackId(),e)})()}setEnabled(e,t,n){var i=this;return C(function*(){return i._setEnabled(e,t,n)})()}_setEnabled(e,t,n){var i=this;return C(function*(){if(!n){if(e===i._enabled)return;i.stateCheck("enabled",e)}if(_.info("[".concat(i.getTrackId(),"] start setEnabled"),e),e){i._originMediaStreamTrack.enabled=!0;try{n||(i._enabled=!0),yield ct(i,X.NEED_ENABLE_TRACK,i),_.info("[".concat(i.getTrackId(),"] setEnabled to ").concat(e," success"))}catch(r){throw n||(i._enabled=!1),_.error("[".concat(i.getTrackId(),"] setEnabled to true error"),r.toString()),r}}else{i._originMediaStreamTrack.enabled=!1,n||(i._enabled=!1);try{yield ct(i,X.NEED_DISABLE_TRACK,i)}catch(r){throw n||(i._enabled=!0),_.error("[".concat(i.getTrackId(),"] setEnabled to false error"),r.toString()),r}}})()}setMuted(e){var t=this;return C(function*(){e!==t._muted&&(t.stateCheck("muted",e),t._muted=e,t._originMediaStreamTrack.enabled=!e,_.debug("[".concat(t.getTrackId(),"] start set muted: ").concat(e)),e?yield ct(t,X.NEED_MUTE_TRACK,t):yield ct(t,X.NEED_UNMUTE_TRACK,t))})()}getStats(){return ml(()=>{_.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),Oo(this,X.GET_STATS)||Rt({},ZP)}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(eo.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(eo.ON_AUDIO_BUFFER),this._source.on(eo.ON_AUDIO_BUFFER,n=>e(n))}play(){_.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(_.debug("[".concat(this.getTrackId(),"] start audio playback in element")),ir.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){_.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?ir.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];_.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&ir.updateTrack(this.getTrackId(),this._mediaStreamTrack)}_updateOriginMediaStreamTrack(e,t){var n=this;return C(function*(){n._originMediaStreamTrack!==e&&(n._originMediaStreamTrack&&(n._originMediaStreamTrack.removeEventListener("ended",n._handleTrackEnded),t&&n._originMediaStreamTrack.stop()),e.addEventListener("ended",n._handleTrackEnded),n._originMediaStreamTrack=e,n._muted&&(n._originMediaStreamTrack.enabled=!1),n.processor&&n._processorContext&&n.processor.updateInput({track:e,context:n._processorContext}),n._mediaStreamTrack!==n._source.outputTrack?(n._mediaStreamTrack=n._originMediaStreamTrack,n._updatePlayerSource(),yield ct(n,X.NEED_REPLACE_TRACK,n)):n._source.updateTrack(n._originMediaStreamTrack),n._getOriginVolumeLevel&&n._source.updateOriginTrack(e))})()}renewMediaStreamTrack(e){return q.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new M(S.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new M(S.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(e){var t=this;e.on(Xi.ON_TRACK,function(){var n=C(function*(i){i?i!==t._mediaStreamTrack&&(t._mediaStreamTrack=i,t._updatePlayerSource(!1),t._source.processedNode=t._source.createMediaStreamSourceNode(i),yield ct(t,X.NEED_REPLACE_TRACK,t)):t._mediaStreamTrack!==t._originMediaStreamTrack&&(t._mediaStreamTrack=t._originMediaStreamTrack,t._updatePlayerSource(),yield ct(t,X.NEED_REPLACE_TRACK,t))});return function(i){return n.apply(this,arguments)}}()),e.on(Xi.ON_NODE,n=>{this._source.processedNode=n})}unbindProcessorDestinationEvents(e){e.removeAllListeners(Xi.ON_TRACK),e.removeAllListeners(Xi.ON_NODE)}bindProcessorContextEvents(e){var t=this;e.on(to.REQUEST_CONSTRAINTS,function(){var n=C(function*(i){i(t._originMediaStreamTrack.getSettings())});return function(i){return n.apply(this,arguments)}}())}unbindProcessorContextEvents(e){e.removeAllListeners(to.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof lM&&(this._trackSource=new jq(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const e=new Zq(this._source.context,this.getTrackId(),"local"),t=new Xq(e);return this._processorContext=e,this._processorDestination=t,this.bindProcessorContextEvents(e),this.bindProcessorDestinationEvents(t),this._source.on(eo.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:e})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(ir.stop(this.getTrackId()),this._source.play()),ct(this,X.NEED_REPLACE_MIXING_TRACK,this).then(()=>{_.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(n=>{_.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),n)})),{processorContext:e,processorDestination:t}}}).prototype,"setVolume",[nY],Object.getOwnPropertyDescriptor(Ot.prototype,"setVolume"),Ot.prototype),Me(Ot.prototype,"setPlaybackDevice",[iY,rY],Object.getOwnPropertyDescriptor(Ot.prototype,"setPlaybackDevice"),Ot.prototype),Me(Ot.prototype,"setEnabled",[oY,sY,aY],Object.getOwnPropertyDescriptor(Ot.prototype,"setEnabled"),Ot.prototype),Me(Ot.prototype,"setMuted",[cY,lY,dY],Object.getOwnPropertyDescriptor(Ot.prototype,"setMuted"),Ot.prototype),Me(Ot.prototype,"getStats",[uY],Object.getOwnPropertyDescriptor(Ot.prototype,"getStats"),Ot.prototype),Me(Ot.prototype,"setAudioFrameCallback",[hY],Object.getOwnPropertyDescriptor(Ot.prototype,"setAudioFrameCallback"),Ot.prototype),Me(Ot.prototype,"play",[pY,fY],Object.getOwnPropertyDescriptor(Ot.prototype,"play"),Ot.prototype),Me(Ot.prototype,"stop",[mY,gY],Object.getOwnPropertyDescriptor(Ot.prototype,"stop"),Ot.prototype),Me(Ot.prototype,"close",[_Y],Object.getOwnPropertyDescriptor(Ot.prototype,"close"),Ot.prototype),Me(Ot.prototype,"pipe",[vY],Object.getOwnPropertyDescriptor(Ot.prototype,"pipe"),Ot.prototype),Me(Ot.prototype,"unpipe",[EY],Object.getOwnPropertyDescriptor(Ot.prototype,"unpipe"),Ot.prototype),Ot),nC=(bY=le({argsMap:(e,t)=>[e.getTrackId(),t]}),yY=en(),SY=hp("MicrophoneAudioTrack","_enabledMutex"),CY=le({argsMap:(e,t,n)=>[e.getTrackId(),t,n]}),TY=en(),wY=le({argsMap:e=>[e.getTrackId()]}),Me((Na=class extends Ht{get __className__(){return"MicrophoneAudioTrack"}constructor(e,t,n,i){super(e,t.encoderConfig?JS(t.encoderConfig):{},i,R("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),x(this,"_config",void 0),x(this,"_deviceName","default"),x(this,"_constraints",void 0),x(this,"_originalConstraints",void 0),x(this,"_enabled",!0),this._config=t,this._constraints=n,this._originalConstraints=n,this._deviceName=e.label,"boolean"==typeof t.bypassWebAudio&&(this._bypassWebAudio=t.bypassWebAudio),(cp()||XN())&&tt.bindInterruptDetectorTrack(this)}setDevice(e){var t=this;return C(function*(){if(_.info("[".concat(t.getTrackId(),"] start set device to ").concat(e)),t._enabled)try{const n=yield ro.getDeviceById(e),i={};i.audio=Rt({},t._constraints),i.audio.deviceId={exact:e},t._originMediaStreamTrack.stop();let r=null;try{r=yield io(i,t.getTrackId())}catch(o){throw _.error("[".concat(t.getTrackId(),"] setDevice failed"),o.toString()),r=yield io({audio:t._constraints},t.getTrackId()),yield t._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!1),o}yield t._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!1),t._deviceName=n.label,t._config.microphoneId=e,t._constraints.deviceId={exact:e}}catch(n){throw _.error("[".concat(t.getTrackId(),"] setDevice error"),n.toString()),n}else try{const n=yield ro.getDeviceById(e);t._deviceName=n.label,t._config.microphoneId=e,t._constraints.deviceId={exact:e}}catch(n){throw _.error("[".concat(t.getTrackId(),"] setDevice error"),n.toString()),n}_.info("[".concat(t.getTrackId(),"] set device to ").concat(e," success"))})()}setEnabled(e,t,n){var i=()=>super._setEnabled,r=this;return C(function*(){if(t)return _.debug("[".concat(r.getTrackId(),"] setEnabled false (do not close microphone)")),yield i().call(r,e);if(!n){if(e===r._enabled)return;r.stateCheck("enabled",e)}if(_.info("[".concat(r.getTrackId(),"] start setEnabled"),e),R("AUTO_RESET_AUDIO_ROUTE")&&(Ki()||Zo())){const c=navigator.audioSession;c&&(e||(c.type="playback"),c.type="auto")}if(!e){var o;r._originMediaStreamTrack.onended=null,r._originMediaStreamTrack.stop(),null===(o=r._source.clonedTrack)||void 0===o||o.stop(),n||(r._enabled=!1);try{yield ct(r,X.NEED_DISABLE_TRACK,r)}catch(c){throw _.error("[".concat(r.getTrackId(),"] setEnabled false failed"),c.toString()),c}return}const s=Rt({},r._constraints),a=ro.searchDeviceIdByName(r._deviceName);a&&!s.deviceId&&(s.deviceId=a);try{n||(r._enabled=!0);const c=yield io({audio:r._constraints},r.getTrackId());yield r._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!1),yield ct(r,X.NEED_ENABLE_TRACK,r)}catch(c){throw n||(r._enabled=!1),_.error("[".concat(r.getTrackId(),"] setEnabled true failed"),c.toString()),c}_.info("[".concat(r.getTrackId(),"] setEnabled success"))})()}close(){super.close(),(cp()||XN())&&tt.unbindInterruptDetectorTrack(this)}onTrackEnded(){var e=this;if((Ki()||Zo())&&this._enabled&&!this._isClosed&&tt.duringInterruption){const t=function(){var n=C(function*(){tt.off(Xn.IOS_INTERRUPTION_END,t),e._enabled&&!e._isClosed&&(_.debug("[".concat(e.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),yield e.setEnabled(!1),yield e.setEnabled(!0))});return function(){return n.apply(this,arguments)}}();tt.on(Xn.IOS_INTERRUPTION_END,t)}else _.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Ap.TRACK_ENDED)}renewMediaStreamTrack(e){var t=this;return C(function*(){const n=e||t._constraints,i=ro.searchDeviceIdByName(t._deviceName);if(i&&!n.deviceId&&(n.deviceId=i),t._constraints=n,t._enabled){t._originMediaStreamTrack.stop();const r=yield io({audio:t._constraints},t.getTrackId());yield t._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!0)}})()}bindProcessorContextEvents(e){var t=this;super.bindProcessorContextEvents(e),e.on(to.REQUEST_UPDATE_CONSTRAINTS,function(){var n=C(function*(i,r,o){try{const s=Object.assign({},t._originalConstraints,...i);yield t.renewMediaStreamTrack(s),r()}catch(s){o(s)}});return function(i,r,o){return n.apply(this,arguments)}}())}unbindProcessorContextEvents(e){super.unbindProcessorContextEvents(e),e.removeAllListeners(to.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[bY,yY],Object.getOwnPropertyDescriptor(Na.prototype,"setDevice"),Na.prototype),Me(Na.prototype,"setEnabled",[SY,CY,TY],Object.getOwnPropertyDescriptor(Na.prototype,"setEnabled"),Na.prototype),Me(Na.prototype,"close",[wY],Object.getOwnPropertyDescriptor(Na.prototype,"close"),Na.prototype),Na),X2e=(IY=le({argsMap:(e,t)=>[e.getTrackId(),t,e.duration]}),RY=en(),AY=le({argsMap:e=>[e.getTrackId()]}),DY=en(),OY=le({argsMap:e=>[e.getTrackId()]}),NY=en(),PY=le({argsMap:e=>[e.getTrackId()]}),MY=en(),xY=le({argsMap:e=>[e.getTrackId()]}),kY=en(),LY=le({argsMap:e=>[e.getTrackId()]}),FY=le({argsMap:e=>[e.getTrackId()]}),UY=en(),Me((oi=class extends Ht{get __className__(){return"BufferSourceAudioTrack"}constructor(e,t,n,i){super(t.createOutputTrack(),n,i),x(this,"source",void 0),x(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=e,this._bufferSource=t,this._bufferSource.on(eo.AUDIO_SOURCE_STATE_CHANGE,r=>{this.safeEmit(Ap.SOURCE_STATE_CHANGE,r)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(e){ot(e,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(e)}}).prototype,"startProcessAudioBuffer",[IY,RY],Object.getOwnPropertyDescriptor(oi.prototype,"startProcessAudioBuffer"),oi.prototype),Me(oi.prototype,"pauseProcessAudioBuffer",[AY,DY],Object.getOwnPropertyDescriptor(oi.prototype,"pauseProcessAudioBuffer"),oi.prototype),Me(oi.prototype,"seekAudioBuffer",[OY,NY],Object.getOwnPropertyDescriptor(oi.prototype,"seekAudioBuffer"),oi.prototype),Me(oi.prototype,"resumeProcessAudioBuffer",[PY,MY],Object.getOwnPropertyDescriptor(oi.prototype,"resumeProcessAudioBuffer"),oi.prototype),Me(oi.prototype,"stopProcessAudioBuffer",[xY,kY],Object.getOwnPropertyDescriptor(oi.prototype,"stopProcessAudioBuffer"),oi.prototype),Me(oi.prototype,"close",[LY],Object.getOwnPropertyDescriptor(oi.prototype,"close"),oi.prototype),Me(oi.prototype,"setAudioBufferPlaybackSpeed",[FY,UY],Object.getOwnPropertyDescriptor(oi.prototype,"setAudioBufferPlaybackSpeed"),oi.prototype),oi);class wn extends Ht{get __className__(){return"MixingAudioTrack"}get isActive(){for(const t of this.trackList)if(t._enabled&&!t._isClosed&&!t.muted)return!0;return!1}constructor(){const t=Pp().createMediaStreamDestination();super(t.stream.getAudioTracks()[0],void 0,gt(8,"track-mix-")),x(this,"trackList",void 0),x(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=t,this.trackList=[]}hasAudioTrack(t){return-1!==this.trackList.indexOf(t)}addAudioTrack(t){-1===this.trackList.indexOf(t)?(_.debug("add ".concat(t.getTrackId()," to mixing track")),t._source.outputNode.connect(this.destNode),this.trackList.push(t),this.updateEncoderConfig()):_.debug("track ".concat(t.getTrackId()," is already added"))}removeAudioTrack(t){if(-1!==this.trackList.indexOf(t)){_.debug("remove ".concat(t.getTrackId()," from mixing track"));try{t._source.outputNode.disconnect(this.destNode)}catch{}DS(this.trackList,t),this.updateEncoderConfig()}}updateEncoderConfig(){const t={};this.trackList.forEach(n=>{n._encoderConfig&&((n._encoderConfig.bitrate||0)>(t.bitrate||0)&&(t.bitrate=n._encoderConfig.bitrate),(n._encoderConfig.sampleRate||0)>(t.sampleRate||0)&&(t.sampleRate=n._encoderConfig.sampleRate),(n._encoderConfig.sampleSize||0)>(t.sampleSize||0)&&(t.sampleSize=n._encoderConfig.sampleSize),n._encoderConfig.stereo&&(t.stereo=!0))}),this._encoderConfig=t}_updateRtpTransceiver(t){this._rtpTransceiver!==t&&(this._rtpTransceiver=t,this.trackList.forEach(n=>{n instanceof wn?n.emit(Bd.TRANSCEIVER_UPDATED,t):n._updateRtpTransceiver(t)}))}}class Z2e extends Bq{set currentState(t){t!==this._currentState&&(this._currentState=t,this.safeEmit(eo.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),x(this,"audioBuffer",void 0),x(this,"sourceNode",void 0),x(this,"startPlayTime",0),x(this,"startPlayOffset",0),x(this,"pausePlayTime",0),x(this,"options",void 0),x(this,"currentLoopCount",0),x(this,"currentPlaybackSpeed",100),x(this,"_currentState","stopped"),this.audioBuffer=t,this.options=n,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:(this.playbackSpeed/100*(this.context.currentTime-this.startPlayTime)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(t){"stopped"===this.currentState?(this.options=t,this.startPlayOffset=this.options.startPlayTime||0):_.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(t){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=t,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=t))}resumeProcessAudioBuffer(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(t){this.sourceNode&&("playing"===this.currentState&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=t/100),this.currentPlaybackSpeed=t}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const t=this.context.createBufferSource();return t.buffer=this.audioBuffer,t.loop=!!this.options.loop,t.connect(this.outputNode),t.playbackRate.value=this.currentPlaybackSpeed/100,t}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const VY=new Map;class uM{get rendFrameRate(){if(this.renderStats&&this.renderStats.curTs!==this.renderStats.lastTs){const n=(this.renderStats.renderNum-this.renderStats.lastRenderNum)/(this.renderStats.curTs-this.renderStats.lastTs);return this.renderStats.lastRenderNum=this.renderStats.renderNum,this.renderStats.lastTs=this.renderStats.curTs,n}return 0}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(t){t!==this._videoElementStatus&&(_.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(t)),this._videoElementStatus=t)}get videoState(){return this._videoState}set videoState(t){var n;t!==this._videoState&&(this._videoState=t,null===(n=this.onVideoStateChanged)||void 0===n||n.call(this,this.videoState))}constructor(t){x(this,"trackId",void 0),x(this,"config",void 0),x(this,"onFirstVideoFrameDecoded",void 0),x(this,"onVideoStateChanged",void 0),x(this,"freezeTimeCounterList",[]),x(this,"renderFreezeAccTime",0),x(this,"isKeepLastFrame",!1),x(this,"timeUpdatedCount",0),x(this,"freezeTime",0),x(this,"playbackTime",0),x(this,"lastTimeUpdatedTime",0),x(this,"autoplayFailed",!1),x(this,"videoTrack",void 0),x(this,"videoElement",void 0),x(this,"cacheVideoElement",void 0),x(this,"renderStats",void 0),x(this,"_videoState",Oa.VideoStateStopped),x(this,"videoElementCheckInterval",void 0),x(this,"videoElementFreezeTimeout",void 0),x(this,"_videoElementStatus",Li.NONE),x(this,"isGettingVideoDimensions",!1),x(this,"startGetVideoDimensions",()=>{const n=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return _.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(n,500)};!this.isGettingVideoDimensions&&n()}),x(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&"live"===this.videoTrack.readyState&&"running"===tt.curState&&(_.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(Y7())),iK()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),x(this,"handleVideoEvents",n=>{switch(n.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=Li.PLAYING;break;case"loadeddata":if(this.videoState=Oa.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=Li.CANPLAY;break;case"stalled":this.videoElementStatus=Li.STALLED;break;case"suspend":this.videoElementStatus=Li.SUSPEND;break;case"pause":this.videoElementStatus=Li.PAUSED,Ki()||Zo()||ei()&&this.autoplayFailed||!this.videoTrack||"live"!==this.videoTrack.readyState||(_.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=Li.WAITING;break;case"abort":this.videoElementStatus=Li.ABORT;break;case"ended":this.videoElementStatus=Li.ENDED;break;case"emptied":this.videoElementStatus=Li.EMPTIED;break;case"error":{const i=this.videoElement.error,r=i?"".concat(i.message," (").concat(i.code,")"):"";i&&(this.videoElementStatus=Li.ERROR),_.error("[".concat(this.trackId,"] media error: ").concat(r," "));break}case"timeupdate":{const i=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=i);const r=i-this.lastTimeUpdatedTime,o=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=i,Ec.lastVisibleTime<Ec.lastHiddenTime||o<Ec.lastHiddenTime||o<Ec.lastVisibleTime)return;for(r>R("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=r),this.playbackTime+=r;this.playbackTime>=6e3;){this.playbackTime-=6e3;const s=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(s),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),x(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&"live"===this.videoTrack.readyState&&(_.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(Y7())),iK()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=t.trackId,this.config=t,this.videoElement=t.element instanceof HTMLVideoElement?t.element:document.createElement("video"),tt.on(Xn.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),tt.on(Xn.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var t;return null!==(t=this.videoElement.parentElement)&&void 0!==t?t:void 0}updateConfig(t){this.config=t,this.trackId=t.trackId,t.element!==this.videoElement&&(this.destroy(),this.videoElement=t.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.initVideoElement())}play(t){const n=this.videoElement.play();n&&n.catch&&n.catch(r=>{t&&qq(t,"video",r.message,this.trackId),"NotAllowedError"===r.name?(_.warning("detected video element autoplay failed",r),this.autoplayFailed=!0,this.handleAutoPlayFailed()):_.warning("[".concat(this.trackId,"] play warning: "),r)});const i=xe();if(("Safari"===i.name&&15===Number(i.version)||cp())&&n&&n.then){const r=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};n.then(r).catch(r)}}getCurrentFrame(){const t=document.createElement("canvas");t.width=this.videoElement.videoWidth,t.height=this.videoElement.videoHeight;const n=t.getContext("2d");if(!n)return _.error("create canvas context failed!"),new ImageData(2,2);n.drawImage(this.videoElement,0,0,t.width,t.height);const i=n.getImageData(0,0,t.width,t.height);return t.remove(),i}getCurrentFrameToUint8Array(t){var n=arguments,i=this;return C(function*(){let r=n.length>1&&void 0!==n[1]?n[1]:1;const o=document.createElement("canvas");o.width=i.videoElement.videoWidth,o.height=i.videoElement.videoHeight;const s=o.getContext("2d");return s?(s.drawImage(i.videoElement,0,0,o.width,o.height),new q((a,c)=>{o.toBlob(function(){var l=C(function*(d){if(o.remove(),d){const u=yield tY(d);a({buffer:u,width:o.width,height:o.height})}else c(new M(S.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))});return function(d){return l.apply(this,arguments)}}(),t,r<0?.1:r>1?1:r)})):yield dM(t)})()}destroy(){this.renderStats=void 0,tt.off(Xn.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),tt.off(Xn.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=Oa.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=Li.INIT,!this.videoElementCheckInterval&&(BY.forEach(o=>{this.videoElement.addEventListener(o,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{var o;(o=this.videoElement)!==document.body&&document.body.contains(o)||(this.videoElementStatus=Li.DESTROYED)},1e3),R("ENABLE_VIDEO_FRAME_CALLBACK"))){var t,n;let o;const s=()=>{"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",s),this.videoElementFreezeTimeout=window.setTimeout(a,R("VIDEO_FREEZE_DURATION")))},a=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===Oa.VideoStateDecoding&&("visible"===document.visibilityState?this.videoState=Oa.VideoStateFrozen:document.addEventListener("visibilitychange",s))},c=(l,d)=>{if(this.videoElementStatus===Li.PLAYING){if(this.renderStats?(this.renderStats.renderNum++,this.renderStats.curTs=d.mediaTime):this.renderStats={lastTs:d.mediaTime,curTs:d.mediaTime,lastRenderNum:0,renderNum:0},o){const p=d.presentationTime-o.presentationTime;this.videoState===Oa.VideoStateStarting&&(this.videoState=Oa.VideoStateDecoding),this.videoState===Oa.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(a,R("VIDEO_FREEZE_DURATION"))),p<R("VIDEO_FREEZE_DURATION")&&this.videoState===Oa.VideoStateFrozen&&(this.videoState=Oa.VideoStateDecoding),p>R("VIDEO_FREEZE_DURATION")&&Ec.lastVisibleTime>=Ec.lastHiddenTime&&o.timestamp>Ec.lastVisibleTime&&o.timestamp>Ec.lastHiddenTime&&(this.renderFreezeAccTime+=p)}o=Rt(Rt({},d),{},{timestamp:l})}var u,h;R("ENABLE_VIDEO_FRAME_CALLBACK")&&(null===(u=(h=this.videoElement).requestVideoFrameCallback)||void 0===u||u.call(h,c))};null===(t=(n=this.videoElement).requestVideoFrameCallback)||void 0===t||t.call(n,c)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),RS()&&!R("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const i=xe();"Safari"===i.name&&15===Number(i.version)||cp()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.videoElement.style.objectFit=this.config.fit?this.config.fit:"cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Bt()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Bt()&&this.videoElement.load());const r=this.videoElement.play();void 0!==r&&r.catch(o=>{_.debug("[".concat(this.trackId,"] playback interrupted"),o.toString())})}resetVideoElement(){BY.forEach(t=>{this.videoElement&&this.videoElement.removeEventListener(t,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=Li.NONE}handleAutoPlayFailed(){const t=n=>{n.preventDefault(),this.videoElement.play().then(()=>{_.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(i=>{_.error(i)}),this.autoplayFailed=!1,jg()?document.body.removeEventListener("click",t,!0):(document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0))};jg()?document.body.addEventListener("click",t,!0):(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)),Kq()}}const BY=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class jY extends uM{constructor(t){super(t),x(this,"container",void 0),x(this,"slot",void 0),this.slot=t.element,this.updateConfig(t)}updateConfig(t){this.config=t,this.trackId=t.trackId;const n=t.element;n!==this.slot&&(this.destroy(),this.slot=n),this.createElements()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.createElements())}play(t){var n;null!==(n=this.container)&&void 0!==n&&n.contains(this.videoElement)&&super.play(t)}getCurrentFrame(){var t;return null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}getCurrentFrameToUint8Array(t){var n=arguments,i=()=>super.getCurrentFrameToUint8Array,r=this;return C(function*(){var o;let s=n.length>1&&void 0!==n[1]?n[1]:1;return null!==(o=r.container)&&void 0!==o&&o.contains(r.videoElement)?yield i().call(r,t,s):yield dM(t)})()}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",R("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var t;!this.container||null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var t;if(null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var t;null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var HY,GY,WY,zY,KY,qY,YY,$Y,XY,ZY,JY,QY,e$,t$,n$,i$,r$,o$,s$,a$,c$,l$,d$,u$,De,h$,p$,f$,m$,g$,_$,v$,E$,so;let yt=(HY=le({argsMap:(e,t,n)=>[e.getTrackId(),"string"==typeof t?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),GY=en(),WY=le({argsMap:e=>[e.getTrackId()]}),zY=hp("LocalVideoTrack","_enabledMutex"),KY=le({argsMap:(e,t)=>[e.getTrackId(),t]}),qY=en(),YY=hp("LocalVideoTrack","_enabledMutex"),$Y=le({argsMap:(e,t)=>[e.getTrackId(),t]}),XY=en(),ZY=le({argsMap:(e,t)=>[e.getTrackId(),t]}),JY=en(),QY=en(),e$=le({argsMap:(e,t,n)=>[e.getTrackId(),t,n]}),t$=en(),n$=en(),i$=en(),r$=en(),o$=en(),s$=en(),a$=en(),c$=le({argsMap:(e,t)=>[e.getTrackId(),t.name]}),l$=le({argsMap:e=>[e.getTrackId()]}),d$=le({argsMap:e=>[e.getTrackId()]}),u$=le({argsMap:(e,t,n)=>[e.getTrackId(),t.label,n]}),De=class IQ extends Np{get videoHeight(){if(ei()){const{height:t}=this._mediaStreamTrack.getSettings();return this._videoHeight=t,this._videoHeight}return this._videoHeight}get videoWidth(){if(ei()){const{width:t}=this._mediaStreamTrack.getSettings();return this._videoWidth=t,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Li.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(t){this._processorContext=t}get __className__(){return"LocalVideoTrack"}constructor(t,n,i,r,o,s){if(super(t,o),x(this,"trackMediaType",Op.VIDEO),x(this,"_player",void 0),x(this,"isUseScaleResolutionDownBy",!1),x(this,"_videoVisibleTimer",null),x(this,"_previousVideoVisibleStatus",void 0),x(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),x(this,"_encoderConfig",void 0),x(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),x(this,"_optimizationMode",void 0),x(this,"_videoHeight",void 0),x(this,"_videoWidth",void 0),x(this,"_forceBitrateLimit",void 0),x(this,"_enabled",!0),x(this,"_processorDestination",void 0),x(this,"_processorContext",void 0),ei()){const{width:a,height:c}=t.getSettings();this._videoWidth=a,this._videoHeight=c}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=n,this._scalabilityMode=i,this._optimizationMode=r,this._hints=s||[],-1===this._hints.indexOf(ft.SCREEN_TRACK))this.updateBitrateFromProfile();else if(function(a,c,l){const d=xe();return!(d.name!==a||!d.osVersion)&&115===Number(d.version)}(Ye.CHROME)&&-1!==wS().indexOf("Windows")){const a=function(c,l){if("VideoFrame"in window&&"TransformStream"in window&&Fe().supportWebRTCInsertableStream){const d=new MediaStreamTrackProcessor(c),u=new MediaStreamTrackGenerator({kind:"video"});let h,p,m=Date.now();const f=()=>{g&&(clearInterval(g),g=void 0),h&&(h.close(),h=void 0),c.stop(),p=void 0,u.removeEventListener("ended",f)};let g=window.setInterval(()=>{if(p&&h&&Date.now()-m>1e3)try{"live"===u.readyState?p.enqueue(h.clone()):f()}catch{f()}},1e3);const E=new TransformStream({transform:(b,T)=>{"live"===u.readyState?(p=T,m=Date.now(),void 0===h?(h=b,T.enqueue(b.clone())):(T.enqueue(h),h=b)):b.close()}});return u.addEventListener("ended",f),d.readable.pipeThrough(E).pipeTo(u.writable),u}}(t);a&&(_.info("local screen video track begin to inject frame"),this._mediaStreamTrack=a)}n&&-1!==this._hints.indexOf(ft.CUSTOM_TRACK)&&this.setEncoderConfiguration(n),this._processorContext=new $q(this.getTrackId(),"local"),this._processorDestination=new Yq(this.processorContext),this.bindProcessorDestinationEvents()}play(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof t){const r=document.getElementById(t);r?t=r:(_.warning("[".concat(this.getTrackId(),'] can not find "#').concat(t,'" element, use document.body')),t=document.body)}_.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(n));const i=Rt(Rt(Rt({},this._getDefaultPlayerConfig()),n),{},{trackId:this.getTrackId(),element:t});this._player?this._player.updateConfig(i):(this._player=t instanceof HTMLVideoElement?new uM(i):new jY(i),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const r=this.getVideoElementVisibleStatus();this.safeEmit(Ap.VIDEO_ELEMENT_VISIBLE_STATUS,r)}catch{}},R("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,_.debug("[".concat(this.getTrackId(),"] stop video playback")))}setEnabled(t,n){var i=this;return C(function*(){if(!n){if(t===i._enabled)return;i.stateCheck("enabled",t)}if(_.info("[".concat(i.getTrackId(),"] start setEnabled"),t),!t){i._originMediaStreamTrack.enabled=!1;try{yield ct(i,X.NEED_DISABLE_TRACK,i)}catch(r){throw _.error("[".concat(i.getTrackId(),"] setEnabled to false error"),r.toString()),r}return n||(i._enabled=!1),void _.info("[".concat(i.getTrackId(),"] setEnabled to false success"))}i._originMediaStreamTrack.enabled=!0;try{yield ct(i,X.NEED_ENABLE_TRACK,i)}catch(r){throw _.error("[".concat(i.getTrackId(),"] setEnabled to true error"),r.toString()),r}_.info("[".concat(i.getTrackId(),"] setEnabled to true success")),n||(i._enabled=!0)})()}setMuted(t){var n=this;return C(function*(){t!==n._muted&&(n.stateCheck("muted",t),n._muted=t,n._originMediaStreamTrack.enabled=!t,_.debug("[".concat(n.getTrackId(),"] start set muted: ").concat(t)),t?yield ct(n,X.NEED_MUTE_TRACK,n):yield ct(n,X.NEED_UNMUTE_TRACK,n))})()}setEncoderConfiguration(t,n){var i=this;return C(function*(){if(!i._enabled)throw new M(S.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(t=Da(t),i._forceBitrateLimit&&(t.bitrateMax=i._forceBitrateLimit.max_bitrate?i._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=i._forceBitrateLimit.min_bitrate?i._forceBitrateLimit.min_bitrate:t.bitrateMin),t.width||t.height||t.frameRate){const r=tC({encoderConfig:t});(ei()||Ki()||Zo())&&(r.deviceId=void 0),_.debug("[".concat(i.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(r));try{yield i._originMediaStreamTrack.applyConstraints(r),i.updateMediaStreamTrackResolution()}catch(o){const s=new M(S.UNEXPECTED_ERROR,o.toString());throw _.error("[".concat(i.getTrackId(),"] applyConstraints error"),s.toString()),s}}i._encoderConfig=t,-1===i._hints.indexOf(ft.SCREEN_TRACK)&&i.updateBitrateFromProfile();try{yield ct(i,X.NEED_UPDATE_VIDEO_ENCODER,i)}catch(r){return r.throw(_)}})()}getStats(){return ml(()=>{_.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),Oo(this,X.GET_STATS)||Rt({},JP)}setBeautyEffect(t){return C(function*(){_.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")})()}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}getCurrentFrameImage(t){var n=arguments,i=this;return C(function*(){return i._player?i._player.getCurrentFrameToUint8Array(t,n.length>1&&void 0!==n[1]?n[1]:1):yield dM(t)})()}setBitrateLimit(t){var n=this;return C(function*(){if(_.debug("[".concat(n.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(t))),t){n._forceBitrateLimit=t,n._encoderConfig&&(n._encoderConfig.bitrateMax=n._encoderConfig.bitrateMax&&n._encoderConfig.bitrateMax<t.max_bitrate?n._encoderConfig.bitrateMax:t.max_bitrate,n._encoderConfig.bitrateMin=t.min_bitrate);try{yield ct(n,X.NEED_UPDATE_VIDEO_ENCODER,n)}catch(i){return i.throw(_)}}})()}setOptimizationMode(t){var n=this;return C(function*(){if("motion"!==t&&"detail"!==t&&"balanced"!==t)return void _.error(S.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const i=n._optimizationMode;try{n._optimizationMode=t,yield ct(n,X.NEED_UPDATE_VIDEO_SEND_PARAMETERS,n)}catch(r){throw n._optimizationMode=i,_.error("[".concat(n.getTrackId(),"] set optimization mode failed"),r.toString()),r}_.info("[".concat(n.getTrackId(),"] set optimization mode success (").concat(t,")"))})()}setScalabiltyMode(t){if(1===t.numSpatialLayers&&1!==t.numTemporalLayers)return _.error(S.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=t,_.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(t,")"))}updateMediaStreamTrackResolution(){Jq(this._originMediaStreamTrack).then(t=>{let[n,i]=t;this._videoHeight=i,this._videoWidth=n}).catch(NS)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}setSenderConfiguration(t){var n=this;return C(function*(){if(!n._enabled)throw new M(S.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");_.debug("[".concat(n.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(t)),t=Da(t),n._forceBitrateLimit&&(t.bitrateMax=n._forceBitrateLimit.max_bitrate?n._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=n._forceBitrateLimit.min_bitrate?n._forceBitrateLimit.min_bitrate:t.bitrateMin),n._encoderConfig=t,-1===n._hints.indexOf(ft.SCREEN_TRACK)&&n.updateBitrateFromProfile();try{yield ct(n,X.NEED_UPDATE_VIDEO_ENCODER,n)}catch(i){return i.throw(_)}})()}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:t,height:n,frameRate:i}=this.getMediaStreamTrackSettings();if(!t||!n||!i)return;const{bitrateMax:r,bitrateMin:o}=this._encoderConfig;if(null==o||null==r){const{max:s,min:a}=function(c,l,d,u,h){const p=R("BITRATE_ADAPTER_TYPE");if("DEFAULT_BITRATE"===p)return{min:u,max:h};if(void 0===h){var m;const g=Math.floor(200*Math.pow(d/15,.6)*Math.pow(c*l/640/360,.75));h="STANDARD_BITRATE"===p?4*g:2*g,u=null!==(m=u)&&void 0!==m?m:g}else{var f;u=null!==(f=u)&&void 0!==f?f:Math.floor(h/10)}return{min:u,max:h}}(t,n,i,o,r);this._encoderConfig.bitrateMin=a,this._encoderConfig.bitrateMax=s,_.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(t,", h: ").concat(n,", fps: ").concat(i,"] => [brMax: ").concat(s,", brMin: ").concat(a,"]"))}}getVideoElementVisibleStatus(){try{var t,n;const i=null==this||null===(t=this._player)||void 0===t?void 0:t.getContainerElement(),r={track:this,element:null==this||null===(n=this._player)||void 0===n?void 0:n.getVideoElement(),slot:i?.parentElement},{element:o,slot:s}=r;if(this.isPlaying&&o instanceof HTMLVideoElement&&s instanceof HTMLElement){const a=cK.checkOneElementVisible(o),c=Object.assign({},a);if(c.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=c.visible;ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]}).onSuccess(c.visible?"Video is visible":"Invisible because of ".concat(c.reason))}return c}return}catch(i){throw new M(S.GET_VIDEO_ELEMENT_VISIBLE_ERROR,i.message)}}renewMediaStreamTrack(t){return C(function*(){})()}pipe(t){if(this.processor===t)return t;if(t._source)throw new M(S.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),t}unpipe(){if(!this.processor)return;const t=this.processor;this.processor._source=void 0,this.processor=void 0,t.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._encoderConfig;t&&(i=Rt(Rt({},i),Da(t))),i=Pd(i);const r=gt(8,"track-video-cloned-"),o=new IQ(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,i,Pd(this._scalabilityMode),this._optimizationMode,r,Pd(this._hints));return t&&i&&o.setEncoderConfiguration(i),_.debug("clone video track from ".concat(this.getTrackId()," to ").concat(r,", clone ").concat(n)),o}replaceTrack(t,n){var i=this;return C(function*(){if(!(t instanceof MediaStreamTrack))throw new M(S.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if("video"!==t.kind)throw new M(S.INVALID_PARAMS,"track should be a video MediaStreamTrack");yield i._updateOriginMediaStreamTrack(t,n,!0),i.updateMediaStreamTrackResolution()})()}sendSeiData(t){if(ml(()=>{ne.reportApiInvoke(null,{name:Cn.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:jt.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!R("ENABLE_VIDEO_SEI")||!R("ENABLE_ENCODED_TRANSFORM"))return void _.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(t instanceof Uint8Array==0)return new M(S.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const n=this.getRTCRtpTransceiver();if(!n)return void _.warning("Video track is not published, SEI can not be send");const i=n.sender.getParameters();if(0===i.codecs.length)return;const r=i.codecs[0].mimeType.toLocaleLowerCase();"video/h264"===r?this.safeEmit("sei-to-send",t):_.warning("SEI is not supported by ".concat(r))}bindProcessorDestinationEvents(){var t=this;this.processorDestination.on(Xi.ON_TRACK,function(){var n=C(function*(i){i?i!==t._mediaStreamTrack&&(t._mediaStreamTrack=i,t._updatePlayerSource(),yield ct(t,X.NEED_REPLACE_TRACK,t)):t._mediaStreamTrack!==t._originMediaStreamTrack&&(t._mediaStreamTrack=t._originMediaStreamTrack,t._updatePlayerSource(),yield ct(t,X.NEED_REPLACE_TRACK,t))});return function(i){return n.apply(this,arguments)}}())}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Xi.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(to.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(to.REQUEST_CONSTRAINTS)}},Me(De.prototype,"play",[HY,GY],Object.getOwnPropertyDescriptor(De.prototype,"play"),De.prototype),Me(De.prototype,"stop",[WY],Object.getOwnPropertyDescriptor(De.prototype,"stop"),De.prototype),Me(De.prototype,"setEnabled",[zY,KY,qY],Object.getOwnPropertyDescriptor(De.prototype,"setEnabled"),De.prototype),Me(De.prototype,"setMuted",[YY,$Y,XY],Object.getOwnPropertyDescriptor(De.prototype,"setMuted"),De.prototype),Me(De.prototype,"setEncoderConfiguration",[ZY,JY],Object.getOwnPropertyDescriptor(De.prototype,"setEncoderConfiguration"),De.prototype),Me(De.prototype,"getStats",[QY],Object.getOwnPropertyDescriptor(De.prototype,"getStats"),De.prototype),Me(De.prototype,"setBeautyEffect",[e$,t$],Object.getOwnPropertyDescriptor(De.prototype,"setBeautyEffect"),De.prototype),Me(De.prototype,"getCurrentFrameData",[n$],Object.getOwnPropertyDescriptor(De.prototype,"getCurrentFrameData"),De.prototype),Me(De.prototype,"getCurrentFrameImage",[i$],Object.getOwnPropertyDescriptor(De.prototype,"getCurrentFrameImage"),De.prototype),Me(De.prototype,"setBitrateLimit",[r$],Object.getOwnPropertyDescriptor(De.prototype,"setBitrateLimit"),De.prototype),Me(De.prototype,"setOptimizationMode",[o$],Object.getOwnPropertyDescriptor(De.prototype,"setOptimizationMode"),De.prototype),Me(De.prototype,"setScalabiltyMode",[s$],Object.getOwnPropertyDescriptor(De.prototype,"setScalabiltyMode"),De.prototype),Me(De.prototype,"updateMediaStreamTrackResolution",[a$],Object.getOwnPropertyDescriptor(De.prototype,"updateMediaStreamTrackResolution"),De.prototype),Me(De.prototype,"pipe",[c$],Object.getOwnPropertyDescriptor(De.prototype,"pipe"),De.prototype),Me(De.prototype,"unpipe",[l$],Object.getOwnPropertyDescriptor(De.prototype,"unpipe"),De.prototype),Me(De.prototype,"close",[d$],Object.getOwnPropertyDescriptor(De.prototype,"close"),De.prototype),Me(De.prototype,"replaceTrack",[u$],Object.getOwnPropertyDescriptor(De.prototype,"replaceTrack"),De.prototype),De),hM=(h$=le({argsMap:(e,t)=>[e.getTrackId(),t]}),p$=en(),f$=hp("CameraVideoTrack","_enabledMutex"),m$=le({argsMap:(e,t)=>[e.getTrackId(),t]}),g$=en(),_$=le({argsMap:(e,t)=>[e.getTrackId(),t]}),v$=en(),E$=le({argsMap:e=>[e.getTrackId()]}),so=class RQ extends yt{get __className__(){return"CameraVideoTrack"}constructor(t,n,i,r,o,s){var a;super(t,Da(n.encoderConfig),r,o,s),a=this,x(this,"_config",void 0),x(this,"_originalConstraints",void 0),x(this,"_constraints",void 0),x(this,"_enabled",!0),x(this,"_deviceName","default"),x(this,"tryResumeVideoForIOS15_16WeChat",C(function*(){(cp()||XN())&&!function(){const c=xe();if(c.os!==kn.IOS||!c.osVersion)return!1;const l=c.osVersion.split(".");return 15===Number(l[0])&&Number(l[1])>=2}()&&rK()&&a._enabled&&!a._isClosed&&(_.debug("[".concat(a.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),yield a.renewMediaStreamTrack())})),this._config=n,this._originalConstraints=i,this._constraints=i,this._deviceName=t.label,this._encoderConfig=Da(this._config.encoderConfig),tt.on(Xn.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),tt.on(Xn.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}setDevice(t){var n=this;return C(function*(){return"string"==typeof t?n._setDeviceById(t):t.deviceId?n._setDeviceById(t.deviceId):t.facingMode?n._setDeviceByFacingModel(t.facingMode):void 0})()}_setDeviceById(t){var n=this;return C(function*(){if(_.info("[".concat(n.getTrackId(),"] set device to ").concat(t)),n._enabled)try{const i=yield ro.getDeviceById(t),r={};r.video=Rt({},n._constraints),r.video.deviceId={exact:t},r.video.facingMode=void 0,n._originMediaStreamTrack.stop();let o=null;try{o=yield io(r,n.getTrackId())}catch(s){throw _.error("[".concat(n.getTrackId(),"] setDevice failed"),s.toString()),o=yield io({video:n._constraints},n.getTrackId()),yield n._updateOriginMediaStreamTrack(o.getVideoTracks()[0],!1),s}yield n._updateOriginMediaStreamTrack(o.getVideoTracks()[0],!1),n.updateMediaStreamTrackResolution(),n._deviceName=i.label,n._config.cameraId=t,n._constraints.deviceId={exact:t}}catch(i){throw _.error("[".concat(n.getTrackId(),"] setDevice error"),i.toString()),i}else try{const i=yield ro.getDeviceById(t);n._deviceName=i.label,n._config.cameraId=t,n._constraints.deviceId={exact:t}}catch(i){throw _.error("[".concat(n.getTrackId(),"] setDevice error"),i.toString()),i}_.info("[".concat(n.getTrackId(),"] setDevice success"))})()}_setDeviceByFacingModel(t){var n=this;return C(function*(){_.info("[".concat(n.getTrackId(),"] set facingMode ").concat(t));const i={video:Rt(Rt({},n._constraints),{},{deviceId:void 0,facingMode:{exact:t}})};if(n._enabled){n._originMediaStreamTrack.stop();let r=null;try{r=yield io(i,n.getTrackId())}catch(o){throw _.error("[".concat(n.getTrackId(),"] setDeviceByFacingModel failed"),o.toString()),r=yield io({video:n._constraints},n.getTrackId()),yield n._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!1),o}yield n._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!1),n.updateMediaStreamTrackResolution()}n._deviceName="",n._config.facingMode=t,n._config.cameraId=void 0,n._constraints=Rt({},i.video),_.info("[".concat(n.getTrackId(),"] setDeviceByFacingModel success"))})()}setEnabled(t,n){var i=this;return C(function*(){if(!n){if(t===i._enabled)return;i.stateCheck("enabled",t)}if(_.info("[".concat(i.getTrackId(),"] start setEnabled"),t),t){try{if(i.isExternalTrack)i._originMediaStreamTrack.enabled=!0;else{const r=yield io({video:i._constraints},i.getTrackId());yield i._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!1)}yield ct(i,X.NEED_ENABLE_TRACK,i)}catch(r){throw _.error("[".concat(i.getTrackId(),"] setEnabled true error"),r.toString()),r}i.updateMediaStreamTrackResolution(),_.info("[".concat(i.getTrackId(),"] setEnabled to true success")),n||(i._enabled=!0)}else{i.isExternalTrack?i._originMediaStreamTrack.enabled=!1:(i._originMediaStreamTrack.onended=null,i._originMediaStreamTrack.stop()),n||(i._enabled=!1);try{yield ct(i,X.NEED_DISABLE_TRACK,i)}catch(r){throw _.error("[".concat(i.getTrackId(),"] setEnabled to false error"),r.toString()),r}_.info("[".concat(i.getTrackId(),"] setEnabled to false success"))}})()}setEncoderConfiguration(t,n){var i=this;return C(function*(){if(!i._enabled)throw new M(S.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");t=Da(t),i._forceBitrateLimit&&(t.bitrateMax=i._forceBitrateLimit.max_bitrate||t.bitrateMax,t.bitrateMin=i._forceBitrateLimit.min_bitrate||t.bitrateMin);const r=dn(i._config);r.encoderConfig=t;const o=tC(r);(ei()||Ki()||Zo())&&(o.deviceId=void 0),_.debug("[".concat(i.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(o));try{yield i._originMediaStreamTrack.applyConstraints(o),i.updateMediaStreamTrackResolution()}catch(s){const a=new M(S.UNEXPECTED_ERROR,s.toString());throw _.error("[".concat(i.getTrackId(),"] applyConstraints error"),a.toString()),a}i._config=r,i._constraints=o,i._originalConstraints=o,i._encoderConfig=t,-1===i._hints.indexOf(ft.SCREEN_TRACK)&&i.updateBitrateFromProfile();try{yield ct(i,X.NEED_UPDATE_VIDEO_ENCODER,i)}catch(s){return s.throw(_)}})()}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){var t=this;if((Ki()||Zo())&&this._enabled&&!this._isClosed&&tt.duringInterruption){const n=function(){var i=C(function*(){tt.off(Xn.IOS_INTERRUPTION_END,n),t._enabled&&!t._isClosed&&(_.debug("[".concat(t.getTrackId(),"] try capture camera media device for interrupted iOS device.")),yield t.setEnabled(!1),yield t.setEnabled(!0))});return function(){return i.apply(this,arguments)}}();tt.on(Xn.IOS_INTERRUPTION_END,n)}else _.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Ap.TRACK_ENDED)}renewMediaStreamTrack(t){var n=this;return C(function*(){const i=t||n._constraints,r=ro.searchDeviceIdByName(n._deviceName);if(r&&!i.deviceId&&(i.deviceId={exact:r}),n._enabled){const o=yield io({video:i},n.getTrackId());n._constraints=i,yield n._updateOriginMediaStreamTrack(o.getVideoTracks()[0],!0),n.updateMediaStreamTrackResolution()}})()}close(){super.close(),tt.off(Xn.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),tt.off(Xn.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._encoderConfig;t&&(i=Rt(Rt({},i),Da(t))),i=Pd(i);const r=gt(8,"track-cam-cloned-"),o=new RQ(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,Pd(Rt(Rt({},this._config),{},{encoderConfig:i})),Pd(this._constraints),Pd(this._scalabilityMode),this._optimizationMode,r);return t&&i&&o.setEncoderConfiguration(i),_.debug("clone track from ".concat(this.getTrackId()," to ").concat(r,", clone ").concat(n)),o}bindProcessorContextEvents(){var t=this;this.processorContext.on(to.REQUEST_UPDATE_CONSTRAINTS,function(){var n=C(function*(i,r,o){try{const s=Object.assign({},t._originalConstraints,...i);yield t.renewMediaStreamTrack(s),r()}catch(s){o(s)}});return function(i,r,o){return n.apply(this,arguments)}}()),this.processorContext.on(to.REQUEST_CONSTRAINTS,function(){var n=C(function*(i){i(t._originMediaStreamTrack.getSettings())});return function(i){return n.apply(this,arguments)}}())}},Me(so.prototype,"setDevice",[h$,p$],Object.getOwnPropertyDescriptor(so.prototype,"setDevice"),so.prototype),Me(so.prototype,"setEnabled",[f$,m$,g$],Object.getOwnPropertyDescriptor(so.prototype,"setEnabled"),so.prototype),Me(so.prototype,"setEncoderConfiguration",[_$,v$],Object.getOwnPropertyDescriptor(so.prototype,"setEncoderConfiguration"),so.prototype),Me(so.prototype,"close",[E$],Object.getOwnPropertyDescriptor(so.prototype,"close"),so.prototype),so);function pM(e,t,n,i){n.optimizationMode&&(i&&i.width&&i.height?(n.encoderConfig=Rt(Rt({},i),{},{bitrateMin:i.bitrateMin,bitrateMax:i.bitrateMax}),"motion"!==n.optimizationMode&&"detail"!==n.optimizationMode||(t.contentHint=n.optimizationMode,t.contentHint===n.optimizationMode?_.debug("[".concat(e,"] set content hint to"),n.optimizationMode):_.debug("[".concat(e,"] set content hint failed")))):_.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}var b$,y$,S$,C$,xo,T$,w$,I$,R$,A$,D$,Fi;class O$ extends Fq{getUserId(){return this._userId}constructor(t,n,i,r){super(t,"track-".concat(t.kind,"-").concat(n,"-").concat(r.clientId,"_").concat(gt(5,""))),x(this,"_userId",void 0),x(this,"_uintId",void 0),x(this,"_isDestroyed",!1),x(this,"store",void 0),x(this,"processor",void 0),x(this,"processorContext",void 0),this._userId=n,this._uintId=i,this.store=r}_updateOriginMediaStreamTrack(t){this._originMediaStreamTrack=t,this._mediaStreamTrack=t,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,_.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let xp=(b$=le({argsMap:(e,t,n)=>[e.getTrackId(),"string"==typeof t?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),y$=le({argsMap:e=>[e.getTrackId()]}),S$=le({argsMap:(e,t)=>[e.getTrackId(),t.name]}),C$=le({argsMap:e=>[e.getTrackId()]}),Me((xo=class extends O${get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Li.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(e,t,n,i){super(e,t,n,i),x(this,"_videoVisibleTimer",null),x(this,"_previousVideoVisibleStatus",void 0),x(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),x(this,"trackMediaType",Op.VIDEO),x(this,"_videoWidth",void 0),x(this,"_videoHeight",void 0),x(this,"_player",void 0),x(this,"processorDestination",void 0),x(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new $q(this.getTrackId(),"remote"),this.processorDestination=new Yq(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return ml(()=>{_.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),Oo(this,X.GET_STATS)||Rt({},kq)}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){const i=document.getElementById(e);i?e=i:(_.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}_.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const n=Rt(Rt({fit:"cover"},t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(n):(this._player=e instanceof HTMLVideoElement?new uM(n):new jY(n),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(Dp.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=i=>{this.safeEmit(Dp.VIDEO_STATE_CHANGED,i)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const i=this.getVideoElementVisibleStatus();this.safeEmit(Dp.VIDEO_ELEMENT_VISIBLE_STATUS,i)}catch{}},R("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,_.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){Jq(this._originMediaStreamTrack).then(e=>{let[t,n]=e;this._videoHeight=n,this._videoWidth=t}).catch(NS)}_updatePlayerSource(){_.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;const n=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),i={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:n?.parentElement},{element:r,slot:o}=i;if(this.isPlaying&&r instanceof HTMLVideoElement&&o instanceof HTMLElement){const s=cK.checkOneElementVisible(r),a=Object.assign({},s);if(a.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=a.visible;ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]}).onSuccess(a.visible?"Video is visible":"Invisible because of ".concat(a.reason))}return a}return}catch(n){throw new M(S.GET_VIDEO_ELEMENT_VISIBLE_ERROR,n.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new M(S.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){var e=this;this.processorDestination.on(Xi.ON_TRACK,function(){var t=C(function*(n){n?n!==e._mediaStreamTrack&&(e._mediaStreamTrack=n,e._updatePlayerSource()):e._mediaStreamTrack!==e._originMediaStreamTrack&&(e._mediaStreamTrack=e._originMediaStreamTrack,e._updatePlayerSource())});return function(n){return t.apply(this,arguments)}}())}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Xi.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(e){this.emit(Bd.SEI_RECEIVED,e)}}).prototype,"play",[b$],Object.getOwnPropertyDescriptor(xo.prototype,"play"),xo.prototype),Me(xo.prototype,"stop",[y$],Object.getOwnPropertyDescriptor(xo.prototype,"stop"),xo.prototype),Me(xo.prototype,"pipe",[S$],Object.getOwnPropertyDescriptor(xo.prototype,"pipe"),xo.prototype),Me(xo.prototype,"unpipe",[C$],Object.getOwnPropertyDescriptor(xo.prototype,"unpipe"),xo.prototype),xo),kp=(T$=le({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),w$=le({argsMap:(e,t)=>[e.getTrackId(),t]}),I$=le({argsMap:e=>[e.getTrackId()]}),R$=le({argsMap:e=>[e.getTrackId()]}),A$=le({argsMap:(e,t)=>[e.getTrackId(),t.name]}),D$=le({argsMap:e=>[e.getTrackId()]}),Me((Fi=class extends O${get isPlaying(){return this._useAudioElement?ir.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(e,t,n,i){super(e,t,n,i),x(this,"trackMediaType",Op.AUDIO),x(this,"_source",void 0),x(this,"_useAudioElement",!0),x(this,"_volume",100),x(this,"processorContext",void 0),x(this,"processorDestination",void 0),x(this,"_played",!1),x(this,"_bypassWebAudio",!1),R("DISABLE_WEBAUDIO")?(this._source=new lM,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new jq(e,!0),R("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(eo.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(Dp.FIRST_FRAME_DECODED)}),this.processorContext=new Zq(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new Xq(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(eo.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(eo.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(eo.ON_AUDIO_BUFFER),this._source.on(eo.ON_AUDIO_BUFFER,n=>e(n))}setVolume(e){this._volume=e,this._useAudioElement?ir.setVolume(this.getTrackId(),e):this._source.setVolume(e/100)}setPlaybackDevice(e){var t=this;return C(function*(){if(!t._useAudioElement||!Nq())throw new M(S.NOT_SUPPORTED,"your browser does not support setting the audio output device");yield ir.setSinkID(t.getTrackId(),e)})()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return ml(()=>{_.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),Oo(this,X.GET_STATS)||Rt({},xq)}play(){_.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(_.debug("[".concat(this.getTrackId(),"] use audio element to play")),ir.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){_.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?ir.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];_.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&ir.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this._bypassWebAudio)throw new M(S.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===e)return e;if(e._source)throw new M(S.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(this._bypassWebAudio)throw new M(S.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){var e=this;this.processorDestination.on(Xi.ON_TRACK,function(){var t=C(function*(n){n?n!==e._mediaStreamTrack&&(e._mediaStreamTrack=n,e._updatePlayerSource(!1),e._source.processedNode=e._source.createMediaStreamSourceNode(n)):e._mediaStreamTrack!==e._originMediaStreamTrack&&(e._mediaStreamTrack=e._originMediaStreamTrack,e._updatePlayerSource())});return function(n){return t.apply(this,arguments)}}()),this.processorDestination.on(Xi.ON_NODE,t=>{this._source.processedNode=t;const n=!t;this._useAudioElement!==n&&(this._played?(this.stop(),this._useAudioElement=n,this.play()):this._useAudioElement=n)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Xi.ON_TRACK),this.processorDestination.removeAllListeners(Xi.ON_NODE)}}).prototype,"setVolume",[T$],Object.getOwnPropertyDescriptor(Fi.prototype,"setVolume"),Fi.prototype),Me(Fi.prototype,"setPlaybackDevice",[w$],Object.getOwnPropertyDescriptor(Fi.prototype,"setPlaybackDevice"),Fi.prototype),Me(Fi.prototype,"play",[I$],Object.getOwnPropertyDescriptor(Fi.prototype,"play"),Fi.prototype),Me(Fi.prototype,"stop",[R$],Object.getOwnPropertyDescriptor(Fi.prototype,"stop"),Fi.prototype),Me(Fi.prototype,"pipe",[A$],Object.getOwnPropertyDescriptor(Fi.prototype,"pipe"),Fi.prototype),Me(Fi.prototype,"unpipe",[D$],Object.getOwnPropertyDescriptor(Fi.prototype,"unpipe"),Fi.prototype),Fi);const Ec=new class extends xt{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),x(this,"_lastHiddenTime",0),x(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),_.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};class N$ extends xt{constructor(t,n){super(),x(this,"trackMediaType",Op.DATA),x(this,"_version",1),x(this,"_type",3),x(this,"_config",void 0),x(this,"_originDataChannel",void 0),x(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),x(this,"_dataStreamPacketHandler",{serialize:i=>i,deserialize:i=>i}),x(this,"_datachannelEventMap",new Map),this._config=t,n&&(this._originDataChannel=n,this._bandDataChannelEvents(n)),this._initPacketHeader()}useDataStream(t){this._dataStreamPacketHandler=t}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return R("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var t,n;return null!==(t=null===(n=this._originDataChannel)||void 0===n?void 0:n.readyState)&&void 0!==t?t:"connecting"}get _originDataChannelId(){var t,n;return null!==(t=null===(n=this._originDataChannel)||void 0===n?void 0:n.id)&&void 0!==t?t:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}_waitTillOpen(){var t=this;return C(function*(){return new q((n,i)=>{if(t._originDataChannel){"open"===t._originDataChannel.readyState&&n();const r=setTimeout(()=>{var o;i(new M(S.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat(null===(o=t._originDataChannel)||void 0===o?void 0:o.id)))},1e4);t._originDataChannel.onopen=()=>{clearTimeout(r),t._originDataChannel&&t._bandDataChannelEvents(t._originDataChannel),n()},t._originDataChannel.onerror=()=>{throw clearTimeout(r),new M(S.DATACHANNEL_CONNECTION_TIMEOUT)}}else i(new M(S.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})})()}_updateOriginDataChannel(t){this._originDataChannel=t,this._bandDataChannelEvents(t)}_initPacketHeader(){const t=new DataView(this._dataStreamPacketHeader);t.setUint16(0,this._version),t.setUint8(2,this._type),t.setUint8(3,this._config.id)}_bandDataChannelEvents(t){this._unbindDataChannelEvents(t),[QS.OPEN,QS.CLOSE,QS.ERROR].forEach(n=>{const i=()=>{this.emit(n)};this._datachannelEventMap.set(n,i),t.addEventListener(n,i)})}_unbindDataChannelEvents(t){Array.from(this._datachannelEventMap.entries()).forEach(n=>{let[i,r]=n;t.removeEventListener(i,r)}),this._datachannelEventMap.clear()}}class J2e extends N${constructor(t){super(t),x(this,"_messageListener",void 0),this._messageListener=n=>{if(n.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const i=n.data.slice(0,this._dataStreamPacketHeader.byteLength),r=new DataView(i).getUint8(3);if(r!==this.id)return void(R("SHOW_DATASTREAM2_LOG")&&_.debug("invalid datachannel id: ".concat(r," !== ").concat(this.id)));let o=n.data.slice(this._dataStreamPacketHeader.byteLength);o=this._dataStreamPacketHandler.deserialize(o),this.emit(QS.MESSAGE,o)}}_updateOriginDataChannel(t){super._updateOriginDataChannel(t),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class Q2e extends N${send(t){if(this._originDataChannel){let n=t;n=this._dataStreamPacketHandler.serialize(t);const i=new Uint8Array(this._dataStreamPacketHeader.byteLength+n.byteLength);i.set(new Uint8Array(this._dataStreamPacketHeader),0),i.set(new Uint8Array(n),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(i.buffer)}}}function iC(){const e=new Blob([atob("ZnVuY3Rpb24gZShlLHQsbil7bGV0IHI9bmV3IFVpbnQ4QXJyYXkoZSx0LG4pLGE9W10sbz0wO2Zvcig7YS5sZW5ndGg8bjspbyszPG4mJjA9PT1yW29dJiYwPT09cltvKzFdJiYzPT09cltvKzJdJiYoMD09PXJbbyszXXx8MT09PXJbbyszXXx8Mj09PXJbbyszXXx8Mz09PXJbbyszXSk/KGEucHVzaChyW29dLHJbbysxXSxyW28rM10pLG8rPTQpOihhLnB1c2gocltvXSksbysrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoYSl9ZnVuY3Rpb24gdChlLHQpe2NvbnN0IG49ZnVuY3Rpb24oZSl7Y29uc3QgdD1lLmxlbmd0aDtsZXQgbj1bXSxyPTA7Zm9yKDtyPHQ7KXIrMjx0JiYwPT09ZVtyXSYmMD09PWVbcisxXSYmKDA9PT1lW3IrMl18fDE9PT1lW3IrMl18fDI9PT1lW3IrMl18fDM9PT1lW3IrMl0pPyhuLnB1c2goZVtyXSxlW3IrMV0sMyxlW3IrMl0pLHIrPTMpOihuLnB1c2goZVtyXSkscisrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobil9KHQpLHI9bi5sZW5ndGgsYT1NYXRoLmZsb29yKHIvMjU1KSxvPXIlMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNithKzErcitlLmJ5dGVMZW5ndGgpO3NbMF09MCxzWzFdPTAsc1syXT0wLHNbM109MSxzWzRdPTYsc1s1XT0xMDE7bGV0IGk9MDtmb3IoO2k8YTspc1s2K2ldPTI1NSxpKys7cmV0dXJuIHNbNitpXT1vLGkrKyxzLnNldChuLDYraSkscy5zZXQobmV3IFVpbnQ4QXJyYXkoZSksNitpK3IpLHMuYnVmZmVyfW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiU2FmYXJpIik+LTEmJi0xPT09bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJDaHJvbWUiKSYmKHNlbGYub25ydGN0cmFuc2Zvcm09bj0+e2NvbnN0IHI9bi50cmFuc2Zvcm1lcjtsZXQgYT1bXTtyLm9wdGlvbnMucG9ydC5vbm1lc3NhZ2U9ZT0+e2UuZGF0YS5zZWkmJmEucHVzaChlLmRhdGEuc2VpKX0sc2VsZi5wb3N0TWVzc2FnZSgic3RhcnRlZCIpO2NvbnN0IG89ci5yZWFkYWJsZS5nZXRSZWFkZXIoKSxzPXIud3JpdGFibGUuZ2V0V3JpdGVyKCk7InJ4Ij09PXIub3B0aW9ucy5uYW1lP2Z1bmN0aW9uIHQobil7by5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgdD1mdW5jdGlvbih0KXtjb25zdCBuPW5ldyBEYXRhVmlldyh0LmRhdGEpO2xldCByPTA7Zm9yKDtyKzQ8dC5kYXRhLmJ5dGVMZW5ndGg7KXtpZigwPT09bi5nZXRVaW50OChyKzApJiYwPT09bi5nZXRVaW50OChyKzEpJiYwPT09bi5nZXRVaW50OChyKzIpJiYxPT09bi5nZXRVaW50OChyKzMpJiY2PT09bi5nZXRVaW50OChyKzQpKXtsZXQgYT1yKzYsbz0wLHM9MDtmb3IoOzI1NT09PShzPW4uZ2V0VWludDgoYSsrKSk7KW8rPTI1NTtvKz1zO2NvbnN0IGk9ZSh0LmRhdGEsYSxvKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoaSl9cisrfXJldHVybiBudWxsfShyLnZhbHVlKTt0JiZuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7c2VpOnR9KX1zLndyaXRlKHIudmFsdWUpLG4ub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQobil9fSkpfShyKToidHgiPT09ci5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIGUobil7by5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgZT1hLnNoaWZ0KCk7ZSYmKHIudmFsdWUuZGF0YT10KHIudmFsdWUuZGF0YSxlKSl9cy53cml0ZShyLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0ocil9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKSk7Cg==")],{type:"text/javascript"});return setTimeout(()=>Oq.revokeObjectURL(e),0),new Worker(Oq.createObjectURL(e))}const rC=new Map,oC=new Map;function eFe(e,t,n){let i=new Uint8Array(e,t,n),r=[],o=0;for(;r.length<n;)o+3<n&&0===i[o]&&0===i[o+1]&&3===i[o+2]&&(0===i[o+3]||1===i[o+3]||2===i[o+3]||3===i[o+3])?(r.push(i[o],i[o+1],i[o+3]),o+=4):(r.push(i[o]),o++);return new Uint8Array(r)}const sC=new Map;function fM(){return fM=C(function*(e,t){if(!Fe().supportWebRTCEncodedTransform)return void _.warning("browser not support video encoded transform");if(sC.has(e)||!e.track)return;const n={track:e.track};if(pl()){if(!e.createEncodedStreams)return void _.warning("browser not support createEncodedStreams() API");let r=null;try{r=e.createEncodedStreams()}catch(a){return void _.error("create video-encoded-streams error",a&&a.message)}let o=[];t.on("sei-to-send",a=>{o.push(a)});const s=new TransformStream({transform(a,c){n.controller||(n.controller=c),e.track&&e.track.id!==n.track.id&&(_.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",i),n.track=e.track,n.track.addEventListener("ended",i));const l=o.shift();l&&(a.data=function(d,u){const h=function(b){const T=b.length;let I=[],D=0;for(;D<T;)D+2<T&&0===b[D]&&0===b[D+1]&&(0===b[D+2]||1===b[D+2]||2===b[D+2]||3===b[D+2])?(I.push(b[D],b[D+1],3,b[D+2]),D+=3):(I.push(b[D]),D++);return new Uint8Array(I)}(u),p=h.length,m=Math.floor(p/255),f=p%255,g=new Uint8Array(6+m+1+p+d.byteLength);g[0]=0,g[1]=0,g[2]=0,g[3]=1,g[4]=6,g[5]=101;let E=0;for(;E<m;)g[6+E]=255,E++;return g[6+E]=f,E++,g.set(h,6+E),g.set(new Uint8Array(d),6+E+p),g.buffer}(a.data,l)),c.enqueue(a)}});r.readable.pipeThrough(s).pipeTo(r.writable)}else{if(!ei())return;{if(typeof RTCRtpScriptTransform>"u")return void _.warning("browser not support RTCRtpScriptTransform");const r=iC(),o=new MessageChannel;yield new q(a=>r.onmessage=c=>{"registered"===c.data&&a(void 0)});const s=new RTCRtpScriptTransform(r,{name:"tx",port:o.port2},[o.port2]);e.transform=s,yield new q(a=>r.onmessage=c=>{"started"===c.data&&a(void 0)}),t.on("sei-to-send",a=>{o.port1.postMessage({sei:a})}),o.port1.onmessage=a=>{var c;a.data.transformed&&e.track&&(null===(c=e.track)||void 0===c?void 0:c.id)!==n.track.id&&(_.debug("video track changed: ".concat(n.track.id," => ").concat(e.track.id)),n.track.removeEventListener("ended",i),n.track=e.track,n.track.addEventListener("ended",i))},n.worker=r}}function i(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",i)}const r=sC.get(e);if(r){sC.delete(e);try{var o,s;null===(o=r.controller)||void 0===o||o.terminate(),null===(s=r.worker)||void 0===s||s.terminate()}catch(a){_.warning(a&&a.message)}}}sC.set(e,n),e.track.addEventListener("ended",i)}),fM.apply(this,arguments)}const n_=new Map;!function(){const e=xe();$n.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),$n.getStreamFromExtension=e.name===Ye.CHROME&&Number(e.version)>34,$n.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const t=new RTCPeerConnection;let n=!1;try{t.addTransceiver("audio"),n=!0}catch{}return t.close(),n}(),$n.supportMinBitrate=e.name===Ye.CHROME||e.name===Ye.EDGE,$n.supportSetRtpSenderParameters=function(){const t=xe();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!fl()||!(!ei()&&!IS())||t.name===Ye.FIREFOX&&Number(t.version)>=64)}(),e.name===Ye.SAFARI&&($n.supportDualStream=Number(e.version)>=14),$n.webAudioMediaStreamDest=function(){const t=xe();return!(t.name===Ye.SAFARI&&Number(t.version)<12)}(),$n.supportReplaceTrack=!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack,$n.supportWebGL=typeof WebGLRenderingContext<"u",$n.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,fl()||($n.webAudioWithAEC=!0),$n.supportShareAudio=function(){const t=xe();return(t.os===kn.WIN_10||t.os===kn.WIN_81||t.os===kn.WIN_7||t.os===kn.LINUX||t.os===kn.MAC_OS||t.os===kn.CHROMIUM_OS)&&t.name===Ye.CHROME&&Number(t.version)>=74}(),$n.supportDataChannel=!!($N(76)||function(t){const n=xe();return!(n.name!==Ye.FIREFOX||!n.osVersion)&&Number(n.version)>=68}()||J7(14)),$n.supportPCSetConfiguration=function(){const t=window.RTCPeerConnection;return!Bt()&&!!t&&t.prototype.setConfiguration instanceof Function}(),$n.supportWebRTCEncodedTransform=function(){const t=xe();return"Chrome"===t.name&&Number(t.version)>=86||"Safari"===t.name&&Number(t.version)>=15}(),$n.supportWebRTCInsertableStream=function(){const t=xe();return(t.name===Ye.CHROME||t.name===Ye.EDGE)&&Number(t.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),$n.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,$n.supportWebCrypto=typeof window<"u"&&void 0!==window.crypto&&void 0!==window.crypto.subtle,OS(()=>{$n.supportDualStreamEncoding=function(){const t=xe();return!!R("DISABLE_WEBAUDIO")||"Safari"===t.name&&Number(t.version)>=14||!!("Chrome"===t.name&&/Windows/i.test(t.os||"")&&Number(t.version)>=100&&R("CHROME_DUAL_STREAM_USE_ENCODING"))}(),_.info("browser compatibility",JSON.stringify($n),JSON.stringify(e))})}();class Gd extends xt{constructor(t,n){super(),y(this,"signal",void 0),y(this,"token",void 0),y(this,"tokenTimeout",void 0),y(this,"tokenInterval",void 0),y(this,"_sequence",0),y(this,"userMap",new Map),y(this,"encoder",new TextEncoder),this.signal=t,this.token=n;const i=()=>{this.signal.connectionState===_t.CONNECTED&&this.check(),this.tokenInterval=0===this.userMap.size?window.setTimeout(i,1e3):window.setTimeout(i,3*R("P2P_TOKEN_INTERVAL"))};i()}send(t,n,i,r,o){var s=this;return C(function*(){var a,c,l;if(0===s.userMap.size)return;const d=Array.from(gc(a=s.userMap).call(a))[0].token;"string"!=typeof n&&(n=JSON.stringify(n)),r=null!==(c=r)&&void 0!==c?c:gt(6,""),o=null!==(l=o)&&void 0!==l?l:s._sequence++;const u={_id:r,_type:t,_seq:o,_message:n,token:"".concat(s.token,"_").concat(d)};R("SHOW_P2P_LOG")&&_.debug("send message",u,"noNeedResponse : ".concat(i)),s.splitMessage(JSON.stringify(u)).forEach(p=>{s.signal.request(pe.DATA_STREAM,{payload:gl(s.encoder.encode(p))})});const h=new q((p,m)=>{const f=window.setTimeout(()=>{s.off("res-@".concat(r,"_ack"),g),s.off("res-@".concat(r),b),s.off(gp.ABORT,E),_.debug("[external-signal] request timeout, type: ".concat(t,", requestId: ").concat(r)),m(new M(0===s.userMap.size?S.INVALID_REMOTE_USER:S.TIMEOUT))},R("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),g=()=>{f&&window.clearTimeout(f),s.off(gp.ABORT,E),i&&p()},E=()=>{f&&window.clearTimeout(f),s.off("res-@".concat(r,"_ack"),g),s.off("res-@".concat(r),b),m(new M(S.EXTERNAL_SIGNAL_ABORT,"type: ".concat(t,", requestId: ").concat(r)))};s.once(gp.ABORT,E),s.once("res-@".concat(r,"_ack"),g);const b=(I,D)=>{T=!0,f&&window.clearTimeout(f),s.off("res-@".concat(r,"_ack"),g),s.off(gp.ABORT,E),"success"===I?p(D):m(new M(S.P2P_MESSAGE_FAILED,"request ".concat(t," failed, requestId: ").concat(r)))};let T=!1;i||(s.once("res-@".concat(r),b),qn(R("SIGNAL_REQUEST_TIMEOUT")).then(()=>{T||_.warning("external_signal request timeout, type: ".concat(t,", requestId: ").concat(r,", ").concat(u))}))});try{return yield h}catch(p){if(p.code===S.TIMEOUT)return yield s.send(t,n,i,r,o);throw p}})()}onMessage(t){var n;const{_uid:i}=t;let r,o=this.userMap.get(i);if(o)r=o.splitMessageMap;else{if(this.userMap.size>0||!("_type"in t)||t._type!==Qt.CHECK)return;const{token:l}=t;r=new Map,o={uid:i,isStart:!0,token:l,splitMessageMap:r,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(i,o),this.signal.emit(Te.ON_USER_ONLINE,{uid:i}),this.handleUserOnline()}if("id"in t&&"total"in t){var s;const{id:l,total:d}=t,u=null!==(s=r.get(l))&&void 0!==s?s:[];if(u.push(t),r.has(l)||r.set(l,u),u.length!==d)return;{const h=Ig(u).call(u,(p,m)=>p.index-m.index).map(p=>p.payload).join("");r.delete(l),(t=JSON.parse(h))._uid=i}}const{_type:a,token:c}=t;if(Y(n=[Qt.ACK,Qt.CHECK]).call(n,a))return a===Qt.CHECK&&this.handleCheckToken(o,c),void this.receiveMessage(t);c==="".concat(o.token,"_").concat(this.token)?this.handleReceivedMessage(t):_.debug('Receive unexpected message", '.concat(c,", cur_token: ").concat(o.token,"_").concat(this.token),t)}check(){const t={_id:gt(6,""),token:this.token,_type:Qt.CHECK};R("SHOW_P2P_LOG")&&_.debug("send message",t),this.signal.request(pe.DATA_STREAM,{payload:gl(this.encoder.encode(JSON.stringify(t)))})}ack(t){const n={_id:t,_type:Qt.ACK,token:this.token};R("SHOW_P2P_LOG")&&_.debug("send message",n),this.signal.request(pe.DATA_STREAM,{payload:gl(this.encoder.encode(JSON.stringify(n)))})}response(t,n,i){this.send(Qt.RESPONSE,JSON.stringify({success:!i,message:n}),!0,t)}handleReceivedMessage(t){const n=()=>{this.userMap.forEach(l=>{const{receivedMessagesMap:d,nextExpectedSequenceNumber:u}=l;for(;d.has(u);){const h=d.get(u);d.delete(u),this.receiveMessage(h),l.nextExpectedSequenceNumber++}})};if(!t)return void n();const{_uid:i,_seq:r}=t,o=this.userMap.get(i),{receivedMessagesMap:s,isStart:a,nextExpectedSequenceNumber:c}=o;if(r<c)return this.ack(t._id),void _.debug("[external-signal] receive old message, seq: ".concat(r,", ").concat(t._message));s.set(r,t),a&&r===c&&(this.receiveMessage(t),s.delete(c),o.nextExpectedSequenceNumber++,n())}receiveMessage(t){const{_id:n,_type:i,_message:r,_uid:o}=t;if(R("SHOW_P2P_LOG")&&_.debug("receive message",t),n){let s;switch(t._type!==Qt.ACK&&(r&&(s=JSON.parse(r)),this.ack(t._id)),t._type){case Qt.CANDIDATE:case Qt.CONTROL:this.signal.emit(i,s,o);break;case Qt.PUBLISH:case Qt.UNPUBLISH:case Qt.RESTART_ICE:case Qt.CALL:s.uid=o,ni(this.signal,i,s).then(a=>{this.response(t._id,a)}).catch(()=>{this.response(t._id,void 0,!0)});break;case Qt.ACK:this.getListeners("res-@".concat(n,"_ack")).length>0&&this.emit("res-@".concat(n,"_ack"));break;case Qt.RESPONSE:{const{success:a,message:c}=s;this.emit("res-@".concat(n),a?"success":"failed",c);break}}}}splitMessage(t){if(t.length<Gd.MAX_MESSAGE_SIZE)return[t];const n=[],{remoteToken:i}=JSON.parse(t),r=gt(6,"");let o=0,s=800;const a=Math.ceil(t.length/s);for(;t.length>0;){o++;const c={id:r,index:o,total:a,payload:t.slice(0,s),token:"".concat(this.token,"_").concat(i)};JSON.stringify(c).length>Gd.MAX_MESSAGE_SIZE?s-=50:(n.push(c),t=t.slice(s))}return n.map(c=>JSON.stringify(c))}handleCheckToken(t,n){return t.token!==n?(_.debug("token changed, from ".concat(t.token," to ").concat(n)),this.reset(t.uid,n),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{_.debug("token timeout, ".concat(n)),this.reset(t.uid)},R("MAX_P2P_TIMEOUT")),!0)}handleUserOnline(){var t=this;return C(function*(){const n=yield ni(t.signal,Qt.CALL,void 0),i=yield t.send(Qt.CALL,n);t.signal.emit(he.P2P_CONNECTION,i,!0)})()}reset(t,n){var i=this;return C(function*(){const r=i.userMap.get(t);r&&(i.emit(gp.ABORT),i.signal.emit(Te.ON_USER_OFFLINE,{uid:r.uid,reason:_Le.P2P_TOKEN_CHANGED}),i._sequence=0,i.userMap.clear(),n||(_.debug("change local token from ".concat(n," to ").concat(n)),i.token=gt(6,"")))})()}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(gp.ABORT)}}y(Gd,"MAX_SIZE",1),y(Gd,"MAX_MESSAGE_SIZE",1024);class P$ extends xt{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===_t.CONNECTED?this.emit(he.WS_CONNECTED):t===_t.RECONNECTING?this.emit(he.WS_RECONNECTING,this._websocketReconnectReason):t===_t.CLOSED&&this.emit(he.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(t,n){super(),y(this,"_disconnectedReason",void 0),y(this,"_websocketReconnectReason",void 0),y(this,"_connectionState",_t.CLOSED),y(this,"reconnectToken",void 0),y(this,"p2pToken",void 0),y(this,"websocket",void 0),y(this,"openConnectionTime",void 0),y(this,"clientId",void 0),y(this,"lastMsgTime",Date.now()),y(this,"uploadCache",[]),y(this,"uploadCacheInterval",void 0),y(this,"rttRolling",new CK(5)),y(this,"pingpongTimer",void 0),y(this,"pingpongTimeoutCount",0),y(this,"joinResponse",void 0),y(this,"multiIpOption",void 0),y(this,"initError",void 0),y(this,"spec",void 0),y(this,"store",void 0),y(this,"_external_signal",void 0),y(this,"onWebsocketMessage",i=>{if(i.data instanceof ArrayBuffer)return void this.emit(he.ON_BINARY_DATA,i.data);const r=JSON.parse(i.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(r,"_id")){const o="res-@".concat(r._id);this.emit(o,r._result,r._message)}else if(Object.prototype.hasOwnProperty.call(r,"_type")){switch(r._type){case Te.ON_DATA_STREAM:return void this.handleDataStream(r._message);case Te.MUTE_AUDIO:case Te.MUTE_VIDEO:case Te.ON_P2P_LOST:case Te.ON_USER_ONLINE:return;case Te.ON_USER_OFFLINE:const{uid:o}=r._message;return _.debug("[".concat(this.clientId,"] user-offline uid: ").concat(o)),void this._external_signal.reset(o)}if(this.emit(r._type,r._message),r._type===Te.ON_NOTIFICATION&&this.handleNotification(r._message),r._type===Te.ON_USER_BANNED)switch(r._message.error_code){case 14:this.close(Qe.UID_BANNED);break;case 15:this.close(Qe.IP_BANNED);break;case 16:this.close(Qe.CHANNEL_BANNED)}if(r._type===Te.ON_USER_LICENSE_BANNED)switch(r._message.error_code){case ce.ERR_LICENSE_MISSING:this.close(Qe.LICENSE_MISSING);break;case ce.ERR_LICENSE_EXPIRED:this.close(Qe.LICENSE_EXPIRED);break;case ce.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Qe.LICENSE_MINUTES_EXCEEDED);break;case ce.ERR_LICENSE_PERIOD_INVALID:this.close(Qe.LICENSE_PERIOD_INVALID);break;case ce.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Qe.LICENSE_MULTIPLE_SDK_SERVICE);break;case ce.ERR_LICENSE_ILLEGAL:this.close(Qe.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=n,this.websocket=new CP("gateway-".concat(this.clientId),this.spec.retryConfig,!0,R("JOIN_GATEWAY_USE_DUAL_DOMAIN"),R("JOIN_GATEWAY_USE_443PORT_ONLY"),n),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===_t.CONNECTED&&this.reconnect("retry",ti.OFFLINE)}),this.p2pToken=gt(6,""),this._external_signal=new Gd(this,this.p2pToken)}request(t,n,i,r){var o=this;return C(function*(){const s=gt(6,""),a={_id:s,_type:t,_message:n},c=o.websocket.connectionID,l=()=>new q((f,g)=>{if(o.connectionState===_t.CONNECTED)return f();const E=()=>{o.off(he.WS_CLOSED,b),f()},b=()=>{o.off(he.WS_CONNECTED,E),g(new M(S.WS_ABORT))};o.once(he.WS_CONNECTED,E),o.once(he.WS_CLOSED,b)});if(o.connectionState!==_t.CONNECTING&&o.connectionState!==_t.RECONNECTING||t===pe.JOIN||t===pe.REJOIN||(yield l()),o.websocket.sendMessage(a,!0),r)return;const d=new q((f,g)=>{let E=!1;const b=(I,D)=>{E=!0,f({isSuccess:"success"===I,message:D||{}}),o.off(he.WS_CLOSED,T),o.off(he.WS_RECONNECTING,T),o.emit(he.REQUEST_SUCCESS,t,n)};o.once("res-@".concat(s),b);const T=()=>{g(new M(S.WS_ABORT,"type: ".concat(t))),o.off(he.WS_CLOSED,T),o.off(he.WS_RECONNECTING,T),o.off("res-@".concat(s),b)};o.once(he.WS_CLOSED,T),o.once(he.WS_RECONNECTING,T),qn(R("SIGNAL_REQUEST_TIMEOUT")).then(()=>{o.websocket.connectionID!==c||E||(_.warning("[".concat(o.clientId,"] ws request timeout, type: ").concat(t)),o.emit(he.REQUEST_TIMEOUT,t,n))})});let u=null;try{u=yield d}catch(f){if(o.connectionState===_t.CLOSED||t===pe.LEAVE)throw new M(S.WS_ABORT);return!o.spec.forceWaitGatewayResponse||i?f.throw():t===pe.JOIN||t===pe.REJOIN?null:(yield l(),yield o.request(t,n))}if(u.isSuccess)return u.message;const h=Number(u.message.error_code||u.message.code),p=qg(h),m=new M(S.UNEXPECTED_RESPONSE,"".concat(p.desc,": ").concat(u.message.error_str),{code:h,data:u.message,desc:p.desc});return"success"===p.action?u.message:(_.warning("[".concat(o.clientId,"] [").concat(o.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(h,", message: ").concat(p.desc,", action: ").concat(p.action)),h===ce.ERR_TOO_MANY_BROADCASTERS?((t===pe.JOIN||t===pe.REJOIN)&&(o.initError=m,o.close()),m.throw()):"failed"===p.action?m.throw():"quit"===p.action?(o.initError=m,o.close(),m.throw()):(h===ce.ERR_JOIN_BY_MULTI_IP?(o.multiIpOption=u.message.option,_.warning("[".concat(o.clientId,"] detect multi ip, recover")),o.reconnect("recover",ti.MULTI_IP)):o.reconnect(p.action,ti.SERVER_ERROR),t===pe.JOIN||t===pe.REJOIN?null:yield o.request(t,n)))})()}waitMessage(t,n){return new q(i=>{const r=o=>{(!n||n(o))&&(this.off(t,r),i(o))};this.on(t,r)})}uploadWRTCStats(t){if(!this.store.sessionId)return void _.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const n={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:t};this.upload(Kg.WRTC_STATS,n)}upload(t,n){const i={_type:t,_message:n};try{this.websocket.sendMessage(i)}catch{const o=R("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(i),this.uploadCache.length>o&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==_t.CONNECTED)return;const s=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(s._type,s._message)},R("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,n){this.websocket.sendMessage({_type:t,_message:n})}sendExtensionMessage(t,n,i){var r=this;return C(function*(){return yield r._external_signal.send(t,n,i)})()}init(t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new q((n,i)=>{this.once(he.WS_CONNECTED,()=>n(this.joinResponse)),this.once(he.WS_CLOSED,()=>i(this.initError||new M(S.WS_ABORT))),this.connectionState=_t.CONNECTING,this.websocket.init(t).catch(i)})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=t||Qe.LEAVE,this.connectionState=_t.CLOSED,_.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=gt(6,""),this._external_signal.clear(),this._external_signal=new Gd(this,this.p2pToken)}join(){var t=this;return C(function*(){if(!t.joinResponse){t.emit(he.ABORT_P2P_EXECUTION);const n=yield ni(t,he.REQUEST_JOIN_INFO),i=yield t.request(pe.JOIN,n);if(!i)return t.emit(he.REPORT_JOIN_GATEWAY,S.TIMEOUT,t.url||""),!1;t.joinResponse=i,t.emit(he.JOIN_RESPONSE,t.joinResponse),t.reconnectToken=t.joinResponse.rejoin_token}return t.connectionState=_t.CONNECTED,t.pingpongTimer&&window.clearInterval(t.pingpongTimer),t.pingpongTimer=window.setInterval(t.handlePingPong.bind(t),3e3),!0})()}reconnect(t,n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,n)}handleDataStream(t){try{var n;const i=Md(t.payload),r=(new TextDecoder).decode(i),o=JSON.parse(r);"total"in o&&"id"in o||Y(n=Object.values(Qt)).call(n,o._type)?(o._uid=t.uid,this._external_signal.onMessage(o)):this.emit(Te.ON_DATA_STREAM,t)}catch{this.emit(Te.ON_DATA_STREAM,t)}}handleNotification(t){_.debug("[".concat(this.clientId,"] receive notification: "),t);const n=qg(t.code);if("success"!==n.action){if("failed"!==n.action)return"quit"===n.action?("ERR_REPEAT_JOIN_CHANNEL"===n.desc&&this.close(Qe.UID_BANNED),void this.close()):void this.reconnect(n.action,ti.SERVER_ERROR);_.error("[".concat(this.clientId,"] ignore error: "),n.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=R("PING_PONG_TIME_OUT"),n=Date.now();this.pingpongTimeoutCount>=t&&(_.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(n-this.lastMsgTime,"ms")),n-this.lastMsgTime>R("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",ti.TIMEOUT):this.request(pe.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const i=Date.now()-n;this.rttRolling.add(i),R("REPORT_STATS")&&this.send(pe.PING_BACK,{pingpongElapse:i})}).catch(i=>{})}handleWebsocketEvents(){this.websocket.on(fe.RECONNECT_WAITTING_FINISH,t=>{this.emit(he.WS_RECONNECT_WAITTING_FINISH,t)}),this.websocket.on(fe.RECONNECT_CREATE_CONNECTION,t=>{this.emit(he.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(fe.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(fe.CLOSED,()=>{this.connectionState=_t.CLOSED}),this.websocket.on(fe.FAILED,()=>{this._disconnectedReason=Qe.NETWORK_ERROR,this.connectionState=_t.CLOSED}),this.websocket.on(fe.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState=this.connectionState===_t.CONNECTED?_t.RECONNECTING:_t.CONNECTING}),this.websocket.on(fe.WILL_RECONNECT,(t,n,i)=>{"retry"!==t?(_.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(t)),this.reconnectToken=void 0):_.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),i(t)}),this.websocket.on(fe.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(t=>{if(this.emit(he.REPORT_JOIN_GATEWAY,t,this.url||""),t instanceof M&&t.code===S.UNEXPECTED_RESPONSE&&t.data.code===ce.ERR_NO_AUTHORIZED)return _.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",ti.SERVER_ERROR);_.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",ti.SERVER_ERROR):(this.initError=t,this.close())})}),this.websocket.on(fe.REQUEST_NEW_URLS,(t,n)=>{ni(this,he.REQUEST_RECOVER,this.multiIpOption).then(t).catch(n)}),this.websocket.on(fe.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(Te.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}var M$={exports:{}};M$.exports=(()=>{var e={8:(i,r,o)=>{o.r(r),o.d(r,{Parser:()=>V,Printer:()=>Dt,parse:()=>F,print:()=>G});const s="\n",a="".concat("\r").concat(s),c=" ";let l;function d(U){return U>="0"&&U<="9"}function u(U){return U>="!"&&U<="~"}function h(U){return u(U)||U>="\x80"&&U<="\xff"}function p(U){return"!"===U||U>="#"&&U<="'"||U>="*"&&U<="+"||U>="-"&&U<="."||U>="0"&&U<="9"||U>="A"&&U<="Z"||U>="^"&&U<="~"}function m(U){return U>="1"&&U<="9"}function f(U){return U>="A"&&U<="Z"||U>="a"&&U<="z"}function g(U){return"d"===U||"h"===U||"m"===U||"s"===U}function E(U){return U>"\x01"&&U<"\t"||U>"\v"&&U<"\f"||U>"\x0e"&&U<"\xff"}function b(U){return f(U)||d(U)||"+"===U||"/"===U}function T(U){return d(U)||f(U)||"+"===U||"/"===U||"-"===U||"_"===U}function I(U){return f(U)||d(U)||"+"===U||"/"===U}function D(U,v){var w=Object.keys(U);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(U);v&&(A=A.filter(function(B){return Object.getOwnPropertyDescriptor(U,B).enumerable})),w.push.apply(w,A)}return w}function O(U){for(var v=1;v<arguments.length;v++){var w=null!=arguments[v]?arguments[v]:{};v%2?D(Object(w),!0).forEach(function(A){k(U,A,w[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(w)):D(Object(w)).forEach(function(A){Object.defineProperty(U,A,Object.getOwnPropertyDescriptor(w,A))})}return U}function k(U,v,w){return v in U?Object.defineProperty(U,v,{value:w,enumerable:!0,configurable:!0,writable:!0}):U[v]=w,U}var U;(U=l||(l={})).VERSION="v",U.ORIGIN="o",U.SESSION_NAME="s",U.INFORMATION="i",U.URI="u",U.EMAIL="e",U.PHONE="p",U.CONNECTION="c",U.BANDWIDTH="b",U.TIME="t",U.REPEAT="r",U.ZONE_ADJUSTMENTS="z",U.KEY="k",U.ATTRIBUTE="a",U.MEDIA="m";class L{consumeText(v,w){let A=w;for(;A<v.length;){const B=v[A];if("\0"===B||"\r"===B||B===s)break;A+=1}if(A-w==0)throw new Error("Invalid text, at ".concat(v));return A}consumeUnicastAddress(v,w,A){return this.consumeTill(v,w,c)}consumeOneOrMore(v,w,A){let B=w;for(;A(v[B]);)B++;if(B-w==0)throw new Error("Invalid rule at ".concat(w,"."));return B}consumeSpace(v,w){if(v[w]===c)return w+1;throw new Error("Invalid space at ".concat(w,"."))}consumeIP4Address(v,w){let A=w;for(let B=0;B<4;B++)if(A=this.consumeDecimalUChar(v,A),3!==B){if("."!==v[A])throw new Error("Invalid IP4 address.");A++}return A}consumeDecimalUChar(v,w){let A=w;for(let ge=0;ge<3&&d(v[A]);ge++,A++);if(A-w==0)throw new Error("Invalid decimal uchar.");const B=parseInt(v.slice(w,A));if(B>=0&&B<=255)return A;throw new Error("Invalid decimal uchar")}consumeIP6Address(v,w){let A=this.consumeHexpart(v,w);return":"===v[A]&&(A+=1,A=this.consumeIP4Address(v,A)),A}consumeHexpart(v,w){let A=w;if(":"===v[A]&&":"===v[A+1]){A+=2;try{A=this.consumeHexseq(v,A)}catch{}return A}if(A=this.consumeHexseq(v,A),":"===v[A]&&":"===v[A+1]){A+=2;try{A=this.consumeHexseq(v,A)}catch{}return A}return A}consumeHexseq(v,w){let A=w;for(;A=this.consumeHex4(v,A),":"===v[A]&&":"!==v[A+1];)A+=1;return A}consumeHex4(v,w){let A=0;for(;A<4;A++)if(!((B=v[w+A])>="0"&&B<="9"||B>="a"&&B<="f"||B>="A"&&B<="F")){if(0===A)throw new Error("Invalid hex 4");break}var B;return w+A}consumeFQDN(v,w){let A=w;for(;d(v[A])||f(v[A])||"-"===v[A]||"."===v[A];)A+=1;if(A-w<4)throw new Error("Invalid FQDN");return A}consumeExtnAddr(v,w){return this.consumeOneOrMore(v,w,h)}consumeMulticastAddress(v,w,A){switch(A){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(v,w);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(v,w);default:try{return this.consumeFQDN(v,w)}catch{return this.consumeExtnAddr(v,w)}}}consumeIP6MulticastAddress(v,w){const A=this.consumeHexpart(v,w);return"/"===v[A]?this.consumeInteger(v,A+1):A}consumeIP4MulticastAddress(v,w){let A=w+3;const B=v.slice(w,A),ge=parseInt(B);if(ge<224||ge>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let Ze=0;Ze<3;Ze++){if("."!==v[A])throw new Error("Invalid IP4 multicast address.");A+=1,A=this.consumeDecimalUChar(v,A)}return"/"===v[A]&&(A+=1),A=this.consumeTTL(v,A),"/"===v[A]&&(A=this.consumeInteger(v,A)),A}consumeInteger(v,w){if(!m(v[w]))throw new Error("Invalid integer.");for(w+=1;d(v[w]);)w+=1;return w}consumeTTL(v,w){if("0"===v[w])return w+1;if(!m(v[w]))throw new Error("Invalid TTL.");w+=1;for(let A=0;A<2&&d(v[w]);A++)w+=1;return w}consumeToken(v,w){return this.consumeOneOrMore(v,w,p)}consumeTime(v,w){let A=w;if("0"===v[A])return A+1;for(m(v[A])&&(A+=1);d(v[A]);)A++;if(A-w<10)throw new Error("Invalid time");return A}consumeAddress(v,w){return this.consumeTill(v,w,c)}consumeTypedTime(v,w){let A=w;return A=this.consumeOneOrMore(v,A,d),g(v[A])?A+1:A}consumeRepeatInterval(v,w){if(!m(v[w]))throw new Error("Invalid repeat interval");for(w+=1;d(v[w]);)w+=1;return g(v[w])&&(w+=1),w}consumePort(v,w){return this.consumeOneOrMore(v,w,d)}consume(v,w,A){for(let B=0;B<A.length;B++){if(w+B>=v.length)throw new Error("consume exceeding value length");if(v[w+B]!==A[B])throw new Error("consume ".concat(A," failed at ").concat(B))}return w+A.length}consumeTill(v,w,A){let B=w;for(;B<v.length&&("string"!=typeof A||v[B]!==A)&&("function"!=typeof A||!A(v[B]));)B++;return B}}class V extends L{constructor(){super(),k(this,"records",[]),k(this,"currentLine",0)}parse(v){const w=this.probeEOL(v);this.records=v.split(w).filter(bn=>!!ki(bn).call(bn)).map(this.parseLine),this.currentLine=0;const A=this.parseVersion(),B=this.parseOrigin(),ge=this.parseSessionName(),Ze=this.parseInformation(),nt=this.parseUri(),jn=this.parseEmail(),si=this.parsePhone(),Ic=this.parseConnection(),kl=this.parseBandWidth(),Vo=this.parseTimeFields(),Ll=this.parseKey(),Zp=this.parseSessionAttribute(),tn=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:A,origin:B,sessionName:ge,information:Ze,uri:nt,emails:jn,phones:si,connection:Ic,bandwidths:kl,timeFields:Vo,key:Ll,attributes:Zp,mediaDescriptions:tn}}getCurrentRecord(){const v=this.records[this.currentLine];if(!v)throw new Error("Record doesn't exit.");return v}probeEOL(v){for(let w=0;w<v.length;w++)if(v[w]===s)return"\r"===v[w-1]?a:s;throw new Error("Invalid newline character.")}parseLine(v,w){if(v.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const A=v[0];if("="!==v[1])throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:A,value:v.slice(2),line:w,cur:0}}parseSessionAttribute(){const v=new oe;for(;this.currentLine<this.records.length;){const w=this.getCurrentRecord();if(w.type!==l.ATTRIBUTE)break;const A={attField:this.extractOneOrMore(w,B=>p(B)&&":"!==B),_cur:0};":"===w.value[w.cur]&&(w.cur+=1,A.attValue=this.extractOneOrMore(w,E)),v.parse(A),this.currentLine++}return v.digest()}parseMediaAttributes(v){const w=new Ie(v);for(;this.currentLine<this.records.length;){const A=this.getCurrentRecord();if(A.type!==l.ATTRIBUTE)break;const B={attField:this.extractOneOrMore(A,ge=>p(ge)&&":"!==ge),_cur:0};":"===A.value[A.cur]&&(A.cur+=1,B.attValue=this.extractOneOrMore(A,E)),w.parse(B),this.currentLine++}return w.digest()}parseKey(){const v=this.getCurrentRecord();if(v.type===l.KEY){if("prompt"===v.value||"clear:"===v.value||"base64:"===v.value||"uri:"===v.value)return v.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const v=this.getCurrentRecord();if(v.type===l.ZONE_ADJUSTMENTS){const w=[];for(;;)try{const A=this.extract(v,this.consumeTime);this.consumeSpaceForRecord(v);let B=!1;"-"===v.value[v.cur]&&(B=!0,v.cur+=1);const ge=this.extract(v,this.consumeTypedTime);w.push({time:A,typedTime:ge,back:B})}catch{break}if(0===w.length)throw new Error("Invalid zone adjustments");return this.currentLine++,w}return[]}parseRepeat(){const v=[];for(;;){const w=this.getCurrentRecord();if(w.type!==l.REPEAT)break;{const A=this.extract(w,this.consumeRepeatInterval),B=this.parseTypedTime(w);v.push({repeatInterval:A,typedTimes:B}),this.currentLine++}}return v}parseTypedTime(v){const w=[];for(;;)try{this.consumeSpaceForRecord(v),w.push(this.extract(v,this.consumeTypedTime))}catch{break}if(0===w.length)throw new Error("Invalid typed time.");return w}parseTime(){const v=this.getCurrentRecord(),w=this.extract(v,this.consumeTime);this.consumeSpaceForRecord(v);const A=this.extract(v,this.consumeTime);return this.currentLine++,{startTime:w,stopTime:A}}parseBandWidth(){const v=[];for(;this.currentLine<this.records.length;){const w=this.getCurrentRecord();if(w.type!==l.BANDWIDTH)break;{const A=this.extractOneOrMore(w,p);if(":"!==w.value[w.cur])throw new Error("Invalid bandwidth field.");w.cur++;const B=this.extractOneOrMore(w,d);v.push({bwtype:A,bandwidth:B}),this.currentLine++}}return v}parseVersion(){const v=this.getCurrentRecord();if(v.type!==l.VERSION)throw new Error("first sdp record must be version");const w=v.value.slice(0,this.consumeOneOrMore(v.value,0,d));if(w.length!==v.value.length)throw new Error('invalid proto version, "v='.concat(v.value,'"'));return this.currentLine++,w}parseOrigin(){const v=this.getCurrentRecord();if(v.type!==l.ORIGIN)throw new Error("second line of sdp must be origin");const w=this.extractOneOrMore(v,h);this.consumeSpaceForRecord(v);const A=this.extractOneOrMore(v,d);this.consumeSpaceForRecord(v);const B=this.extractOneOrMore(v,d);this.consumeSpaceForRecord(v);const ge=this.extractOneOrMore(v,p);this.consumeSpaceForRecord(v);const Ze=this.extractOneOrMore(v,p);this.consumeSpaceForRecord(v);const nt=this.extract(v,this.consumeUnicastAddress);return this.currentLine++,{username:w,sessId:A,sessVersion:B,nettype:ge,addrtype:Ze,unicastAddress:nt}}parseSessionName(){const v=this.getCurrentRecord();if(v.type===l.SESSION_NAME){const w=this.extract(v,this.consumeText);return this.currentLine++,w}}parseInformation(){const v=this.getCurrentRecord();if(v.type!==l.INFORMATION)return;const w=this.extract(v,this.consumeText);return this.currentLine++,w}parseUri(){const v=this.getCurrentRecord();if(v.type===l.URI)return this.currentLine++,v.value}parseEmail(){const v=[];for(;;){const w=this.getCurrentRecord();if(w.type!==l.EMAIL)break;v.push(w.value),this.currentLine++}return v}parsePhone(){const v=[];for(;;){const w=this.getCurrentRecord();if(w.type!==l.PHONE)break;v.push(w.value),this.currentLine++}return v}parseConnection(){const v=this.getCurrentRecord();if(v.type===l.CONNECTION){const w=this.extractOneOrMore(v,p);this.consumeSpaceForRecord(v);const A=this.extractOneOrMore(v,p);this.consumeSpaceForRecord(v);const B=this.extract(v,this.consumeAddress);return this.currentLine++,{nettype:w,addrtype:A,address:B}}}parseMedia(){const v=this.getCurrentRecord(),w=this.extract(v,this.consumeToken);this.consumeSpaceForRecord(v);let A=this.extract(v,this.consumePort);"/"===v.value[v.cur]&&(v.cur+=1,A+=this.extract(v,this.consumeInteger)),this.consumeSpaceForRecord(v);const B=[];for(B.push(this.extract(v,this.consumeToken));"/"===v.value[v.cur];)v.cur+=1,B.push(this.extract(v,this.consumeToken));if(0===B.length)throw new Error("Invalid proto");const ge=this.parseFmt(v);return this.currentLine++,{mediaType:w,port:A,protos:B,fmts:ge}}parseTimeFields(){const v=[];for(;this.getCurrentRecord().type===l.TIME;){const w=this.parseTime(),A=this.parseRepeat(),B=this.parseZone();v.push({time:w,repeats:A,zones:B})}return v}parseMediaDescription(){const v=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===l.MEDIA;){const w=this.parseMedia(),A=this.parseInformation(),B=this.parseConnections(),ge=this.parseBandWidth(),Ze=this.parseKey(),nt=this.parseMediaAttributes(w);v.push({media:w,information:A,connections:B,bandwidths:ge,key:Ze,attributes:nt})}return v}parseConnections(){const v=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===l.CONNECTION;)v.push(this.parseConnection());return v}parseFmt(v){const w=[];for(;;)try{this.consumeSpaceForRecord(v),w.push(this.extract(v,this.consumeToken))}catch{break}if(0===w.length)throw new Error("Invalid fmts");return w}extract(v,w){for(var A=arguments.length,B=new Array(A>2?A-2:0),ge=2;ge<A;ge++)B[ge-2]=arguments[ge];const Ze=w.call(this,v.value,v.cur,...B),nt=v.value.slice(v.cur,Ze);return v.cur=Ze,nt}extractOneOrMore(v,w){const A=this.consumeOneOrMore(v.value,v.cur,w),B=v.value.slice(v.cur,A);return v.cur=A,B}consumeSpaceForRecord(v){if(v.value[v.cur]!==c)throw new Error("Invalid space at ".concat(v.cur,"."));v.cur+=1}}class ee extends L{constructor(){super(...arguments),k(this,"attributes",void 0),k(this,"digested",!1)}extractOneOrMore(v,w,A){const B=this.consumeOneOrMore(v.attValue,v._cur,w),ge=v.attValue.slice(v._cur,B),[Ze,nt]=A||[];if("number"==typeof Ze&&ge.length<Ze)throw new Error("error in length, should be more or equal than ".concat(Ze," characters."));if("number"==typeof nt&&ge.length>nt)throw new Error("error in length, should be less or equal than ".concat(nt," characters."));return v._cur=B,ge}consumeAttributeSpace(v){if(v.attValue[v._cur]!==c)throw new Error("Invalid space at ".concat(v._cur,"."));v._cur+=1}extract(v,w){if(!v.attValue)throw new Error("Nothing to extract from attValue.");for(var A=arguments.length,B=new Array(A>2?A-2:0),ge=2;ge<A;ge++)B[ge-2]=arguments[ge];const Ze=w.call(this,v.attValue,v._cur,...B),nt=v.attValue.slice(v._cur,Ze);return v._cur=Ze,nt}atEnd(v){if(!v.attValue)throw new Error;return v._cur>=v.attValue.length}peekChar(v){if(!v.attValue)throw new Error;return v.attValue[v._cur]}peek(v,w){if(!v.attValue)throw new Error;for(let A=0;A<w.length;A++)if(w[A]!==v.attValue[v._cur+A])return!1;return!0}parseIceUfrag(v){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(v,b,[4,256])}parseIcePwd(v){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(v,b,[22,256])}parseIceOptions(v){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const w=[];for(;!this.atEnd(v);){w.push(this.extractOneOrMore(v,b));try{this.consumeAttributeSpace(v)}catch(A){if(this.atEnd(v))break;throw A}}this.attributes.iceOptions=w}parseFingerprint(v){const w=this.extract(v,this.consumeToken);this.consumeAttributeSpace(v);const A=this.extract(v,this.consumeTill);this.attributes.fingerprints.push({hashFunction:w,fingerprint:A})}parseExtmap(v){const w=this.extractOneOrMore(v,d);let A;"/"===this.peekChar(v)&&(this.extract(v,this.consume,"/"),A=this.extract(v,this.consumeToken)),this.consumeAttributeSpace(v);const B=this.extract(v,this.consumeTill,c),ge=O(O({entry:parseInt(w,10)},A&&{direction:A}),{},{extensionName:B});this.peekChar(v)===c&&(this.consumeAttributeSpace(v),ge.extensionAttributes=this.extract(v,this.consumeTill)),this.attributes.extmaps.push(ge)}parseSetup(v){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const w=this.extract(v,this.consumeTill);if("active"!==w&&"passive"!==w&&"actpass"!==w&&"holdconn"!==w)throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=w}}class oe extends ee{constructor(){super(...arguments),k(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(v){if(this.digested)throw new Error("already digested");try{switch(v.attField){case"group":this.parseGroup(v);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(v);break;case"ice-pwd":this.parseIcePwd(v);break;case"ice-options":this.parseIceOptions(v);break;case"fingerprint":this.parseFingerprint(v);break;case"setup":this.parseSetup(v);break;case"tls-id":this.parseTlsId(v);break;case"identity":this.parseIdentity(v);break;case"extmap":this.parseExtmap(v);break;case"msid-semantic":this.parseMsidSemantic(v);break;default:v.ignored=!0,this.attributes.unrecognized.push(v)}}catch(w){throw console.error("parsing session attribute ".concat(v.attField,' error, "a=').concat(v.attField,":").concat(v.attValue,'"')),w}if(!v.ignored&&v.attValue&&!this.atEnd(v))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(v){const w=this.extract(v,this.consumeToken),A=[];for(;!this.atEnd(v)&&this.peekChar(v)===c;)this.consumeAttributeSpace(v),A.push(this.extract(v,this.consumeToken));this.attributes.groups.push({semantic:w,identificationTag:A})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(v){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(v,T)}parseIdentity(v){const w=this.extractOneOrMore(v,I),A=[];for(;!this.atEnd(v)&&this.peekChar(v)===c;){this.consumeAttributeSpace(v);const B=this.extract(v,this.consumeToken);this.extract(v,this.consume,"=");const ge=this.extractOneOrMore(v,Ze=>Ze!==c&&E(Ze));A.push({name:B,value:ge})}this.attributes.identities.push({assertionValue:w,extensions:A})}parseMsidSemantic(v){this.peekChar(v)===c&&this.consumeAttributeSpace(v);const w={semantic:this.extract(v,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(v)}catch{break}if("*"===this.peekChar(v)){this.extract(v,this.consume,"*"),w.applyForAll=!0;break}{const A=this.extract(v,this.consumeTill,c);w.identifierList.push(A)}}this.attributes.msidSemantic=w}}class Ie extends ee{constructor(v){super(),k(this,"attributes",void 0),-1!==v.protos.indexOf("RTP")||v.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(v){if(this.digested)throw new Error("already digested");try{switch(v.attField){case"extmap":this.parseExtmap(v);break;case"setup":this.parseSetup(v);break;case"ice-ufrag":this.parseIceUfrag(v);break;case"ice-pwd":this.parseIcePwd(v);break;case"ice-options":this.parseIceOptions(v);break;case"candidate":this.parseCandidate(v);break;case"remote-candidate":this.parseRemoteCandidate(v);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(v);break;case"rtpmap":this.parseRtpmap(v);break;case"ptime":this.parsePtime(v);break;case"maxptime":this.parseMaxPtime(v);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(v);break;case"ssrc":this.parseSSRC(v);break;case"fmtp":this.parseFmtp(v);break;case"rtcp-fb":this.parseRtcpFb(v);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(v);break;case"mid":this.parseMid(v);break;case"msid":this.parseMsid(v);break;case"imageattr":this.parseImageAttr(v);break;case"rid":this.parseRid(v);break;case"simulcast":this.parseSimulcast(v);break;case"sctp-port":this.parseSctpPort(v);break;case"max-message-size":this.parseMaxMessageSize(v);break;case"ssrc-group":this.parseSSRCGroup(v);break;default:v.ignored=!0,this.attributes.unrecognized.push(v)}}catch(w){throw console.error("parsing media attribute ".concat(v.attField,' error, "a=').concat(v.attField,":").concat(v.attValue,'"')),w}if(!v.ignored&&v.attValue&&!this.atEnd(v))throw new Error("attribute parsing error")}parseCandidate(v){const w=this.extractOneOrMore(v,b,[1,32]);this.consumeAttributeSpace(v);const A=this.extractOneOrMore(v,d,[1,5]);this.consumeAttributeSpace(v);const B=this.extract(v,this.consumeToken);this.consumeAttributeSpace(v);const ge=this.extractOneOrMore(v,d,[1,10]);this.consumeAttributeSpace(v);const Ze=this.extract(v,this.consumeAddress);this.consumeAttributeSpace(v);const nt=this.extract(v,this.consumePort);this.consumeAttributeSpace(v),this.extract(v,this.consume,"typ"),this.consumeAttributeSpace(v);const jn={foundation:w,componentId:A,transport:B,priority:ge,connectionAddress:Ze,port:nt,type:this.extract(v,this.consumeToken),extension:{}};for(this.peek(v," raddr")&&(this.extract(v,this.consume," raddr"),this.consumeAttributeSpace(v),jn.relAddr=this.extract(v,this.consumeAddress)),this.peek(v," rport")&&(this.extract(v,this.consume," rport"),this.consumeAttributeSpace(v),jn.relPort=this.extract(v,this.consumePort));this.peekChar(v)===c;){this.consumeAttributeSpace(v);const si=this.extract(v,this.consumeToken);this.consumeAttributeSpace(v),jn.extension[si]=this.extractOneOrMore(v,u)}this.attributes.candidates.push(jn)}parseRemoteCandidate(v){const w=[];for(;;){const A=this.extractOneOrMore(v,d,[1,5]);this.consumeAttributeSpace(v);const B=this.extract(v,this.consumeAddress);this.consumeAttributeSpace(v);const ge=this.extract(v,this.consumePort);w.push({componentId:A,connectionAddress:B,port:ge});try{this.consumeAttributeSpace(v)}catch{break}}this.attributes.remoteCandidatesList.push(w)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(v){const w=this.extract(v,this.consumeToken);this.consumeAttributeSpace(v);const A=this.extract(v,this.consumeTill,"/");this.extract(v,this.consume,"/");const B={encodingName:A,clockRate:this.extractOneOrMore(v,d)};this.atEnd(v)||"/"!==this.peekChar(v)||(this.extract(v,this.consume,"/"),B.encodingParameters=parseInt(this.extract(v,this.consumeTill),10));const ge=this.attributes.payloads.find(Ze=>Ze.payloadType===parseInt(w,10));ge?ge.rtpMap=B:this.attributes.payloads.push({payloadType:parseInt(w,10),rtpMap:B,rtcpFeedbacks:[]})}parsePtime(v){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(v,this.consumeTill)}parseMaxPtime(v){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(v,this.consumeTill)}parseDirection(v){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=v.attField}parseSSRC(v){const w=this.extractOneOrMore(v,d);this.consumeAttributeSpace(v);const A=this.extract(v,this.consumeTill,":");let B;":"===this.peekChar(v)&&(this.extract(v,this.consume,":"),B=this.extract(v,this.consumeTill));const ge=this.attributes.ssrcs.find(Ze=>Ze.ssrcId===parseInt(w,10));ge?ge.attributes[A]=B:this.attributes.ssrcs.push({ssrcId:parseInt(w,10),attributes:{[A]:B}})}parseFmtp(v){const w=this.extract(v,this.consumeTill,c);this.consumeAttributeSpace(v);const A=this.extract(v,this.consumeTill),B={};A.split(";").forEach(Ze=>{let[nt,jn]=Ze.split("=");nt=ki(nt).call(nt);const si="string"==typeof jn?ki(jn).call(jn):null;"string"==typeof nt&&nt.length>0&&(B[nt]=si)});const ge=this.attributes.payloads.find(Ze=>Ze.payloadType===parseInt(w,10));ge?ge.fmtp={parameters:B}:this.attributes.payloads.push({payloadType:parseInt(w,10),rtcpFeedbacks:[],fmtp:{parameters:B}})}parseFmtParameters(v){const w={},A=this.extract(v,this.consumeTill,"=");v._cur++;const B=this.extract(v,this.consumeTill,";");for(w[A]=B;";"===v.attValue[v._cur];){const ge=this.extract(v,this.consumeTill,"=");v._cur++;const Ze=this.extract(v,this.consumeTill,";");w[ge]=Ze}return w}parseRtcpFb(v){let w="";w="*"===this.peekChar(v)?this.extract(v,this.consume,"*"):this.extract(v,this.consumeTill,c),this.consumeAttributeSpace(v);const A=this.extract(v,this.consumeTill,c);let B;if("trr-int"===A)B={type:A,interval:this.extract(v,this.consumeTill)};else{const ge={type:A};this.peekChar(v)===c&&(this.consumeAttributeSpace(v),ge.parameter=this.extract(v,this.consumeToken),this.peekChar(v)===c&&(ge.additional=this.extract(v,this.consumeTill))),B=ge}if("*"===w)this.attributes.rtcpFeedbackWildcards.push(B);else{const ge=this.attributes.payloads.find(Ze=>Ze.payloadType===parseInt(w,10));ge?ge.rtcpFeedbacks.push(B):this.attributes.payloads.push({payloadType:parseInt(w,10),rtcpFeedbacks:[B]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(v){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const w={port:this.extract(v,this.consumePort)};this.peekChar(v)===c&&(this.consumeAttributeSpace(v),w.netType=this.extractOneOrMore(v,p),this.consumeAttributeSpace(v),w.addressType=this.extractOneOrMore(v,p),this.consumeAttributeSpace(v),w.address=this.extract(v,this.consumeAddress)),this.attributes.rtcp=w}parseMsid(v){const w={id:this.extractOneOrMore(v,p,[1,64])};this.peekChar(v)===c&&(this.consumeAttributeSpace(v),w.appdata=this.extractOneOrMore(v,p,[1,64])),this.attributes.msids.push(w)}parseImageAttr(v){this.attributes.imageattr.push(v.attValue)}parseRid(v){const w=this.extractOneOrMore(v,B=>f(B)||d(B)||"_"===B||"-"===B);this.consumeAttributeSpace(v);const A={id:w,direction:this.extract(v,this.consumeToken),params:[]};if(this.peekChar(v)===c){if(this.consumeAttributeSpace(v),this.peek(v,"pt=")){this.extract(v,this.consume,"pt=");const B=[];for(;;){const ge=this.extract(v,this.consumeToken);B.push(ge);try{this.extract(v,this.consume,",")}catch{break}}A.payloads=B,this.peekChar(v)===c&&this.extract(v,this.consume,c)}for(;;){const B=this.extract(v,this.consumeToken);switch(B){case"depend":{const ge={type:B,rids:this.extract(v,this.consume,"=").split(",")};A.params.push(ge);break}default:{const ge={type:B};"="===this.peekChar(v)&&(this.extract(v,this.consume,"="),ge.val=this.extract(v,this.consumeTill,";")),A.params.push(ge)}}try{this.extract(v,this.consume,";")}catch{break}}}this.attributes.rids.push(A)}parseSimulcast(v){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=v.attValue,this.extract(v,this.consumeTill)}parseSctpPort(v){this.attributes.sctpPort=this.extractOneOrMore(v,d,[1,5])}parseMaxMessageSize(v){this.attributes.maxMessageSize=this.extractOneOrMore(v,d,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(v){this.attributes.mid=this.extract(v,this.consumeToken)}parseSSRCGroup(v){const w=this.extract(v,this.consumeToken),A=[];for(;;)try{this.consumeAttributeSpace(v);const B=this.extract(v,this.consumeInteger);A.push(parseInt(B,10))}catch{break}this.attributes.ssrcGroups.push({semantic:w,ssrcIds:A})}}function Ue(U,v,w){return v in U?Object.defineProperty(U,v,{value:w,enumerable:!0,configurable:!0,writable:!0}):U[v]=w,U}class Dt{constructor(){Ue(this,"eol",a)}print(v,w){let A="";return w&&(this.eol=w),A+=this.printVersion(v.version),A+=this.printOrigin(v.origin),A+=this.printSessionName(v.sessionName),A+=this.printInformation(v.information),A+=this.printUri(v.uri),A+=this.printEmail(v.emails),A+=this.printPhone(v.phones),A+=this.printConnection(v.connection),A+=this.printBandwidth(v.bandwidths),A+=this.printTimeFields(v.timeFields),A+=this.printKey(v.key),A+=this.printSessionAttributes(v.attributes),A+=this.printMediaDescription(v.mediaDescriptions),A}printVersion(v){return"v=".concat(v).concat(this.eol)}printOrigin(v){return"o=".concat(v.username," ").concat(v.sessId," ").concat(v.sessVersion," ").concat(v.nettype," ").concat(v.addrtype," ").concat(v.unicastAddress).concat(this.eol)}printSessionName(v){return v?"s=".concat(v).concat(this.eol):""}printInformation(v){return v?"i=".concat(v).concat(this.eol):""}printUri(v){return v?"u=".concat(v).concat(this.eol):""}printEmail(v){let w="";for(const A of v)w+="e=".concat(A).concat(this.eol);return w}printPhone(v){let w="";for(const A of v)w+="e=".concat(A).concat(this.eol);return w}printConnection(v){return v?"c=".concat(v.nettype," ").concat(v.addrtype," ").concat(v.address).concat(this.eol):""}printBandwidth(v){let w="";for(const A of v)w+="b=".concat(A.bwtype,":").concat(A.bandwidth).concat(this.eol);return w}printTimeFields(v){let w="";for(const A of v){w+="t=".concat(A.time.startTime," ").concat(A.time.startTime).concat(this.eol);for(const B of A.repeats)w+="r=".concat(B.repeatInterval," ").concat(B.typedTimes.join(" ")).concat(this.eol);A.zoneAdjustments&&(w+="z=",w+="z=".concat(A.zoneAdjustments.map(B=>"".concat(B.time," ").concat(B.back?"-":""," ").concat(B.typedTime)).join(" ")).concat(this.eol),w+=this.eol)}return w}printKey(v){return v?"k=".concat(v).concat(this.eol):""}printAttributes(v){let w="";for(const A of v)w+="a=".concat(A.attField).concat(A.attValue?":".concat(A.attValue):"").concat(this.eol);return w}printMediaDescription(v){let w="";for(const A of v)w+=this.printMedia(A.media),w+=this.printInformation(A.information),w+=this.printConnections(A.connections),w+=this.printBandwidth(A.bandwidths),w+=this.printKey(A.key),w+=this.printMediaAttributes(A);return w}printConnections(v){let w="";for(const A of v)w+=this.printConnection(A);return w}printMedia(v){return"m=".concat(v.mediaType," ").concat(v.port," ").concat(v.protos.join("/")," ").concat(v.fmts.join(" ")).concat(this.eol)}printSessionAttributes(v){return new me(this.eol).print(v)}printMediaAttributes(v){return new P(this.eol).print(v)}}class dt{constructor(v){Ue(this,"eol",void 0),this.eol=v}printIceUfrag(v){return void 0===v?"":"a=ice-ufrag:".concat(v).concat(this.eol)}printIcePwd(v){return void 0===v?"":"a=ice-pwd:".concat(v).concat(this.eol)}printIceOptions(v){return void 0===v?"":"a=ice-options:".concat(v.join(c)).concat(this.eol)}printFingerprints(v){return v.length>0?v.map(w=>"a=fingerprint:".concat(w.hashFunction).concat(c).concat(w.fingerprint)).join(this.eol)+this.eol:""}printExtmap(v){return v.map(w=>"a=extmap:".concat(w.entry).concat(w.direction?"/".concat(w.direction):"").concat(c).concat(w.extensionName).concat(w.extensionAttributes?"".concat(c).concat(w.extensionAttributes):"").concat(this.eol)).join("")}printSetup(v){return void 0===v?"":"a=setup:".concat(v).concat(this.eol)}printUnrecognized(v){return v.map(w=>"a=".concat(w.attField).concat(w.attValue?":".concat(w.attValue):"").concat(this.eol)).join("")}}class me extends dt{print(v){let w="";return w+=this.printGroups(v.groups),w+=this.printMsidSemantic(v.msidSemantic),w+=this.printIceLite(v.iceLite),w+=this.printIceUfrag(v.iceUfrag),w+=this.printIcePwd(v.icePwd),w+=this.printIceOptions(v.iceOptions),w+=this.printFingerprints(v.fingerprints),w+=this.printSetup(v.setup),w+=this.printTlsId(v.tlsId),w+=this.printIdentity(v.identities),w+=this.printExtmap(v.extmaps),w+=this.printUnrecognized(v.unrecognized),w}printGroups(v){let w="";return v.length>0&&(w+=v.map(A=>"a=group:".concat(A.semantic).concat(A.identificationTag.map(B=>"".concat(c).concat(B)).join("")).concat(this.eol)).join("")),w}printIceLite(v){return void 0===v?"":"a=ice-lite"+this.eol}printTlsId(v){return v?"a=tls-id:".concat(v).concat(this.eol):""}printIdentity(v){return 0===v.length?"":v.map(w=>"a=identity:".concat(w.assertionValue).concat(w.extensions.map(A=>"".concat(c).concat(A.name).concat(A.value?"=".concat(A.value):"")))).join(this.eol)+this.eol}printMsidSemantic(v){if(!v)return"";let w="a=msid-semantic:".concat(v.semantic);return v.applyForAll?w+="".concat(c,"*"):v.identifierList.length>0&&(w+=v.identifierList.map(A=>"".concat(c).concat(A))),w+this.eol}}class P extends dt{print(v){const w=v.attributes;let A="";return A+=this.printRTCP(w.rtcp),A+=this.printIceUfrag(w.iceUfrag),A+=this.printIcePwd(w.icePwd),A+=this.printIceOptions(w.iceOptions),A+=this.printCandidates(w.candidates),A+=this.printRemoteCandidatesList(w.remoteCandidatesList),A+=this.printEndOfCandidates(w.endOfCandidates),A+=this.printFingerprints(w.fingerprints),A+=this.printSetup(w.setup),A+=this.printMid(w.mid),A+=this.printExtmap(w.extmaps),A+=this.printRTPRelated(w),A+=this.printPtime(w.ptime),A+=this.printMaxPtime(w.maxPtime),A+=this.printDirection(w.direction),A+=this.printSSRCGroups(w.ssrcGroups),A+=this.printSSRC(w.ssrcs),A+=this.printRTCPMux(w.rtcpMux),A+=this.printRTCPMuxOnly(w.rtcpMuxOnly),A+=this.printRTCPRsize(w.rtcpRsize),A+=this.printMSId(w.msids),A+=this.printImageattr(w.imageattr),A+=this.printRid(w.rids),A+=this.printSimulcast(w.simulcast),A+=this.printSCTPPort(w.sctpPort),A+=this.printMaxMessageSize(w.maxMessageSize),A+=this.printUnrecognized(w.unrecognized),A}printCandidates(v){return v.map(w=>"a=candidate:".concat(w.foundation).concat(c).concat(w.componentId).concat(c).concat(w.transport).concat(c).concat(w.priority).concat(c).concat(w.connectionAddress).concat(c).concat(w.port).concat(c,"typ").concat(c).concat(w.type).concat(w.relAddr?"".concat(c,"raddr").concat(c).concat(w.relAddr):"").concat(w.relPort?"".concat(c,"rport").concat(c).concat(w.relPort):"").concat(Object.keys(w.extension).map(A=>"".concat(c).concat(A).concat(c).concat(w.extension[A])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(v){return v.map(w=>"a=remote-candidates:".concat(w.join(c)).concat(this.eol)).join("")}printEndOfCandidates(v){return void 0===v?"":"a=end-of-candidates"+this.eol}printRTPRelated(v){if(!v.payloads)return"";const w=v.payloads;let A="";A+=v.rtcpFeedbackWildcards.map(B=>this.printRTCPFeedback("*",B)).join("");for(const B of w)A+=this.printRtpMap(B.payloadType,B.rtpMap),A+=this.printFmtp(B.payloadType,B.fmtp),A+=B.rtcpFeedbacks.map(ge=>this.printRTCPFeedback(B.payloadType,ge)).join("");return A}printFmtp(v,w){if(!w)return"";const A=Object.keys(w.parameters);return 1===A.length&&null===w.parameters[A[0]]?"a=fmtp:".concat(v).concat(c).concat(A[0]).concat(this.eol):"a=fmtp:".concat(v).concat(c).concat(Object.keys(w.parameters).map(B=>"".concat(B,"=").concat(w.parameters[B])).join(";")).concat(this.eol)}printRtpMap(v,w){return w?"a=rtpmap:".concat(v).concat(c).concat(w.encodingName,"/").concat(w.clockRate).concat(w.encodingParameters?"/".concat(w.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(v,w){let A="a=rtcp-fb:".concat(v).concat(c),B=w;return"trr-int"===B.type?A+="ttr-int".concat(c).concat(B.interval):(A+="".concat(B.type),B.parameter&&(A+="".concat(c).concat(B.parameter),B.additional&&(A+="".concat(c).concat(B.additional)))),A+this.eol}printPtime(v){return void 0===v?"":"a=ptime:".concat(v).concat(this.eol)}printMaxPtime(v){return void 0===v?"":"a=maxptime:".concat(v).concat(this.eol)}printDirection(v){return void 0===v?"":"a=".concat(v).concat(this.eol)}printSSRC(v){return v.map(w=>Object.keys(w.attributes).map(A=>"a=ssrc:".concat(w.ssrcId.toString(10)).concat(c).concat(A).concat(w.attributes[A]?":".concat(w.attributes[A]):"").concat(this.eol)).join("")).join("")}printRTCPMux(v){return void 0===v?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(v){return void 0===v?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(v){return void 0===v?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(v){if(void 0===v)return"";let w="a=rtcp:".concat(v.port);return v.netType&&(w+="".concat(c).concat(v.netType)),v.addressType&&(w+="".concat(c).concat(v.addressType)),v.address&&(w+="".concat(c).concat(v.address)),w+this.eol}printMSId(v){return v.map(w=>"a=msid:".concat(w.id).concat(w.appdata?"".concat(c).concat(w.appdata):"").concat(this.eol)).join("")}printImageattr(v){return v.map(w=>"a=imageattr:".concat(w).concat(this.eol)).join("")}printRid(v){return v.map(w=>{let A="a=rid:".concat(w.id).concat(c).concat(w.direction);return w.payloads&&(A+="".concat(c,"pt=").concat(w.payloads.join(","))),w.params.length>0&&(A+="".concat(c).concat(w.params.map(B=>"depend"===B.type?"depend=".concat(B.rids.join(",")):"".concat(B.type,"=").concat(B.val)).join(";"))),A+this.eol}).join("")}printSimulcast(v){return void 0===v?"":"a=simulcast:".concat(v).concat(this.eol)}printSCTPPort(v){return void 0===v?"":"a=sctp-port:".concat(v).concat(this.eol)}printMaxMessageSize(v){return void 0===v?"":"a=max-message-size:".concat(v).concat(this.eol)}printMid(v){return void 0===v?"":"a=mid:".concat(v).concat(this.eol)}printSSRCGroups(v){return v.map(w=>"a=ssrc-group:".concat(w.semantic).concat(w.ssrcIds.map(A=>"".concat(c).concat(A.toString(10))).join("")).concat(this.eol)).join("")}}function F(U){return(new V).parse(U)}function G(U,v){return(new Dt).print(U,v)}}},t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}return n.d=(i,r)=>{for(var o in r)n.o(r,o)&&!n.o(i,o)&&Object.defineProperty(i,o,{enumerable:!0,get:r[o]})},n.o=(i,r)=>Object.prototype.hasOwnProperty.call(i,r),n.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n(8)})();var Zn=M$.exports;function mM(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R("SVC_MODE");if(R("ENABLE_SVC"))return function(t){return t in gP}(e)?e:gP.L1T3}function x$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function k$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x$(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x$(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function i_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;const{filterRTX:r,filterVideoFec:o,filterAudioFec:s,filterAudioCodec:a,filterVideoCodec:c}=t,{useXR:l}=n;let d=[],u=[],h=[],p=[],m=!1,f=!1;if(Zn.parse(e).mediaDescriptions.forEach(E=>{i&&i!==E.attributes.direction||("video"!==E.media.mediaType||m||(u=E.attributes.payloads,p=E.attributes.extmaps,m=!0),"audio"!==E.media.mediaType||f||(d=E.attributes.payloads,h=E.attributes.extmaps,f=!0))}),!p||0===u.length)throw new Error("Cannot get video capabilities from SDP.");if(!h||0===d.length)throw new Error("Cannot get audio capabilities from SDP.");if(u.forEach(E=>{var b;null!==(b=E.rtpMap)&&void 0!==b&&b.clockRate&&(E.rtpMap.clockRate=parseInt(E.rtpMap.clockRate)),l&&E.rtcpFeedbacks.push({type:"rrtr"})}),d.forEach(E=>{var b;null!==(b=E.rtpMap)&&void 0!==b&&b.clockRate&&(E.rtpMap.clockRate=parseInt(E.rtpMap.clockRate)),l&&E.rtcpFeedbacks.push({type:"rrtr"})}),r&&(d=d.filter(E=>{var b;return"rtx"!==(null===(b=E.rtpMap)||void 0===b?void 0:b.encodingName.toLowerCase())}),u=u.filter(E=>{var b;return"rtx"!==(null===(b=E.rtpMap)||void 0===b?void 0:b.encodingName.toLowerCase())})),o&&(u=u.filter(E=>{var b;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(b=E.rtpMap)||void 0===b?void 0:b.encodingName)||"")})),s&&(d=d.filter(E=>{var b;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(b=E.rtpMap)||void 0===b?void 0:b.encodingName)||"")})),a&&a?.length>0&&(d=d.filter(E=>{var b;return Y(a).call(a,(null===(b=E.rtpMap)||void 0===b?void 0:b.encodingName.toLowerCase())||"")})),c&&c?.length>0){const E=u.filter(b=>{var T;return Y(c).call(c,(null===(T=b.rtpMap)||void 0===T?void 0:T.encodingName.toLowerCase())||"")});u=E.concat(r?[]:EM(E,u))}const g=R("UNSUPPORTED_VIDEO_CODEC");return g&&g.length>0&&(u=u.filter(E=>!(E.rtpMap&&Y(g).call(g,E.rtpMap.encodingName.toLowerCase())))),{audioCodecs:d,videoCodecs:u,audioExtensions:h,videoExtensions:p}}function Cl(e){const t=Zn.parse(e);let n,i;for(const r of t.mediaDescriptions){if(!n){const o=r.attributes.iceUfrag,s=r.attributes.icePwd;if(!o||!s)throw new Error("Cannot get iceUfrag or icePwd from SDP.");n={iceUfrag:o,icePwd:s}}if(!i){const o=r.attributes.fingerprints;o.length>0&&(i={fingerprints:o})}}if(!i&&t.attributes.fingerprints.length>0&&(i={fingerprints:t.attributes.fingerprints}),!i||!n)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:n,dtlsParameters:i}}function L$(e,t){const n=[],i=e.attributes.ssrcGroups.filter(s=>"FID"===s.semantic),r=e.attributes.ssrcGroups.find(s=>"SIM"===s.semantic),o=e.attributes.ssrcs;if(r)r.ssrcIds.forEach(s=>{var a;const c=null===(a=i.find(l=>l.ssrcIds[0]===s))||void 0===a?void 0:a.ssrcIds[1];n.push({ssrcId:s,rtx:t?c:void 0})});else if(i.length>0)n.push({ssrcId:i[0].ssrcIds[0],rtx:t?i[0].ssrcIds[1]:void 0});else{if(0===o.length)throw new Error("No ssrcs found on local media description.");n.push({ssrcId:o[0].ssrcId})}return n}function F$(e,t,n){const{cname:i}=e;let r=[];t&&(r=U$(t)),0===r.length&&(r=e.iceParameters.candidates.map(d=>({foundation:d.foundation,componentId:"1",transport:d.protocol,priority:d.priority.toString(),connectionAddress:d.ip,port:d.port.toString(),type:d.type,extension:{}})),_.debug("Using candidates from gateway."));const o={fingerprints:e.dtlsParameters.fingerprints.map(d=>({hashFunction:d.algorithm,fingerprint:d.fingerprint}))},s={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let a;switch(e.dtlsParameters.role){case"server":a="passive";break;case"client":a="active";break;case"auto":a="actpass"}const c=cC(e.rtpCapabilities),l=[];return Array.isArray(n)&&n.length>0&&n.forEach(d=>{l.push({kind:ie.VIDEO,ssrcId:d.v,rtx:d.v_rtx,mslabel:"".concat(d.v,"_").concat(d.a)},{kind:ie.AUDIO,ssrcId:d.a,mslabel:"".concat(d.v,"_").concat(d.a)})}),{dtlsParameters:o,iceParameters:s,candidates:r,rtpCapabilities:c,setup:a,cname:i,preSSRCs:l}}function U$(e){let t=[];return e.ip&&"number"==typeof e.port&&(t=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip,port:e.port.toString(),type:"host",extension:{}}],_.debug("Using remote candidate from AP ".concat(e.ip,":").concat(e.port)),e.ip6&&(t.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip6,port:e.port.toString(),type:"host",extension:{}}),_.debug("Using IPV6 remote candidate from AP ".concat(e.ip6,":").concat(e.port)))),t}function Wd(e,t,n){const i=[],r=[];return e.forEach(o=>{let{ssrcId:s,rtx:a}=o;const c=gt(8,"track-"),l={ssrcId:s,attributes:k$({label:c,mslabel:n=n||gt(10,""),msid:"".concat(n," ").concat(c)},t&&{cname:t})};if(i.push(l),void 0!==a){const d={ssrcId:a,attributes:k$({label:c,mslabel:n,msid:"".concat(n," ").concat(c)},t&&{cname:t})};i.push(d),r.push({semantic:"FID",ssrcIds:[s,a]})}}),e.length>1&&r.push({semantic:"SIM",ssrcIds:e.map(o=>{let{ssrcId:s}=o;return s})}),{ssrcs:i,ssrcGroups:r}}function Lp(e,t){t instanceof Ht&&e.attributes.payloads.forEach(n=>{var i;const r=null===(i=n.rtpMap)||void 0===i?void 0:i.encodingName.toLowerCase();if(!r||-1===["opus","pcmu","pcma","g722"].indexOf(r))return;n.fmtp||(n.fmtp={parameters:{}}),n.fmtp.parameters.minptime="10",n.fmtp.parameters.useinbandfec="1";const o=t._encoderConfig;o&&"pcmu"!==r&&"pcma"!==r&&"g722"!==r&&(o.bitrate&&!Bt()&&(n.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*o.bitrate))),o.sampleRate&&(n.fmtp.parameters.maxplaybackrate="".concat(o.sampleRate),n.fmtp.parameters["sprop-maxcapturerate"]="".concat(o.sampleRate)),o.stereo&&(n.fmtp.parameters.stereo="1",n.fmtp.parameters["sprop-stereo"]="1"))})}function gM(e){const t=e.attributes.unrecognized.findIndex(n=>"x-google-flag"===n.attField&&"conference"===n.attValue);-1!==t&&e.attributes.unrecognized.splice(t,1)}function _M(e,t){var n;if(!(t instanceof yt&&t._encoderConfig&&-1===t._hints.indexOf(ft.SCREEN_TRACK)))return;const i=t._encoderConfig;Fe().supportMinBitrate&&i.bitrateMin&&e.attributes.payloads.forEach(r=>{var o,s;Y(o=["h264","h265","vp8","vp9","av1"]).call(o,(null===(s=r.rtpMap)||void 0===s?void 0:s.encodingName.toLowerCase())||"")&&(r.fmtp||(r.fmtp={parameters:{}}),r.fmtp.parameters["x-google-min-bitrate"]="".concat(i.bitrateMin))}),Fe().supportMinBitrate&&!Y(n=t._hints).call(n,ft.LOW_STREAM)&&i.bitrateMax&&e.attributes.payloads.forEach(r=>{var o,s;Y(o=["h264","h265","vp8","vp9","av1"]).call(o,(null===(s=r.rtpMap)||void 0===s?void 0:s.encodingName.toLowerCase())||"")&&(r.fmtp||(r.fmtp={parameters:{}}),r.fmtp.parameters["x-google-start-bitrate"]="".concat(R("X_GOOGLE_START_BITRATE")||Math.floor(i.bitrateMax)))})}function V$(e){if("video"!==e.media.mediaType)return;const t=xe();if(t.name!==Ye.SAFARI&&t.os!==kn.IOS)return;const n=e.attributes.extmaps.findIndex(i=>/video-orientation/g.test(i.extensionName));-1!==n&&e.attributes.extmaps.splice(n,1)}function aC(e,t,n){if(!t)return;let i,r;if("video"===e.media.mediaType?(i=n.videoExtensions,r=n.videoCodecs):(i=n.audioExtensions,r=n.audioCodecs),!0===t.twcc){const o=i.find(s=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===s.extensionName);o&&(e.attributes.extmaps.find(a=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===a.extensionName)||e.attributes.extmaps.push({entry:o.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),(a=r,c=e.attributes.payloads,c.filter(l=>!!a.find(d=>d.payloadType===l.payloadType&&!!d.rtcpFeedbacks.find(u=>"transport-cc"===u.type)))).forEach(a=>{a.rtcpFeedbacks.find(c=>"transport-cc"===c.type)||a.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(!1===t.twcc){const o=e.attributes.extmaps.findIndex(s=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===s.extensionName);-1!==o&&e.attributes.extmaps.splice(o,1),e.attributes.payloads.forEach(s=>{const a=s.rtcpFeedbacks.findIndex(c=>"transport-cc"===c.type);-1!==a&&s.rtcpFeedbacks.splice(a,1)})}var a,c;if(!0===t.remb){const o=i.find(s=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===s.extensionName);o&&(e.attributes.extmaps.find(a=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===a.extensionName)||e.attributes.extmaps.push({entry:o.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(a,c){return c.filter(l=>!!a.find(d=>d.payloadType===l.payloadType&&!!d.rtcpFeedbacks.find(u=>"goog-remb"===u.type)))}(r,e.attributes.payloads).forEach(a=>{a.rtcpFeedbacks.find(c=>"goog-remb"===c.type)||a.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(!1===t.remb){const o=e.attributes.extmaps.findIndex(s=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===s.extensionName);-1!==o&&e.attributes.extmaps.splice(o,1),e.attributes.payloads.forEach(s=>{const a=s.rtcpFeedbacks.findIndex(c=>"goog-remb"===c.type);-1!==a&&s.rtcpFeedbacks.splice(a,1)})}}function B$(e,t,n){if(Bt()||"video"!==e.media.mediaType||!(t instanceof yt)||"vp9"!==n&&"vp8"!==n||"vp8"===n&&!R("SIMULCAST")||"vp9"===n&&R("ENABLE_SVC")||void 0===t._scalabilityMode||t._scalabilityMode.numSpatialLayers<=1)return;const i="vp8"===n?2:t._scalabilityMode.numSpatialLayers,r=e.attributes.ssrcs[0],o=e.attributes.ssrcGroups.find(a=>"FID"===a.semantic&&a.ssrcIds[0]===r.ssrcId),s={semantic:"SIM",ssrcIds:[r.ssrcId]};for(let a=1;a<i;a++)e.attributes.ssrcs.push({ssrcId:r.ssrcId+a,attributes:dn(r.attributes)}),s.ssrcIds.push(r.ssrcId+a),o&&(e.attributes.ssrcs.push({ssrcId:o.ssrcIds[1]+a,attributes:dn(r.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[r.ssrcId+a,o.ssrcIds[1]+a]}));e.attributes.ssrcGroups.unshift(s)}function j$(){return vM.apply(this,arguments)}function vM(){return vM=C(function*(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new RTCPeerConnection;n.addTransceiver("video",{direction:"sendonly"}),n.addTransceiver("audio",{direction:"sendonly"}),n.addTransceiver("video",{direction:"recvonly"}),n.addTransceiver("audio",{direction:"recvonly"});const i=(yield n.createOffer()).sdp,{send:r,recv:o,sendrecv:s}=function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;const d=i_(l,a,c,"sendonly"),u=i_(l,a,c,"recvonly"),h={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},p={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},m={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(as(d,u,"videoExtensions",h,p,m),as(d,u,"videoCodecs",h,p,m),as(d,u,"audioExtensions",h,p,m),as(d,u,"audioCodecs",h,p,m),R("RAISE_H264_BASELINE_PRIORITY")){const f=m.videoCodecs.findIndex(g=>{var E,b;return"h264"===(null===(E=g.rtpMap)||void 0===E?void 0:E.encodingName.toLocaleLowerCase())&&"42001f"===(null===(b=g.fmtp)||void 0===b?void 0:b.parameters["profile-level-id"])});if(-1!==f){const g=m.videoCodecs.findIndex(E=>{var b;return"h264"===(null===(b=E.rtpMap)||void 0===b?void 0:b.encodingName.toLocaleLowerCase())});if(g<f){_.debug("raising H264 baseline profile priority");const E=m.videoCodecs[f];m.videoCodecs.splice(f,1),m.videoCodecs.splice(g,0,E)}-1!==g&&(p.videoCodecs=p.videoCodecs.filter(E=>{var b,T;return!("h264"===(null===(b=E.rtpMap)||void 0===b?void 0:b.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(T=E.fmtp)||void 0===T?void 0:T.parameters["profile-level-id"]))})),-1!==g&&R("FILTER_SEND_H264_BASELINE")&&(h.videoCodecs=h.videoCodecs.filter(E=>{var b,T;return!("h264"===(null===(b=E.rtpMap)||void 0===b?void 0:b.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(T=E.fmtp)||void 0===T?void 0:T.parameters["profile-level-id"]))}))}}return{send:h,recv:p,sendrecv:m}}(e,t,i);try{n.close()}catch{}return{send:r,recv:o,sendrecv:s}}),vM.apply(this,arguments)}function H$(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=i_(arguments.length>2?arguments[2]:void 0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"recvonly"),n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(as(e,t,"videoExtensions",n,i,r),as(e,t,"videoCodecs",n,i,r),as(e,t,"audioExtensions",n,i,r),as(e,t,"audioCodecs",n,i,r),R("RAISE_H264_BASELINE_PRIORITY")){const o=r.videoCodecs.findIndex(s=>s.rtpMap&&"h264"===s.rtpMap.encodingName.toLocaleLowerCase()&&s.fmtp&&"42001f"===s.fmtp.parameters["profile-level-id"]);if(-1!==o){const s=r.videoCodecs.findIndex(a=>a.rtpMap&&"h264"===a.rtpMap.encodingName.toLocaleLowerCase());if(s<o){_.debug("raising H264 baseline profile priority");const a=r.videoCodecs[o];r.videoCodecs.splice(o,1),r.videoCodecs.splice(s,0,a)}-1!==s&&(i.videoCodecs=i.videoCodecs.filter(a=>!(a.rtpMap&&"h264"===a.rtpMap.encodingName.toLocaleLowerCase()&&a.fmtp&&"42001f"!==a.fmtp.parameters["profile-level-id"])))}}return{send:n,recv:i,sendrecv:r}}function as(e,t,n,i,r,o){if("videoExtensions"===n||"audioExtensions"===n){const s=[];return e[n].forEach(a=>{t[n].some((c,l)=>{if(a.entry===c.entry&&a.extensionName===c.extensionName)return s.push(l),!0})?o[n].push(a):i[n].push(a)}),void t[n].forEach((a,c)=>{-1===s.indexOf(c)&&r[n].push(a)})}if("videoCodecs"===n||"audioCodecs"===n){const s=[];return e[n].forEach(a=>{t[n].some((c,l)=>{if(a.payloadType===c.payloadType&&JSON.stringify(a)===JSON.stringify(c))return s.push(l),!0})?o[n].push(a):i[n].push(a)}),void t[n].forEach((a,c)=>{-1===s.indexOf(c)&&r[n].push(a)})}}function cC(e){const{send:t,recv:n,sendrecv:i}=e;if(!i){if(!t||!n)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:n}}let r,o;return t?(r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r.audioCodecs=[...t.audioCodecs,...i.audioCodecs],r.videoCodecs=[...t.videoCodecs,...i.videoCodecs],r.audioExtensions=[...t.audioExtensions,...i.audioExtensions],r.videoExtensions=[...t.videoExtensions,...i.videoExtensions]):r=i,n?(o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},o.audioCodecs=[...n.audioCodecs,...i.audioCodecs],o.videoCodecs=[...n.videoCodecs,...i.videoCodecs],o.audioExtensions=[...n.audioExtensions,...i.audioExtensions],o.videoExtensions=[...n.videoExtensions,...i.videoExtensions]):o=i,{send:r,recv:o}}function Fp(e){"audio"===e.media.mediaType&&e.attributes.payloads.filter(t=>{var n;return"opus"===(null===(n=t.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase())}).forEach(t=>{t.fmtp||(t.fmtp={parameters:{}}),t.fmtp.parameters.stereo="1",t.fmtp.parameters["sprop-stereo"]="1"})}function r_(e,t,n,i){let r=[];if(e===ie.VIDEO){if(R("H264_PROFILE_LEVEL_ID")&&"h264"===i&&(r=t.videoCodecs.filter(o=>{var s;return Y(s=o.rtpMap&&o.rtpMap.encodingName.toLowerCase()||"").call(s,i)&&o&&o.fmtp&&o.fmtp.parameters["profile-level-id"]===R("H264_PROFILE_LEVEL_ID")})),!Array.isArray(r)||0===r.length){let o=[];const s=[],a=[],c=[];if(n.videoCodecs.forEach(l=>{const d=l.rtpMap&&l.rtpMap.encodingName.toLowerCase()||"";Y(d).call(d,i)?o.push(l):Y(d).call(d,"vp9")?s.push(l):Y(d).call(d,"vp8")?a.push(l):Y(d).call(d,"h264")&&c.push(l)}),0===o.length){let l="";0!==s.length?(o=s,l="vp9"):0!==a.length?(o=a,l="vp8"):0!==c.length&&(o=c,l="h264"),_.warning("codec ".concat(i," not included in rtpCapabilities, fallback to default payloads: ").concat(l))}0!==o.length&&(r=t.videoCodecs.filter(l=>o.some(d=>d.payloadType===l.payloadType)))}if(0===r.length&&(_.warning("codec ".concat(i," not included in rtpCapabilities, fallback to default payloads: ").concat(t.videoCodecs[0].rtpMap&&t.videoCodecs[0].rtpMap.encodingName)),r=t.videoCodecs),R("USE_PUB_RTX")||R("USE_SUB_RTX")){const o=EM(r,t.videoCodecs);r=[...r,...o]}}else r=t.audioCodecs.filter(o=>{var s;return Y(s=o.rtpMap&&o.rtpMap.encodingName.toLowerCase()||"").call(s,i)}),0===r.length&&(_.warning("codec ".concat(i," not included in rtpCapabilities, fallback to opus")),r=t.audioCodecs.filter(o=>{var s;return Y(s=o.rtpMap&&o.rtpMap.encodingName.toLowerCase()||"").call(s,"opus")}));return r}function EM(e,t){const n=e.map(i=>i.payloadType.toString());return t.filter(i=>i.rtpMap&&"rtx"===i.rtpMap.encodingName&&i.fmtp&&i.fmtp.parameters.apt&&Y(n).call(n,i.fmtp&&i.fmtp.parameters.apt))}function lC(e,t,n){return bM.apply(this,arguments)}function bM(){return bM=C(function*(e,t,n){const i=t.toString(),r=W$(i,"offer","remote","exchangeSDP");yield e.setRemoteDescription({type:"offer",sdp:i});const o=yield e.createAnswer();if(!o.sdp)throw new Error("cannot get answer sdp");let s=o.sdp;s=G$(s,n||{}),r?.(s||""),yield e.setLocalDescription({type:"answer",sdp:s})}),bM.apply(this,arguments)}function G$(e,t,n){const i=Zn.parse(e),{useXR:r}=t;return i.mediaDescriptions.forEach(o=>{var s;o.attributes.mid&&(Array.isArray(n)&&!Y(n).call(n,o.attributes.mid)||("audio"===o.media.mediaType&&Fp(o),r&&Y(s=["audio","video"]).call(s,o.media.mediaType)&&o.attributes.payloads.forEach(a=>{-1===a.rtcpFeedbacks.findIndex(c=>"rrtr"===c.type)&&a.rtcpFeedbacks.push({type:"rrtr"})})))}),Zn.print(i)}function W$(e,t,n,i){if(R("SDP_LOGGING"))return _.upload("exchanging ".concat(n," ").concat(t," SDP during P2PConnection.").concat(i,"\n"),e),"offer"===t?r=>{W$(r,"answer","local"===n?"remote":"local",i)}:void 0}function Pa(e,t){return typeof R(e)===t?R(e):void 0}function z$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function Tl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z$(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z$(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}const yM=new Map;class nFe extends xt{get state(){return this._state}set state(t){if(t===this._state)return;const n=this._state;this._state=t,"DISCONNECTED"===t&&this._disconnectedReason?this.emit(ri.CONNECTION_STATE_CHANGE,t,n,this._disconnectedReason):this.emit(ri.CONNECTION_STATE_CHANGE,t,n)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(t){_.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(t)),this._joinGatewayStartTime=t}constructor(t,n){super(),y(this,"store",void 0),y(this,"joinInfo",void 0),y(this,"key",void 0),y(this,"ntpOffset",0),y(this,"signal",void 0),y(this,"role",void 0),y(this,"inChannelInfo",{joinAt:null,duration:0}),y(this,"spec",void 0),y(this,"_state","DISCONNECTED"),y(this,"_statsCollector",void 0),y(this,"_disconnectedReason",void 0),y(this,"isSignalRecover",!1),y(this,"hasChangeBGPAddress",!1),y(this,"trafficStatsInterval",void 0),y(this,"networkQualityInterval",void 0),y(this,"_joinGatewayStartTime",0),y(this,"_signalTimeout",!1),y(this,"_clientRoleOptions",void 0),y(this,"_isProactiveJoin",!1),this.store=t,this.spec=n,this.signal=this.store.useP2P?new P$(Tl(Tl({},n),{},{retryConfig:n.websocketRetryConfig}),t):new ILe(Tl(Tl({},n),{},{retryConfig:n.websocketRetryConfig}),t),this._statsCollector=n.statsCollector,this.role=n.role||"audience",this._clientRoleOptions=n.clientRoleOptions,this.handleSignalEvents()}join(t,n,i){var r=this;return C(function*(){r.store.joinGatewayStart(),"disabled"!==t.cloudProxyServer&&(r.hasChangeBGPAddress=!0);const o=Date.now();let s=yM.get(t.cname);if(s||(s=new Map,yM.set(t.cname,s)),r._isProactiveJoin=!0,s.has(t.uid)){const d=new N(S.UID_CONFLICT);throw ne.joinGateway(t.sid,{lts:o,succ:!1,ec:d.code,addr:null,uid:t.uid,cid:t.cid,firstSuccess:r._isProactiveJoin,avoidJoinStartTime:r.store.avoidJoinStart,isProxy:!!t.proxyServer,signalChannel:"0",preload:t.preload}),r._isProactiveJoin=!1,d}s.set(t.uid,!0),r.joinInfo=t,r.key=n;let a=0;r.joinGatewayStartTime=o;const c=t.proxyServer;try{_.debug("[".concat(r.store.clientId,"] use websocket join uid ").concat(a));const d=t.gatewayAddrs.map(u=>{let{address:h}=u;const[p,m]=h.split(":"),f={host:p,port:m};return t.proxyServer&&(f.proxy=t.proxyServer),f});a=(yield r.signal.init(d,i)).uid,_.debug("[".concat(r.store.clientId,"] websocket join uid ").concat(a," cost ").concat(Date.now()-r.joinGatewayStartTime))}catch(d){var l;throw _.error("[".concat(r.store.clientId,"] User join failed"),d.toString()),ne.joinGateway(t.sid,{lts:o,succ:!1,ec:(null===(l=d.data)||void 0===l?void 0:l.desc)||d.code,errorMsg:d.message,addr:r.signal.url,uid:t.uid,cid:t.cid,firstSuccess:r._isProactiveJoin,avoidJoinStartTime:r.store.avoidJoinStart,isProxy:!!c,signalChannel:"0",preload:t.preload}),r._isProactiveJoin=!1,s.delete(t.uid),r.signal.close(),d}return r.state="CONNECTED",r.inChannelInfo.joinAt=Date.now(),_.debug("[".concat(r.store.clientId,"] Connected to gateway server")),r.trafficStatsInterval=window.setInterval(()=>{r.updateTrafficStats().catch(d=>{_.warning("[".concat(r.store.clientId,"] get traffic stats error"),d.toString())})},3e3),r.networkQualityInterval=window.setInterval(()=>{navigator&&void 0!==navigator.onLine&&!navigator.onLine?r.emit(ri.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):r.emit(ri.NETWORK_QUALITY,r._signalTimeout?{downlinkNetworkQuality:5,uplinkNetworkQuality:5}:"CONNECTED"===r.state&&r._statsCollector.trafficStats?{uplinkNetworkQuality:ZK(r._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:ZK(r._statsCollector.trafficStats.B_dnq)}:{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),r.store.joinGatewayEnd(),a})()}leave(){var t=arguments,n=this;return C(function*(){let i=t.length>0&&void 0!==t[0]&&t[0],r=t.length>1?t[1]:void 0;if("DISCONNECTED"!==n.state){r!==Qe.FALLBACK&&(n.state="DISCONNECTING");try{i||n.signal.connectionState!==_t.CONNECTED||(yield(o=n.signal.request(pe.LEAVE,void 0,!0),q.race([o,Cke(3e3)])))}catch(o){_.warning("[".concat(n.store.clientId,"] leave request failed, ignore"),o)}n.signal.close(r),r!==Qe.FALLBACK&&(n.state="DISCONNECTED"),n.reset()}var o})()}publish(t,n,i){var r=this;return C(function*(){if("CONNECTED"!==r.state&&"RECONNECTING"!==r.state)throw new N(S.INVALID_OPERATION,"can not publish when connection state is ".concat(r.state));const o={state:"offer",p2p_id:r.store.p2pId,ortc:n,mode:r.spec.mode,extend:R("PUB_EXTEND"),twcc:!!R("PUBLISH_TWCC"),rtx:!!R("USE_PUB_RTX")};try{return(yield r.signal.request(pe.PUBLISH,o,!0))._message}catch(s){if(i&&s.data&&s.data.code===ce.ERR_PUBLISH_REQUEST_INVALID)return _.warning("[".concat(r.store.clientId,"] receive publish error code, retry"),s.toString()),yield r.tryUnpubBeforeRepub(t,n),r.publish(t,n,!1);throw s}})()}publishDataChannel(t,n,i){var r=this;return C(function*(){var o;if("CONNECTED"!==r.state&&"RECONNECTING"!==r.state)throw new N(S.INVALID_OPERATION,"can not publish when connection state is ".concat(r.state));const s={stream_id:n.streamId,ordered:n.ordered?1:0,max_retrans_times:null!==(o=n.maxRetransmits)&&void 0!==o?o:10,channel_id:n.channelId,metadata:n.metadata};try{yield r.signal.request(pe.PUBLISH_DATASTREAM,s,!0)}catch(a){if(i&&a.data&&a.data.code===ce.ERR_PUBLISH_REQUEST_INVALID)return _.warning("[".concat(r.store.clientId,"] receive publish datachannels error code, retry"),a.toString()),yield r.tryUnpubDataChannelBeforeRepub(t,n),r.publishDataChannel(t,n,!1);throw a}})()}unpublish(t,n){var i=this;return C(function*(){try{if("CONNECTED"!==i.state&&"RECONNECTING"!==i.state)throw new N(S.INVALID_OPERATION,"can not publish when connection state is ".concat(i.state));yield i.signal.request(pe.UNPUBLISH,{stream_id:n,ortc:t},!0)}catch(r){_.warning("[".concat(i.store.clientId,"] unpublish warning: "),r)}})()}unpublishDataChannel(t){var n=this;return C(function*(){try{if("CONNECTED"!==n.state&&"RECONNECTING"!==n.state)throw new N(S.INVALID_OPERATION,"can not publish when connection state is ".concat(n.state));yield q.all(t.map(i=>n.signal.request(pe.UNPUBLISH_DATASTREAM,{channel_id:i},!0)))}catch(i){_.warning("unpublish datachannels warning: ",i)}})()}presubscribe(t,n,i){var r=this;return C(function*(){if("CONNECTED"!==r.state&&"RECONNECTING"!==r.state)throw new N(S.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(r.state));const o={stream_id:t,stream_type:n,mode:r.spec.mode,codec:r.spec.codec,p2p_id:r.store.p2pId,twcc:!!R("SUBSCRIBE_TWCC"),rtx:!!R("USE_SUB_RTX")||void 0,extend:R("SUB_EXTEND"),svc:Array.isArray(R("SVC"))&&0!==R("SVC").length?R("SVC"):void 0};try{return yield r.signal.request(pe.PRE_SUBSCRIBE,o,!0)}catch(s){if(i&&s.data&&s.data.code===ce.ERR_SUBSCRIBE_REQUEST_INVALID)return _.warning("[".concat(r.store.clientId,"] pre-subscribe error, retry"),s.toString()),r.presubscribe(t,n,!1);throw s}})()}subscribe(t,n,i){var r=this;return C(function*(){if("CONNECTED"!==r.state&&"RECONNECTING"!==r.state)throw new N(S.INVALID_OPERATION,"can not subscribe when connection state is ".concat(r.state));const o={stream_id:t,stream_type:n.stream_type,mode:r.spec.mode,codec:r.spec.codec,p2p_id:r.store.p2pId,twcc:!!R("SUBSCRIBE_TWCC"),rtx:!!R("USE_SUB_RTX"),extend:R("SUB_EXTEND"),ssrcId:n.ssrcId,svc:Array.isArray(R("SVC"))&&0!==R("SVC").length?R("SVC"):void 0};try{return(yield r.signal.request(pe.SUBSCRIBE,o,!0))._message}catch(s){if(i&&s.data&&s.data.code===ce.ERR_SUBSCRIBE_REQUEST_INVALID)return _.warning("[".concat(r.store.clientId,"] receiver subscribe error code, retry"),s.toString()),yield r.tryUnsubBeforeResub(t,n),yield r.subscribe(t,n,!1);throw s}})()}subscribeDataChannel(t,n,i){var r=this;return C(function*(){if("CONNECTED"!==r.state&&"RECONNECTING"!==r.state)throw new N(S.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(r.state));const o={uid:t,stream_id:n.id,channel_id:n.datachannelId};try{return void(yield r.signal.request(pe.SUBSCRIBE_DATASTREAM,o,!0))}catch(s){if(i&&s.data&&s.data.code===ce.ERR_SUBSCRIBE_REQUEST_INVALID)return _.warning("[".concat(r.store.clientId,"] receiver subscribe datachannel error code, retry"),s.toString()),yield r.tryUnsubDataChannelBeforeResub(t,n),yield r.subscribeDataChannel(t,n,!1);throw s}})()}subscribeAll(t,n){var i=this;return C(function*(){if("CONNECTED"!==i.state&&"RECONNECTING"!==i.state)throw new N(S.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(i.state));const r={p2p_id:i.store.p2pId,users:t,dtx:!1,rtx:!!R("USE_SUB_RTX"),twcc:!!R("SUBSCRIBE_TWCC"),svc:Array.isArray(R("SVC"))&&0!==R("SVC").length?R("SVC"):void 0};try{return yield i.signal.request(pe.SUBSCRIBE_STREAMS,r,!0)}catch(o){if(n&&o.data&&o.data.code===ce.ERR_SUBSCRIBE_REQUEST_INVALID)return _.warning("[".concat(i.store.clientId,"] receiver massSubscribe error code, retry"),o.toString()),yield i.tryMassUnsubBeforeResub(t),yield i.subscribeAll(t,!1);throw o}})()}setVideoProfile(t){var n=this;return C(function*(){const i=function(r){if(!(r.bitrateMax&&r.bitrateMin&&r.frameRate&&r.height&&r.width))return;let o=r.frameRate,s=r.width,a=r.height,c=!0;return"number"!=typeof o&&(o=o.exact||o.ideal||o.max||o.min||0,o||(c=!1)),"number"!=typeof s&&(s=s.exact||s.ideal||s.max||s.min||0,s||(c=!1)),"number"!=typeof a&&(a=a.exact||a.ideal||a.max||a.min||0,o||(c=!1)),c?{stream_type:0,width:s,height:a,fps:o,start_bps:1e3*r.bitrateMax,min_bps:1e3*r.bitrateMin,target_bps:1e3*r.bitrateMax}:void 0}(t);if(i)return n.signal.request(pe.SET_VIDEO_PROFILE,i);_.debug("[".concat(n.store.clientId,"] encoder config is not complete, do not report to gateway"))})()}unsubscribe(t,n){var i=this;return C(function*(){try{yield i.signal.request(pe.UNSUBSCRIBE,{p2p_id:i.store.p2pId,ortc:t,stream_id:n},!0)}catch(r){_.warning("[".concat(i.store.clientId,"] unsubscribe warning: "),r)}})()}unsubscribeDataChannel(t,n){var i=this;return C(function*(){try{if("CONNECTED"!==i.state&&"RECONNECTING"!==i.state)throw new N(S.INVALID_OPERATION,"can not publish when connection state is ".concat(i.state));yield q.all(t.map(r=>i.signal.request(pe.UNSUBSCRIBE_DATASTREAM,{stream_id:r,uid:n},!0)))}catch(r){_.warning("unsubscribeDataChannel warning: ",r)}})()}massUnsubscribe(t){var n=this;return C(function*(){try{yield n.signal.request(pe.UNSUBSCRIBE_STREAMS,t,!0)}catch(i){_.warning("[".concat(n.store.clientId,"] massUnsubscribeAll warning: "),i)}})()}reconnectPC(t){var n=this;return C(function*(){const{iceParameters:i,dtlsParameters:r,rtpCapabilities:o}=t;return{gatewayEstablishParams:yield n.signal.request(pe.CONNECT_PC,{p2p_id:n.store.p2pId,stream_id:n.store.uid,ortc:{iceParameters:i,dtlsParameters:r,rtpCapabilities:o}},!0),gatewayAddress:n.getCurrentGatewayAddress()}})()}getGatewayInfo(){return this.signal.request(pe.GATEWAY_INFO)}renewToken(t){var n=this;return C(function*(){yield n.signal.request(pe.RENEW_TOKEN,t),n.key=t.token})()}setClientRole(t,n){var i=this;return C(function*(){if(n&&(i._clientRoleOptions=Object.assign({},n)),"CONNECTED"!==i.state)return void(i.role=t);let r,o=0;"audience"===t?i._clientRoleOptions&&i._clientRoleOptions.delay?(r=i._clientRoleOptions.delay,o=1):o=i._clientRoleOptions&&i._clientRoleOptions.level?i._clientRoleOptions.level:2:o=0,yield i.signal.request(pe.SET_CLIENT_ROLE,{role:t,level:o,delay:r,client_ts:Date.now()}),i.role=t})()}setRemoteVideoStreamType(t,n){var i=this;return C(function*(){yield i.signal.request(pe.SWITCH_VIDEO_STREAM,{stream_id:t,stream_type:n})})()}setDefaultRemoteVideoStreamType(t){var n=this;return C(function*(){yield n.signal.request(pe.DEFAULT_VIDEO_STREAM,{stream_type:t})})()}setStreamFallbackOption(t,n){var i=this;return C(function*(){yield i.signal.request(pe.SET_FALLBACK_OPTION,{stream_id:t,fallback_type:n})})()}pickSVCLayer(t,n){var i=this;return C(function*(){yield i.signal.request(pe.PICK_SVC_LAYER,{stream_id:t,spatial_layer:n.spatialLayer,temporal_layer:n.temporalLayer})})()}setRTM2Flag(t){var n=this;return C(function*(){yield n.signal.request(pe.SET_RTM2_FLAG,{rtm2_flag:t})})()}sendExtensionMessage(t,n,i){var r=this;return C(function*(){if(r.signal instanceof P$)return r.signal.sendExtensionMessage(t,n,i)})()}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),Tl({},this.inChannelInfo)}getGatewayVersion(){var t=this;return C(function*(){return(yield t.signal.request(pe.GATEWAY_INFO)).version})()}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const t=yM.get(this.joinInfo.cname);t&&t.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const t=function(n){let i;return i=n.startsWith("dc")?n.match(/(dc\:\/\/)?([^:]+):(\d+)/):n.match(/(wss\:\/\/)?([^:]+):(\d+)/),i?{username:ii.username,password:ii.password,turnServerURL:i[2],tcpport:parseInt(i[3])+30,udpport:parseInt(i[3])+30,forceturn:!1}:null}(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],t&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&this.joinInfo.turnServer.serversFromGateway.push(Tl(Tl({},ii),{},{turnServerURL:t.turnServerURL,tcpport:t.tcpport,udpport:t.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}updateTrafficStats(){var t=this;return C(function*(){if("CONNECTED"!==t.state)return;const n=yield t.signal.request(pe.TRAFFIC_STATS,void 0,!0);n.timestamp=Date.now(),null!=n.ntp_offset&&(t.ntpOffset=n.ntp_offset),n.peer_delay.forEach(i=>{const r=t._statsCollector.trafficStats&&t._statsCollector.trafficStats.peer_delay.find(o=>o.peer_uid===i.peer_uid);r&&r.B_st!==i.B_st&&OS(()=>{t.emit(ri.STREAM_TYPE_CHANGE,i.peer_uid,i.B_st)})}),t._statsCollector.updateTrafficStats(n)})()}getJoinMessage(t){if(!this.joinInfo||!this.key)throw new N(S.UNEXPECTED_ERROR,"can not generate join message, no join info");const n=Object.assign({},this.joinInfo.apResponse);let i=R("REPORT_APP_SCENARIO");if("string"!=typeof i)try{i=JSON.stringify(i)}catch{i=void 0}i&&i.length>128&&(i=void 0);const r=!(Bt()||X7(87)||Pq())&&"boolean"==typeof R("ENABLE_PRE_SUB")&&R("ENABLE_PRE_SUB"),o=!Pq()&&Pa("ENABLE_PREALLOC_PC","boolean"),s=Tl({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:No,browser:navigator.userAgent,process_id:R("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:n,extend:R("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:"proxy3"===this.joinInfo.cloudProxyServer?"1":"proxy5"===this.joinInfo.cloudProxyServer?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:i,attributes:{userAttributes:{enablePublishedUserList:R("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:R("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:"number"==typeof R("SUBSCRIBE_AUDIO_FILTER_TOPN")?R("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:"boolean"==typeof R("ENABLE_PUBLISH_AUDIO_FILTER")?R("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:"boolean"==typeof R("ENABLE_USER_LICENSE_CHECK")?R("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:!0===R("USE_PUB_RTX")||!0===R("USE_SUB_RTX")||void 0,disableFEC:R("DISABLE_FEC"),enableNTPReport:!!R("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!R("ENABLE_INSTANT_VIDEO")||void 0,enableFulllinkAvSync:!!R("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:Pa("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!R("ENABLE_AUT_FEEDBACK")||void 0,rtm2Flag:"number"==typeof this.joinInfo.rtmFlag?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!R("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:Pa("USE_XR","boolean"),enableLossbasedBwe:Pa("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!R("ENABLE_AUT_CC")||void 0,enableCCFallback:Pa("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:o,preSubNum:r?Pa("PRE_SUB_NUM","number"):void 0,enablePubTWCC:Pa("PUBLISH_TWCC","boolean"),enableSubTWCC:Pa("SUBSCRIBE_TWCC","boolean"),enablePubRTX:Pa("USE_PUB_RTX","boolean"),enableSubRTX:Pa("USE_SUB_RTX","boolean"),enableSubSVC:R("ENABLE_SVC")?R("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(R("SVC"))&&0!==R("SVC").length?R("SVC"):void 0}},join_ts:this.joinGatewayStartTime},t);return this.joinInfo.stringUid&&(s.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(s.aes_mode=this.joinInfo.aesmode,R("ENCRYPT_AES")?(s.aes_secret=this.joinInfo.aespassword,s.aes_encrypt=!0):s.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(s.aes_salt=this.joinInfo.aessalt)),n.addresses[this.signal.websocket.currentURLIndex]&&(s.ap_response.ticket=n.addresses[this.signal.websocket.currentURLIndex].ticket,delete n.addresses),void 0!==this.joinInfo.defaultVideoStream&&(s.default_video_stream=this.joinInfo.defaultVideoStream),s}getRejoinMessage(){if(!this.joinInfo)throw new N(S.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){var t=this;this.signal.on(he.WS_RECONNECT_WAITTING_FINISH,n=>{var i;Y(i=["tryNext","recover"]).call(i,n)&&this.joinInfo&&ne.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(he.WS_RECONNECT_CREATE_CONNECTION,n=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(he.WS_RECONNECTING,n=>{this.joinInfo&&ne.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:n||ti.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",ne.sessionInit(this.joinInfo.sid,{lts:(new Date).getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:"live"===this.spec.mode?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:"audience"===this.role?2:1,buildFormat:2}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(he.WS_CLOSED,n=>{let i;switch(n){case Qe.LEAVE:i=ti.LEAVE;break;case Qe.UID_BANNED:case Qe.IP_BANNED:case Qe.CHANNEL_BANNED:case Qe.SERVER_ERROR:i=ti.SERVER_ERROR;break;case Qe.FALLBACK:i=ti.FALLBACK;break;case Qe.LICENSE_MISSING:case Qe.LICENSE_EXPIRED:case Qe.LICENSE_MINUTES_EXCEEDED:case Qe.LICENSE_PERIOD_INVALID:case Qe.LICENSE_MULTIPLE_SDK_SERVICE:case Qe.LICENSE_ILLEGAL:case Qe.TOKEN_EXPIRE:i=n;break;default:i=ti.NETWORK_ERROR}_.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(i||"undefined -> "+ti.NETWORK_ERROR)),this.joinInfo&&ne.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:n===Qe.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:i}),this._disconnectedReason=n,n!==Qe.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(he.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&("audience"===this.role&&this._clientRoleOptions&&(this._clientRoleOptions.level||this._clientRoleOptions.delay)&&(_.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions.level,", delay: ").concat(this._clientRoleOptions.delay)),this.setClientRole(this.role,this._clientRoleOptions)),ne.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&1===this.joinInfo.setLocalAPVersion)){const n=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!n)return void _.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(n));st("EVENT_REPORT_DOMAIN",n[1]),st("EVENT_REPORT_BACKUP_DOMAIN",n[1]),st("LOG_UPLOAD_SERVER","".concat(n[1],":6444"))}}),this.signal.on(Te.ON_UPLINK_STATS,n=>{this._statsCollector.updateUplinkStats(n)}),this.signal.on(he.REQUEST_RECOVER,(n,i,r)=>{if(!this.joinInfo)return r(new N(S.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));n&&(this.joinInfo.multiIP=n,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,ni(this,ri.REQUEST_NEW_GATEWAY_LIST).then(i).catch(r)}),this.signal.on(he.REQUEST_JOIN_INFO,function(){var n=C(function*(i){var r;if(t.updateTurnConfigFromSignal(),t.store.useP2P)return void i(t.getJoinMessage({ortc:{}}));const{iceParameters:o,dtlsParameters:s,rtpCapabilities:a}=yield ni(t,ri.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:null===(r=t.joinInfo)||void 0===r?void 0:r.turnServer});i(t.getJoinMessage({ortc:{iceParameters:o,dtlsParameters:s,rtpCapabilities:a,version:"2"}}))});return function(i){return n.apply(this,arguments)}}()),this.signal.on(he.REQUEST_REJOIN_INFO,n=>{n(this.getRejoinMessage())}),this.signal.on(he.REPORT_JOIN_GATEWAY,(n,i)=>{if(!this.joinInfo)return;let r,o="";var s;n instanceof N?(r=(null===(s=n.data)||void 0===s?void 0:s.desc)||n.code,o=n.message):r=n,ne.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:r,errorMsg:o,addr:i,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload}),this._isProactiveJoin=!1}),this.signal.on(he.IS_P2P_DISCONNECTED,n=>{n(Wg(this,ri.IS_P2P_DISCONNECTED))}),this.signal.on(he.DISCONNECT_P2P,()=>{this.emit(ri.DISCONNECT_P2P)}),this.signal.on(he.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(he.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(he.JOIN_RESPONSE,n=>{const i=this.getCurrentGatewayAddress();this.emit(ri.JOIN_RESPONSE,n,i)}),this.signal.on(he.PRE_CONNECT_PC,C(function*(){if(t.joinInfo){t.updateTurnConfigFromSignal();const n=t.getCurrentGatewayAddress(),i=R("FINGERPRINT")||t.joinInfo.apResponse.addresses[t.signal.currentURLIndex].fingerprint;if(n&&i){const r=U$(n);t.emit(ri.PRE_CONNECT_PC,{candidates:r,fingerprint:i})}}})),this.signal.on(he.RECOVER_NOTIFICATION,n=>{this.joinInfo&&"string"==typeof R("AP_REQUEST_DETAIL")&&(this.joinInfo.apRequestDetail="".concat(R("AP_REQUEST_DETAIL"),";").concat(n))})}tryUnsubBeforeResub(t,n){var i=this;return C(function*(){try{yield i.signal.request(pe.UNSUBSCRIBE,{p2p_id:i.store.p2pId,stream_id:t,ortc:[n]},!0)}catch(r){throw _.warning("[".concat(i.store.clientId,"] tryUnsubBeforeResub warning"),r),r}})()}tryUnsubDataChannelBeforeResub(t,n){var i=this;return C(function*(){try{yield i.signal.request(pe.UNSUBSCRIBE,{stream_id:n.id},!0)}catch(r){throw _.warning("unsubscribe datachannel warning",r),r}})()}tryUnpubBeforeRepub(t,n){var i=this;return C(function*(){try{yield i.signal.request(pe.UNPUBLISH,{stream_id:t,ortc:n},!0)}catch(r){throw _.warning("[".concat(i.store.clientId,"] tryUnpubBeforeRepub warning: "),r),r}})()}tryUnpubDataChannelBeforeRepub(t,n){var i=this;return C(function*(){try{yield i.signal.request(pe.UNPUBLISH_DATASTREAM,{channnel_id:n.channelId},!0)}catch(r){throw _.warning("unpublish datastream warning: ",r),r}})()}tryMassUnsubBeforeResub(t){var n=this;return C(function*(){const i={users:t.map(r=>({stream_id:r.stream_id,stream_type:r.stream_type}))};try{yield n.signal.request(pe.UNSUBSCRIBE_STREAMS,i,!0)}catch(r){throw _.warning("[".concat(n.store.clientId,"] tryMassUnsubBeforeResub warning"),r),r}})()}muteLocal(t,n){var i=this;return C(function*(){const r={action:t.find(o=>o.stream_type===$e.Audio)?"mute_local_audio":"mute_local_video",p2p_id:i.store.p2pId,ortc:t,stream_id:n};try{yield i.signal.request(pe.CONTROL,r,!0,!0)}catch(o){throw _.warning("[".concat(i.store.clientId,"] gateway muteLocal warning: "),o),o}})()}unmuteLocal(t,n){var i=this;return C(function*(){const r={action:t.find(o=>o.stream_type===$e.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:i.store.p2pId,ortc:t,stream_id:n};try{yield i.signal.request(pe.CONTROL,r,!0,!0)}catch(o){throw _.warning("[".concat(i.store.clientId,"] gateway unmuteLocal warning: "),o),o}})()}muteRemote(t,n){var i=this;return C(function*(){const r={action:t===ie.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:i.store.p2pId,stream_id:n};try{yield i.signal.request(pe.CONTROL,r,!0,!0)}catch(o){throw _.warning("[".concat(i.store.clientId,"] gateway muteRemote warning: "),o),o}})()}unmuteRemote(t,n){var i=this;return C(function*(){const r={action:t===ie.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:i.store.p2pId,stream_id:n};try{yield i.signal.request(pe.CONTROL,r,!0,!0)}catch(o){throw _.warning("[".concat(i.store.clientId,"] gateway unmuteRemote warning: "),o),o}})()}uploadWRTCStats(t){this.signal.uploadWRTCStats(t)}upload(t,n){this.signal.upload(t,n)}getSignalRTT(){return this.signal.rtt}restartICE(t){var n=this;return C(function*(){const i={p2p_id:n.store.p2pId,stream_id:n.store.uid,ortc:t};try{return yield n.signal.request(pe.RESTART_ICE,i,!0)}catch(r){throw _.warning("[".concat(n.store.clientId,"] P2PChannel.restartICE warning: "),r),r}})()}reconnect(){"CONNECTED"===this.state&&this.signal.reconnect(void 0,ti.P2P_FAILED)}getCurrentGatewayAddress(){var t,n;if(!R("GATEWAY_WSS_ADDRESS"))return R("USE_CANDIDATE_FROM_AP_DETAIL")&&null!==(t=this.joinInfo)&&void 0!==t&&t.apGatewayAddress?(_.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):null!==(n=this.joinInfo)&&void 0!==n&&n.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}setPublishAudioFilterEnabled(t){var n=this;return C(function*(){yield n.signal.request(pe.SET_PARAMETER,{enablePublishAudioFilter:t})})()}}let dC=0,SM=0;function js(e,t,n,i){return new q((r,o)=>{t.timeout=t.timeout||R("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),dC+=wa(t.data)):n&&(t.data.size?dC+=t.data.size:t.data instanceof FormData?dC+=_K(t.data):dC+=wa(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,nr.request(t).then(s=>{"string"==typeof s.data?SM+=wa(s.data):s.data instanceof ArrayBuffer||s.data instanceof Uint8Array?SM+=s.data.byteLength:SM+=wa(JSON.stringify(s.data)),i&&r({data:s.data,headers:s.headers}),r(s.data)}).catch(s=>{nr.isCancel(s)?o(new N(S.OPERATION_ABORTED,"cancel token canceled")):o("ECONNABORTED"===s.code?new N(S.NETWORK_TIMEOUT,s.message):s.response?new N(S.NETWORK_RESPONSE_ERROR,s.response.status):new N(S.NETWORK_ERROR,s.message))})})}!function(){var e;function t(P){var F=0;return function(){return F<P.length?{done:!1,value:P[F++]}:{done:!0}}}var i,n="function"==typeof Object.defineProperties?Object.defineProperty:function(P,F,G){return P==Array.prototype||P==Object.prototype||(P[F]=G.value),P},r=function(P){P=["object"==typeof globalThis&&globalThis,P,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Ph&&Ph];for(var F=0;F<P.length;++F){var G=P[F];if(G&&G.Math==Math)return G}throw Error("Cannot find global object")}(this);function o(P,F){if(F)e:{var G=r;P=P.split(".");for(var U=0;U<P.length-1;U++){var v=P[U];if(!(v in G))break e;G=G[v]}(F=F(U=G[P=P[P.length-1]]))!=U&&null!=F&&n(G,P,{configurable:!0,writable:!0,value:F})}}function s(P){return(P={next:P})[Symbol.iterator]=function(){return this},P}function a(P){var F=typeof Symbol<"u"&&Symbol.iterator&&P[Symbol.iterator];return F?F.call(P):{next:t(P)}}if(o("Symbol",function(P){function F(v,w){this.A=v,n(this,"description",{configurable:!0,writable:!0,value:w})}if(P)return P;F.prototype.toString=function(){return this.A};var G="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",U=0;return function v(w){if(this instanceof v)throw new TypeError("Symbol is not a constructor");return new F(G+(w||"")+"_"+U++,w)}}),o("Symbol.iterator",function(P){if(P)return P;P=Symbol("Symbol.iterator");for(var F="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),G=0;G<F.length;G++){var U=r[F[G]];"function"==typeof U&&"function"!=typeof U.prototype[P]&&n(U.prototype,P,{configurable:!0,writable:!0,value:function(){return s(t(this))}})}return P}),"function"==typeof Object.setPrototypeOf)i=Object.setPrototypeOf;else{var c;e:{var l={};try{l.__proto__={a:!0},c=l.a;break e}catch{}c=!1}i=c?function(P,F){if(P.__proto__=F,P.__proto__!==F)throw new TypeError(P+" is not extensible");return P}:null}var d=i;function u(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function h(P){if(P.m)throw new TypeError("Generator is already running");P.m=!0}function p(P,F){return P.h=3,{value:F}}function m(P){this.g=new u,this.G=P}function f(P,F,G,U){try{var v=F.call(P.g.j,G);if(!(v instanceof Object))throw new TypeError("Iterator result "+v+" is not an object");if(!v.done)return P.g.m=!1,v;var w=v.value}catch(A){return P.g.j=null,P.g.s(A),g(P)}return P.g.j=null,U.call(P.g,w),g(P)}function g(P){for(;P.g.h;)try{var F=P.G(P.g);if(F)return P.g.m=!1,{value:F.value,done:!1}}catch(G){P.g.v=void 0,P.g.s(G)}if(P.g.m=!1,P.g.l){if(F=P.g.l,P.g.l=null,F.F)throw F.D;return{value:F.return,done:!0}}return{value:void 0,done:!0}}function E(P){this.next=function(F){return P.o(F)},this.throw=function(F){return P.s(F)},this.return=function(F){return function(G,U){h(G.g);var v=G.g.j;return v?f(G,"return"in v?v.return:function(w){return{value:w,done:!0}},U,G.g.return):(G.g.return(U),g(G))}(P,F)},this[Symbol.iterator]=function(){return this}}function b(P,F){return F=new E(new m(F)),d&&P.prototype&&d(F,P.prototype),F}if(u.prototype.o=function(P){this.v=P},u.prototype.s=function(P){this.l={D:P,F:!0},this.h=this.C||this.u},u.prototype.return=function(P){this.l={return:P},this.h=this.u},m.prototype.o=function(P){return h(this.g),this.g.j?f(this,this.g.j.next,P,this.g.o):(this.g.o(P),g(this))},m.prototype.s=function(P){return h(this.g),this.g.j?f(this,this.g.j.throw,P,this.g.o):(this.g.s(P),g(this))},o("Array.prototype.entries",function(P){return P||function(){return function(F,G){F instanceof String&&(F+="");var U=0,v=!1,w={next:function(){if(!v&&U<F.length){var A=U++;return{value:G(A,F[A]),done:!1}}return v=!0,{done:!0,value:void 0}}};return w[Symbol.iterator]=function(){return w},w}(this,function(F,G){return[F,G]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var T=function(P,F){for(var G=0;G<P.length;G++)F(P[G])},I=function(P){return P.replace(/\r?\n|\r/g,"\r\n")},D=function(P,F,G){return F instanceof Blob?(F.name===(G=void 0!==G?G+"":"string"==typeof F.name?F.name:"blob")&&"[object Blob]"!==Object.prototype.toString.call(F)||(F=new File([F],G)),[String(P),F]):[String(P),String(F)]},O=function(P,F){if(P.length<F)throw new TypeError(F+" argument required, but only "+P.length+" present.")},k="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,L=k.FormData,V=k.XMLHttpRequest&&k.XMLHttpRequest.prototype.send,ee=k.Request&&k.fetch,oe=k.navigator&&k.navigator.sendBeacon,Ie=k.Element&&k.Element.prototype,Ue=k.Symbol&&Symbol.toStringTag;Ue&&(Blob.prototype[Ue]||(Blob.prototype[Ue]="Blob"),"File"in k&&!File.prototype[Ue]&&(File.prototype[Ue]="File"));try{new File([],"")}catch{k.File=function(F,G,U){return F=new Blob(F,U||{}),Object.defineProperties(F,{name:{value:G},lastModified:{value:+(U&&void 0!==U.lastModified?new Date(U.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),Ue&&Object.defineProperty(F,Ue,{value:"File"}),F}}var Dt=function(P){return P.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},dt=function(P){this.i=[];var F=this;P&&T(P.elements,function(G){if(G.name&&!G.disabled&&"submit"!==G.type&&"button"!==G.type&&!G.matches("form fieldset[disabled] *"))if("file"===G.type){var U=G.files&&G.files.length?G.files:[new File([],"",{type:"application/octet-stream"})];T(U,function(v){F.append(G.name,v)})}else"select-multiple"===G.type||"select-one"===G.type?T(G.options,function(v){!v.disabled&&v.selected&&F.append(G.name,v.value)}):"checkbox"===G.type||"radio"===G.type?G.checked&&F.append(G.name,G.value):(U="textarea"===G.type?I(G.value):G.value,F.append(G.name,U))})};if((e=dt.prototype).append=function(P,F,G){O(arguments,2),this.i.push(D(P,F,G))},e.delete=function(P){O(arguments,1);var F=[];P=String(P),T(this.i,function(G){G[0]!==P&&F.push(G)}),this.i=F},e.entries=function P(){var F,G=this;return b(P,function(U){if(1==U.h&&(F=0),3!=U.h)return F<G.i.length?U=p(U,G.i[F]):(U.h=0,U=void 0),U;F++,U.h=2})},e.forEach=function(P,F){O(arguments,1);for(var G=a(this),U=G.next();!U.done;U=G.next()){var v=a(U.value);U=v.next().value,v=v.next().value,P.call(F,v,U,this)}},e.get=function(P){O(arguments,1);var F=this.i;P=String(P);for(var G=0;G<F.length;G++)if(F[G][0]===P)return F[G][1];return null},e.getAll=function(P){O(arguments,1);var F=[];return P=String(P),T(this.i,function(G){G[0]===P&&F.push(G[1])}),F},e.has=function(P){O(arguments,1),P=String(P);for(var F=0;F<this.i.length;F++)if(this.i[F][0]===P)return!0;return!1},e.keys=function P(){var F,G,w=this;return b(P,function(A){if(1==A.h&&(F=a(w),G=F.next()),3!=A.h)return G.done?void(A.h=0):p(A,a(G.value).next().value);G=F.next(),A.h=2})},e.set=function(P,F,G){O(arguments,2),P=String(P);var U=[],v=D(P,F,G),w=!0;T(this.i,function(A){A[0]===P?w&&(w=!U.push(v)):U.push(A)}),w&&U.push(v),this.i=U},e.values=function P(){var F,G,v,w=this;return b(P,function(A){if(1==A.h&&(F=a(w),G=F.next()),3!=A.h)return G.done?void(A.h=0):((v=a(G.value)).next(),p(A,v.next().value));G=F.next(),A.h=2})},dt.prototype._asNative=function(){for(var P=new L,F=a(this),G=F.next();!G.done;G=F.next()){var U=a(G.value);G=U.next().value,U=U.next().value,P.append(G,U)}return P},dt.prototype._blob=function(){var P="----formdata-polyfill-"+Math.random(),F=[],G="--"+P+'\r\nContent-Disposition: form-data; name="';return this.forEach(function(U,v){return"string"==typeof U?F.push(G+Dt(I(v))+'"\r\n\r\n'+I(U)+"\r\n"):F.push(G+Dt(I(v))+'"; filename="'+Dt(U.name)+'"\r\nContent-Type: '+(U.type||"application/octet-stream")+"\r\n\r\n",U,"\r\n")}),F.push("--"+P+"--"),new Blob(F,{type:"multipart/form-data; boundary="+P})},dt.prototype[Symbol.iterator]=function(){return this.entries()},dt.prototype.toString=function(){return"[object FormData]"},Ie&&!Ie.matches&&(Ie.matches=Ie.matchesSelector||Ie.mozMatchesSelector||Ie.msMatchesSelector||Ie.oMatchesSelector||Ie.webkitMatchesSelector||function(P){for(var F=(P=(this.document||this.ownerDocument).querySelectorAll(P)).length;0<=--F&&P.item(F)!==this;);return-1<F}),Ue&&(dt.prototype[Ue]="FormData"),V){var me=k.XMLHttpRequest.prototype.setRequestHeader;k.XMLHttpRequest.prototype.setRequestHeader=function(P,F){me.call(this,P,F),"content-type"===P.toLowerCase()&&(this.B=!0)},k.XMLHttpRequest.prototype.send=function(P){P instanceof dt?(P=P._blob(),this.B||this.setRequestHeader("Content-Type",P.type),V.call(this,P)):V.call(this,P)}}ee&&(k.fetch=function(P,F){return F&&F.body&&F.body instanceof dt&&(F.body=F.body._blob()),ee.call(this,P,F)}),oe&&(k.navigator.sendBeacon=function(P,F){return F instanceof dt&&(F=F._asNative()),oe.call(this,P,F)}),k.FormData=dt}}();const o_=()=>{const e=R("AREAS");return 0===e.length&&e.push(We.GLOBAL),Ps(e).call(e,(t,n,i)=>{const r=K$(n);return r?0===i?r:"".concat(t,",").concat(r):t},"")},K$=e=>e===We.OVERSEA?"".concat(gi.ASIA,",").concat(gi.EUROPE,",").concat(gi.AFRICA,",").concat(gi.NORTH_AMERICA,",").concat(gi.SOUTH_AMERICA,",").concat(gi.OCEANIA):gi[e],iFe=e=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return e.map(n=>{const i=jS[n],r=Object.keys(i);r&&r.map(o=>{"CODE"!==o&&(t[o]=t[o].concat(i[o]))})}),t},uC={GLOBAL:{ASIA:[We.CHINA,We.JAPAN,We.INDIA,We.KOREA,We.HKMC],EUROPE:[],NORTH_AMERICA:[We.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},hC=Object.keys(uC[We.GLOBAL]),CM=[We.CHINA,We.NORTH_AMERICA,We.EUROPE,We.ASIA,We.JAPAN,We.INDIA,We.OCEANIA,We.SOUTH_AMERICA,We.AFRICA,We.KOREA,We.HKMC,We.US],rFe=function(e,t){let n=[];if(Y(e).call(e,We.GLOBAL)){const o=[We.GLOBAL,We.OVERSEA],s=Object.keys(jS);if(t===We.GLOBAL)throw new N(S.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===We.CHINA)n=[We.OVERSEA];else if(r=t,Y(hC).call(hC,r)){const a=uC[We.GLOBAL][t]||[],c=[...o,t,...a];n=s.filter(l=>!Y(c).call(c,l))}else if(function(a){let c=!1;return hC.forEach(l=>{var d;Y(d=uC[We.GLOBAL][l]).call(d,a)&&(c=!0)}),c}(t)){const a=function(l){let d;return hC.forEach(u=>{var h;Y(h=uC[We.GLOBAL][u]).call(h,l)&&(d=u)}),d}(t),c=[...o,a,t];n=s.filter(l=>!Y(c).call(c,l))}else n=e;n=function(a){const c=[];return CM.forEach(l=>{Y(a).call(a,l)&&c.push(l)}),c.concat(a.filter(l=>!Y(CM).call(CM,l)))}(n)}else n=e;var r;return n};function q$(e){var t,n;if(!e&&Y(t=R("AREAS")).call(t,We.EXTENSIONS))return _.debug("update area from ap : reset"),void TM(Mke,!0);if(!Y(n=R("AREAS")).call(n,We.GLOBAL)||!e)return;let i=jS.EXTENSIONS;i&&(i={CODE:K$(We.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(e,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(e,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(e,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(e,".agora.io"),"cds-ap-web-2-".concat(e,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(e,".agora.io"),"sua-ap-web-2-".concat(e,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(e,".agora.io"),"uap-ap-web-2-".concat(e,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(e,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(e,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(e,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(e,".agora.io")]},_.debug("update area from ap success: ".concat(e,",config is "),i),st("AREAS",[We.EXTENSIONS],!0),Object.keys(i).map(r=>{st(r,"LOG_UPLOAD_SERVER"===r||"EVENT_REPORT_DOMAIN"===r||"EVENT_REPORT_BACKUP_DOMAIN"===r||"PROXY_SERVER_TYPE3"===r?i[r][0]:i[r])}))}function TM(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=ne.reportApiInvoke(null,{name:Cn.SET_AREA,options:e,tag:jt.TRACER});try{let i=[];if("string"==typeof e&&(i=[e]),Array.isArray(e)&&(e.forEach(o=>{if(!Y(BK).call(BK,o))throw new N(S.INVALID_PARAMS,"invalid area code")}),i=e),"[object Object]"===Object.prototype.toString.call(e)){const{areaCode:o,excludedArea:s}=e;if(!o)throw new N(S.INVALID_PARAMS,"area code is needed");let a=o;"string"==typeof o&&(a=[o]),i=s?rFe(a,s):a}if(!t){if(_l.AREAS){const o=new N(S.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return n.onError(o),void _.warning("setArea is prohibited because of config-distribute")}if(Y(i).call(i,We.GLOBAL)&&R("AREAS")===We.EXTENSIONS){const o=new N(S.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return n.onError(o),void _.warning("setArea is prohibited because of ap extensions")}}st("AREAS",i,t);const r=iFe(i);Object.keys(r).map(o=>{st(o,"LOG_UPLOAD_SERVER"===o||"EVENT_REPORT_DOMAIN"===o||"EVENT_REPORT_BACKUP_DOMAIN"===o||"PROXY_SERVER_TYPE3"===o?r[o][0]:r[o])}),_.debug("set area success:",i.join(","))}catch(i){throw n.onError(i),i}n.onSuccess()}function Y$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function pC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y$(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y$(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}let wM=1,IM=1;function $$(e,t,n,i){let{url:r,areaCode:o}=e;const{clientId:s,sid:a}=t,c=Date.now();let l;const[d,u]=AM(t,o,[un.CHOOSE_SERVER]);let h=ln.networkState;return Fs(C(function*(){h&&ln.networkState===Pr.OFFLINE&&ln.onlineWaiter&&(yield q.race([ln.onlineWaiter,qn(i&&i.maxRetryTimeout||vn.maxRetryTimeout)])),h=ln.networkState;const{data:p,headers:m}=yield js(r,{data:d,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);l="1"===m.http3?1:-1,ne.reportResourceTiming(r,a),Z$(p,r,t,c,[un.CHOOSE_SERVER],l);const f=$g(p,un.CHOOSE_SERVER);return RM(f),TP(f,r)}),p=>(p&&ne.joinChooseServer(a,{lts:c,succ:!0,csAddr:r,opid:u,serverList:p.gatewayAddrs.map(m=>m.address),ec:null,cid:p.cid.toString(),uid:p.uid.toString(),csIp:p.csIp,unilbsServerIds:[un.CHOOSE_SERVER].toString(),isHttp3:l,corssRegionTagReq:t.apRequestDetail,corssRegionTagRes:p.res.detail&&p.res.detail[38]}),!1),p=>p.code!==S.OPERATION_ABORTED&&(p.code===S.CAN_NOT_GET_GATEWAY_SERVER?p.data.retry:(ne.joinChooseServer(a,{lts:c,succ:!1,csAddr:r,serverList:null,opid:u,ec:p.code,csIp:p.data&&p.data.csIp,unilbsServerIds:[un.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:h}),isHttp3:l,corssRegionTagReq:t.apRequestDetail}),_.warning("[".concat(s||"sid-".concat(a.slice(0,6)),"] Choose server network error, retry"),p),!0)),i)}function X$(e,t,n,i){let r,{url:o,areaCode:s,serviceIds:a}=e;const c=Date.now(),[l,d]=AM(t,s,a);let u;return Fs(C(function*(){u&&ln.networkState===Pr.OFFLINE&&ln.onlineWaiter&&(yield q.race([ln.onlineWaiter,qn(i&&i.maxRetryTimeout||vn.maxRetryTimeout)])),u=ln.networkState;const{data:h,headers:p}=yield js(o,{data:l,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);r="1"===p.http3?1:-1,ne.reportResourceTiming(o,t.sid),Z$(h,o,t,c,a,r);const m=$g(h,un.CHOOSE_SERVER),f=$g(h,"proxy5"===t.cloudProxyServer?un.CLOUD_PROXY_5:"proxy3"===t.cloudProxyServer||"proxy4"===t.cloudProxyServer?un.CLOUD_PROXY:un.CLOUD_PROXY_FALLBACK);return RM(m),{gatewayInfo:TP(m,o),proxyInfo:f,url:o}}),h=>(h.gatewayInfo&&ne.joinChooseServer(t.sid,{lts:c,succ:!0,csAddr:o,serverList:h.gatewayInfo.gatewayAddrs.map(p=>p.address),ec:null,opid:d,cid:h.gatewayInfo.cid.toString(),uid:h.gatewayInfo.uid.toString(),csIp:h.gatewayInfo.csIp,unilbsServerIds:a.toString(),isHttp3:r,corssRegionTagReq:t.apRequestDetail,corssRegionTagRes:h.gatewayInfo.res.detail&&h.gatewayInfo.res.detail[38]}),h.proxyInfo&&ne.joinWebProxyAP(t.sid,{lts:c,sucess:1,apServerAddr:o,turnServerAddrList:h.proxyInfo.addresses.map(p=>p.ip).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:a.toString()}),!1),h=>h.code!==S.OPERATION_ABORTED&&(h.code===S.CAN_NOT_GET_GATEWAY_SERVER?h.data.retry:(ne.joinWebProxyAP(t.sid,{lts:c,sucess:0,apServerAddr:o,turnServerAddrList:null,errorCode:h.code,eventType:t.cloudProxyServer,unilbsServerIds:a.toString(),extend:JSON.stringify({networkState:u})}),_.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),h),!0)),i)}const Z$=(e,t,n,i,r,o)=>{const{sid:s,clientId:a,cloudProxyServer:c}=n,l=[],d=u=>{4096===u.flag?ne.joinChooseServer(s,{lts:i,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:u.error.message,csIp:u.error.data&&u.error.data.csIp,unilbsServerIds:r.toString(),isHttp3:o,corssRegionTagReq:n.apRequestDetail}):1048576!==u.flag&&4194304!==u.flag&&4194310!==u.flag||ne.joinWebProxyAP(s,{lts:i,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:u.error.code,eventType:c,unilbsServerIds:r.toString()})};if(e.response_body.forEach(u=>{const h=u.buffer.code;if(23===u.uri&&0===h&&!u.buffer.edges_services)if(4194310===u.buffer.flag)_.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),u.buffer.edges_services=[];else{const p={error:new N(S.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:u.buffer.flag};l.push(p),d(p)}if(0!==h){const p=_p(h),m={error:new N(S.CAN_NOT_GET_GATEWAY_SERVER,p.desc,{desc:p.desc,retry:p.retry,csIp:e.detail[502]}),flag:u.buffer.flag};4194310===u.buffer.flag?_.warning(m.error.toString()):l.push(m),d(m)}}),l.length)throw _.warning("[".concat(a||"sid-".concat(s.slice(0,6)),"] multi unilbs ").concat(t," failed, ").concat(l.map(u=>"flag: ".concat(u.flag,", message: ").concat(u.error.message,", retry: ").concat(u.error.data.retry)).join(" | "))),new N(S.CAN_NOT_GET_GATEWAY_SERVER,l.map(u=>"flag: ".concat(u.flag,", message: ").concat(u.error.message)).join(" | "),{retry:!!l.find(u=>u.error.data.retry),csIp:e.detail[502],desc:[...new Set(l.map(u=>{var h;return null==u||null===(h=u.error)||void 0===h||null===(h=h.data)||void 0===h?void 0:h.desc}).filter(u=>!!u))]})},RM=e=>{var t,n,i,r;if(e.addresses&&0===e.addresses.length&&0===e.code)throw new N(S.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(R("AP_AREA")&&(null!==(i=e.detail)&&void 0!==i&&i[23]&&"string"==typeof(null===(r=e.detail)||void 0===r?void 0:r[23])?q$(e.detail[23].toLowerCase()):q$()),null!==(t=e.detail)&&void 0!==t&&t[19]&&"string"==typeof(null===(n=e.detail)||void 0===n?void 0:n[19])){const s=e.detail[19],a=s?.split(";");for(let c=0;c<a.length;c++){var o;const l=ki(o=a[c]).call(o);e.addresses[c]&&a&&(e.addresses[c].fingerprint=l)}}if(R("GATEWAY_ADDRESS")&&R("GATEWAY_ADDRESS").length>0){_.debug("assign gateway address to",R("GATEWAY_ADDRESS"));const s=R("GATEWAY_ADDRESS").map(a=>{var c,l;const d=null!==(c=null===(l=e.addresses.find(u=>u.ip===a.ip&&u.port===a.port))||void 0===l?void 0:l.fingerprint)&&void 0!==c?c:"";return{ip:a.ip,port:a.port,ticket:e.addresses[0]&&e.addresses[0].ticket,fingerprint:d}});e.addresses=s}},AM=(e,t,n)=>{const i=Math.floor(1e12*Math.random()),r={appid:e.appId,client_ts:Date.now(),opid:i,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:pC(pC({6:e.stringUid,11:t,12:R("USE_NEW_TOKEN")?"1":void 0,22:t},e.apRequestDetail?{33:e.apRequestDetail}:{}),e.apRTM?{26:"RTM2"}:{}),key:e.token,service_ids:n,uid:e.uid||0}}]};r.request_bodies.forEach(s=>{e.multiIP&&e.multiIP.gateway_ip&&(s.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))});const o=new FormData;return o.append("request",JSON.stringify(r)),[o,i]};let Up=0;function Vp(e){return q.all(e.map(t=>t.then(n=>{throw n},n=>n))).then(t=>{throw t},t=>t)}const s_=function(){var e=C(function*(t){let{fragementLength:n,referenceList:i,asyncMapHandler:r,allFailedhandler:o,promisesCollector:s}=t,a=0;const c=n;let l,d=0;const u=function(){var h=C(function*(){const p=(()=>{const m=a*c;return i.slice(m,m+c).map(r)})();s&&s.push(...p);try{l=yield Vp(p)}catch(m){if(d+=c,a++,!(d>=i.length))return void(yield u());o(m)}p.forEach(m=>m.cancel())});return function(){return h.apply(this,arguments)}}();return yield u(),l});return function(n){return e.apply(this,arguments)}}(),J$=function(){var e=C(function*(t){let{referenceList:n,asyncMapHandler:i,closeFn:r}=t;const o=n.length;let s=0;const a=function(){var c=C(function*(){const l=i(n.shift());try{return yield l}catch(d){if(s++,s>=o||null!=r&&r(d))throw d;return a()}});return function(){return c.apply(this,arguments)}}();return a()});return function(n){return e.apply(this,arguments)}}();function DM(e,t,n,i){return OM.apply(this,arguments)}function OM(){return OM=C(function*(e,t,n,i){return{gatewayInfo:yield(o=C(function*(s,a,c,l){let d=null;const u=[],h=function(){var m=C(function*(){const f=R("WEBCS_DOMAIN").slice(0,R("AJAX_REQUEST_CONCURRENT")).map(b=>({url:s.proxyServer?"https://".concat(s.proxyServer,"/ap/?url=").concat(b+"/api/v2/transpond/webrtc?v=2"):"https://".concat(b,"/api/v2/transpond/webrtc?v=2"),areaCode:o_()})),g=l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:f.map(b=>b.url)}),E=yield s_({fragementLength:R("FRAGEMENT_LENGTH"),referenceList:f,asyncMapHandler:b=>(_.debug("[".concat(s.clientId,"] Connect to choose_server:"),b.url),$$(b,s,a,c)),allFailedhandler:b=>{throw l.recordJoinChannelService({endTs:Date.now(),status:"error",errors:b},g),b[0]},promisesCollector:u});return l.recordJoinChannelService({endTs:Date.now(),status:"success"},g),E});return function(){return m.apply(this,arguments)}}(),p=function(){var m=C(function*(){if(yield qn(1e3),null!==d)return d;const f=R("WEBCS_DOMAIN_BACKUP_LIST").map(b=>({url:s.proxyServer?"https://".concat(s.proxyServer,"/ap/?url=").concat(b+"/api/v2/transpond/webrtc?v=2"):"https://".concat(b,"/api/v2/transpond/webrtc?v=2"),areaCode:o_()})),g=l.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:f.map(b=>b.url)}),E=yield s_({fragementLength:R("FRAGEMENT_LENGTH"),referenceList:f,asyncMapHandler:b=>(_.debug("[".concat(s.clientId,"] Connect to backup choose_server:"),b.url),$$(b,s,a,c)),allFailedhandler:b=>{throw l.recordJoinChannelService({endTs:Date.now(),status:"error",errors:b},g),b[0]},promisesCollector:u});return l.recordJoinChannelService({endTs:Date.now(),status:"success"},g),E});return function(){return m.apply(this,arguments)}}();try{return d=yield Vp([h(),p()]),u.length&&u.forEach(m=>m.cancel&&"function"==typeof m.cancel&&m.cancel()),d}catch(m){throw m[0]}}),function(s,a,c,l){return o.apply(this,arguments)})(e,t,n,i)};var o}),OM.apply(this,arguments)}function Q$(e,t,n,i,r){return NM.apply(this,arguments)}function NM(){return NM=C(function*(e,t,n,i,r){const o=e.cloudProxyServer;if("disabled"===o){if(!i)return;if(e.useLocalAccessPoint)return yield DM(e,t,n,r);if(R("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:h,proxyInfo:p}=yield nX(e,t,n,r);if(e.turnServer&&"auto"!==e.turnServer.mode)return{gatewayInfo:h};const m=p.map(f=>({turnServerURL:f.address,tcpport:f.tcpport||ii.tcpport,udpport:f.udpport||ii.udpport,username:f.username||ii.username,password:f.password||ii.password,forceturn:!1,security:!0}));if(r.useP2P){var s;const f=null!==(s=e.uid)&&void 0!==s?s:h.uid,g="glb:".concat(f.toString()),E=yield tP(g),b=p.map(T=>({turnServerURL:T.address,tcpport:T.tcpport||ii.tcpport,udpport:T.udpport||ii.udpport,username:g,password:E,forceturn:!1,security:!0}));m.push(...b)}return e.turnServer={mode:"manual",servers:m},{gatewayInfo:h}}return yield DM(e,t,n,r)}const{proxyInfo:a,gatewayInfo:c}=yield nX(e,t,n,r),l={gatewayInfo:c},d=a.map(h=>({turnServerURL:h.address,tcpport:"proxy3"===o?void 0:h.tcpport?h.tcpport:ii.tcpport,udpport:"proxy4"===o?void 0:h.udpport?h.udpport:ii.udpport,username:h.username||ii.username,password:h.password||ii.password,forceturn:"proxy4"!==o,security:"proxy5"===o}));if(r.useP2P){var u;const h=null!==(u=e.uid)&&void 0!==u?u:c.uid,p="glb:".concat(h.toString()),m=yield tP(p),f=a.map(g=>({turnServerURL:g.address,tcpport:"proxy3"===o?void 0:g.tcpport||ii.tcpport,udpport:"proxy4"===o?void 0:g.udpport||ii.udpport,username:p,password:m,forceturn:"proxy4"!==o,security:"proxy5"===o}));d.push(...f)}return e.turnServer={mode:"manual",servers:d},_.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(o)),l}),NM.apply(this,arguments)}function eX(e,t,n,i,r){return PM.apply(this,arguments)}function PM(){return PM=C(function*(e,t,n,i,r){let s=[];s=R("ACCOUNT_REGISTER").slice(0,R("AJAX_REQUEST_CONCURRENT")).map(t.proxyServer?c=>"https://".concat(t.proxyServer,"/ap/?url=").concat(c+"/api/v1"):c=>"https://".concat(c,"/api/v1"));const a=r?.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:s});try{const c=yield(l=C(function*(d,u,h,p,m){const f=Date.now(),g={sid:h.sid,opid:10,appid:h.appId,string_uid:u};let E=d[0];const b=yield Fs(()=>js(E+"".concat(-1===E.indexOf("?")?"?":"&","action=stringuid"),{data:g,cancelToken:p,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(T,I)=>{if(0===T.code){if(T.uid<=0||T.uid>=Math.pow(2,32))throw _.error("Invalid Uint Uid ".concat(u," => ").concat(T.uid),T),ne.reqUserAccount(g.sid,{lts:f,success:!1,serverAddr:E,stringUid:g.string_uid,uid:T.uid,errorCode:S.INVALID_UINT_UID_FROM_STRING_UID,extend:g}),new N(S.INVALID_UINT_UID_FROM_STRING_UID);return ne.reqUserAccount(g.sid,{lts:f,success:!0,serverAddr:E,stringUid:g.string_uid,uid:T.uid,errorCode:null,extend:g}),!1}const D=_p(T.code);return D.retry&&(E=d[(I+1)%d.length]),ne.reqUserAccount(g.sid,{lts:f,success:!1,serverAddr:E,stringUid:g.string_uid,uid:T.uid,errorCode:D.desc,extend:g}),D.retry},(T,I)=>T.code!==S.OPERATION_ABORTED&&(ne.reqUserAccount(g.sid,{lts:f,success:!1,serverAddr:E,stringUid:g.string_uid,uid:null,errorCode:T.code,extend:g}),E=d[(I+1)%d.length],!0),m);if(0!==b.code){const T=_p(b.code);throw new N(S.UNEXPECTED_RESPONSE,T.desc)}return b}),function(d,u,h,p,m){return l.apply(this,arguments)})(s,e,t,n,i);return r?.recordJoinChannelService({status:"success",endTs:Date.now()},a),c.uid}catch(c){throw r?.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[c]},a),c}var l}),PM.apply(this,arguments)}function cFe(e,t,n){return MM.apply(this,arguments)}function MM(){return MM=C(function*(e,t,n){let r=[];r=R("ACCOUNT_REGISTER").map(t.proxyServer?o=>"https://".concat(t.proxyServer,"/ap/?url=").concat(o+"/api/v1"):o=>"https://".concat(o,"/api/v1"));try{return yield J$({referenceList:r,asyncMapHandler:s=>{return(a=C(function*(c,l,d,u){const h=Date.now(),p={sid:d.sid,opid:10,appid:d.appId,string_uid:l};try{const m=yield js(c+"".concat(-1===c.indexOf("?")?"?":"&","action=stringuid"),{data:p,cancelToken:u,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(0!==m.code){const f=_p(m.code);throw new N(S.UNEXPECTED_RESPONSE,"preload sua error:".concat(f.desc),f)}if(m.uid<=0||m.uid>=Math.pow(2,32))throw new N(S.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:h,url:c,req:p,uid:m.uid,elapse:Date.now()-h}}catch(m){throw m}}),function(c,l,d,u){return a.apply(this,arguments)})(s,e,t,n);var a},closeFn:s=>s.code===S.OPERATION_ABORTED||s.code===S.UNEXPECTED_RESPONSE&&!s.data.retry})}catch(o){throw o}}),MM.apply(this,arguments)}function xM(){return xM=C(function*(e,t,n){const r=R("CDS_AP").slice(0,R("AJAX_REQUEST_CONCURRENT")).map(c=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(c+"/api/v1"):"https://".concat(c,"/api/v1?action=config")).map(c=>function(l,d,u,h){const p=xe(),m={flag:64,cipher_method:0,features:{device:p.name,system:p.os,system_general:navigator.userAgent,vendor:d.appId,version:No,cname:d.cname,sid:d.sid,session_id:d.sid,detail:"",proxyServer:d.proxyServer}};return Fs(()=>js(l,{data:m,timeout:1e3,cancelToken:u,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,f=>f.code!==S.OPERATION_ABORTED,h)}(c,e,t,n));let o=null,s=null,a={};try{o=yield Vp(r)}catch(c){if(c.code===S.OPERATION_ABORTED)throw c;s=c}if(r.forEach(c=>c.cancel()),ne.reportApiInvoke(e.sid,{name:Cn.REQUEST_CONFIG_DISTRIBUTE,options:{error:s,res:o}}).onSuccess(),o&&o.test_tags)try{a=function(c){if(!c.test_tags)return{};const l=c.test_tags,d=Object.keys(l),u={};return d.forEach(h=>{var p;const m=ki(p=h.slice(4)).call(p),f=JSON.parse(l[h])[1];u[m]=f}),u}(o)}catch{}return a}),xM.apply(this,arguments)}function tX(e,t){return kM.apply(this,arguments)}function kM(){return kM=C(function*(e,t){const n=R("WEBCS_DOMAIN").concat(R("WEBCS_DOMAIN_BACKUP_LIST")).map(i=>({url:"https://".concat(i,"/api/v2/transpond/webrtc?v=2"),areaCode:o_(),serviceIds:[un.CHOOSE_SERVER,un.CLOUD_PROXY_FALLBACK]}));try{return yield J$({referenceList:n,asyncMapHandler:r=>{return(o=C(function*(s,a,c){let l,{url:d,areaCode:u,serviceIds:h}=s;const p=Date.now(),[m,f]=AM(a,u,h);let g=ln.networkState;try{g&&ln.networkState===Pr.OFFLINE&&ln.onlineWaiter&&(yield q.race([ln.onlineWaiter,qn(vn.maxRetryTimeout)])),g=ln.networkState;const{data:E,headers:b}=yield js(d,{data:m,cancelToken:c,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);l="1"===b.http3?1:-1,(O=>{const k=[];if(O.response_body.forEach(L=>{const V=L.buffer.code;if(23===L.uri&&0===V&&!L.buffer.edges_services)if(4194310===L.buffer.flag)L.buffer.edges_services=[];else{const ee={error:new N(S.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:O.detail[502]}),flag:L.buffer.flag};k.push(ee)}if(0!==V){const ee=_p(V),oe={error:new N(S.CAN_NOT_GET_GATEWAY_SERVER,ee.desc,{desc:ee.desc,retry:ee.retry,csIp:O.detail[502]}),flag:L.buffer.flag};4194310===L.buffer.flag?_.warning(oe.error.toString()):k.push(oe)}}),k.length)throw new N(S.CAN_NOT_GET_GATEWAY_SERVER,k.map(L=>"flag: ".concat(L.flag,", message: ").concat(L.error.message)).join(" | "),{retry:!!k.find(L=>L.error.data.retry),csIp:O.detail[502],desc:[...new Set(k.map(L=>{var V;return null==L||null===(V=L.error)||void 0===V||null===(V=V.data)||void 0===V?void 0:V.desc}).filter(L=>!!L))]})})(E);const I=$g(E,un.CHOOSE_SERVER),D=$g(E,un.CLOUD_PROXY_FALLBACK);return RM(I),{gatewayInfo:TP(I,d),proxyInfo:D,opid:f,requestTime:p,url:d,isHttp3:l,elapse:Date.now()-p}}catch(E){throw E}}),function(s,a,c){return o.apply(this,arguments)})(r,e,t);var o},closeFn:r=>r.code===S.OPERATION_ABORTED||r.code===S.CAN_NOT_GET_GATEWAY_SERVER&&!r.data.retry})}catch(i){throw i}}),kM.apply(this,arguments)}function nX(e,t,n,i){return LM.apply(this,arguments)}function LM(){return LM=C(function*(e,t,n,i){const r=R("PROXY_SERVER_TYPE3"),o=(p,m,f)=>{let g=f||r;return Array.isArray(g)&&(g=m%2==0?r[1]:r[0]),"https://".concat(g,"/ap/?url=").concat(p)};let s=null;const a=[],c=function(){var p=C(function*(){const m=R("WEBCS_DOMAIN").slice(0,R("AJAX_REQUEST_CONCURRENT")).map((E,b)=>{let T;return T="disabled"===e.cloudProxyServer&&e.proxyServer?o("".concat(E,"/api/v2/transpond/webrtc?v=2"),b,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(E,"/api/v2/transpond/webrtc?v=2"):o("".concat(E,"/api/v2/transpond/webrtc?v=2"),b),{url:T,areaCode:o_(),serviceIds:[un.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?un.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?un.CLOUD_PROXY:un.CLOUD_PROXY_FALLBACK]}}),f=i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:m.map(E=>E.url)}),g=yield s_({fragementLength:R("FRAGEMENT_LENGTH"),referenceList:m,asyncMapHandler:E=>(_.debug("[".concat(e.clientId,"] Connect to choose_server:"),E.url),X$(E,e,t,n)),allFailedhandler:E=>{throw i.recordJoinChannelService({endTs:Date.now(),status:"error",errors:E},f),E[0]},promisesCollector:a});return i.recordJoinChannelService({endTs:Date.now(),status:"success"},f),g});return function(){return p.apply(this,arguments)}}(),l=function(){var p=C(function*(){if(yield qn(1e3),null!==s)return s;const m=R("WEBCS_DOMAIN_BACKUP_LIST").map((E,b)=>{let T;return T="disabled"===e.cloudProxyServer&&e.proxyServer?o("".concat(E,"/api/v2/transpond/webrtc?v=2"),b,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(E,"/api/v2/transpond/webrtc?v=2"):o("".concat(E,"/api/v2/transpond/webrtc?v=2"),b),{url:T,areaCode:o_(),serviceIds:[un.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?un.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?un.CLOUD_PROXY:un.CLOUD_PROXY_FALLBACK]}}),f=i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:m.map(E=>E.url)}),g=yield s_({fragementLength:R("FRAGEMENT_LENGTH"),referenceList:m,asyncMapHandler:E=>(_.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),E.url),X$(E,e,t,n)),allFailedhandler:E=>{throw i.recordJoinChannelService({endTs:Date.now(),status:"error",errors:E},f),E[0]},promisesCollector:a});return i.recordJoinChannelService({endTs:Date.now(),status:"success"},f),g});return function(){return p.apply(this,arguments)}}();let d,u,h;try{({gatewayInfo:d,proxyInfo:u,url:h}=yield Vp([c(),l()]))}catch(p){throw p[0]}if(a.length&&a.forEach(p=>p.cancel&&"function"==typeof p.cancel&&p.cancel()),!d||!u)throw new N(S.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=h,"disabled"!==e.cloudProxyServer&&Array.isArray(r)&&h){const p=/^https?:\/\/(.+?)(\/.*)?$/.exec(h)[1];Y(r).call(r,p)&&(e.proxyServer=p,_.setProxyServer(p),ne.setProxyServer(p))}return s={gatewayInfo:d,proxyInfo:yield JK(u,d.uid)},s}),LM.apply(this,arguments)}function FM(){return FM=C(function*(e,t,n){const r=R("UAP_AP").slice(0,R("AJAX_REQUEST_CONCURRENT")).map(o=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(o+"/api/v1?action=uap"):"https://".concat(o,"/api/v1?action=uap")).map(o=>function(s,a,c,l){const d={command:"convergeAllocateEdge",sid:a.sid,appId:a.appId,token:a.token,ts:Date.now(),version:No,cname:a.cname,uid:a.uid.toString(),requestId:IM,seq:IM};IM+=1;const u={service_name:"tele_channel",json_body:JSON.stringify(d)};return Fs(C(function*(){const h=yield js(s,{data:u,cancelToken:c,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(0!==h.code){const m=new N(S.UNEXPECTED_RESPONSE,"cross channel ap error, code"+h.code,{retry:!0});throw _.error(m.toString()),m}const p=JSON.parse(h.json_body);if(200!==p.code){const m=new N(S.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(p.code,", reason: ").concat(p.reason));throw _.error(m.toString()),m}if(!p.servers||0===p.servers.length){const m=new N(S.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw _.error(m.toString()),m}return{vid:p.vid,workerToken:p.workerToken,addressList:(R("CHANNEL_MEDIA_RELAY_SERVERS")||p.servers).map(m=>"wss://".concat(m.address.replace(/\./g,"-"),".").concat(R("WORKER_DOMAIN"),":").concat(m.wss))}}),void 0,h=>!!(h.code!==S.OPERATION_ABORTED&&h.code!==S.UNEXPECTED_RESPONSE||h.data&&h.data.retry),l)}(o,e,t,n));try{const o=yield Vp(r);return r.forEach(s=>s.cancel()),o}catch(o){throw o[0]}}),FM.apply(this,arguments)}function UM(){return UM=C(function*(e,t,n){let i=null;const r=[],o=function(){var s=C(function*(a){const c=R(a?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(l=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(l+"/api/v2/transpond/webrtc?v=2"):"https://".concat(l,"/api/v2/transpond/webrtc?v=2"));return a&&(yield qn(1e3),null!==i)?i:yield s_({fragementLength:R("FRAGEMENT_LENGTH"),referenceList:c,asyncMapHandler:l=>(_.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(a?"backup":""," choose_server:"),l),function(d,u,h,p){const[m]=((e,t)=>{const n=Math.floor(1e12*Math.random()),i={appid:e.appId,client_ts:Date.now(),opid:n,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:t,uid:e.uid||0,edges_services:e.apResponse.addresses.map(o=>({ip:o.ip,port:o.port}))}}]},r=new FormData;return r.append("request",JSON.stringify(i)),[r,n]})(u,[un.CHOOSE_SERVER]);let f=ln.networkState;return Fs(C(function*(){f&&ln.networkState===Pr.OFFLINE&&ln.onlineWaiter&&(yield q.race([ln.onlineWaiter,qn(p&&p.maxRetryTimeout||vn.maxRetryTimeout)])),f=ln.networkState;return((e,t)=>{if(e.response_body&&e.response_body.length){const n=e.response_body[0];if(0!==n.buffer.code){const i=_p(n.buffer.code);throw new N(S.UPDATE_TICKET_FAILED,"[".concat(n.buffer.code,"]: ").concat(i.desc),{retry:i.retry})}return n.buffer.ticket}throw _.debug("update ticket request received ap response without response body:",t),new N(S.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})})(yield js(d,{data:m,cancelToken:h,headers:{"Content-Type":"multipart/form-data;"}},!0),d)}),()=>!1,g=>g.code!==S.OPERATION_ABORTED&&(g.code===S.UPDATE_TICKET_FAILED?g.data.retry:(_.warning("[".concat(u.clientId,"] update ticket network error, retry"),g),!0)),p)}(l,e,t,n)),allFailedhandler:l=>{throw l[0]},promisesCollector:r})});return function(c){return s.apply(this,arguments)}}();try{return i=yield Vp([o(!1),o(!0)]),r.length&&r.forEach(s=>s.cancel&&"function"==typeof s.cancel&&s.cancel()),i}catch(s){throw s[0]}}),UM.apply(this,arguments)}function iX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function rX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}class hFe extends xt{get isSuccess(){return!!this.configs}constructor(){super(),y(this,"configs",void 0),y(this,"joinInfo",void 0),y(this,"cancelToken",void 0),y(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),y(this,"interval",void 0),y(this,"mutex",new mi("config-distribute")),y(this,"mutableParamsRead",!1)}startGetConfigDistribute(t,n){this.joinInfo=t,this.cancelToken=n,this.interval&&this.stopGetConfigDistribute(),R("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},R("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}awaitConfigDistributeComplete(){var t=this;return C(function*(){t.mutex.isLocked&&(yield t.mutex.lock())()})()}updateConfigDistribute(){var t=this;return C(function*(){if(t.mutableParamsRead||(t.mutableParamsRead=!0,ne.reportApiInvoke(null,{options:void 0,name:Cn.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:jt.TRACER}).onSuccess(JSON.stringify(_l))),!t.joinInfo||!t.cancelToken||!t.retryConfig)return void _.debug("[config-distribute] get config distribute interrupted have no joininfo");let n;const i=yield t.mutex.lock();try{n=yield function lFe(e,t,n){return xM.apply(this,arguments)}(t.joinInfo,t.cancelToken,t.retryConfig),_.debug("[config-distribute] get config distribute",JSON.stringify(n)),n.limit_bitrate&&t.handleBitrateLimit(n.limit_bitrate),t.cacheGlobalParameterConfig(n),t.configs=n}catch(r){const o=new N(S.NETWORK_RESPONSE_ERROR,r);_.warning("[config-distribute] ".concat(o.toString()))}finally{i()}})()}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(t){var n;(n=t)&&n.uplink&&n.id&&void 0!==n.uplink.max_bitrate&&void 0!==n.uplink.min_bitrate&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==t.id&&this.emit(yP.UPDATE_BITRATE_LIMIT,t):this.emit(yP.UPDATE_BITRATE_LIMIT,t))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&rX({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(t){var n;const i=Ig(n=Object.keys(t).filter(o=>/^webrtc_ng_global_parameter/.test(o))).call(n);for(let o=0;o<i.length;o++)for(let s=i.length-1;s>o;s--){const a=i[s];if("number"==typeof t[a].__priority){const l=i[s-1];if("number"==typeof t[l].__priority){if(!(t[a].__priority>t[l].__priority))continue;{const d=a;i[s]=i[s-1],i[s-1]=d}}else{const d=a;i[s]=i[s-1],i[s-1]=d}}}const r={};i.forEach(o=>{const s=t[o],a=s.__expires;Object.keys(s).forEach(c=>{"__priority"===c||"__expires"===c||Object.prototype.hasOwnProperty.call(r,c)||(r[c]=rX({value:s[c]},a&&{expires:a}))})});try{!function(a){try{const c=Date.now();Object.keys(a).forEach(l=>{switch(l){case"ENABLE_EVENT_REPORT":case"UPLOAD_LOG":case"ENABLE_AG_ADAPTATION":case"FORCE_AG_HIGH_FRAMERATE":case"FORCE_SUPPORT_AG_ADAPTATION":case"ENCODER_CONFIG_LIMIT":case"CAMERA_CAPTURE_CONFIG":case"ENABLE_PRELOAD":if(Object.prototype.hasOwnProperty.call(Jt,l)){const{value:d,expires:u}=a[l];if(u&&u<=c)return;_l[l]=d,Jt[l]=d,_.debug("Update global parameters from config distribute",l,d)}}})}catch(c){_.error("Error update config immediately: ".concat(a),c.message)}}(r);const o=JSON.stringify(r),s=window.btoa(o);window.localStorage.setItem("websdk_ng_global_parameter",s),_.debug("Caching global parameters ".concat(o))}catch(o){_.error("Error caching global parameters:",o.message)}}}class pFe extends xt{constructor(){super(...arguments),y(this,"resultStorage",new Map)}setLocalAudioStats(t,n,i){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",t,this.checkAudioInputLevel(i,n)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",t,this.checkSendAudioBitrate(i,n))}setLocalVideoStats(t,n,i){this.record("SEND_VIDEO_BITRATE_TOO_LOW",t,this.checkSendVideoBitrate(i,n)),this.record("FRAMERATE_INPUT_TOO_LOW",t,this.checkFramerateInput(i,n)),this.record("FRAMERATE_SENT_TOO_LOW",t,this.checkFramerateSent(i))}setRemoteAudioStats(t,n){const i=t.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",i,this.checkAudioOutputLevel(n))}setRemoteVideoStats(t,n){const i=t.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",i,this.checkVideoDecode(n))}record(t,n,i){if(R("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(t)||this.resultStorage.set(t,{result:[],isPrevNormal:!0});const r=this.resultStorage.get(t);if(r&&(r.result.push(i),r.result.length>=5)){var o;const s=Y(o=r.result).call(o,!0);r.isPrevNormal&&!s&&this.emit("exception",oX[t],t,n),!r.isPrevNormal&&s&&this.emit("exception",oX[t]+2e3,t+"_RECOVER",n),r.isPrevNormal=s,r.result=[]}}checkAudioOutputLevel(t){return!(t.receiveBitrate>0&&0===t.receiveLevel)}checkAudioInputLevel(t,n){return n instanceof wn&&!n.isActive||!!n.muted||0!==t.sendVolumeLevel}checkFramerateInput(t,n){let i=null;n._encoderConfig&&n._encoderConfig.frameRate&&(i=xr(n._encoderConfig.frameRate));const r=t.captureFrameRate;return!i||!r||!(i>10&&r<5||i<10&&i>=5&&r<=1)}checkFramerateSent(t){return!(t.captureFrameRate&&t.sendFrameRate&&t.captureFrameRate>5&&t.sendFrameRate<=1)}checkSendVideoBitrate(t,n){return!!n.muted||0!==t.sendBitrate}checkSendAudioBitrate(t,n){return n instanceof wn&&!n.isActive||!!n.muted||0!==t.sendBitrate}checkVideoDecode(t){return 0===t.receiveBitrate||0!==t.decodeFrameRate}}const oX={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},_i=new class{markSubscribeStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(t))}markPublishStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(t))}measureFromSubscribeStart(e,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(t));if(n.length>0){const i=n[n.length-1];return Math.round(performance.now()-i.startTime)}return 0}measureFromPublishStart(e,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(t));if(n.length>0){const i=n[n.length-1];return Math.round(performance.now()-i.startTime)}return 0}};var sX=Vt(To.Object.getOwnPropertySymbols),fFe=it,mFe=ID.indexOf,gFe=_y,VM=ug([].indexOf),aX=!!VM&&1/VM([1],1,-0)<0;fFe({target:"Array",proto:!0,forced:aX||!gFe("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return aX?VM(this,e,t)||0:mFe(this,e,t)}});var _Fe=$o("Array").indexOf,vFe=Wi,EFe=_Fe,BM=Array.prototype,cX=Vt(function(e){var t=e.indexOf;return e===BM||vFe(BM,e)&&t===BM.indexOf?EFe:t});function cs(e){if(Array.isArray(e))return e.map(n=>n);if(!lX(e))return e;const t={};for(const n in e){const i=e[n];t[n]=lX(i)||Array.isArray(i)?cs(i):i}return t}function lX(e){return!("object"!=typeof e||Array.isArray(e)||!e)}class jM{constructor(t){y(this,"input",[]),y(this,"size",void 0),this.size=t}add(t){this.input.push(t),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}}const Ma={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},a_={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:Ma,remoteCandidate:Ma}},dX={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0},uX={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},hX={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},pX={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function fX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function mX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}class HM{constructor(t,n){var i=this;y(this,"onFirstVideoReceived",void 0),y(this,"onFirstVideoDecoded",void 0),y(this,"onFirstAudioReceived",void 0),y(this,"onFirstVideoDecodedTimeout",void 0),y(this,"onFirstAudioDecoded",void 0),y(this,"onSelectedLocalCandidateChanged",void 0),y(this,"onSelectedRemoteCandidateChanged",void 0),y(this,"videoIsReady",!1),y(this,"videoIsReady2",{}),y(this,"pc",void 0),y(this,"options",void 0),y(this,"intervalTimer",void 0),y(this,"stats",cs(a_)),y(this,"isFirstVideoReceived",{}),y(this,"isFirstVideoDecoded",{}),y(this,"isFirstAudioReceived",{}),y(this,"isFirstAudioDecoded",{}),y(this,"isFirstVideoDecodedTimeout",{}),y(this,"lossRateWindowStats",[]),this.pc=t,this.options=n,this.intervalTimer=window.setInterval(C(function*(){i.updateStats()}),this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new q(t=>{t({local:mX({},Ma),remote:mX({},Ma)})})}setVideoIsReady(t){this.videoIsReady=t}setVideoIsReady2(t,n){this.videoIsReady2[t]=n}getVideoIsReady(t){return this.videoIsReady2[t]||!1}setIsFirstAudioDecoded(t){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(t){this.lossRateWindowStats.push(t),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const n=this.lossRateWindowStats.length,i=["videoSend","audioSend","videoRecv","audioRecv"];let r=0,o=0,s=0,a=0;for(const c of i)t[c].forEach((l,d)=>{if(!this.lossRateWindowStats[n-1][c][d]||!this.lossRateWindowStats[0][c][d])return;const u=this.lossRateWindowStats[n-1][c][d].packets-this.lossRateWindowStats[0][c][d].packets,h=this.lossRateWindowStats[n-1][c][d].packetsLost-this.lossRateWindowStats[0][c][d].packetsLost;"videoSend"===c||"audioSend"===c?(r+=u,s+=h):(o+=u,a+=h),l.packetLostRate=Number.isNaN(u)||Number.isNaN(u)||u<=0||h<=0?0:h/(u+h)});t.sendPacketLossRate=r<=0||s<=0?0:s/(r+s),t.recvPacketLossRate=o<=0||a<=0?0:a/(o+a)}}function gX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function SFe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}class CFe extends HM{constructor(){super(...arguments),y(this,"_stats",a_),y(this,"lastDecodeVideoReceiverStats",new Map)}updateStats(){var t=this;return C(function*(){const n=yield t._getStats(),i=t.statsResponsesToObjects(n);t._stats=cs(a_);const r=i.filter(s=>"ssrc"===s.type);t.processSSRCStats(r);const o=i.find(s=>"VideoBwe"===s.type);o&&t.processBandwidthStats(o),t._stats.timestamp=Date.now(),t.calcLossRate(t._stats),t.stats=t._stats})()}processBandwidthStats(t){this._stats.bitrate={actualEncoded:Number(t.googActualEncBitrate),targetEncoded:Number(t.googTargetEncBitrate),retransmit:Number(t.googRetransmitBitrate),transmit:Number(t.googTransmitBitrate)},this._stats.sendBandwidth=Number(t.googAvailableSendBandwidth)}processSSRCStats(t){t.forEach(n=>{var i;const r=Y(i=n.id).call(i,"send");switch("".concat(n.mediaType,"_").concat(r?"send":"recv")){case"video_send":{const o=cs(uX);o.codec=n.googCodecName,o.adaptionChangeReason="none",n.googCpuLimitedResolution&&(o.adaptionChangeReason="cpu"),n.googBandwidthLimitedResolution&&(o.adaptionChangeReason="bandwidth"),o.avgEncodeMs=Number(n.googAvgEncodeMs),o.inputFrame={width:Number(n.googFrameWidthInput)||Number(n.googFrameWidthSent),height:Number(n.googFrameHeightInput)||Number(n.googFrameHeightSent),frameRate:Number(n.googFrameRateInput)},o.sentFrame={width:Number(n.googFrameWidthSent),height:Number(n.googFrameHeightSent),frameRate:Number(n.googFrameRateInput)},o.firsCount=Number(n.googFirReceived),o.nacksCount=Number(n.googNacksReceived),o.plisCount=Number(n.googPlisReceived),o.frameCount=Number(n.framesEncoded),o.bytes=Number(n.bytesSent),o.packets=Number(n.packetsSent),o.packetsLost=Number(n.packetsLost),o.ssrc=Number(n.ssrc),o.rttMs=Number(n.googRtt||0),this._stats.videoSend.push(o),this._stats.rtt=o.rttMs;break}case"video_recv":{const o=cs(dX),s=this.lastDecodeVideoReceiverStats.get(Number(n.ssrc));if(o.codec=n.googCodecName,o.targetDelayMs=Number(n.googTargetDelayMs),o.renderDelayMs=Number(n.googRenderDelayMs),o.currentDelayMs=Number(n.googCurrentDelayMs),o.minPlayoutDelayMs=Number(n.googMinPlayoutDelayMs),o.decodeMs=Number(n.googDecodeMs),o.maxDecodeMs=Number(n.googMaxDecodeMs),o.receivedFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateReceived)},o.decodedFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateDecoded)},o.decodeFrameRate=Number(n.googFrameRateDecoded),o.outputFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateOutput)},o.jitterBufferMs=Number(n.googJitterBufferMs),o.firsCount=Number(n.googFirsSent),o.nacksCount=Number(n.googNacksSent),o.plisCount=Number(n.googPlisSent),o.framesDecodeCount=Number(n.framesDecoded),o.bytes=Number(n.bytesReceived),o.packets=Number(n.packetsReceived),o.packetsLost=Number(n.packetsLost),o.ssrc=Number(n.ssrc),o.packets>0&&!this.isFirstVideoReceived[o.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(o.ssrc),this.isFirstVideoReceived[o.ssrc]=!0),o.framesDecodeCount>0&&!this.isFirstVideoDecoded[o.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(o.ssrc,o.decodedFrame.width,o.decodedFrame.height),this.isFirstVideoDecoded[o.ssrc]=!0),s){const a=s.stats,c=Date.now()-s.lts;o.framesDecodeFreezeTime=a.framesDecodeFreezeTime,o.framesDecodeInterval=a.framesDecodeInterval,o.framesDecodeCount>a.framesDecodeCount&&this.isFirstVideoDecoded[o.ssrc]?(s.lts=Date.now(),o.framesDecodeInterval=c,o.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(n.ssrc,10))?o.framesDecodeFreezeTime+=o.framesDecodeInterval:this.setVideoIsReady2(parseInt(n.ssrc,10),!0))):o.framesDecodeCount<s.stats.framesDecodeCount&&(o.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(o.ssrc,{stats:SFe({},o),lts:Date.now()}),this._stats.videoRecv.push(o);break}case"audio_recv":{const o=cs(pX);o.codec=n.googCodecName,o.outputLevel=Math.abs(Number(n.audioOutputLevel))/32767,o.decodingCNG=Number(n.googDecodingCNG),o.decodingCTN=Number(n.googDecodingCTN),o.decodingCTSG=Number(n.googDecodingCTSG),o.decodingNormal=Number(n.googDecodingNormal),o.decodingPLC=Number(n.googDecodingPLC),o.decodingPLCCNG=Number(n.googDecodingPLCCNG),o.expandRate=Number(n.googExpandRate),o.accelerateRate=Number(n.googAccelerateRate),o.preemptiveExpandRate=Number(n.googPreemptiveExpandRate),o.secondaryDecodedRate=Number(n.googSecondaryDecodedRate),o.speechExpandRate=Number(n.googSpeechExpandRate),o.preferredJitterBufferMs=Number(n.googPreferredJitterBufferMs),o.jitterBufferMs=Number(n.googJitterBufferMs),o.jitterMs=Number(n.googJitterReceived),o.bytes=Number(n.bytesReceived),o.packets=Number(n.packetsReceived),o.packetsLost=Number(n.packetsLost),o.ssrc=Number(n.ssrc),o.receivedFrames=Number(n.googDecodingCTN)||Number(n.packetsReceived),o.droppedFrames=Number(n.googDecodingPLC)+Number(n.googDecodingPLCCNG)||Number(n.packetsLost),o.receivedFrames>0&&!this.isFirstAudioReceived[o.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(o.ssrc),this.isFirstAudioReceived[o.ssrc]=!0),o.decodingNormal>0&&!this.isFirstAudioDecoded[o.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(o.ssrc),this.isFirstAudioDecoded[o.ssrc]=!0),this._stats.audioRecv.push(o);break}case"audio_send":{const o=cs(hX);o.codec=n.googCodecName,o.inputLevel=Math.abs(Number(n.audioInputLevel))/32767,o.aecReturnLoss=Number(n.googEchoCancellationReturnLoss||0),o.aecReturnLossEnhancement=Number(n.googEchoCancellationReturnLossEnhancement||0),o.residualEchoLikelihood=Number(n.googResidualEchoLikelihood||0),o.residualEchoLikelihoodRecentMax=Number(n.googResidualEchoLikelihoodRecentMax||0),o.bytes=Number(n.bytesSent),o.packets=Number(n.packetsSent),o.packetsLost=Number(n.packetsLost),o.ssrc=Number(n.ssrc),o.rttMs=Number(n.googRtt||0),this._stats.rtt=o.rttMs,this._stats.audioSend.push(o);break}}})}_getStats(){return new q((t,n)=>{this.pc.getStats(t,n)})}statsResponsesToObjects(t){const n=[];return t.result().forEach(i=>{const r={id:i.id,timestamp:i.timestamp.valueOf().toString(),type:i.type};i.names().forEach(o=>{r[o]=i.stat(o)}),n.push(r)}),n}}function _X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function zd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_X(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_X(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}class vX extends HM{constructor(){super(...arguments),y(this,"_stats",a_),y(this,"report",void 0),y(this,"lastDecodeVideoReceiverStats",new Map),y(this,"lastVideoFramesRecv",new Map),y(this,"lastVideoFramesSent",new Map),y(this,"lastVideoFramesDecode",new Map),y(this,"lastVideoFramesOutput",new Map),y(this,"lastVideoJBDelay",new Map),y(this,"lastAudioJBDelay",new Map),y(this,"mediaBytesSent",new Map),y(this,"mediaBytesRetransmit",new Map),y(this,"mediaBytesTargetEncode",new Map),y(this,"lastEncoderMs",new Map)}updateStats(){var t=this;return C(function*(){t.report=yield t.pc.getStats(),t._stats=cs(a_),t.report.forEach(n=>{switch(n.type){case Qr.OUTBOUND:case Qr.INBOUND:{const i=n.mediaType||n.kind,r=!i&&"frameWidth"in n,o=!i&&!("frameWidth"in n);n.type===Qr.OUTBOUND?"audio"===i||o?t.processAudioOutboundStats(n):("video"===i||r)&&t.processVideoOutboundStats(n):n.type===Qr.INBOUND&&("audio"===i||o?t.processAudioInboundStats(n):("video"===i||r)&&t.processVideoInboundStats(n));break}case Qr.TRANSPORT:{const i=t.report.get(n.selectedCandidatePairId);i&&t.processCandidatePairStats(i);break}case Qr.CANDIDATE_PAIR:n.selected&&t.processCandidatePairStats(n)}}),t.updateSendBitrate(),t._stats.timestamp=Date.now(),t.calcLossRate(t._stats),t.stats=t._stats})()}getSelectedCandidatePair(){var t=this;return C(function*(){const n=yield t.pc.getStats(),i={local:zd({},Ma),remote:zd({},Ma)};return n.forEach(r=>{let o;if(r.type===Qr.TRANSPORT&&(o=n.get(r.selectedCandidatePairId)),r.type===Qr.CANDIDATE_PAIR&&r.selected&&(o=r),o){const s=(a,c)=>{a.type=c.type,a.id=c.id,c.address&&(a.address=c.address),c.candidateType&&(a.candidateType=c.candidateType),c.port&&(a.port=c.port),c.priority&&(a.priority=c.priority),c.protocol&&(a.protocol=c.protocol),c.relayProtocol&&(a.relayProtocol=c.relayProtocol)};if(o.localCandidateId){const a=n.get(o.localCandidateId);a&&s(i.local,a)}if(o.remoteCandidateId){const a=n.get(o.remoteCandidateId);a&&s(i.remote,a)}}}),i})()}processCandidatePairStats(t){if(this._stats.sendBandwidth=t.availableOutgoingBitrate||0,t.currentRoundTripTime&&(this._stats.rtt=1e3*t.currentRoundTripTime),this._stats.videoSend.forEach(n=>{t.currentRoundTripTime&&(n.rttMs=1e3*t.currentRoundTripTime)}),this._stats.audioSend.forEach(n=>{t.currentRoundTripTime&&(n.rttMs=1e3*t.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=t.id,t.localCandidateId){const n=this.report.get(t.localCandidateId);n&&this.processCandidateStats(n)}if(t.remoteCandidateId){const n=this.report.get(t.remoteCandidateId);n&&this.processCandidateStats(n)}}processCandidateStats(t){let n;t.type===Qr.LOCAL_CANDIDATE&&(n=this._stats.selectedCandidatePair.localCandidate),t.type===Qr.REMOTE_CANDIDATE&&(n=this._stats.selectedCandidatePair.remoteCandidate),n&&(n.type=t.type,n.id=t.id,t.address&&(n.address=t.address),t.candidateType&&(n.candidateType=t.candidateType),t.port&&(n.port=t.port),t.priority&&(n.priority=t.priority),t.protocol&&(n.protocol=t.protocol),t.relayProtocol&&(n.relayProtocol=t.relayProtocol),t.type===Qr.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==n.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(zd({},n),zd({},this.stats.selectedCandidatePair.localCandidate)),t.type===Qr.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==n.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(zd({},n),zd({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(t){let n=this._stats.audioRecv.find(i=>i.ssrc===t.ssrc);n||(n=cs(pX),this._stats.audioRecv.push(n)),n.ssrc=t.ssrc,n.packets=t.packetsReceived,n.packetsLost=t.packetsLost,n.packetsDiscarded=t.packetsDiscarded,n.bytes=t.bytesReceived,n.jitterMs=1e3*t.jitter,this.processAudioTrackReceiverStats(t,t.trackId,n),t.codecId&&(n.codec=this.getCodecFromCodecStats(t.codecId)),n.receivedFrames||(n.receivedFrames=t.packetsReceived),n.droppedFrames||(n.droppedFrames=t.packetsLost),n.receivedFrames>0&&!this.isFirstAudioReceived[n.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(n.ssrc),this.isFirstAudioReceived[n.ssrc]=!0),n.outputLevel&&n.outputLevel>0&&!this.isFirstAudioDecoded[n.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(n.ssrc),this.isFirstAudioDecoded[n.ssrc]=!0),"number"==typeof t.concealedSamples&&(n.concealedSamples=t.concealedSamples)}processVideoInboundStats(t){let n=this._stats.videoRecv.find(a=>a.ssrc===t.ssrc);n||(n=cs(dX),this._stats.videoRecv.push(n)),n.ssrc=t.ssrc,n.packets=t.packetsReceived,n.packetsLost=t.packetsLost,n.bytes=t.bytesReceived,n.firsCount=t.firCount,n.nacksCount=t.nackCount,n.plisCount=t.pliCount,n.framesDecodeCount=t.framesDecoded,n.framesDroppedCount=t.framesDropped,n.totalInterFrameDelay=t.totalInterFrameDelay,n.totalSquaredInterFrameDelay=t.totalSquaredInterFrameDelay,n.totalFreezesDuration=t.totalFreezesDuration;const i=this.lastDecodeVideoReceiverStats.get(n.ssrc),r=this.lastVideoFramesDecode.get(n.ssrc),o=this.lastVideoFramesOutput.get(n.ssrc),s=Date.now();if(n.framesDecodeCount>0&&!this.isFirstVideoDecoded[n.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(n.ssrc,n.decodedFrame?n.decodedFrame.width:0,n.decodedFrame?n.decodedFrame.height:0),this.isFirstVideoDecoded[n.ssrc]=!0),i){const a=i.stats,c=s-i.lts;n.framesDecodeFreezeTime=a.framesDecodeFreezeTime,n.framesDecodeInterval=a.framesDecodeInterval,!this.isFirstVideoDecoded[n.ssrc]&&c>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[n.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(n.ssrc),this.isFirstVideoDecodedTimeout[n.ssrc]=!0),n.framesDecodeCount>a.framesDecodeCount&&this.isFirstVideoDecoded[n.ssrc]?(i.lts=Date.now(),n.framesDecodeInterval=c,n.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(t.ssrc))?n.framesDecodeFreezeTime+=n.framesDecodeInterval:this.setVideoIsReady2(parseInt(t.ssrc,10),!0))):n.framesDecodeCount<a.framesDecodeCount&&(n.framesDecodeInterval=0),t.framesDecoded&&t.qpSum&&(n.qpSumPerFrame=i.stats.framesDecodeCount>t.framesDecoded?t.qpSum/t.framesDecoded:(t.qpSum-i.qpSum)/(t.framesDecoded-i.stats.framesDecodeCount))}r&&s-r.lts>=800?(n.decodeFrameRate=Math.round((n.framesDecodeCount-r.count)/((s-r.lts)/1e3)),this.lastVideoFramesDecode.set(n.ssrc,{count:n.framesDecodeCount,lts:s,rate:n.decodeFrameRate})):r?n.decodeFrameRate=r.rate:this.lastVideoFramesDecode.set(n.ssrc,{count:n.framesDecodeCount,lts:s,rate:0}),n.framesDroppedCount&&t.framesReceived&&(o&&s-o.lts>=800?(n.outputFrameRate=Math.round((t.framesReceived-n.framesDroppedCount-o.count)/((s-o.lts)/1e3)),this.lastVideoFramesOutput.set(n.ssrc,{count:t.framesReceived-n.framesDroppedCount,lts:s,rate:Math.max(n.outputFrameRate,0)})):o?n.outputFrameRate=o.rate:this.lastVideoFramesOutput.set(n.ssrc,{count:t.framesReceived-n.framesDroppedCount,lts:s,rate:0})),t.totalDecodeTime&&(n.decodeMs=1e3*t.totalDecodeTime),this.processVideoTrackReceiverStats(t,t.trackId,n),t.codecId&&(n.codec=this.getCodecFromCodecStats(t.codecId)),t.framerateMean&&(n.framesRateFirefox=t.framerateMean),n.packets>0&&!this.isFirstVideoReceived[n.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(n.ssrc),this.isFirstVideoReceived[n.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(n.ssrc,{stats:zd({},n),lts:i?i.lts:Date.now(),qpSum:t.qpSum})}processVideoOutboundStats(t){let n=this._stats.videoSend.find(r=>r.ssrc===t.ssrc);n||(n=cs(uX),this._stats.videoSend.push(n));const i=this.mediaBytesSent.get(t.ssrc);if(i)i.add(t.bytesSent);else{const r=new jM(10);r.add(t.bytesSent),this.mediaBytesSent.set(t.ssrc,r)}if(void 0!==t.retransmittedBytesSent){const r=this.mediaBytesRetransmit.get(t.ssrc);if(r)r.add(t.retransmittedBytesSent);else{const o=new jM(10);o.add(t.retransmittedBytesSent),this.mediaBytesRetransmit.set(t.ssrc,o)}}if(t.totalEncodedBytesTarget){const r=this.mediaBytesTargetEncode.get(t.ssrc);if(r)r.add(t.totalEncodedBytesTarget);else{const o=new jM(10);o.add(t.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(t.ssrc,o)}}if(n.ssrc=t.ssrc,n.bytes=t.bytesSent,n.packets=t.packetsSent,n.firsCount=t.firCount,n.nacksCount=t.nackCount,n.plisCount=t.pliCount,n.frameCount=t.framesEncoded,n.adaptionChangeReason=t.qualityLimitationReason,n.scalabilityMode=t.scalabilityMode,t.totalEncodeTime&&t.framesEncoded){const r=this.lastEncoderMs.get(t.ssrc);n.avgEncodeMs=!r||r.lastFrameCount>t.framesEncoded?1e3*t.totalEncodeTime/t.framesEncoded:1e3*(t.totalEncodeTime-r.lastEncoderTime)/(t.framesEncoded-r.lastFrameCount)}if(t.framesEncoded&&t.qpSum){const r=this.lastEncoderMs.get(t.ssrc);n.qpSumPerFrame=!r||r.lastFrameCount>t.framesEncoded?t.qpSum/t.framesEncoded:(t.qpSum-r.lastQpSum)/(t.framesEncoded-r.lastFrameCount)}if(this.lastEncoderMs.set(t.ssrc,{lastFrameCount:t.framesEncoded,lastEncoderTime:t.totalEncodeTime,lastQpSum:t.qpSum,lts:Date.now()}),t.codecId&&(n.codec=this.getCodecFromCodecStats(t.codecId)),t.mediaSourceId&&this.processVideoMediaSource(t.mediaSourceId,n),this.processVideoTrackSenderStats(t,t.trackId,n),t.remoteId)this.processRemoteInboundStats(t.remoteId,n);else{const r=this.findRemoteStatsId(t.ssrc,Qr.REMOTE_INBOUND);r&&this.processRemoteInboundStats(r,n)}}processAudioOutboundStats(t){let n=this._stats.audioSend.find(i=>i.ssrc===t.ssrc);if(n||(n=cs(hX),this._stats.audioSend.push(n)),n.ssrc=t.ssrc,n.packets=t.packetsSent,n.bytes=t.bytesSent,t.mediaSourceId&&this.processAudioMediaSource(t.mediaSourceId,n),t.codecId&&(n.codec=this.getCodecFromCodecStats(t.codecId)),this.processAudioTrackSenderStats(t,t.trackId,n),t.remoteId)this.processRemoteInboundStats(t.remoteId,n);else{const i=this.findRemoteStatsId(t.ssrc,Qr.REMOTE_INBOUND);i&&this.processRemoteInboundStats(i,n)}}findRemoteStatsId(t,n){var i;const r=Array.from(gc(i=this.report).call(i)).find(o=>o.type===n&&o.ssrc===t);return r?r.id:null}processVideoMediaSource(t,n){const i=this.report.get(t);i&&i.width&&i.height&&i.framesPerSecond&&(n.inputFrame={width:i.width,height:i.height,frameRate:i.framesPerSecond})}processAudioMediaSource(t,n){const i=this.report.get(t);i&&(n.inputLevel=i.audioLevel)}processVideoTrackSenderStats(t,n,i){var r,o,s,a;const c=n?this.report.get(n):void 0,l=null!==(r=c?.framesSent)&&void 0!==r?r:t.framesSent;if("number"!=typeof l)return;let d=null!==(o=c?.frameWidth)&&void 0!==o?o:t.frameWidth,u=null!==(s=c?.frameHeight)&&void 0!==s?s:t.frameHeight,h=null!==(a=c?.framesPerSecond)&&void 0!==a?a:t.framesPerSecond;if("number"==typeof d&&"number"==typeof u||(d=0,u=0),null==h){const p=Date.now(),m=this.lastVideoFramesSent.get(i.ssrc);m&&p-m.lts>=800?(h=Math.round((l-m.count)/((p-m.lts)/1e3)),this.lastVideoFramesSent.set(i.ssrc,{count:l,lts:p,rate:h})):m?h=m.rate:this.lastVideoFramesSent.set(i.ssrc,{count:l,lts:p,rate:0})}i.sentFrame={width:d,height:u,frameRate:Math.max(0,h)}}processVideoTrackReceiverStats(t,n,i){var r,o,s,a,c;const l=n?this.report.get(n):void 0,d=null!==(r=l?.framesReceived)&&void 0!==r?r:t.framesReceived,u=null!==(o=l?.frameWidth)&&void 0!==o?o:t.frameWidth,h=null!==(s=l?.frameHeight)&&void 0!==s?s:t.frameHeight,p=null!==(a=l?.jitterBufferDelay)&&void 0!==a?a:t.jitterBufferDelay,m=null!==(c=l?.jitterBufferEmittedCount)&&void 0!==c?c:t.jitterBufferEmittedCount;if("number"==typeof d){const f=this.lastVideoFramesRecv.get(i.ssrc),g=Date.now();i.framesReceivedCount=d;let E=0;f&&g-f.lts>=800?(E=Math.round((d-f.count)/((g-f.lts)/1e3)),this.lastVideoFramesRecv.set(i.ssrc,{count:d,lts:g,rate:E})):f?E=f.rate:this.lastVideoFramesRecv.set(i.ssrc,{count:d,lts:g,rate:0}),i.receivedFrame={width:u||0,height:h||0,frameRate:E||0},i.decodedFrame={width:u||0,height:h||0,frameRate:i.decodeFrameRate||0},i.outputFrame={width:u||0,height:h||0,frameRate:i.outputFrameRate||i.decodeFrameRate||0}}if(p&&m){const f=this.lastVideoJBDelay.get(i.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let g=f.jitterBufferMs;const E=m-f.jitterBufferEmittedCount;E>0&&(g=1e3*(p-f.jitterBufferDelay)/E),i.jitterBufferMs=g,i.currentDelayMs=Math.round(g),this.lastVideoJBDelay.set(i.ssrc,{jitterBufferDelay:p,jitterBufferEmittedCount:m,jitterBufferMs:i.currentDelayMs})}}processAudioTrackSenderStats(t,n,i){var r,o,s,a;const c=n?this.report.get(n):void 0,l=null!==(r=null!==(o=c?.echoReturnLoss)&&void 0!==o?o:t.echoReturnLoss)&&void 0!==r?r:0,d=null!==(s=null!==(a=c?.echoReturnLossEnhancement)&&void 0!==a?a:t.echoReturnLossEnhancement)&&void 0!==s?s:0;i.aecReturnLoss=l,i.aecReturnLossEnhancement=d}processAudioTrackReceiverStats(t,n,i){var r,o,s,a,c,l,d;const u=n?this.report.get(n):void 0,h=null!==(r=u?.removedSamplesForAcceleration)&&void 0!==r?r:t.removedSamplesForAcceleration,p=null!==(o=u?.totalSamplesReceived)&&void 0!==o?o:t.totalSamplesReceived,m=null!==(s=u?.jitterBufferDelay)&&void 0!==s?s:t.jitterBufferDelay,f=null!==(a=u?.jitterBufferEmittedCount)&&void 0!==a?a:t.jitterBufferEmittedCount,g=null!==(c=u?.audioLevel)&&void 0!==c?c:t?.audioLevel,E=null!==(l=u?.totalSamplesDuration)&&void 0!==l?l:t?.totalSamplesDuration,b=null!==(d=u?.concealedSamples)&&void 0!==d?d:t.concealedSamples;if(h&&p&&(i.accelerateRate=h/p),m&&f){const I=this.lastAudioJBDelay.get(i.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let D=I.jitterBufferMs;const O=f-I.jitterBufferEmittedCount;O>0&&(D=1e3*(m-I.jitterBufferDelay)/O),i.jitterBufferMs=Math.round(D),this.lastAudioJBDelay.set(i.ssrc,{jitterBufferDelay:m,jitterBufferEmittedCount:f,jitterBufferMs:i.jitterBufferMs})}i.outputLevel=g;let T=1920;E&&p&&(T=p/E/50,i.receivedFrames=Math.round(p/T)),b&&(i.droppedFrames=Math.round(b/T))}processRemoteInboundStats(t,n){const i=this.report.get(t);i&&(n.packetsLost=i.packetsLost,i.roundTripTime&&(n.rttMs=1e3*i.roundTripTime),i.jitter&&(n.jitterMs=1e3*i.jitter),i.timestamp&&(n.timestamp=i.timestamp))}getCodecFromCodecStats(t){const n=this.report.get(t);if(!n)return"";const i=n.mimeType.match(/\/(.*)$/);return i&&i[1]?i[1]:""}updateSendBitrate(){let t=0,n=null,i=null;this.mediaBytesSent.forEach(o=>{t+=o.diffMean()}),this.mediaBytesRetransmit.forEach(o=>{n=null===n?o.diffMean():n+o.diffMean()}),this.mediaBytesTargetEncode.forEach(o=>{i=null===i?o.diffMean():i+o.diffMean()}),this._stats.bitrate={actualEncoded:8*(null!==n?t-n:t)/(this.options.updateInterval/1e3),transmit:8*t/(this.options.updateInterval/1e3)},null!==n&&(this._stats.bitrate.retransmit=8*n/(this.options.updateInterval/1e3)),null!==i&&(this._stats.bitrate.targetEncoded=8*i/(this.options.updateInterval/1e3))}}class TFe extends HM{updateStats(){return q.resolve()}}function GM(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e4;const o=function(){const s=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return s&&s[0]?Number(s[0].split("/")[1]):null}();return o?o<76?new CFe(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:i,firstVideoDecodedTimeout:r}):new vX(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:i,firstVideoDecodedTimeout:r}):function(s){if(!window.RTCStatsReport)return!1;const a=s.getStats();return!(!(a instanceof q)&&(c=a,!c||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof c.then));var c}(e)?new vX(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:i,firstVideoDecodedTimeout:r}):new TFe(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:i,firstVideoDecodedTimeout:r})}let EX=class{get localCapabilities(){return dn(this._localCapabilities)}get rtpCapabilities(){return dn(this._rtpCapabilities)}get candidates(){return dn(this._candidates)}get iceParameters(){return dn(this._iceParameters)}get dtlsParameters(){return dn(this._dtlsParameters)}constructor(e){y(this,"sessionDesc",void 0),y(this,"_localCapabilities",void 0),y(this,"_rtpCapabilities",void 0),y(this,"_candidates",void 0),y(this,"_iceParameters",void 0),y(this,"_dtlsParameters",void 0),y(this,"setup",void 0),y(this,"currentMidIndex",void 0),y(this,"cname","o/i14u9pJrxRKAsu"),y(this,"firefoxSsrcMidMap",new Map),e=dn(e);const{remoteIceParameters:t,remoteDtlsParameters:n,candidates:i,remoteRTPCapabilities:r,localCapabilities:o,direction:s,setup:a,videoCodec:c,audioCodec:l}=e;let d;this.setup=a,d=Zn.parse(s===Yi.RECEIVE_ONLY?"v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=extmap-allow-mixed\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n":"v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=extmap-allow-mixed\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=recvonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=recvonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n"),this._rtpCapabilities=r,this._candidates=i,this._iceParameters=t,this._dtlsParameters=n,this._localCapabilities=o;const u=s===Yi.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,h=s===Yi.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,p=s===Yi.RECEIVE_ONLY?r.send.videoCodecs:r_(ie.VIDEO,u,h,c),m=s===Yi.RECEIVE_ONLY?r.send.audioCodecs:r_(ie.AUDIO,u,h,l);for(const f of d.mediaDescriptions)f.attributes.iceUfrag=t.iceUfrag,f.attributes.icePwd=t.icePwd,f.attributes.fingerprints=n.fingerprints,f.attributes.candidates=i,f.attributes.setup=this.setup,"application"===f.media.mediaType&&(f.attributes.sctpPort="5000"),"video"===f.media.mediaType&&(f.media.fmts=p.map(g=>g.payloadType.toString(10)),f.attributes.payloads=p,f.attributes.extmaps=u.videoExtensions),"audio"===f.media.mediaType&&(f.media.fmts=m.map(g=>g.payloadType.toString(10)),f.attributes.payloads=m,f.attributes.extmaps=u.audioExtensions,Fp(f));this.sessionDesc=d,this.currentMidIndex=d.mediaDescriptions.length-1}toString(){return Zn.print(this.sessionDesc)}hasMid(e){return Array.isArray(e)?e.every(t=>this.hasMid(t)):this.sessionDesc.mediaDescriptions.some(t=>t.attributes.mid===e)}send(e,t,n,i,r){n=n.replace(/ /g,"-");const{ssrcs:o,ssrcGroups:s}=Wd(t,this.cname,R("SYNC_GROUP")?n:void 0),a=this.findPreloadMediaDesc(o);if(a){if(Bt()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,a.attributes.mid),r&&(r.twcc||r.remb)){const c=this.sessionDesc.mediaDescriptions.indexOf(a);return this.sessionDesc.mediaDescriptions[c]=this.mungSendMediaDesc(a,r),{mid:a.attributes.mid,needExchangeSDP:!0}}return{mid:a.attributes.mid,needExchangeSDP:!1}}{const c=this.findAvailableMediaIndex(e,o,i);let l;return-1===c?(l=this.createOrRecycleSendMedia(e,o,s,"sendonly",i,r),this.updateBundleMids()):(l=dn(this.sessionDesc.mediaDescriptions[c]),l.attributes.direction="sendonly",l.attributes.ssrcs=o,l.attributes.ssrcGroups=s,this.sessionDesc.mediaDescriptions[c]=this.mungSendMediaDesc(l,r)),Bt()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,l.attributes.mid),{needExchangeSDP:!0,mid:l.attributes.mid}}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter(n=>n.attributes.mid&&-1!==e.indexOf(n.attributes.mid));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach(n=>{n.attributes.ssrcs=[]}),this.updateBundleMids()}receive(e,t,n){const i=[];return e.forEach(r=>{const s=this.findAvailableRecvMediaIndex(r._mediaStreamTrack.kind);let a,c=!1;-1===s?(c=!0,a=this.createOrRecycleRecvMedia(r,[],"recvonly",t,n),this.updateBundleMids()):(a=dn(this.sessionDesc.mediaDescriptions[s]),a.attributes.direction="recvonly"),i.push({mid:a.attributes.mid,needCreateTransceiver:c})}),i}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter(n=>-1!==e.indexOf(n.attributes.mid));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach(n=>{n.media.port="0",n.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(e){const{foundation:t,protocol:n,address:i,port:r,type:o,relatedAddress:s,relatedPort:a,priority:c}=new RTCIceCandidate(e),l={foundation:t??"",componentId:"1",transport:n??"",priority:c?c+"":"",connectionAddress:i??"",port:r?r+"":"",type:o?o+"":"",relAddr:s??"",relPort:a?a+"":"",extension:{}};this.candidates.some(d=>d.priority===l.priority&&d.connectionAddress===l.connectionAddress&&d.port===l.port)||(this._candidates.push(l),this.sessionDesc.mediaDescriptions.forEach(d=>{d.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(e,t,n,i,r){const o=e._mediaStreamTrack.kind,s=this.rtpCapabilities.recv,a=r_(o,s,this.localCapabilities.send,o===ie.AUDIO?r:i),c=o===ie.VIDEO?s.videoExtensions:s.audioExtensions,l="".concat(++this.currentMidIndex);let d={media:{mediaType:o,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:a.map(h=>h.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:a,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(l)}};d=this.mungRecvMediaDsec(d,e);const u=this.findFirstClosedMedia(o);if(u){const h=this.sessionDesc.mediaDescriptions.indexOf(u);this.sessionDesc.mediaDescriptions[h]=d}else this.sessionDesc.mediaDescriptions.push(d);return d}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter(n=>Y(e).call(e,n.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(n=>{n.attributes.direction="inactive"})}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter(n=>Y(e).call(e,n.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(n=>{n.attributes.direction="recvonly"})}findAvailableMediaIndex(e,t,n){return this.sessionDesc.mediaDescriptions.findIndex(i=>{const r=i.media.mediaType===e&&"0"!==i.media.port&&("sendonly"===i.attributes.direction||"sendrecv"===i.attributes.direction)&&0===i.attributes.ssrcs.length;if(Bt()){if(r){const o=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(o||"0"!==i.attributes.mid&&"1"!==i.attributes.mid)||!(!o||o!==i.attributes.mid)}return!1}return r&&i.attributes.mid===n})}findAvailableRecvMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex(t=>"0"!==t.attributes.mid&&"1"!==t.attributes.mid&&t.media.mediaType===e&&"0"!==t.media.port&&("recvonly"===t.attributes.direction||"sendrecv"===t.attributes.direction))}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}restartICE(e){e=dn(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd})}createOrRecycleSendMedia(e,t,n,i,r,o){const s=this.rtpCapabilities.send,a=e===ie.VIDEO?s.videoCodecs:s.audioCodecs,c=e===ie.VIDEO?s.videoExtensions:s.audioExtensions;Bt()&&(r="".concat(++this.currentMidIndex));let l={media:{mediaType:e,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:a.map(u=>u.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:a,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:r}};l=this.mungSendMediaDesc(l,o);const d=this.findFirstClosedMedia(e);if(d){const u=this.sessionDesc.mediaDescriptions.indexOf(d);this.sessionDesc.mediaDescriptions[u]=l}else this.sessionDesc.mediaDescriptions.push(l);return l}mungRecvMediaDsec(e,t,n){const i=dn(e);return gM(i),Lp(i,t),_M(i,t),V$(i),aC(i,n,this.localCapabilities.send),i}mungSendMediaDesc(e,t){const n=dn(e);return aC(n,t,this.localCapabilities.recv),Fp(n),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex(i=>i.attributes.mid===e);if(-1!==n){const i=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=i}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>"0"!==e.media.port).map(e=>e.attributes.mid)}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(t=>{var n;return(null===(n=t.attributes)||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId)===e[0].ssrcId})}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(t=>Bt()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port)}};const wFe=["sdp"];var vt;function bX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function wl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}let yX=(vt=class Jp extends jK{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,n;return null!==(t=null===(n=this.peerConnection.getReceivers()[0])||void 0===n||null===(n=n.transport)||void 0===n?void 0:n.state)&&void 0!==t?t:null}get localCodecs(){return[]}set isInRestartIce(t){this._isInRestartIce=t}get isInRestartIce(){return this._isInRestartIce}constructor(t,n,i){super(t,n),y(this,"direction",void 0),y(this,"name",void 0),y(this,"store",void 0),y(this,"spec",void 0),y(this,"peerConnection",void 0),y(this,"initialOffer",void 0),y(this,"transport",void 0),y(this,"statsFilter",void 0),y(this,"localCandidateCount",0),y(this,"_isInRestartIce",!1),y(this,"mutex",new mi("P2PConnection-mutex")),y(this,"onLocalCandidate",void 0),y(this,"remoteSDP",void 0),y(this,"pendingCandidates",[]),y(this,"localCapabilities",void 0),y(this,"isReady",!1),y(this,"restartCnt",0),y(this,"curTurnServerIndex",0),this.store=n,this.spec=t,this.peerConnection=new RTCPeerConnection(Jp.resolvePCConfiguration(t,n.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=i??Yi.SEND_ONLY,this.name=this.direction===Yi.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=GM(this.peerConnection,R("STATS_UPDATE_INTERVAL"),void 0,Bt()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}establish(t){var n=this;return C(function*(){try{const i=yield j$();if(n.localCapabilities=cC(i),t){const{sdp:r}=t,o=function yFe(e,t){if(null==e)return{};var n,i,r=function(s,a){if(null==s)return{};var c,l,d={},u=xK(s);for(l=0;l<u.length;l++)c=u[l],cX(a).call(a,c)>=0||(d[c]=s[c]);return d}(e,t);if(sX){var o=sX(e);for(i=0;i<o.length;i++)n=o[i],cX(t).call(t,n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(t,wFe),s=function(){const u={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},h=i_(arguments.length>2?arguments[2]:void 0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"sendonly"),p={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},m={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},f={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(as(h,u,"videoExtensions",p,m,f),as(h,u,"videoCodecs",p,m,f),as(h,u,"audioExtensions",p,m,f),as(h,u,"audioCodecs",p,m,f),R("RAISE_H264_BASELINE_PRIORITY")){const g=f.videoCodecs.findIndex(E=>E.rtpMap&&"h264"===E.rtpMap.encodingName.toLocaleLowerCase()&&E.fmtp&&"42001f"===E.fmtp.parameters["profile-level-id"]);if(-1!==g){const E=f.videoCodecs.findIndex(b=>b.rtpMap&&"h264"===b.rtpMap.encodingName.toLocaleLowerCase());if(E<g){_.debug("raising H264 baseline profile priority");const b=f.videoCodecs[g];f.videoCodecs.splice(g,1),f.videoCodecs.splice(E,0,b)}-1!==E&&R("FILTER_SEND_H264_BASELINE")&&(p.videoCodecs=p.videoCodecs.filter(b=>!(b.rtpMap&&"h264"===b.rtpMap.encodingName.toLocaleLowerCase()&&b.fmtp&&"42001f"!==b.fmtp.parameters["profile-level-id"])))}}return{send:p,recv:m,sendrecv:f}}({},{},r);n.remoteSDP=new EX({remoteIceParameters:o.iceParameters,remoteDtlsParameters:o.dtlsParameters,candidates:[],remoteRTPCapabilities:s,localCapabilities:n.localCapabilities,direction:n.direction,setup:"actpass",videoCodec:n.store.codec,audioCodec:n.store.audioCodec}),yield n.setRemoteDescription({type:"offer",sdp:n.remoteSDP.toString()}),n.isReady=!0;const a=yield n.peerConnection.createAnswer();if(!a.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const c=Cl(a.sdp);yield n.peerConnection.setLocalDescription(a);const l=yield H$({},{},a.sdp);n.localCapabilities=cC(l);const d=n.peerConnection.getTransceivers()[0];return null!=d&&d.receiver&&d.receiver.transport&&n.tryBindTransportEvents(d.receiver.transport),wl(wl({},c),{},{sdp:a.sdp})}{n.peerConnection.addTransceiver("video",{direction:"sendonly"}),n.peerConnection.addTransceiver("audio",{direction:"sendonly"});const r=yield n.peerConnection.createOffer();if(!r.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const o=Cl(r.sdp);return n.initialOffer=r,wl(wl({},o),{},{sdp:r.sdp})}}catch(i){throw new M(S.GET_LOCAL_CONNECTION_PARAMS_FAILED,i.toString())}})()}connect(t){var n=this;return C(function*(){try{if(!n.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");yield n.peerConnection.setLocalDescription(n.initialOffer);const{sdp:i,iceParameters:r,dtlsParameters:o}=t,s=yield H$({},{},i);n.remoteSDP=new EX({remoteIceParameters:r,remoteDtlsParameters:o,candidates:[],remoteRTPCapabilities:s,localCapabilities:n.localCapabilities,direction:n.direction,setup:"active",videoCodec:n.store.codec,audioCodec:n.store.audioCodec}),yield n.setRemoteDescription({type:"answer",sdp:n.remoteSDP.toString()});const a=n.peerConnection.getTransceivers()[0];null!=a&&a.sender&&a.sender.transport&&n.tryBindTransportEvents(a.sender.transport)}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(i.toString()))}})()}addRemoteCandidate(t){var n=this;return C(function*(){try{t&&n.pendingCandidates.push(t),n.peerConnection.remoteDescription&&n.isReady&&(n.pendingCandidates.forEach(i=>{n.peerConnection.addIceCandidate(i)}),n.pendingCandidates=[])}catch(i){throw new M(S.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(i.toString()))}})()}send(t,n,i){var r=this;return Do(function*(){const o=yield Ne(r.mutex.lock("From P2PConnection.send"));try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const s=[],a=r.remoteSDP.receive(t,n,i);t.forEach((g,E)=>{if(a[E].needCreateTransceiver){const b=r.peerConnection.addTransceiver(g._mediaStreamTrack,{direction:"sendonly"});s.push(b),g._updateRtpTransceiver(b)}else{const b=r.peerConnection.getTransceivers().find(T=>T.mid===a[E].mid);if(!b)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(a[E].mid));s.push(b),g._updateRtpTransceiver(b)}}),Bt()&&!0===R("SIMULCAST")&&(yield Ne(r.applySimulcastForFirefox(s,t)));const c=a.map(g=>g.mid),l=yield Ne(r.peerConnection.createOffer()),d=r.mungSendOfferSDP(l.sdp,t,c),u=Zn.parse(d),h=c.map(g=>{const E=u.mediaDescriptions.find(b=>b.attributes.mid===g);if(!E)throw new Error("Cannot extract ssrc from mediaDescription.");return L$(E,R("USE_PUB_RTX"))}),p=s.map((g,E)=>({localSSRC:h[E],id:c[E]}));yield Ne(r.peerConnection.setLocalDescription({type:"offer",sdp:d}));try{yield p}catch(g){const E=r.remoteSDP.toString();throw yield Ne(r.peerConnection.setLocalDescription({type:"offer",sdp:d})),yield Ne(r.peerConnection.setRemoteDescription({type:"answer",sdp:E})),yield Ne(r.stopSending(c,!0)),g}yield Ne(r.applySimulcastEncodings(s,t)),yield Ne(r.applySendEncodings(s,t));const m=r.remoteSDP.toString(),f=r.logSDPExchange(d,"offer","local","send");return f?.(m),yield Ne(r.setRemoteDescription({type:"answer",sdp:m})),s.map((g,E)=>({localSSRC:h[E],id:c[E]}))}catch(s){throw s instanceof M?s:new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(s.toString()))}finally{o()}})()}stopSending(t,n){var i=this;return C(function*(){const r=n?void 0:yield i.mutex.lock("From P2PConnection.stopSending");try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const o=i.peerConnection.getTransceivers().filter(l=>-1!==t.indexOf(l.mid));if(o.length!==t.length)throw new Error("Transceivers' length (".concat(o.length,") doesn't match mids' length (").concat(t.length,") when trying to call P2PConnection.stopSending."));o.map(l=>{var d;l.direction="inactive",null===(d=l.stop)||void 0===d||d.call(l)});const s=yield i.peerConnection.createOffer(),a=i.logSDPExchange(s.sdp||"","offer","local","stopSending");yield i.peerConnection.setLocalDescription(s),i.remoteSDP.stopReceiving(t);const c=i.remoteSDP.toString();a?.(c),yield i.setRemoteDescription({type:"answer",sdp:c})}catch(o){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(o.toString()))}finally{r&&r()}})()}receive(t,n,i,r){var o=this;return C(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:s,needExchangeSDP:a}=o.remoteSDP.send(t,n,i,r);if(a){const l=o.remoteSDP.toString(),d=o.logSDPExchange(l,"offer","remote","receive");yield o.setRemoteDescription({type:"offer",sdp:l});const u=yield o.peerConnection.createAnswer(),h=o.mungReceiveAnswerSDP(u.sdp,s,t);d?.(h||""),yield o.peerConnection.setLocalDescription({type:"answer",sdp:h}),_.debug("[".concat(o.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else _.debug("[".concat(o.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."));const c=o.peerConnection.getTransceivers().find(l=>l.mid===s);if(!c||null===c.mid)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:c.receiver.track,mid:c.mid,transceiver:c}}catch(s){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}})()}mockReceive(t,n,i,r){var o=this;return C(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:s,needExchangeSDP:a}=o.remoteSDP.send(t,n,i,r);if(a){const c=o.remoteSDP.toString(),l=o.logSDPExchange(c,"offer","remote","receive");yield o.setRemoteDescription({type:"offer",sdp:c});const d=yield o.peerConnection.createAnswer(),u=o.mungReceiveAnswerSDP(d.sdp,s,t);l?.(u||""),yield o.peerConnection.setLocalDescription({type:"answer",sdp:u}),_.debug("[".concat(o.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else _.debug("[".concat(o.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."))}catch(s){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}})()}stopReceiving(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");n.remoteSDP.stopSending(t);const i=n.remoteSDP.toString(),r=n.logSDPExchange(i,"offer","remote","stopReceiving");yield n.setRemoteDescription({type:"offer",sdp:i});const o=yield n.peerConnection.createAnswer();r?.(o.sdp||""),yield n.peerConnection.setLocalDescription(o)}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}})()}restartICE(t){var n=this;return C(function*(){try{if(n.store.p2pTransport===xd.Auto&&(n.store.p2pTransport=xd.SdRtn,Fe().supportPCSetConfiguration&&n.peerConnection.setConfiguration(Jp.resolvePCConfiguration(n.spec,n.store.p2pTransport))),n.restartCnt>3&&(n.restartCnt=0,Fe().supportPCSetConfiguration&&n.peerConnection.setConfiguration(Jp.resolvePCConfiguration(n.spec,n.store.p2pTransport,++n.curTurnServerIndex))),!t){n.restartCnt++,n.isReady=!1;const i=yield n.peerConnection.createOffer({iceRestart:!0});if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:r}=Cl(i.sdp);return n.store.descriptionStart(),n.direction===Yi.SEND_ONLY&&(yield n.peerConnection.setLocalDescription(i)),r}if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(n.remoteSDP.restartICE(t),n.store.descriptionStart(),n.direction===Yi.RECEIVE_ONLY){n.restartCnt++,yield n.setRemoteDescription({type:"offer",sdp:n.remoteSDP.toString()});const i=yield n.peerConnection.createAnswer();if(!i.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:r}=Cl(i.sdp);return yield n.peerConnection.setLocalDescription(i),r}yield n.setRemoteDescription({type:"answer",sdp:n.remoteSDP.toString()}),n.isReady=!0}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}})()}close(){var t;this.peerConnection.close(),this.peerConnection.onicecandidate=null,null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}updateEncoderConfig(t,n){var i=this;return C(function*(){try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const r=yield i.peerConnection.createOffer(),o=i.mungSendOfferSDP(r.sdp,[n],[t]);i.remoteSDP.updateRecvMedia(t,n);const s=i.remoteSDP.toString(),a=i.logSDPExchange(o,"offer","local","updateEncoderConfig");yield i.peerConnection.setLocalDescription({type:"offer",sdp:o}),a?.(s),yield i.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(r){throw new M(S.EXCHANGE_SDP_FAILED,r.toString())}})()}updateSendParameters(t,n){var i=this;return C(function*(){const r=i.peerConnection.getTransceivers().filter(o=>o.mid===t);1===r.length&&(i.isVP8Simulcast(n)?Bt()||(yield i.applySimulcastEncodings(r,[n])):yield i.applySendEncodings(r,[n]))})()}setStatsRemoteVideoIsReady(t,n){this.statsFilter.setVideoIsReady2(t,n)}replaceTrack(t,n){var i=this;return C(function*(){const r=i.peerConnection.getTransceivers().find(o=>o.mid===n);r&&(yield r.sender.replaceTrack(t._mediaStreamTrack))})()}getSelectedCandidatePair(){var t=this;return C(function*(){const n=t.peerConnection.getReceivers();if(n.length>0&&n[0].transport&&n[0].transport.iceTransport&&n[0].transport.iceTransport.getSelectedCandidatePair&&n[0].transport.iceTransport.getSelectedCandidatePair()){const i=n[0].transport.iceTransport,{local:r,remote:o}=i.getSelectedCandidatePair();return{local:wl(wl({},Ma),{},{candidateType:r.type,protocol:r.protocol,address:r.address,port:r.port}),remote:wl(wl({},Ma),{},{candidateType:o.type,protocol:o.protocol,address:o.address,port:o.port})}}return t.statsFilter.getSelectedCandidatePair()})()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t,n;Y(t=["connected","completed"]).call(t,this.peerConnection.iceConnectionState)&&(this.isReady=!1),null===(n=this.onICEConnectionStateChange)||void 0===n||n.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;"connected"===this.peerConnection.connectionState&&(this.restartCnt=0),null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=t=>{var n;t.candidate?(t.candidate.candidate&&(null===(n=this.onLocalCandidate)||void 0===n||n.call(this,t.candidate.toJSON())),this.localCandidateCount+=1):_.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={iceServers:[]};var o;return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(AS(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...Jp.turnServerConfigToIceServers(t.turnServer.servers,n,i)),R("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...Jp.turnServerConfigToIceServers(t.turnServer.serversFromGateway,n,i)),Y(o=[xd.Relay,xd.SdRtn]).call(o,n)&&(r.iceTransportPolicy="relay"),R("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(r.iceTransportPolicy="relay")}))),R("ENABLE_ENCODED_TRANSFORM")&&Fe().supportWebRTCEncodedTransform&&(r.encodedInsertableStreams=!0),_.debug("P2PConnection p2pTransport is ".concat(n)),r}static turnServerConfigToIceServers(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=[],o=t.filter(a=>a.tcpport);_.debug("P2PConnection turnServers is ".concat(o,", current index is ").concat(i));const s=o.length>i?o[i]:o[0];switch(n){case xd.SdRtn:const a=t.filter(l=>{var d;return Y(d=l.username).call(d,"glb:")&&l.turnServerURL==l.turnServerURL}),c=a.length>i?a[i]:a[0];c&&(r.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(vp(c.turnServerURL),":").concat(c.tcpport,"?transport=udp")}),r.push({username:c.username,credential:c.password,credentialType:"password",urls:"turns:".concat(vp(c.turnServerURL),":").concat(c.tcpport,"?transport=tcp")}));break;case xd.Relay:s&&(r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=udp")}),r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(vp(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}));break;default:s&&(r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=udp")}),r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(vp(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}),r.push({username:s.username,credential:s.password,credentialType:"password",urls:"stun:".concat(s.turnServerURL,":").concat(s.tcpport)}))}return r}tryBindTransportEvents(t){if(t){this.transport=t,t.onstatechange=()=>{var i;null!=t&&t.state&&(null===(i=this.onDTLSTransportStateChange)||void 0===i||i.call(this,t.state))},t.onerror=i=>{var r;null===(r=this.onDTLSTransportError)||void 0===r||r.call(this,"error"in i?i.error:i)};const n=t.iceTransport;n&&(n.onstatechange=()=>{const i=t?.iceTransport.state;var r;i&&(null===(r=this.onICETransportStateChange)||void 0===r||r.call(this,i))},n.getSelectedCandidatePair&&(n.onselectedcandidatepairchange=()=>{if(n.getSelectedCandidatePair()){const{local:i,remote:r}=n.getSelectedCandidatePair();_.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:i.type,protocol:i.protocol}),", remote ").concat(JSON.stringify({candidateType:r.type,protocol:r.protocol,address:r.address,port:r.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}updateRtpSenderEncodings(t,n){var i=this;return C(function*(){var r;if(n||(n=i.peerConnection.getSenders().find(u=>u.track===t._mediaStreamTrack)),!n)return _.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(i.isVP8Simulcast(t))return _.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Fe().supportSetRtpSenderParameters)return _.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const o={},s={};switch(t._optimizationMode){case"motion":o.degradationPreference="maintain-framerate";break;case"detail":o.degradationPreference="maintain-resolution";break;default:o.degradationPreference="balanced"}if(t._encoderConfig){var a;const{bitrateMax:u,frameRate:h,scaleResolutionDownBy:p}=t._encoderConfig;u&&(s.maxBitrate=1e3*u),Y(a=t._hints).call(a,ft.LOW_STREAM)&&(h&&(s.maxFramerate=xr(h)),p&&p>=1&&(s.scaleResolutionDownBy=p))}if(R("DSCP_TYPE")&&fl()){var c;const u=R("DSCP_TYPE");Y(c=["very-low","low","medium","high"]).call(c,u)&&(s.networkPriority=u)}const l=n.getParameters(),d=null===(r=l.encodings)||void 0===r?void 0:r[0];Bt()&&!d&&(o.encodings=[s]),d&&Object.assign(d,s),Object.assign(l,o),_.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(l.encodings))),yield n.setParameters(l)})()}applySendEncodings(t,n){var i=this;return C(function*(){try{if(!Fe().supportSetRtpSenderParameters||t.length!==n.length)return;for(let r=0;r<t.length;r++){const o=t[r],s=n[r];s instanceof yt&&!i.isVP8Simulcast(s)&&(yield i.updateRtpSenderEncodings(s,o.sender))}}catch{_.debug("[".concat(i.store.clientId,"] Apply RTPSendEncodings failed."))}})()}mungSendOfferSDP(t,n,i){const r=Zn.parse(t);return n.forEach((o,s)=>{const a=i[s],c=r.mediaDescriptions.find(l=>l.attributes.mid===a);c&&(Lp(c,o),B$(c,o,this.store.codec))}),Zn.print(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var n;null===(n=this.onFirstAudioReceived)||void 0===n||n.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var n;null===(n=this.onFirstVideoReceived)||void 0===n||n.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var n;null===(n=this.onFirstAudioDecoded)||void 0===n||n.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,n,i)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,t,n,i)},this.statsFilter.onSelectedLocalCandidateChanged=(t,n)=>{var i;null===(i=this.onSelectedLocalCandidateChanged)||void 0===i||i.call(this,t,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,n)=>{var i;null===(i=this.onSelectedRemoteCandidateChanged)||void 0===i||i.call(this,t,n)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var n;null===(n=this.onFirstVideoDecodedTimeout)||void 0===n||n.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}applySimulcastForFirefox(t,n){var i=this;return C(function*(){if(t.length===n.length)for(let l=0;l<t.length;l++){var r,o,s,a,c;const d=t[l],u=n[l];if(u instanceof yt&&!Y(r=u._hints).call(r,ft.LOW_STREAM)&&null!==(o=u._encoderConfig)&&void 0!==o&&o.bitrateMax&&(null===(s=u._encoderConfig)||void 0===s?void 0:s.bitrateMax)>200&&null!==(a=u._scalabilityMode)&&void 0!==a&&a.numSpatialLayers&&(null===(c=u._scalabilityMode)||void 0===c?void 0:c.numSpatialLayers)>1&&"vp8"===i.store.codec){const h={},p={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{rid:"m",active:!0,maxBitrate:p.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:p.high}];const m=d.sender.getParameters();yield d.sender.setParameters(Object.assign(m,h))}}})()}applySimulcastEncodings(t,n){var i=this;return C(function*(){if(!Bt()&&t.length===n.length)for(let r=0;r<t.length;r++){const o=n[r];if(o instanceof yt&&i.isVP8Simulcast(o)){const s=t[r],a={},c={high:1e3*(o._encoderConfig.bitrateMax-50),medium:5e4};a.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:c.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:c.medium,scaleResolutionDownBy:4}];const l=s.sender.getParameters();yield s.sender.setParameters(Object.assign(l,a))}}})()}isVP8Simulcast(t){var n,i,r,o,s;return!!(t instanceof yt&&R("SIMULCAST")&&"vp8"===this.store.codec&&!Y(n=t._hints).call(n,ft.LOW_STREAM)&&null!==(i=t._encoderConfig)&&void 0!==i&&i.bitrateMax&&(null===(r=t._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(o=t._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(s=t._scalabilityMode)||void 0===s?void 0:s.numSpatialLayers)>1)}logSDPExchange(t,n,i,r){if(R("SDP_LOGGING"))return _.upload("[".concat(this.store.clientId,"] exchanging ").concat(i," ").concat(n," SDP during P2PConnection.").concat(r,"\n"),t),"offer"===n?o=>{this.logSDPExchange(o,"answer","local"===i?"remote":"local",r)}:void 0}muteLocal(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const i=n.peerConnection.getTransceivers().filter(a=>a.mid&&-1!==t.indexOf(a.mid));if(i.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(a=>{a.direction="inactive"});const r=yield n.peerConnection.createOffer(),o=n.logSDPExchange(r.sdp||"","offer","local","muteLocal");yield n.peerConnection.setLocalDescription(r),n.remoteSDP.muteRemote(t);const s=n.remoteSDP.toString();o?.(s),yield n.setRemoteDescription({type:"answer",sdp:s})}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(i.toString()))}})()}unmuteLocal(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const i=n.peerConnection.getTransceivers().filter(a=>a.mid&&-1!==t.indexOf(a.mid));if(i.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(function(){var a=C(function*(c){c.direction="sendonly"});return function(c){return a.apply(this,arguments)}}());const r=yield n.peerConnection.createOffer(),o=n.logSDPExchange(r.sdp||"","offer","local","unmuteLocal");yield n.peerConnection.setLocalDescription(r),n.remoteSDP.unmuteRemote(t);const s=n.remoteSDP.toString();o?.(s),yield n.setRemoteDescription({type:"answer",sdp:s})}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(i.toString()))}})()}getRemoteSSRC(t,n){var i=this;return C(function*(){var r,o;if(n=null!==(r=n)&&void 0!==r?r:null===(o=i.currentRemoteDescription)||void 0===o?void 0:o.sdp){var s;const a=null===(s=Zn.parse(n).mediaDescriptions.find(c=>c.attributes.mid===t))||void 0===s?void 0:s.attributes.ssrcs;return a?.[0].ssrcId}})()}setRemoteDescription(t){var n=this;return C(function*(){var i;yield n.peerConnection.setRemoteDescription(t),Y(i=["connected","completed"]).call(i,n.peerConnection.iceConnectionState)||(n.isReady=!0,n.addRemoteCandidate())})()}mungReceiveAnswerSDP(t,n,i){const r=Zn.parse(t),o=r.mediaDescriptions.find(s=>s.attributes.mid===n);return o&&i===ie.AUDIO&&"audio"===o.media.mediaType&&Fp(o),Zn.print(r)}},Q(vt.prototype,"establish",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"establish"),vt.prototype),Q(vt.prototype,"connect",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"connect"),vt.prototype),Q(vt.prototype,"receive",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"receive"),vt.prototype),Q(vt.prototype,"mockReceive",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"mockReceive"),vt.prototype),Q(vt.prototype,"stopReceiving",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"stopReceiving"),vt.prototype),Q(vt.prototype,"restartICE",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"restartICE"),vt.prototype),Q(vt.prototype,"close",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"close"),vt.prototype),Q(vt.prototype,"updateEncoderConfig",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"updateEncoderConfig"),vt.prototype),Q(vt.prototype,"updateSendParameters",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"updateSendParameters"),vt.prototype),Q(vt.prototype,"replaceTrack",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"replaceTrack"),vt.prototype),Q(vt.prototype,"muteLocal",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"muteLocal"),vt.prototype),Q(vt.prototype,"unmuteLocal",[ls],Object.getOwnPropertyDescriptor(vt.prototype,"unmuteLocal"),vt.prototype),vt);function ls(e,t,n){const i=e[t];if("function"!=typeof i)throw new Error("Cannot use mutex on object property.");return n.value=C(function*(){const r=this.mutex,o=yield r.lock("From P2PConnection.".concat(t));try{for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return yield i.apply(this,a)}finally{o()}}),n}function WM(e,t){let n=document.createElement("video"),i=document.createElement("canvas");n.setAttribute("style","display:none"),i.setAttribute("style","display:none"),n.setAttribute("muted",""),n.muted=!0,n.setAttribute("autoplay",""),n.autoplay=!0,n.setAttribute("playsinline",""),i.width=xr(t.width),i.height=xr(t.height);const r=xr(t.framerate||15);document.body.append(n),document.body.append(i);let o=e._mediaStreamTrack;n.srcObject=new MediaStream([o]),n.play();const s=i.getContext("2d");if(!s)throw new N(S.UNEXPECTED_ERROR,"can not get canvas context");const a=Fe(),c=i.captureStream(a.supportRequestFrame?0:r).getVideoTracks()[0];c.canvas||(c.canvas=i),i.startCapture=()=>{if(!n)return i.stopCapture&&i.stopCapture();if(n.paused&&n.play(),n.videoHeight>2&&n.videoWidth>2){const h=i.width*(n.videoHeight/n.videoWidth);Math.abs(h-i.height)>=2&&(_.debug("adjust low stream resolution","".concat(i.width,"x").concat(i.height," -> ").concat(i.width,"x").concat(h)),i.height=h)}s.drawImage(n,0,0,i.width,i.height),c.requestFrame&&c.requestFrame(),o!==e._mediaStreamTrack&&(o=e._mediaStreamTrack,n.srcObject=new MediaStream([o]))},i.stopCapture=tM(()=>i.startCapture&&i.startCapture(),r);const l=c.stop;return c.stop=()=>{l.call(c),n&&(n.remove(),n.srcObject=null,n=null),i&&(i.width=0,i.remove(),i.stopCapture&&i.stopCapture(),i.startCapture=void 0,i.stopCapture=void 0,i=null),_.debug("clean low stream renderer")},c}var fC=function(e){return e[e.HEIGHT=2033]="HEIGHT",e[e.FRAME_RATE=2034]="FRAME_RATE",e[e.WIDTH=2035]="WIDTH",e}(fC||{}),Fn=function(e){return e[e.FRAME_RATE=2002]="FRAME_RATE",e[e.WIDTH=2003]="WIDTH",e[e.HEIGHT=2004]="HEIGHT",e[e.PACKAGE_LOST=2005]="PACKAGE_LOST",e[e.AVG_ENCODE=2007]="AVG_ENCODE",e[e.NACKS=2009]="NACKS",e[e.PLIS=2010]="PLIS",e[e.FIRS=2011]="FIRS",e[e.BITRATE=2012]="BITRATE",e[e.PACKAGE_RATE=2031]="PACKAGE_RATE",e[e.ADAPTATION=2032]="ADAPTATION",e[e.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",e[e.BANDWIDTH=2061]="BANDWIDTH",e[e.RETRANSMIT=2062]="RETRANSMIT",e[e.TARGET_ENCODED=2064]="TARGET_ENCODED",e[e.TRANSMIT=2066]="TRANSMIT",e[e.FREEZE=2082]="FREEZE",e[e.DISABLED=2095]="DISABLED",e[e.PLAYER_STATUS=2128]="PLAYER_STATUS",e[e.QP_SUM=2143]="QP_SUM",e}(Fn||{}),Kd=function(e){return e[e.BITRATE=2069]="BITRATE",e[e.PACKAGE_LOST=2070]="PACKAGE_LOST",e[e.PACKAGE_RATE=2071]="PACKAGE_RATE",e[e.HEIGHT=2073]="HEIGHT",e[e.FRAME_RATE=2075]="FRAME_RATE",e[e.WIDTH=2077]="WIDTH",e}(Kd||{}),Ii=function(e){return e[e.JITTER=-1]="JITTER",e[e.PACKAGE_LOST=2014]="PACKAGE_LOST",e[e.WIDTH=2018]="WIDTH",e[e.HEIGHT=2019]="HEIGHT",e[e.FRAME_RATE=2020]="FRAME_RATE",e[e.JITTER_BUFFER=2023]="JITTER_BUFFER",e[e.CURRENT_DELAY=2024]="CURRENT_DELAY",e[e.NACKS=2026]="NACKS",e[e.PLIS=2027]="PLIS",e[e.FIRS=2028]="FIRS",e[e.BITRATE=2029]="BITRATE",e[e.PACKAGE_RATE=2078]="PACKAGE_RATE",e[e.FREEZE=2084]="FREEZE",e[e.DISABLED=2101]="DISABLED",e[e.PLAYER_STATUS=2129]="PLAYER_STATUS",e[e.QP_SUM=2144]="QP_SUM",e[e.I_FRAME_DELAY=2149]="I_FRAME_DELAY",e}(Ii||{}),qd=function(e){return e[e.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",e[e.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",e[e.FRAME_RATE_OUTPUT=2155]="FRAME_RATE_OUTPUT",e[e.FREEZE_TIME=2109]="FREEZE_TIME",e[e.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER",e[e.FREEZE_DURATION=2156]="FREEZE_DURATION",e}(qd||{}),SX=function(e){return e[e.PCM_LEVEL=2104]="PCM_LEVEL",e}(SX||{}),bc=function(e){return e[e.PACKAGE_LOST=-1]="PACKAGE_LOST",e[e.LEVEL=2038]="LEVEL",e[e.BITRATE=2039]="BITRATE",e[e.PACKAGE_RATE=2040]="PACKAGE_RATE",e[e.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",e[e.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",e[e.FREEZE=2081]="FREEZE",e[e.DISABLED=2096]="DISABLED",e}(bc||{}),ds=function(e){return e[e.BITRATE=2044]="BITRATE",e[e.PACKAGE_LOST=2045]="PACKAGE_LOST",e[e.PACKAGE_RATE=2046]="PACKAGE_RATE",e[e.CURRENT_DELAY=2047]="CURRENT_DELAY",e[e.JITTER_BUFFER=2054]="JITTER_BUFFER",e[e.JITTER=2055]="JITTER",e[e.FREEZE=2083]="FREEZE",e[e.DISABLED=2102]="DISABLED",e[e.PCM_LEVEL=2105]="PCM_LEVEL",e[e.PLAYER_STATUS=2130]="PLAYER_STATUS",e[e.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES",e}(ds||{}),CX=function(e){return e[e.FREEZE_TIME=-1]="FREEZE_TIME",e[e.LEVEL=2043]="LEVEL",e}(CX||{}),ko=function(e){return e[e.RTT=2006]="RTT",e[e.CONN_TYPE=801]="CONN_TYPE",e}(ko||{});function Ee(e,t,n){null!=n&&Number.isFinite(n)&&(e[t]=Math.round(Math.max(0,n)))}function TX(e){const t={[ko.CONN_TYPE]:0,[ko.RTT]:e.rtt};switch(e.selectedCandidatePair.localCandidate.candidateType){case"relay":{const n=e.selectedCandidatePair.localCandidate.relayProtocol;"udp"===n&&(t[ko.CONN_TYPE]=1),"tcp"===n&&(t[ko.CONN_TYPE]=3),"tls"===n&&(t[ko.CONN_TYPE]=4);break}case"srflx":t[ko.CONN_TYPE]=2}return t}function wX(e){let t=0;switch(e){case"none":t=0;break;case"cpu":t=1;break;case"bandwidth":t=2;break;case"other":t=3}return t}class IX extends xt{constructor(t){super(),y(this,"store",void 0),y(this,"uploadWRTCStatsTimer",void 0),y(this,"uploadOutboundDenoiserStatsTimer",void 0),y(this,"uploadExtStatsTimer",void 0),y(this,"uploadExtUsageStatsTimer",void 0),y(this,"uploadInboundExtStatsTimer",void 0),y(this,"requestStats",void 0),y(this,"requestTransportStats",void 0),y(this,"requestLocalMedia",void 0),y(this,"requestRemoteMedia",void 0),y(this,"requestAllTracks",void 0),y(this,"requestVideoIsReady",void 0),y(this,"requestUploadStats",void 0),y(this,"requestUpload",void 0),y(this,"uploadOutboundStarted",!1),y(this,"uploadInboundStarted",!1),y(this,"uploadTransportStarted",!1),y(this,"uploadExtensionUsageStarted",!1),y(this,"lastRecvStats",void 0),y(this,"lastSendStats",void 0),y(this,"lastFullRecvStats",void 0),y(this,"lastFullSendStats",void 0),y(this,"needUploadRenderFreezeTime",!0),this.store=t}uploadWRTCStats(t){if(!this.requestStats||!this.requestUploadStats)return;let n,i;if(this.uploadTransportStarted&&(n=this.requestStats(),this.store.useP2P&&(i=this.requestStats(!0))),!n&&this.uploadOutboundStarted&&(n=this.requestStats()),!i&&this.uploadInboundStarted&&(i=this.requestStats(!0)),n||i){const r={};if(this.uploadTransportStarted&&n){const o=this.getTransportStats(n,i,t);o&&(r.misc=[o])}if(this.uploadOutboundStarted&&n){const o=this.getOutboundStats(n,t?this.lastSendStats:this.lastFullSendStats,t);o&&(r.outbound=[o])}if(this.uploadInboundStarted&&i){const o=this.getInboundStats(i,t?this.lastRecvStats:this.lastFullRecvStats,t);o&&(r.inbound=o)}this.requestUploadStats(r)}this.lastRecvStats=i,this.lastSendStats=n,t||(this.lastFullRecvStats=i,this.lastFullSendStats=n)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;let t=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted)return this.stopUploadWRTCStats();this.uploadWRTCStats(3!==t),4==++t&&(t=1)},1e3)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(t,n,i){if(!this.requestStats)return;if(i)return null==t.rtt?void 0:{addition:{[ko.RTT]:t.rtt,[ko.CONN_TYPE]:void 0}};const r=TX(t);if(this.store.useP2P){if(n){const o=TX(n);r[ko.CONN_TYPE]+=o[ko.CONN_TYPE]<<3}r[ko.CONN_TYPE]+=110}else r[ko.CONN_TYPE]+=100;return{addition:r}}getOutboundStats(t,n,i){if(!this.requestUploadStats||!this.requestLocalMedia)return;const r=this.requestLocalMedia();if(!r||0===r.length)return;let o,s,a;return r.forEach(c=>{let[l,{track:d,ssrcs:u}]=c;switch(l){case j.LocalVideoLowTrack:case j.LocalVideoTrack:if(l===j.LocalVideoTrack){const h=function(f,g,E,b,T){const I=g.videoSend.find(ee=>ee.ssrc===f);if(!I)return;const D={},{sentFrame:O,inputFrame:k}=I;if(k&&O&&(D[Fn.FREEZE]=function(Ie,Ue){let Dt=!0;return Dt=!(Ie<=5)&&(Ie<=10?Ue<3:Ie<=20?Ue<4:Ue<5),Dt}(k.frameRate,O.frameRate)?1:0),Ee(D,Fn.QP_SUM,I.qpSumPerFrame),T)return D;switch(O&&(Ee(D,Fn.HEIGHT,O.height),Ee(D,Fn.WIDTH,O.width),Ee(D,Fn.FRAME_RATE,O.frameRate)),D[Fn.DISABLED]=b._originMediaStreamTrack&&!b._originMediaStreamTrack.enabled||b._mediaStreamTrack&&!b._mediaStreamTrack.enabled?1:0,I.adaptionChangeReason){case"none":D[Fn.ADAPTATION]=0;break;case"cpu":D[Fn.ADAPTATION]=1;break;case"bandwidth":D[Fn.ADAPTATION]=2;break;case"other":D[Fn.ADAPTATION]=3}let L=0;I.adaptionChangeReason&&(L+=wX(I.adaptionChangeReason)),g.qualityLimitationReason&&(L+=wX(g.qualityLimitationReason)<<3),D[Fn.ADAPTATION]=L,D[Fn.PLAYER_STATUS]=QP[b._player?b._player.videoElementStatus:"uninit"],Ee(D,Fn.NACKS,I.nacksCount),Ee(D,Fn.PLIS,I.plisCount),Ee(D,Fn.FIRS,I.firsCount),Ee(D,Fn.AVG_ENCODE,I.avgEncodeMs);const V=E&&E.videoSend.find(ee=>ee.ssrc===f);if(V){let ee=T?1e3:3e3;V.timestamp&&I.timestamp&&(ee=I.timestamp-V.timestamp),null!=V.packets&&null!=I.packets&&Ee(D,Fn.PACKAGE_RATE,1e3*(I.packets-V.packets)/ee),null!=I.packetsLost&&null!=V.packetsLost&&Ee(D,Fn.PACKAGE_LOST,I.packetsLost-V.packetsLost),null!=V.bytes&&null!=I.bytes&&Ee(D,Fn.BITRATE,8*(I.bytes-V.bytes)/ee)}return D}(u[0].ssrcId,t,n,d,i),p=i?null:function(f,g,E){const b=g.videoSend.find(L=>L.ssrc===f);if(!b)return null;const T={},I=b.inputFrame,O=I&&I.width||E&&E.videoWidth||0,k=I&&I.frameRate||0;return Ee(T,fC.HEIGHT,I&&I.height||E&&E.videoHeight||0),Ee(T,fC.WIDTH,O),Ee(T,fC.FRAME_RATE,k),T}(u[0].ssrcId,t,d),m=i?null:function(f){const g={};return Ee(g,Fn.RETRANSMIT,f.bitrate.retransmit),Ee(g,Fn.TARGET_ENCODED,f.bitrate.targetEncoded),Ee(g,Fn.ACTUAL_ENCODED,f.bitrate.actualEncoded),Ee(g,Fn.TRANSMIT,f.bitrate.transmit),Ee(g,Fn.BANDWIDTH,f.sendBandwidth),g}(t);s=Object.assign({},h,p,m)}else a=i?void 0:function(h,p,m){const f=p.videoSend.find(b=>b.ssrc===h);if(!f)return;const g={},E=f.sentFrame;if(E&&(Ee(g,Kd.HEIGHT,E.height),Ee(g,Kd.WIDTH,E.width),Ee(g,Kd.FRAME_RATE,E.frameRate)),m){const b=m.videoSend.find(T=>T.ssrc===h);if(b){let T=3e3;b.timestamp&&f.timestamp&&(T=f.timestamp-b.timestamp),null!=b.packets&&null!=f.packets&&Ee(g,Kd.PACKAGE_RATE,1e3*(f.packets-b.packets)/T),null!=f.packetsLost&&null!=b.packetsLost&&Ee(g,Kd.PACKAGE_LOST,f.packetsLost-b.packetsLost),null!=b.bytes&&null!=f.bytes&&Ee(g,Kd.BITRATE,8*(f.bytes-b.bytes)/T)}}return g}(u[0].ssrcId,t,n);break;case j.LocalAudioTrack:o=i?void 0:function(h,p,m,f){const g=p.audioSend.find(D=>D.ssrc===h);if(!g)return;const E={};E[bc.DISABLED]=f._originMediaStreamTrack&&!f._originMediaStreamTrack.enabled||f._mediaStreamTrack&&!f._mediaStreamTrack.enabled?1:0;const b=100*f._source.getAccurateVolumeLevel(),T=g.inputLevel;if(null!=T){const D=Math.ceil(50*Math.log10(100*T+1));Ee(E,bc.LEVEL,D)}else Ee(E,bc.LEVEL,b);Ee(E,SX.PCM_LEVEL,b),Ee(E,bc.AEC_RETURN_LOSS,g.aecReturnLoss),Ee(E,bc.AEC_RETURN_LOSS_ENH,g.aecReturnLossEnhancement),E[bc.FREEZE]=0;const I=m&&m.audioSend.find(D=>D.ssrc===h);if(I){let D=3e3;I.timestamp&&g.timestamp&&(D=g.timestamp-I.timestamp),null!=I.bytes&&null!=g.bytes&&Ee(E,bc.BITRATE,8*(g.bytes-I.bytes)/D),null!=I.packets&&null!=g.packets&&Ee(E,bc.PACKAGE_RATE,1e3*(g.packets-I.packets)/D)}return E}(u[0].ssrcId,t,n,d)}}),{high:s,low:a,audio:o}}getInboundStats(t,n,i){if(!this.requestRemoteMedia)return;const r=this.requestRemoteMedia()||[],o=[];return r.forEach(s=>{let[a,c]=s;const l={peer:a.uid};if(c.has(ie.VIDEO)&&a.videoTrack){const d=a._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(a._videoSSRC)||!1,u=a.videoTrack?function(h,p,m,f,g,E,b){var T;const I=p.videoRecv.find(oe=>oe.ssrc===h);if(!I)return;const D={},{receivedFrame:O,outputFrame:k,decodeFrameRate:L}=I,V=m&&m.videoRecv.find(oe=>oe.ssrc===h);if(D[Ii.FREEZE]=g&&c_.isRemoteVideoFreeze(f,I,V)?1:0,Ee(D,qd.FRAME_RATE_DECODE,L),Ee(D,Ii.QP_SUM,I.qpSumPerFrame),I.framesRateFirefox&&Ee(D,Ii.FRAME_RATE,I.framesRateFirefox),O&&Ee(D,Ii.FRAME_RATE,O.frameRate),V){const oe=p.timestamp-m.timestamp||(b?1e3:3e3);null!=I.packetsLost&&null!=V.packetsLost&&Ee(D,Ii.PACKAGE_LOST,I.packetsLost-V.packetsLost),null!=V.bytes&&null!=I.bytes&&Ee(D,Ii.BITRATE,8*(I.bytes-V.bytes)/oe),null!=V.packets&&null!=I.packets&&Ee(D,Ii.PACKAGE_RATE,1e3*(I.packets-V.packets)/oe)}if(b)return D;O?(Ee(D,Ii.HEIGHT,O.height),Ee(D,Ii.WIDTH,O.width)):f&&(Ee(D,Ii.HEIGHT,f._videoHeight||0),Ee(D,Ii.WIDTH,f._videoWidth||0)),k&&Ee(D,qd.FRAME_RATE_OUTPUT,k.frameRate);const ee=null===(T=f._player)||void 0===T?void 0:T.rendFrameRate.toFixed(0);if(ee&&Ee(D,qd.FRAME_RATE_RENDER,+ee),Ee(D,Ii.JITTER_BUFFER,I.jitterBufferMs),Ee(D,Ii.CURRENT_DELAY,I.currentDelayMs),Ee(D,Ii.FIRS,I.firsCount),Ee(D,Ii.NACKS,I.nacksCount),Ee(D,Ii.PLIS,I.plisCount),f){D[Ii.DISABLED]=f._originMediaStreamTrack.enabled&&f._mediaStreamTrack.enabled?0:1;const oe=f._player;if(oe){const{freezeTimeCounterList:Ie,renderFreezeAccTime:Ue,videoElementStatus:Dt}=oe;if(Ie&&Ie.length>0&&Ee(D,qd.FREEZE_TIME,Ie.splice(0,1)[0]),E&&"visible"===Ec.visibility&&Dt===Li.PLAYING&&Fe().supportRequestVideoFrameCallback){const dt=Math.min(6e3,Ue);oe.renderFreezeAccTime=Math.max(0,Ue-dt),Ee(D,qd.FREEZE_TIME_RENDER,dt)}"number"==typeof I.totalFreezesDuration&&Ee(D,qd.FREEZE_DURATION,1e3*(V&&V.totalFreezesDuration?I.totalFreezesDuration-V.totalFreezesDuration:I.totalFreezesDuration))}}if(D[Ii.PLAYER_STATUS]=QP[f._player?f._player.videoElementStatus:"uninit"],V&&void 0!==I.totalInterFrameDelay&&void 0!==I.totalSquaredInterFrameDelay&&void 0!==V.totalInterFrameDelay&&void 0!==V.totalSquaredInterFrameDelay){const oe=I.totalInterFrameDelay-V.totalInterFrameDelay,Ue=I.framesDecodeCount-V.framesDecodeCount,Dt=oe/Ue*1e3,dt=Math.round(1e3*Math.sqrt((I.totalSquaredInterFrameDelay-V.totalSquaredInterFrameDelay-Math.pow(oe,2)/Ue)/Ue));!isNaN(dt)&&Dt+dt>Math.max(3*Dt,Dt+150)&&(D[Ii.I_FRAME_DELAY]=dt)}return D}(a._videoSSRC,t,n,a.videoTrack,!0===d,this.needUploadRenderFreezeTime,i):void 0;u&&(l.video=u)}if(c.has(ie.AUDIO)&&a.audioTrack){const d=a.audioTrack?function(u,h,p,m,f){const g=h.audioRecv.find(V=>V.ssrc===u);if(!g)return;const E={},b=p&&p.audioRecv.find(V=>V.ssrc===u),{receivedFrames:T,droppedFrames:I}=g;var D;if(Ee(E,ds.JITTER,g.jitterMs),null!=T&&null!=I&&(E[ds.FREEZE]=0===(D=T)||100*I/D>20?1:0),b){const V=h.timestamp-p.timestamp||(f?1e3:3e3);null!=g.packets&&null!=b.packets&&Ee(E,ds.PACKAGE_RATE,1e3*(g.packets-b.packets)/V),null!=b.bytes&&null!=g.bytes&&Ee(E,ds.BITRATE,8*(g.bytes-b.bytes)/V),null!=g.packetsLost&&null!=b.packetsLost&&Ee(E,ds.PACKAGE_LOST,g.packetsLost-b.packetsLost)}if(f)return E;const k=100*m._source.getAccurateVolumeLevel(),L=g.outputLevel;if(null!=L){const V=Math.ceil(50*Math.log10(100*L+1));Ee(E,CX.LEVEL,V)}if(Ee(E,ds.PCM_LEVEL,k),m&&(E[ds.DISABLED]=m._originMediaStreamTrack.enabled&&m._mediaStreamTrack.enabled?0:1),Ee(E,ds.JITTER_BUFFER,g.jitterBufferMs),Ee(E,ds.CURRENT_DELAY,g.jitterBufferMs),E[ds.PLAYER_STATUS]=QP[ir.getPlayerState(m.getTrackId())],b){const V=g.concealedSamples-b.concealedSamples;V>0&&Ee(E,ds.CONCEALED_SAMPLES,V)}return E}(a._audioSSRC,t,n,a.audioTrack,i):void 0;d&&(l.audio=d)}(l.video||l.audio)&&o.push(l)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,o}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const t=(this.requestAllTracks()||[]).find(n=>n instanceof nC);if(t&&t._external.getDenoiserStats){const n=t._external.getDenoiserStats();n&&this.requestUpload(Kg.DENOISER_STATS,n)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(t=>{t.getProcessorStats().forEach(n=>{this.requestUpload&&this.requestUpload(n.type,n.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(t=>{let[n,i]=t;i.has(ie.VIDEO)&&n.videoTrack&&n.videoTrack.getProcessorStats().forEach(r=>{this.requestUpload&&this.requestUpload(r.type,r.stats)}),i.has(ie.AUDIO)&&n.audioTrack&&n.audioTrack.getProcessorStats().forEach(r=>{this.requestUpload&&this.requestUpload(r.type,r.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){var t=this;if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const n=new Map;this.uploadExtUsageStatsTimer=window.setInterval(C(function*(){const i=Date.now(),r={connectionInterval:R("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:i};let o=[];const s=t.requestAllTracks&&t.requestAllTracks()||[];for(const d of s)!d.muted&&d.enabled&&(o=o.concat(yield d.getProcessorUsage()));const a=t.requestRemoteMedia&&t.requestRemoteMedia()||[];for(const[d,u]of a)u.has(ie.VIDEO)&&d.videoTrack&&(o=o.concat(yield d.videoTrack.getProcessorUsage())),u.has(ie.AUDIO)&&d.audioTrack&&(o=o.concat(yield d.audioTrack.getProcessorUsage()));if(0===o.length)return;r.details=function(d,u){const h={};for(const{id:g,value:E,level:b,direction:T}of d){var p;const I=null!==(p=u.get(g))&&void 0!==p?p:0,D=2===E?I+R("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:I;var m,f;u.set(g,D),h[g]?(2===E&&(h[g].value=E),b>h[g].level&&(h[g].level=b),"remote"===T&&(h[g].remoteUidCount+=1),h[g].totalTs=null!==(m=u.get(g))&&void 0!==m?m:0):h[g]={value:E,level:b,remoteUidCount:"local"===T?0:1,totalTs:null!==(f=u.get(g))&&void 0!==f?f:0}}return Object.keys(h).map(g=>{const{level:E,value:b,totalTs:T}=h[g];return{id:g,level:E,value:b,totalTs:T}})}(o,n);const c=Date.now();t.requestUpload&&t.requestUpload(Kg.EXTENSION_USAGE_STATS,{usageStats:r,sendTs:c>i?c:i+1})}),R("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}}class Il{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(t,n){y(this,"uid",void 0),y(this,"_uintid",void 0),y(this,"_trust_in_room_",!0),y(this,"_trust_audio_enabled_state_",!0),y(this,"_trust_video_enabled_state_",!0),y(this,"_trust_audio_mute_state_",!0),y(this,"_trust_video_mute_state_",!0),y(this,"_audio_muted_",!1),y(this,"_video_muted_",!1),y(this,"_audio_enabled_",!0),y(this,"_video_enabled_",!0),y(this,"_audio_added_",!1),y(this,"_video_added_",!1),y(this,"_is_pre_created",!1),y(this,"_video_pre_subscribed",!1),y(this,"_audio_pre_subscribed",!1),y(this,"_trust_video_stream_added_state_",!0),y(this,"_trust_audio_stream_added_state_",!0),y(this,"_audioTrack",void 0),y(this,"_videoTrack",void 0),y(this,"_dataChannels",[]),y(this,"_audioSSRC",void 0),y(this,"_videoSSRC",void 0),y(this,"_audioOrtc",void 0),y(this,"_videoOrtc",void 0),y(this,"_cname",void 0),y(this,"_rtxSsrcId",void 0),y(this,"_videoMid",void 0),y(this,"_audioMid",void 0),this.uid=t,this._uintid=n}}let Hs=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({});function IFe(e,t){var n;let i;switch(t){case j.LocalAudioTrack:i=$e.Audio;break;case j.LocalVideoTrack:i=Y(n=e._hints).call(n,ft.SCREEN_TRACK)?$e.Screen:$e.High;break;case j.LocalVideoLowTrack:i=$e.Low}return i}function zM(e){const t=Fe();if(e.some(n=>n._bypassWebAudio))throw new M(S.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!t.webAudioMediaStreamDest)throw new M(S.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function KM(e,t){zM(e);const n=t||new wn;return e.forEach(i=>n.addAudioTrack(i)),n}var RX,AX,DX,OX,NX,PX,MX,xX,kX,LX,FX,At;function UX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function mC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}let Lr=(RX=Gs(Hs.SEND_ONLY),AX=Gs(Hs.SEND_ONLY),DX=Gs(),OX=Gs(Hs.RECEIVE_ONLY),NX=Gs(Hs.RECEIVE_ONLY),PX=Gs(Hs.RECEIVE_ONLY),MX=Gs(Hs.RECEIVE_ONLY),xX=Gs(Hs.RECEIVE_ONLY),kX=Gs(Hs.RECEIVE_ONLY),LX=Gs(),FX=Gs(Hs.RECEIVE_ONLY),At=class extends xt{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(de.StateChange,t,this._state)}constructor(e,t){var n;super(),n=this,y(this,"isPlanB",!1),y(this,"store",void 0),y(this,"statsUploader",void 0),y(this,"sendConnection",void 0),y(this,"recvConnection",void 0),y(this,"localTrackMap",new Map),y(this,"remoteUserMap",new Map),y(this,"localDataChannels",[]),y(this,"pendingLocalTracks",[]),y(this,"pendingRemoteTracks",[]),y(this,"statsCollector",void 0),y(this,"dtlsFailedCount",0),y(this,"sendMutex",new mi("P2PChannel2-send-mutex")),y(this,"recvMutex",new mi("P2PChannel2-recv-mutex")),y(this,"_state",Xe.Disconnected),y(this,"_restartStates",["disconnected","failed"]),y(this,"reconnectInterval",void 0),y(this,"uploadUnplinkStarted",!1),y(this,"uploadDownlinkStarted",!1),y(this,"uplinkStateUploadInterval",void 0),y(this,"downlinkStatsUploadInterval",void 0),y(this,"handleMuteLocalTrack",function(){var i=C(function*(r,o,s){const a=yield n.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!n.sendConnection||n.state!==Xe.Connected)return void s(new M(S.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const d=n.filterTobeMutedTracks(r);if(0===d.length)return void o();const u=d.find(f=>"videoLowTrack"===f[0]);u&&u[1].track._originMediaStreamTrack.stop(),yield n.sendConnection.muteLocal(d.map(f=>{let[,{id:g}]=f;return g}));let h=!1;var c,l;h="video"===r.trackMediaType?!(null===(c=n.localTrackMap.get(j.LocalAudioTrack))||void 0===c||!c.track._muted):void 0===(null===(l=n.localTrackMap.get(j.LocalVideoTrack))||void 0===l?void 0:l.id);const p=n.createMuteMessage(d);yield ct(n,de.RequestMuteLocal,p);const m="video"===r.trackMediaType?El.MUTE_LOCAL_VIDEO:El.MUTE_LOCAL_AUDIO;yield ct(n,de.RequestP2PMuteLocal,{action:m,message:p,isMuteAll:h}),o()}catch(d){s(d)}finally{a()}});return function(r,o,s){return i.apply(this,arguments)}}()),y(this,"handleUnmuteLocalTrack",function(){var i=C(function*(r,o,s){const a=yield n.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!n.sendConnection||n.state!==Xe.Connected)return void s(new M(S.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const c=n.filterTobeUnmutedTracks(r);if(0===c.length)return void o();yield n.sendConnection.unmuteLocal(c.map(u=>{let[,{id:h}]=u;return h}));const l=n.createUnmuteMessage(c),d="video"===r.trackMediaType?El.UNMUTE_LOCAL_VIDEO:El.UNMUTE_LOCAL_AUDIO;yield ct(n,de.RequestP2PMuteLocal,{action:d,message:l}),o()}catch(c){s(c)}finally{a()}});return function(r,o,s){return i.apply(this,arguments)}}()),y(this,"handleUpdateVideoEncoder",function(){var i=C(function*(r,o,s){const a=yield n.sendMutex.lock("Locking from P2PChannel2.handleSetVideoEncoder");try{const c=n.localTrackMap.get(j.LocalVideoTrack);if(!n.sendConnection||!c||c.track!==r||n.state!==Xe.Connected)return void o();const{id:l,track:d}=c;l&&(yield n.sendConnection.updateSendParameters(l,d),yield n.sendConnection.updateEncoderConfig(l,d),n.emit(de.UpdateVideoEncoder,d)),o()}catch(c){s(c)}finally{a()}});return function(r,o,s){return i.apply(this,arguments)}}()),y(this,"handleUpdateVideoSendParameters",function(){var i=C(function*(r,o,s){const a=yield n.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const c=n.localTrackMap.get(j.LocalVideoTrack);if(!n.sendConnection||!c||c.track!==r||n.state!==Xe.Connected)return void o();const{id:l,track:d}=c;l&&(yield n.sendConnection.updateSendParameters(l,d)),o()}catch(c){s(c)}finally{a()}});return function(r,o,s){return i.apply(this,arguments)}}()),y(this,"handleReplaceTrack",function(){var i=C(function*(r,o,s,a){let c;_.debug("[".concat(n.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(r.getTrackId(),"]")),"boolean"==typeof a&&a||(c=yield n.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var l;const u=Array.from(n.localTrackMap.entries()).find(h=>{let[,{track:p}]=h;return r===p});if(!n.sendConnection||!u||void 0===u[1].id||n.state!==Xe.Connected)return void o();if(yield null===(l=n.sendConnection)||void 0===l?void 0:l.replaceTrack(r,u[1].id),u[0]===j.LocalVideoTrack&&Fe().supportDualStreamEncoding){const h=n.localTrackMap.get(j.LocalVideoLowTrack);if(h){const p=r._mediaStreamTrack.clone();h.track._originMediaStreamTrack.stop(),h.track._mediaStreamTrack=p,h.track._originMediaStreamTrack=p,yield new q((m,f)=>{n.handleReplaceTrack(h.track,m,f,!0)})}}o()}catch(u){s(u)}finally{var d;null===(d=c)||void 0===d||d()}});return function(r,o,s,a){return i.apply(this,arguments)}}()),y(this,"handleGetLocalVideoStats",i=>{i(this.statsCollector.getLocalVideoTrackStats())}),y(this,"handleGetLocalAudioStats",i=>{i(this.statsCollector.getLocalAudioTrackStats())}),y(this,"handleGetRemoteVideoStats",i=>this.statsCollector.getRemoteVideoTrackStats(i.uid)[i.uid]),y(this,"handleGetRemoteAudioStats",i=>this.statsCollector.getRemoteAudioTrackStats(i.uid)[i.uid]),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new IX(e),this.bindStatsUploaderEvents(),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(i=>{i&&("disconnected"!==i.iceConnectionState&&"failed"!==i.iceConnectionState||this.handleDisconnect(i.direction))})},R("ICE_RESTART_INTERVAL"))}startP2PConnection(e,t){return C(function*(){throw new M(S.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")})()}connect(e){return C(function*(){throw new M(S.NOT_SUPPORTED,"p2p mode does not support connect.")})()}startP2P(e,t){var n=this;return C(function*(){let i;try{if(t){n.recvConnection&&(_.warning("[".concat(n.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),n.recvConnection.close(),n.unbindConnectionEvents(n.recvConnection)),i=yield n.recvMutex.lock("From P2PChannel.startP2P"),n.recvConnection=new yX(e,n.store,Yi.RECEIVE_ONLY),n.bindConnectionEvents(n.recvConnection);const r=yield n.recvConnection.establish(t);return{iceParameters:r.iceParameters,dtlsParameters:r.dtlsParameters,sdp:r.sdp}}{n.state=Xe.New,n.sendConnection&&(_.warning("[".concat(n.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),n.sendConnection.close(),n.unbindConnectionEvents(n.sendConnection)),i=yield n.sendMutex.lock("From P2PChannel.startP2P"),n.sendConnection=new yX(e,n.store),n.store.peerConnectionStart(),n.bindConnectionEvents(n.sendConnection);const r=yield n.sendConnection.establish();return{iceParameters:r.iceParameters,dtlsParameters:r.dtlsParameters,sdp:r.sdp}}}finally{i&&i()}})()}p2pConnect(e){var t=this;return C(function*(){if(!t.sendConnection)throw new M(S.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");t.store.peerConnectionStart(),yield t.sendConnection.connect(e),t.statsUploader.startUploadTransportStats(),t.statsUploader.startUploadExtensionUsageStats(),t.state=Xe.Connected})()}addRemoteCandidate(e,t){var n=this;return C(function*(){if(t===Yi.RECEIVE_ONLY){if(!n.sendConnection)throw new M(S.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");yield n.sendConnection.addRemoteCandidate(e)}else{if(!n.recvConnection)throw new M(S.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");yield n.recvConnection.addRemoteCandidate(e)}})()}publish(e,t,n){var i=this;return Do(function*(){const r=yield Ne(i.sendMutex.lock("From P2PChannel.publish"));try{if(!i.sendConnection||i.state!==Xe.Connected){i.throwIfTrackTypeNotMatch(e);const l=e.filter(d=>-1===i.pendingLocalTracks.indexOf(d));return void(i.pendingLocalTracks=i.pendingLocalTracks.concat(l))}i.store.pubId=i.store.pubId+1,_i.markPublishStart(i.store.clientId,i.store.pubId);const o=i.filterTobePublishedTracks(e,t,n);if(0===o.length)return void(yield Ne(i.tryToUnmuteAudio(e)));o.forEach(l=>{let{track:d,type:u}=l;const h=Date.now();i.store.publish(d.getTrackId(),u===j.LocalAudioTrack?"audio":"video",h)}),i.bindLocalTrackEvents(o);const s=yield Ne(i.sendConnection.send(o.map(l=>{let{track:d}=l;return d}),i.store.codec,i.store.audioCodec)),a=(yield Ne(s.next())).value,c=i.createGatewayPublishMessage(o,a);try{yield c}catch(l){throw s.throw(l),l?.code===S.WS_ABORT&&o.forEach(d=>{let{track:u}=d;-1===i.pendingLocalTracks.indexOf(u)&&i.pendingLocalTracks.push(u)}),i.unbindLocalTrackEvents(o),l}yield Ne(s.next()),o.forEach(l=>{let{type:d}=l;i.statsCollector.addLocalStats(d)}),i.statsUploader.startUploadOutboundStats(),i.assignLocalTracks(o,a),o.forEach(l=>{let{track:d,type:u}=l;const h=Date.now();i.store.publish(d.getTrackId(),u===j.LocalAudioTrack?"audio":"video",void 0,h)}),i.startUploadUplinkState()}finally{r()}})()}unpublish(e){var t=this;return C(function*(){if(!t.sendConnection||t.state!==Xe.Connected)return void(0===e.length?t.pendingLocalTracks.length=0:t.pendingLocalTracks=t.pendingLocalTracks.filter(o=>!Y(e).call(e,o)));const n=t.filterTobeUnpublishedTracks(e);if(0===n.length)return;const i=n.find(o=>"videoLowTrack"===o[0]);i&&i[1].track.close();const r=t.createGatewayUnpublishMessage(n);if(yield t.sendConnection.stopSending(n.map(o=>{let[,{id:s}]=o;return s})),t.withdrawLocalTracks(n),t.unbindLocalTrackEvents(n.map(o=>{let[s,{track:a}]=o;return{type:s,track:a}})),n.forEach(o=>{let[s]=o;t.statsCollector.removeLocalStats(s)}),0===t.localTrackMap.size&&(t.statsUploader.stopUploadOutboundStats(),t.stopUploadUplinkState()),t.sendConnection&&t.state===Xe.Connected)return i&&i[1].track.close(),r;e.forEach(o=>{const s=t.pendingLocalTracks.indexOf(o);-1!==s&&t.pendingLocalTracks.splice(s,1)})})()}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const e=()=>{const t=[],n=[];Array.from(this.localTrackMap.entries()).forEach(i=>{let[r,{track:o,ssrcs:s}]=i;const a={stream_type:IFe(o,r),ssrcs:s};o._muted||!o._enabled?t.push(a):n.push(a)}),t.length>0&&t.forEach(i=>{ct(this,de.RequestMuteLocal,[i])}),n.length>0&&n.forEach(i=>{ct(this,de.RequestUnmuteLocal,[i])})};e(),this.uplinkStateUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(e){return Do(function*(){throw new M(S.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}republish(){var e=this;return C(function*(){e.pendingLocalTracks.length>0&&(_.debug("[".concat(e.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),yield ni(e,de.RequestRePublish,e.pendingLocalTracks),e.emit(de.MediaReconnectEnd,e.store.uid),e.pendingLocalTracks=[])})()}unpublishLowStream(){return C(function*(){throw new M(S.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")})()}subscribe(e,t,n,i){var r=this;return C(function*(){var o;if(!r.recvConnection)throw new M(S.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if(null!==(o=r.remoteUserMap.get(e))&&void 0!==o&&o.has(t))return;const{track:s,mid:a,transceiver:c}=yield r.recvConnection.receive(t,[{ssrcId:n}],String(e.uid),i);t===ie.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(s):(e._audioTrack=new kp(s,e.uid,e._uintid,r.store),_.info("[".concat(r.store.clientId,"] [").concat(r.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),c&&e._audioTrack._updateRtpTransceiver(c),r.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoSSRC=n,e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(s):(e._videoTrack=new xp(s,e.uid,e._uintid,r.store),_.info("[".concat(r.store.clientId,"] [").concat(r.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),c&&e._videoTrack._updateRtpTransceiver(c),r.bindRemoteTrackEvents(e,e._videoTrack));const l=r.remoteUserMap.get(e);l?l.set(t,a):r.remoteUserMap.set(e,new Map([[t,a]])),r.statsCollector.addRemoteStats(e.uid),r.statsUploader.startUploadInboundStats(),r.startUploadDownlinkState();const d=r.pendingRemoteTracks.findIndex(u=>{let{user:h,kind:p}=u;return h.uid===e.uid&&t===p});-1!==d&&(r.pendingRemoteTracks.splice(d,1),r.emit(de.MediaReconnectEnd,e.uid))})()}mockSubscribe(e,t,n,i){var r=this;return C(function*(){if(!r.recvConnection)throw new M(S.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");yield r.recvConnection.mockReceive(t,[{ssrcId:n}],String(e.uid),i)})()}unsubscribe(e,t,n){var i=this;return C(function*(){const r=i.pendingRemoteTracks.filter(s=>{let{user:a,kind:c}=s;return void 0!==t?a.uid===e.uid&&t===c:a.uid===e.uid});if(r.forEach(s=>{const a=i.pendingRemoteTracks.indexOf(s);i.pendingRemoteTracks.splice(a,1)}),i.recvConnection||n||r.forEach(s=>{let{kind:a}=s;var c;if(a===ie.AUDIO)null===(c=e._audioTrack)||void 0===c||c._destroy(),e._audioTrack=void 0;else if(a===ie.VIDEO){var l;null===(l=e._videoTrack)||void 0===l||l._destroy(),e._videoTrack=void 0}}),!i.recvConnection)return;const o=i.filterTobeUnSubscribedTracks(e,t);0!==o.length&&(yield i.recvConnection.stopReceiving(o.map(s=>{let[,{id:a}]=s;return a})),i.withdrawRemoteTracks(o),0===i.remoteUserMap.size&&(i.statsUploader.stopUploadInboundStats(),i.stopUploadDownlinkState()),o.forEach(s=>{let[a,{kind:c}]=s;var l,d;if(c===ie.VIDEO&&a._videoSSRC&&(null===(l=i.recvConnection)||void 0===l||l.setStatsRemoteVideoIsReady(a._videoSSRC,!1)),c===ie.VIDEO)i.unbindRemoteTrackEvents(a._videoTrack),n||(null===(d=a._videoTrack)||void 0===d||d._destroy(),a._videoTrack=void 0);else if(c===ie.AUDIO){var u;i.unbindRemoteTrackEvents(a._audioTrack),!n&&(null===(u=a._audioTrack)||void 0===u||u._destroy(),a._audioTrack=void 0)}}),o.forEach(s=>{let[,{kind:a}]=s;ct(i,de.RequestP2PMuteRemote,a)}))})()}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const e=()=>Array.from(this.remoteUserMap.entries()).forEach(t=>{let[,n]=t;[ie.VIDEO,ie.AUDIO].forEach(i=>{n.has(i)?ct(this,de.RequestP2PUnmuteRemote,i):ct(this,de.RequestP2PMuteRemote,i)})});e(),this.downlinkStatsUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}massSubscribe(e){return C(function*(){throw new M(S.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")})()}massSubscribeNoLock(e){return C(function*(){throw new M(S.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")})()}massUnsubscribe(e){return C(function*(){throw new M(S.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")})()}massUnsubscribeNoLock(e){return C(function*(){throw new M(S.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")})()}muteRemote(e,t){var n=this;return C(function*(){if(!n.recvConnection)return;const i=n.remoteUserMap.get(e);if(!i)return void _.warning("[".concat(n.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid,"."));if(!i.get(t))return void _.warning("[".concat(n.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const r=t===ie.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==r&&n.recvConnection.setStatsRemoteVideoIsReady(r,!1)})()}unmuteRemote(e,t){var n=this;return C(function*(){return n.unmuteRemoteNoLock(e,t)})()}unmuteRemoteNoLock(e,t){var n=this;return C(function*(){if(!n.recvConnection)return;const i=n.remoteUserMap.get(e);i?i.get(t)||_.warning("[".concat(n.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,".")):_.warning("[".concat(n.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid,"."))})()}getAllTracks(e){const t=this.localTrackMap.get(j.LocalAudioTrack);if(t?.track instanceof wn){const n=t.track;return Array.from(this.localTrackMap.entries()).filter(i=>{let[r]=i;return r!==j.LocalAudioTrack}).filter(i=>{let[r]=i;return!(e&&r===j.LocalVideoLowTrack)}).map(i=>{let[,{track:r}]=i;return r}).concat(n.trackList)}return Array.from(this.localTrackMap.entries()).filter(n=>{let[i]=n;return!(e&&i===j.LocalVideoLowTrack)}).map(n=>{let[,{track:i}]=n;return i})}reportPublishEvent(e,t,n,i,r){if(e){const s=this.localTrackMap.get(j.LocalAudioTrack),a=this.localTrackMap.get(i?j.LocalVideoLowTrack:j.LocalVideoTrack);ne.publish(this.store.sessionId,{eventElapse:_i.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:s?.track.getTrackLabel(),videoName:a?.track.getTrackLabel(),screenshare:-1!==a?.track._hints.indexOf(ft.SCREEN_TRACK),audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:r})}else{var o;n||(n=[]);const s=n.find(c=>c instanceof Ht),a=i?null===(o=this.localTrackMap.get(j.LocalVideoTrack))||void 0===o?void 0:o.track:n.find(c=>c instanceof yt);ne.publish(this.store.sessionId,{eventElapse:_i.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:s?.getTrackLabel(),videoName:a?.getTrackLabel(),screenshare:-1!==a?._hints.indexOf(ft.SCREEN_TRACK),audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:r})}}reportSubscribeEvent(e,t,n,i){const r=i===ie.VIDEO?n._videoSSRC:n._audioSSRC;r&&ne.subscribe(this.store.sessionId,{succ:e,ec:t,video:i===ie.VIDEO,audio:i===ie.AUDIO,peerid:n.uid,subscribeRequestid:i===ie.VIDEO?n._videoSSRC:n._audioSSRC,p2pid:this.store.p2pId,eventElapse:_i.measureFromSubscribeStart(this.store.clientId,r)})}reset(){_.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new mi("P2PChannel2-send-mutex"),this.sendMutex=new mi("P2PChannel2-recv-mutex"),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(j.LocalAudioTrack);if(e?.track instanceof wn){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach(n=>{t.removeAudioTrack(n)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=Xe.Disconnected}getStats(e){var t,n;return e?null===(n=this.recvConnection)||void 0===n?void 0:n.getStats():null===(t=this.sendConnection)||void 0===t?void 0:t.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.recvConnection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(j.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(j.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof yt||t&&t.track instanceof Ht?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}hasRemoteMediaWithLock(e,t){var n=this;return C(function*(){if(!e)return n.remoteUserMap.size>0;const i=n.remoteUserMap.get(e);return!!i&&(!t||i.has(t))})()}getRemoteMedia(e){var t;const n=Array.from(Xr(t=this.remoteUserMap).call(t)).find(i=>i.uid===e);return n?{audioTrack:n.audioTrack,audioSSRC:n._audioSSRC,videoTrack:n.videoTrack,videoSSRC:n._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(n=>{let[i]=n;return{uid:i.uid,level:i.audioTrack?100*i.audioTrack._source.getAccurateVolumeLevel():0}});const t=this.localTrackMap.get(j.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Ig(e).call(e,(n,i)=>n.level-i.level),e}disconnectForReconnect(){var e=this;return C(function*(){e.sendConnection&&e.recvConnection&&(_.debug("[".concat(e.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),e.state=Xe.Reconnecting,R("KEEP_LAST_FRAME")&&0!==e.remoteUserMap.size&&Array.from(e.remoteUserMap.entries()).forEach(t=>{let[n]=t;var i;n._videoTrack&&n._videoTrack._player&&(null===(i=n._videoTrack._player.getVideoElement())||void 0===i||i.pause(),n._videoTrack._player.isKeepLastFrame=!0,n._videoTrack._originMediaStreamTrack.stop())}),e.sendConnection.close(),e.unbindConnectionEvents(e.sendConnection),e.sendConnection=void 0,e.recvConnection.close(),e.unbindConnectionEvents(e.recvConnection),e.recvConnection=void 0,0!==e.localTrackMap.size&&(Array.from(e.localTrackMap.entries()).forEach(t=>{var n;let[i,{track:r}]=t;switch(i){case j.LocalVideoTrack:Y(n=r._hints).call(n,ft.LOW_STREAM)?r.close():e.pendingLocalTracks.push(r);break;case j.LocalAudioTrack:r instanceof wn?e.pendingLocalTracks=e.pendingLocalTracks.concat(r.trackList):e.pendingLocalTracks.push(r)}}),e.emit(de.MediaReconnectStart,e.store.uid)),e.unbindLocalTrackEvents(),e.localTrackMap.clear(),0!==e.remoteUserMap.size&&Array.from(e.remoteUserMap.entries()).forEach(t=>{let[n,i]=t;Array.from(Xr(i).call(i)).forEach(r=>{e.setPendingRemoteMedia(n,r)}),e.emit(de.MediaReconnectStart,n.uid)}),e.unbindAllRemoteTrackEvents(),e.remoteUserMap.clear(),e.stopUploadUplinkState(),e.stopUploadDownlinkState(),e.statsUploader.stopUploadOutboundStats(),e.statsUploader.stopUploadInboundStats(),e.statsUploader.stopUploadTransportStats(),_.debug("[".concat(e.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))})()}hasPendingRemoteMedia(e,t){for(const n of this.pendingRemoteTracks){const{user:i,kind:r}=n;if((e instanceof Il?e.uid:e)===i.uid&&t===r)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}restartICE(e,t){var n=this;return C(function*(){let i,r;if(e===Yi.SEND_ONLY){if(!n.sendConnection)throw new M(S.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");i=yield n.sendMutex.lock("From P2PChannel.restartICE"),r=n.sendConnection}else{if(!n.recvConnection)throw new M(S.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");i=yield n.recvMutex.lock("From P2PChannel.restartICE"),r=n.recvConnection}try{if(t){const o=yield r.restartICE(t);return r.isInRestartIce=!1,o}{const o=yield r.restartICE();if(o){const s=yield ni(n,de.RequestP2PRestartICE,{direction:Yi.RECEIVE_ONLY,iceParameter:o});yield r.restartICE(s),r.isInRestartIce=!1}}}finally{i()}})()}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const e=this.sendConnection.getStats(),t=this.localTrackMap.get(j.LocalVideoTrack),n=this.localTrackMap.get(j.LocalAudioTrack),i=e.videoSend.find(p=>{var m;return p.ssrc===(null==t||null===(m=t.ssrcs)||void 0===m?void 0:m[0].ssrcId)}),r=e.audioSend.find(p=>{var m;return p.ssrc===(null==n||null===(m=n.ssrcs)||void 0===m?void 0:m[0].ssrcId)});if(!i||!r)return 1;const o=Oo(this,de.NeedSignalRTT),s=i?i.rttMs:void 0,a=r?r.rttMs:void 0,c=s&&a?(s+a)/2:s||a,d=100*e.sendPacketLossRate*.7/50+.3*((c&&o?(c+o)/2:c||o)||0)/1500,u=d<.17?1:d<.36?2:d<.59?3:d<.1?4:5,h=t?.track;if(h&&h._encoderConfig&&-1===h._hints.indexOf(ft.SCREEN_TRACK)){const p=h._encoderConfig.bitrateMax,m=e.bitrate.actualEncoded;if(p&&m){const f=(1e3*p-m)/(1e3*p);return NK[f<.15?0:f<.3?1:f<.45?2:f<.6?3:4][u]}}return u}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const e=this.recvConnection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach(n=>{let[i]=n;const r=i._audioSSRC,o=i._videoSSRC,s=e.audioRecv.find(m=>m.ssrc===r),a=e.videoRecv.find(m=>m.ssrc===o);if(!s&&!a)return void(t+=1);const c=Oo(this,de.NeedSignalRTT),l=e.rtt,d=(l&&c?(l+c)/2:l||c)||0,u=s?s.jitterMs:void 0,h=e.recvPacketLossRate;let p=.7*h*100/50+.3*d/1500;u&&(p=.6*h*100/50+.2*d/1500+.2*u/400),t+=p<.1?1:p<.17?2:p<.36?3:p<.59?4:5}),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}muteLocalTrack(e){var t=this;return C(function*(){return new q((n,i)=>{t.handleMuteLocalTrack(e,n,i)})})()}filterTobePublishedTracks(e,t,n){const i=[],r=Fe(),o=this.getAllTracks();e=dp(e=e.filter(c=>-1===o.indexOf(c)));let s=!1,a=!1;for(const c of e){if(c instanceof yt&&(this.localTrackMap.has(j.LocalVideoTrack)||s?new M(S.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(i.push({track:c,type:j.LocalVideoTrack}),s=!0),t)){const l=this.getLowVideoTrack(c,n);i.push({track:l,type:j.LocalVideoLowTrack})}if(c instanceof Ht){const l=this.localTrackMap.get(j.LocalAudioTrack);if(l){if(!(l.track instanceof wn))throw new M(S.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new M(S.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");l.track.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0)}else if(a){const d=i.find(u=>{let{type:h}=u;return h===j.LocalAudioTrack});if(!(d.track instanceof wn))throw new M(S.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new M(S.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");d.track.addAudioTrack(c)}else{if(!r.webAudioMediaStreamDest||c instanceof wn||c._bypassWebAudio)i.push({track:c,type:j.LocalAudioTrack});else{const d=new wn;d.addAudioTrack(c),i.push({track:d,type:j.LocalAudioTrack})}a=!0}}}return i}filterTobeUnpublishedTracks(e){const t=[],n=this.getAllTracks();e=dp(e=e.filter(i=>-1!==n.indexOf(i)));for(const i of e){if(i instanceof Ht){const r=this.localTrackMap.get(j.LocalAudioTrack);if(!r)continue;r.track instanceof wn?(r.track.removeAudioTrack(i),this.unbindLocalAudioTrackEvents(i),0===r.track.trackList.length&&(t.push([j.LocalAudioTrack,r]),r.track.close())):t.push([j.LocalAudioTrack,r])}if(i instanceof yt){const r=this.localTrackMap.get(j.LocalVideoTrack);if(!r)continue;t.push([j.LocalVideoTrack,r]);const o=this.localTrackMap.get(j.LocalVideoLowTrack);o&&t.push([j.LocalVideoLowTrack,o])}}return t}bindLocalTrackEvents(e){e.forEach(t=>{let{track:n,type:i}=t;switch(i){case j.LocalVideoTrack:n.addListener(X.GET_STATS,this.handleGetLocalVideoStats),n.addListener(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.addListener(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.addListener(X.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),n.addListener(X.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),n.addListener(X.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.addListener(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.addListener(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case j.LocalAudioTrack:this.bindLocalAudioTrackEvents(n)}})}bindLocalAudioTrackEvents(e,t){e instanceof wn?e.trackList.forEach(n=>{n.addListener(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.addListener(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.addListener(X.GET_STATS,this.handleGetLocalAudioStats),n.addListener(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.addListener(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(X.GET_STATS,this.handleGetLocalAudioStats),e.addListener(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(X.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(t=>{let[n,{track:i}]=t;return{track:i,type:n}})),e.forEach(t=>{let{track:n,type:i}=t;switch(i){case j.LocalVideoTrack:n.off(X.GET_STATS,this.handleGetLocalVideoStats),n.off(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(X.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),n.off(X.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),n.off(X.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.off(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case j.LocalAudioTrack:this.unbindLocalAudioTrackEvents(n)}})}unbindLocalAudioTrackEvents(e){e instanceof wn?e.trackList.forEach(t=>{t.off(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(X.GET_STATS,this.handleGetLocalAudioStats),t.off(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(X.GET_STATS,this.handleGetLocalAudioStats),e.off(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(X.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof xp&&t.addListener(X.GET_STATS,n=>{n(this.handleGetRemoteVideoStats(e))}),t instanceof kp&&t.addListener(X.GET_STATS,n=>{n(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(X.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,n]=e;n.has(ie.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),n.has(ie.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)})}createGatewayPublishMessage(e,t){return e.map((n,i)=>{var r;let o,{track:s,type:a}=n;switch(a){case j.LocalAudioTrack:o=$e.Audio;break;case j.LocalVideoTrack:o=Y(r=s._hints).call(r,ft.SCREEN_TRACK)?$e.Screen:$e.High;break;case j.LocalVideoLowTrack:o=$e.Low}return{kind:a===j.LocalAudioTrack?ie.AUDIO:ie.VIDEO,stream_type:o,mid:t[i].id,ssrcs:t[i].localSSRC,isMuted:s.muted||!s.enabled}})}createGatewayUnpublishMessage(e){return e.map(t=>{var n;let i,[r,{track:o,ssrcs:s,id:a}]=t;switch(r){case j.LocalVideoTrack:i=Y(n=o._hints).call(n,ft.SCREEN_TRACK)?$e.Screen:$e.High;break;case j.LocalAudioTrack:i=$e.Audio;break;case j.LocalVideoLowTrack:i=$e.Low}return{stream_type:i,ssrcs:s,mid:a}})}assignLocalTracks(e,t){e.forEach((n,i)=>{let{track:r,type:o}=n;this.localTrackMap.set(o,{track:r,id:t[i].id,ssrcs:t[i].localSSRC})})}withdrawLocalTracks(e){e.forEach(t=>{let[n]=t;this.localTrackMap.delete(n)})}bindConnectionEvents(e){var t=this;e.onConnectionStateChange=function(){var n=C(function*(i){var r;_.info("[".concat(t.store.clientId,"] [p2pId: ").concat(t.store.p2pId,"]: ").concat(e.name,".onConnectionStateChange(").concat(i,")")),t.emit(de.PeerConnectionStateChange,i),"connected"!==i||t.store.keyMetrics.peerConnectionEnd||t.store.peerConnectionEnd(),"connected"===i&&(e.isInRestartIce=!1),Y(r=t._restartStates).call(r,i)&&!e.isInRestartIce&&("disconnected"===i&&(yield qn(800)),"disconnected"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||t.handleDisconnect(e.direction))});return function(i){return n.apply(this,arguments)}}(),e.onICEConnectionStateChange=n=>{"connected"!==n||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(n,")")),ne.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:n,tag:jt.TRACER}).onSuccess(),this.emit(de.IceConnectionStateChange,n)},e.onICETransportStateChange=n=>{_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(n,")"))},e.onDTLSTransportStateChange=n=>{_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(n,")"))},e.onDTLSTransportError=n=>{_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(n,")"))},e.onFirstAudioDecoded=n=>{var i;const r=Array.from(Xr(i=this.remoteUserMap).call(i)).find(s=>s._audioSSRC===n);var o;r&&(this.store.subscribe(r.uid,"audio",void 0,void 0,void 0,Date.now()),null===(o=r.audioTrack)||void 0===o||o.emit(Dp.FIRST_FRAME_DECODED),ne.firstRemoteFrame(this.store.sessionId,Yn.FIRST_AUDIO_DECODE,kt.FIRST_AUDIO_DECODE,{peer:r._uintid,subscribeElapse:_i.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=n=>{var i;const r=Array.from(Xr(i=this.remoteUserMap).call(i)).find(o=>o._audioSSRC===n);r&&ne.firstRemoteFrame(this.store.sessionId,Yn.FIRST_AUDIO_RECEIVED,kt.FIRST_AUDIO_RECEIVED,{peer:r._uintid,subscribeElapse:_i.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(n,i,r)=>{this.reportVideoFirstFrameDecoded(n,i,r)},e.onFirstVideoReceived=n=>{var i;const r=Array.from(Xr(i=this.remoteUserMap).call(i)).find(o=>o._videoSSRC===n);r&&ne.firstRemoteFrame(this.store.sessionId,Yn.FIRST_VIDEO_RECEIVED,kt.FIRST_VIDEO_RECEIVED,{peer:r._uintid,subscribeElapse:_i.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(n,i)=>{const r="relay"===n.candidateType;"unknown"!==i.candidateType&&r===("relay"===i.candidateType)||this.emit(de.ConnectionTypeChange,r),_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(bl(i))," -> ").concat(JSON.stringify(bl(n)),")"))},e.onSelectedRemoteCandidateChanged=(n,i)=>{_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(bl(i))," -> ").concat(JSON.stringify(bl(n)),")"))},e.onFirstVideoDecodedTimeout=n=>{this.reportVideoFirstFrameDecoded(n,void 0,void 0,!0)},e.onLocalCandidate=n=>{this.emit(de.LocalCandidate,{candidate:n,direction:e.direction})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.onLocalCandidate=void 0}handleDisconnect(e){var t=this;return C(function*(){const n=e===Yi.SEND_ONLY?t.sendConnection:t.recvConnection;n&&!n.isInRestartIce&&(n.isInRestartIce=!0,_.debug("[".concat(t.store.clientId,"] [P2PChannel-").concat(n.name,"] start use restartICE")),e===Yi.SEND_ONLY?t.restartICE(e):ni(t,de.RequestP2PRestartICE,{direction:Yi.SEND_ONLY}))})()}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const n=this.localTrackMap.get(j.LocalAudioTrack);if(e instanceof Ht&&n?.track instanceof wn)return n.track.isActive||t.push([j.LocalAudioTrack,n]),t;const i=Array.from(this.localTrackMap.entries()).find(r=>{let[,{track:o}]=r;return e===o});if(i&&(t.push(i),i[0]===j.LocalVideoTrack)){const r=this.localTrackMap.get(j.LocalVideoLowTrack);r&&t.push([j.LocalVideoLowTrack,r])}return t}filterTobeUnmutedTracks(e){const t=[],n=this.localTrackMap.get(j.LocalAudioTrack);if(e instanceof Ht&&n?.track instanceof wn)return n.track.isActive&&t.push([j.LocalAudioTrack,n]),t;const i=Array.from(this.localTrackMap.entries()).find(r=>{let[,{track:o}]=r;return e===o});if(i)if(i[0]===j.LocalVideoTrack){t.push(i);const r=this.localTrackMap.get(j.LocalVideoLowTrack);r&&t.push([j.LocalVideoLowTrack,r])}else t.push(i);return t}createMuteMessage(e){return e.map(t=>{var n;let i,[r,{track:o,ssrcs:s,id:a}]=t;switch(r){case j.LocalAudioTrack:i=$e.Audio;break;case j.LocalVideoTrack:i=Y(n=o._hints).call(n,ft.SCREEN_TRACK)?$e.Screen:$e.High;break;case j.LocalVideoLowTrack:i=$e.Low}return{stream_type:i,ssrcs:s,mid:a}})}createUnmuteMessage(e){return e.map(t=>{var n;let i,[r,{track:o,ssrcs:s,id:a}]=t;switch(r){case j.LocalAudioTrack:i=$e.Audio;break;case j.LocalVideoTrack:i=Y(n=o._hints).call(n,ft.SCREEN_TRACK)?$e.Screen:$e.High;break;case j.LocalVideoLowTrack:i=$e.Low}return{stream_type:i,ssrcs:s,mid:a}})}filterTobeUnSubscribedTracks(e,t){const n=[],i=this.remoteUserMap.get(e);if(!i)return n;if(t){const r=i.get(t);if(!r)return n;n.push([e,{kind:t,id:r}])}else Array.from(i.entries()).forEach(r=>{let[o,s]=r;n.push([e,{kind:o,id:s}])});return n}createUnsubscribeMessage(e){const t=[];return e.forEach(n=>{let[i,{kind:r}]=n;switch(r){case ie.VIDEO:return void(i._videoSSRC&&t.push({stream_type:ie.VIDEO,ssrcId:i._videoSSRC}));case ie.AUDIO:return void(i._audioSSRC&&t.push({stream_type:ie.AUDIO,ssrcId:i._audioSSRC}))}}),t}withdrawRemoteTracks(e){e.forEach(t=>{let[n,{kind:i}]=t;const r=this.remoteUserMap.get(n);r&&(r.delete(i),0===Array.from(r.entries()).length&&this.remoteUserMap.delete(n))})}updateBitrateLimit(e){var t=this;return C(function*(){const n=t.localTrackMap.get(j.LocalVideoTrack),i=t.localTrackMap.get(j.LocalVideoLowTrack);n&&(yield n.track.setBitrateLimit(e.uplink)),i&&e.low_stream_uplink&&(yield i.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}))})()}isP2PDisconnected(){return!this.sendConnection||!this.recvConnection||"connected"!==this.sendConnection.peerConnectionState&&"connected"!==this.recvConnection.peerConnectionState}tryToUnmuteAudio(e){var t=this;return C(function*(){for(let n=0;n<e.length;n++)if(e[n]instanceof Ht){const i=t.filterTobeUnmutedTracks(e[n]);if(0===i.length)continue;const r=t.createUnmuteMessage(i);return void(yield ct(t,de.RequestUnmuteLocal,r))}})()}bindStatsUploaderEvents(){this.statsUploader.requestStats=e=>this.getStats(e),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(e=>{let[,{ssrcs:t}]=e;return!!t}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.recvConnection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(de.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(de.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}requestReconnect(){var e=this;return C(function*(){e.dtlsFailedCount+=1,yield qn(rP(e.dtlsFailedCount,vn)),e.emit(de.RequestReconnect)})()}reconnectP2P(){return C(function*(){})()}canPublishLowStream(){return this.localTrackMap.has(j.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof yt)}throwIfTrackTypeNotMatch(e){if(e.filter(t=>t instanceof yt).length>1)throw new M(S.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(t=>t instanceof Ht).length>1&&(e.some(t=>t instanceof Ht&&t._bypassWebAudio)||!Fe().webAudioMediaStreamDest))throw new M(S.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof yt&&this.pendingLocalTracks.some(n=>n instanceof yt))throw new M(S.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof Ht&&this.pendingLocalTracks.some(n=>n instanceof Ht)&&(!Fe().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some(n=>n instanceof Ht&&n._bypassWebAudio)))throw new M(S.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const n=!R("DISABLE_DUAL_STREAM_USE_ENCODING")&&Fe().supportDualStreamEncoding,i=mC(mC({},{width:160,height:120,framerate:15,bitrate:50}),t);let r;r=n?e._mediaStreamTrack.clone():WM(e,i);const o=gt(8,"track-low-"),s=new yt(r,mC(mC({},n&&{scaleResolutionDownBy:IP(i,e)}),{},{frameRate:i.framerate,bitrateMax:i.bitrate,bitrateMin:i.bitrate}),void 0,void 0,o);return s.on(Bd.TRANSCEIVER_UPDATED,a=>{e._updateRtpTransceiver(a,Rp.LOW_STREAM)}),s._hints.push(ft.LOW_STREAM),e.addListener(X.NEED_CLOSE,()=>{s.close()}),s}globalLock(){var e=this;return C(function*(){return e.recvMutex.lock("From P2PChannel2.globalLock")})()}reportVideoFirstFrameDecoded(e,t,n,i){var r;const o=Array.from(Xr(r=this.remoteUserMap).call(r)).find(s=>s._videoSSRC===e);if(o){i||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());const s=this.store.keyMetrics,a=s.subscribe.find(c=>c.userId===o.uid&&"video"===c.type);ne.firstRemoteVideoDecode(this.store.sessionId,Yn.FIRST_VIDEO_DECODE,kt.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:n,subscribeElapse:_i.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:s.requestAPEnd||0,apStart:s.requestAPStart||0,joinGwEnd:s.joinGatewayEnd||0,joinGwStart:s.joinGatewayStart||0,pcEnd:s.peerConnectionEnd||0,pcStart:s.peerConnectionStart||0,subscriberEnd:a?.subscribeEnd||0,subscriberStart:a?.subscribeStart||0,videoAddNotify:a?.streamAdded||0,state:i?1:0})}}remoteMediaSsrcChanged(e,t,n){var i=this;return C(function*(){if(!i.recvConnection)return!1;const r=i.remoteUserMap.get(e);if(!r)return!1;const o=r.get(t);if(!o)return!1;const s=yield i.recvConnection.getRemoteSSRC(o);return void 0!==s&&s!==n})()}isPreSubScribe(e){return!1}publishDataChannel(e){return C(function*(){throw new M(S.NOT_SUPPORTED)})()}unpublishDataChannel(e){return C(function*(){throw new M(S.NOT_SUPPORTED)})()}subscribeDataChannel(e,t){return C(function*(){throw new M(S.NOT_SUPPORTED)})()}unsubscribeDataChannel(e,t){return C(function*(){throw new M(S.NOT_SUPPORTED)})()}hasPendingRemoteDataChannel(e,t){throw new M(S.NOT_SUPPORTED)}setPendingRemoteDataChannel(e,t){throw new M(S.NOT_SUPPORTED)}preConnect(e){return C(function*(){throw new M(S.NOT_SUPPORTED)})()}getEstablishParams(){throw new M(S.NOT_SUPPORTED)}reSubscribe(e){return C(function*(){throw new M(S.NOT_SUPPORTED)})()}updateVideoStreamParameter(e,t){return C(function*(){throw new M(S.NOT_SUPPORTED)})()}unbindRtpTransceiver(){0!==this.localTrackMap.size&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[t,{track:n}]=e;t===j.LocalVideoLowTrack?n._updateRtpTransceiver(void 0,Rp.LOW_STREAM):n._updateRtpTransceiver(void 0)})}},Q(At.prototype,"p2pConnect",[RX],Object.getOwnPropertyDescriptor(At.prototype,"p2pConnect"),At.prototype),Q(At.prototype,"unpublish",[AX],Object.getOwnPropertyDescriptor(At.prototype,"unpublish"),At.prototype),Q(At.prototype,"unpublishLowStream",[DX],Object.getOwnPropertyDescriptor(At.prototype,"unpublishLowStream"),At.prototype),Q(At.prototype,"subscribe",[OX],Object.getOwnPropertyDescriptor(At.prototype,"subscribe"),At.prototype),Q(At.prototype,"mockSubscribe",[NX],Object.getOwnPropertyDescriptor(At.prototype,"mockSubscribe"),At.prototype),Q(At.prototype,"unsubscribe",[PX],Object.getOwnPropertyDescriptor(At.prototype,"unsubscribe"),At.prototype),Q(At.prototype,"muteRemote",[MX],Object.getOwnPropertyDescriptor(At.prototype,"muteRemote"),At.prototype),Q(At.prototype,"unmuteRemote",[xX],Object.getOwnPropertyDescriptor(At.prototype,"unmuteRemote"),At.prototype),Q(At.prototype,"hasRemoteMediaWithLock",[kX],Object.getOwnPropertyDescriptor(At.prototype,"hasRemoteMediaWithLock"),At.prototype),Q(At.prototype,"disconnectForReconnect",[LX],Object.getOwnPropertyDescriptor(At.prototype,"disconnectForReconnect"),At.prototype),Q(At.prototype,"remoteMediaSsrcChanged",[FX],Object.getOwnPropertyDescriptor(At.prototype,"remoteMediaSsrcChanged"),At.prototype),At);function Gs(e){return function(t,n,i){const r=t[n];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return i.value=C(function*(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];switch(e){case Hs.SEND_ONLY:{const c=yield this.sendMutex.lock("From P2PChannel2.".concat(n));try{return yield r.apply(this,s)}finally{c()}}case Hs.RECEIVE_ONLY:{const c=yield this.recvMutex.lock("From P2PChannel2.".concat(n));try{return yield r.apply(this,s)}finally{c()}}default:{const c=yield this.sendMutex.lock("From P2PChannel2.".concat(n)),l=yield this.recvMutex.lock("From P2PChannel2.".concat(n));try{return yield r.apply(this,s)}finally{c(),l()}}}}),i}}function VX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function $d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?VX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}class c_{constructor(t){y(this,"store",void 0),y(this,"onStatsException",void 0),y(this,"onUploadPublishDuration",void 0),y(this,"onStatsChanged",void 0),y(this,"localStats",new Map),y(this,"remoteStats",new Map),y(this,"updateStatsInterval",void 0),y(this,"trafficStats",void 0),y(this,"trafficStatsPeerList",[]),y(this,"uplinkStats",void 0),y(this,"exceptionMonitor",void 0),y(this,"p2pChannel",void 0),y(this,"scalabilityMode",gP.L1T1),y(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=t,this.exceptionMonitor=new pFe,this.exceptionMonitor.on("exception",(n,i,r)=>{this.onStatsException&&this.onStatsException(n,i,r)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(j.LocalAudioTrack)||$d({},ZP)}getLocalVideoTrackStats(){return this.localStats.get(j.LocalVideoTrack)||$d({},JP)}getRemoteAudioTrackStats(t){const n=(o,s)=>{if(!this.trafficStats)return s;const a=this.trafficStats.peer_delay.find(c=>c.peer_uid===o);return a&&(s.publishDuration=a.B_ppad+(Date.now()-this.trafficStats.timestamp)),s},i={};if(t){var r;const o=null===(r=this.remoteStats.get(t))||void 0===r?void 0:r.audioStats;o&&(i[t]=n(t,o))}else Array.from(this.remoteStats.entries()).forEach(o=>{let[s,{audioStats:a}]=o;a&&(i[s]=n(s,a))});return i}getRemoteNetworkQualityStats(t){const n={};if(t){var i;const r=null===(i=this.remoteStats.get(t))||void 0===i?void 0:i.networkStats;r&&(n[t]=r)}else Array.from(this.remoteStats.entries()).forEach(r=>{let[o,{networkStats:s}]=r;s&&(n[o]=s)});return n}getRemoteVideoTrackStats(t){const n=(o,s)=>{if(!this.trafficStats)return s;const a=this.trafficStats.peer_delay.find(c=>c.peer_uid===o);return a&&(s.publishDuration=a.B_ppvd+(Date.now()-this.trafficStats.timestamp)),s},i={};if(t){var r;const o=null===(r=this.remoteStats.get(t))||void 0===r?void 0:r.videoStats;o&&(i[t]=n(t,o))}else Array.from(this.remoteStats.entries()).forEach(o=>{let[s,{videoStats:a}]=o;a&&(i[s]=n(s,a))});return i}getRTCStats(){let t=0,n=0,i=0,r=0;const o=this.localStats.get(j.LocalAudioTrack);o&&(t+=o.sendBytes,n+=o.sendBitrate);const s=this.localStats.get(j.LocalVideoTrack);s&&(t+=s.sendBytes,n+=s.sendBitrate);const a=this.localStats.get(j.LocalVideoLowTrack);a&&(t+=a.sendBytes,n+=a.sendBitrate),this.remoteStats.forEach(l=>{let{audioStats:d,videoStats:u}=l;d&&(i+=d.receiveBytes,r+=d.receiveBitrate),u&&(i+=u.receiveBytes,r+=u.receiveBitrate)});let c=1;return this.trafficStats&&(c+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:c,SendBitrate:n,SendBytes:t,RecvBytes:i,RecvBitrate:r,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(t){this.localStats.set(t,void 0)}removeLocalStats(t){t?this.localStats.delete(t):this.localStats.clear()}addRemoteStats(t){this.remoteStats.set(t,{})}removeRemoteStats(t){t?this.remoteStats.delete(t):this.remoteStats.clear()}addP2PChannel(t){this.p2pChannel=t}updateTrafficStats(t){t.peer_delay=t.peer_delay.filter(n=>void 0!==n.B_ppad||void 0!==n.B_ppvd),t.peer_delay.filter(n=>-1===this.trafficStatsPeerList.indexOf(n.peer_uid)).forEach(n=>{var i;const r=null===(i=this.p2pChannel)||void 0===i?void 0:i.getRemoteMedia(n.peer_uid),o=null!=r&&r.videoSSRC?_i.measureFromSubscribeStart(this.store.clientId,r.videoSSRC):0,s=null!=r&&r.audioSSRC?_i.measureFromSubscribeStart(this.store.clientId,r.audioSSRC):0;void 0!==n.B_ppad&&void 0!==n.B_ppvd&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(n.peer_uid,n.B_ppad,n.B_ppvd,o>s?o:s),this.trafficStatsPeerList.push(n.peer_uid))}),this.trafficStats=t}updateUplinkStats(t){this.uplinkStats&&this.uplinkStats.B_fir!==t.B_fir&&_.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(t.B_fir)),this.uplinkStats=t}static isRemoteVideoFreeze(t,n,i){return!!t&&(!!i&&n.framesDecodeFreezeTime>i.framesDecodeFreezeTime||!(!i||n.framesDecodeCount>i.framesDecodeCount))}static isRemoteAudioFreeze(t){return!!t&&t._isFreeze()}isLocalVideoFreeze(t){return!(!t.inputFrame||!t.sentFrame)&&t.inputFrame.frameRate>5&&t.sentFrame.frameRate<3}updateLocalStats(t){Array.from(this.localStats.entries()).forEach(n=>{let[i,r]=n;switch(i){case j.LocalVideoTrack:case j.LocalVideoLowTrack:{const s=r,a=$d({},JP),c=t.getStats(),l=t.getLocalMedia(i);if(c){const d=c.videoSend.find(u=>u.ssrc===l?.ssrcs[0].ssrcId);if(d){const u=t.getLocalVideoSize(),h=t.getEncoderConfig(j.LocalVideoTrack);"H264"!==d.codec&&"H265"!==d.codec&&"VP8"!==d.codec&&"VP9"!==d.codec&&"AV1X"!==d.codec&&"AV1"!==d.codec||(a.codecType=d.codec),a.sendBytes=d.bytes,a.sendBitrate=s?8*Math.max(0,a.sendBytes-s.sendBytes):0,d.inputFrame?(a.captureFrameRate=d.inputFrame.frameRate,a.captureResolutionHeight=d.inputFrame.height,a.captureResolutionWidth=d.inputFrame.width):u&&(a.captureResolutionWidth=u.width,a.captureResolutionHeight=u.height),d.sentFrame?(a.sendFrameRate=d.sentFrame.frameRate,a.sendResolutionHeight=d.sentFrame.height,a.sendResolutionWidth=d.sentFrame.width):u&&(a.sendResolutionWidth=u.width,a.sendResolutionHeight=u.height),d.avgEncodeMs&&(a.encodeDelay=d.avgEncodeMs),h&&h.bitrateMax&&(a.targetSendBitrate=1e3*h.bitrateMax),a.sendPackets=d.packets,a.sendPacketsLost=d.packetsLost,a.sendJitterMs=d.jitterMs,a.sendRttMs=d.rttMs,a.totalDuration=s?s.totalDuration+1:1,a.totalFreezeTime=s?s.totalFreezeTime:0,this.isLocalVideoFreeze(d)&&(a.totalFreezeTime+=1),d.scalabilityMode&&this.scalabilityMode!==d.scalabilityMode&&(_.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(d.scalabilityMode)),this.scalabilityMode=d.scalabilityMode)}this.trafficStats&&(a.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var o;this.localStats.set(i,a),(s?.sendResolutionWidth!==a.sendResolutionWidth||s?.sendResolutionHeight!==a.sendResolutionHeight)&&(null===(o=this.onStatsChanged)||void 0===o||o.call(this,"resolution",{width:a.sendResolutionWidth,height:a.sendResolutionHeight})),a&&l&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,l.track,a);break}case j.LocalAudioTrack:{const s=r,a=$d({},ZP),c=t.getStats(),l=t.getLocalMedia(i);if(c){const d=c.audioSend.find(u=>u.ssrc===l?.ssrcs[0].ssrcId);if(d){if("opus"!==d.codec&&"aac"!==d.codec&&"PCMU"!==d.codec&&"PCMA"!==d.codec&&"G722"!==d.codec||(a.codecType=d.codec),d.inputLevel)a.sendVolumeLevel=Math.round(32767*d.inputLevel);else{const u=t.getLocalAudioVolume();u&&(a.sendVolumeLevel=Math.round(32767*u))}a.sendBytes=d.bytes,a.sendPackets=d.packets,a.sendPacketsLost=d.packetsLost,a.sendJitterMs=d.jitterMs,a.sendRttMs=d.rttMs,a.sendBitrate=s?8*Math.max(0,a.sendBytes-s.sendBytes):0}}this.trafficStats&&(a.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(j.LocalAudioTrack,a),a&&l&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,l.track,a);break}}})}updateRemoteStats(t){Array.from(this.remoteStats.entries()).forEach(n=>{var i,r;let[o,{videoStats:s,audioStats:a,videoPcStats:c}]=n;const l=a,d=s,u=c,h=$d({},xq),p=$d({},kq),m=$d({},W2e),{audioTrack:f,videoTrack:g,audioSSRC:E,videoSSRC:b}=t.getRemoteMedia(o);let T;T=t instanceof Lr?t.getStats(!0):t.getStats();const I=null===(i=T)||void 0===i?void 0:i.audioRecv.find(k=>k.ssrc===E),D=null===(r=T)||void 0===r?void 0:r.videoRecv.find(k=>k.ssrc===b),O=this.trafficStats&&this.trafficStats.peer_delay.find(k=>k.peer_uid===o);if(I&&("opus"!==I.codec&&"aac"!==I.codec&&"PCMU"!==I.codec&&"PCMA"!==I.codec&&"G722"!==I.codec||(h.codecType=I.codec),I.outputLevel?h.receiveLevel=Math.round(32767*I.outputLevel):f&&(h.receiveLevel=Math.round(32767*f.getVolumeLevel())),h.receiveBytes=I.bytes,h.receivePackets=I.packets,h.receivePacketsLost=I.packetsLost,h.receivePacketsDiscarded=I.packetsDiscarded,h.packetLossRate=h.receivePacketsLost/(h.receivePackets+h.receivePacketsLost),h.receiveBitrate=l?8*Math.max(0,h.receiveBytes-l.receiveBytes):0,h.totalDuration=l?l.totalDuration+1:1,h.totalFreezeTime=l?l.totalFreezeTime:0,h.freezeRate=h.totalFreezeTime/h.totalDuration,h.receiveDelay=I.jitterBufferMs,h.totalDuration>10&&c_.isRemoteAudioFreeze(f)&&(h.totalFreezeTime+=1)),D){"H264"!==D.codec&&"H265"!==D.codec&&"VP8"!==D.codec&&"VP9"!==D.codec&&"AV1X"!==D.codec&&"AV1"!==D.codec||(p.codecType=D.codec),p.receiveBytes=D.bytes,p.receiveBitrate=d?8*Math.max(0,p.receiveBytes-d.receiveBytes):0,p.decodeFrameRate=D.decodeFrameRate<0?0:D.decodeFrameRate,p.renderFrameRate=D.decodeFrameRate<0?0:D.decodeFrameRate,D.outputFrame&&(p.renderFrameRate=D.outputFrame.frameRate),D.receivedFrame?(p.receiveFrameRate=D.receivedFrame.frameRate,p.receiveResolutionHeight=D.receivedFrame.height,p.receiveResolutionWidth=D.receivedFrame.width):g&&(p.receiveResolutionHeight=g._videoHeight||0,p.receiveResolutionWidth=g._videoWidth||0),void 0!==D.framesRateFirefox&&(p.receiveFrameRate=Math.round(D.framesRateFirefox)),p.receivePackets=D.packets,p.receivePacketsLost=D.packetsLost,p.packetLossRate=p.receivePacketsLost/(p.receivePackets+p.receivePacketsLost),p.totalDuration=d?d.totalDuration+1:1,p.totalFreezeTime=d?d.totalFreezeTime:0,p.receiveDelay=D.jitterBufferMs||0;const k=!!b&&t.getRemoteVideoIsReady(b);g&&k&&c_.isRemoteVideoFreeze(g,D,u)&&(p.totalFreezeTime+=1),p.freezeRate=p.totalFreezeTime/p.totalDuration}O&&(h.end2EndDelay=O.B_ad,p.end2EndDelay=O.B_vd,h.transportDelay=O.B_ed,p.transportDelay=O.B_ed,h.currentPacketLossRate=O.B_ealr4/100,p.currentPacketLossRate=O.B_evlr4/100,m.uplinkNetworkQuality=O.B_punq?O.B_punq:0,m.downlinkNetworkQuality=O.B_pdnq?O.B_pdnq:0),this.remoteStats.set(o,{audioStats:h,videoStats:p,videoPcStats:D,networkStats:m}),f&&this.exceptionMonitor.setRemoteAudioStats(f,h),g&&this.exceptionMonitor.setRemoteVideoStats(g,p)})}}class BX{constructor(){y(this,"destChannelMediaInfos",new Map),y(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(t){VK(t),this.srcChannelMediaInfo=t}addDestChannelInfo(t){VK(t),this.destChannelMediaInfos.set(t.channelName,t)}removeDestChannelInfo(t){US(t),this.destChannelMediaInfos.delete(t)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function jX(e){if(!(e instanceof BX))return new N(S.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=e.getSrcChannelMediaInfo(),n=e.getDestChannelMediaInfo();return t?0===n.size?new N(S.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw():void 0:new N(S.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw()}function HX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function GX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var lt;function WX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function gC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}let l_=(lt=class L_ extends HK{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(t=>t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").filter(t=>{var n;return Y(n=Object.keys(kS)).call(n,t)}))]}constructor(t,n){super(t,n),y(this,"store",void 0),y(this,"peerConnection",void 0),y(this,"remoteSDP",void 0),y(this,"initialOffer",void 0),y(this,"statsFilter",void 0),y(this,"useRTX",!1),y(this,"localCapabilities",void 0),y(this,"localCandidateCount",0),y(this,"allCandidatesReceived",!1),y(this,"establishPromise",void 0),y(this,"mutex",new mi("P2PConnection-mutex")),this.store=n,this.peerConnection=new RTCPeerConnection(L_.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=GM(this.peerConnection,R("STATS_UPDATE_INTERVAL"),void 0,Bt()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}establish(){var t=this;return C(function*(){try{const n=yield t.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!n.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const i=Cl(n.sdp),r=i_(n.sdp,{filterRTX:!t.useRTX,filterVideoFec:R("FILTER_VIDEO_FEC"),filterAudioFec:R("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return t.localCapabilities=r,t.initialOffer=n,gC(gC({},i),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:r},offerSDP:n.sdp})}catch(n){throw new M(S.GET_LOCAL_CONNECTION_PARAMS_FAILED,n.toString())}})()}updateRemoteConnect(){return C(function*(){})()}connect(t){var n=this;return C(function*(){try{if(!n.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");n.remoteSDP=new class{constructor(r){y(this,"sessionDesc",void 0),y(this,"localCapabilities",void 0),y(this,"rtpCapabilities",void 0),y(this,"candidates",void 0),y(this,"iceParameters",void 0),y(this,"dtlsParameters",void 0),y(this,"setup",void 0),y(this,"currentMidIndex",void 0),y(this,"cname",void 0),r=dn(r);const{iceParameters:o,dtlsParameters:s,candidates:a,rtpCapabilities:c,setup:l,localCapabilities:d,sdkCodec:u,cname:h}=r,p=Zn.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE audio video\na=msid-semantic: WMS\na=ice-lite\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:audio\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:video\n");this.rtpCapabilities=c,this.candidates=a,this.iceParameters=o,this.dtlsParameters=s,this.setup=l,this.localCapabilities=d,this.cname=h;for(let m=0;m<p.mediaDescriptions.length;m++){const f=p.mediaDescriptions[m];if(f.attributes.iceUfrag=o.iceUfrag,f.attributes.icePwd=o.icePwd,f.attributes.fingerprints=s.fingerprints,f.attributes.candidates=a,f.attributes.setup=l,"video"===f.media.mediaType){f.media.fmts=c.videoCodecs.map(E=>E.payloadType.toString(10));let g=c.videoCodecs.filter(E=>{var b,T;return null===(b=E.rtpMap)||void 0===b?void 0:Y(T=b.encodingName.toLowerCase()).call(T,u)});0===g.length&&(g=c.videoCodecs),f.attributes.payloads=g,f.attributes.extmaps=c.videoExtensions}"audio"===f.media.mediaType&&(f.media.fmts=c.audioCodecs.map(g=>g.payloadType.toString(10)),f.attributes.payloads=c.audioCodecs,f.attributes.extmaps=c.audioExtensions),p.mediaDescriptions[m]=this.mungMediaDesc(f)}this.sessionDesc=p,this.currentMidIndex=p.mediaDescriptions.length-1}toString(){return Zn.print(this.sessionDesc)}send(r,o,s){const{ssrcs:a,ssrcGroups:c}=Wd(o,this.cname),l=this.sessionDesc.mediaDescriptions.find(h=>r===ie.VIDEO?"video"===h.media.mediaType:"audio"===h.media.mediaType),d=a[0].attributes.label,u=a[0].attributes.mslabel;return l.attributes.ssrcs=l.attributes.ssrcs.concat(a),l.attributes.ssrcGroups=l.attributes.ssrcGroups.concat(c),{id:d,mslabel:u}}batchSend(r){return r.map(o=>{let{kind:s,ssrcMsg:a}=o;return this.send(s,a,void 0)})}stopSending(r){this.sessionDesc.mediaDescriptions.forEach(o=>{const s=[],a=[],c=[];o.attributes.ssrcs.forEach(l=>{Y(r).call(r,l.attributes.label||"")?c.push(l):s.push(l)}),o.attributes.ssrcGroups.forEach(l=>{var d;Y(d=c.map(u=>u.ssrcId)).call(d,l.ssrcIds[0])||a.push(l)}),o.attributes.ssrcs=s,o.attributes.ssrcGroups=a})}mute(r){const o=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===r);if(!o)throw new Error("mediaDescription not found with ".concat(r," in remote SDP when calling RemoteSDP.mute."));o.attributes.direction="inactive"}unmute(r){const o=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===r);if(!o)throw new Error("mediaDescription not found with ".concat(r," in remote SDP when calling RemoteSDP.unmute."));o.attributes.direction="sendonly"}receive(r,o,s){r.forEach((a,c)=>{const l=a._mediaStreamTrack,d=this.sessionDesc.mediaDescriptions.findIndex(h=>h.attributes.mid===l.kind),u=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[d],a);this.sessionDesc.mediaDescriptions[d]=u})}stopReceiving(r){}updateCandidates(r){r===Mr.TCP?this.candidates.forEach(o=>{-1===this.candidates.findIndex(s=>"tcp"===s.transport&&s.connectionAddress===o.connectionAddress&&s.port===o.port)&&this.candidates.push(GX(GX({},o),{},{foundation:"tcpcandidate",priority:Number(o.priority)-1+"",transport:"tcp",port:Number(o.port)+90+""}))}):this.candidates=this.candidates.filter(o=>"tcp"!==o.transport);for(const o of this.sessionDesc.mediaDescriptions)o.attributes.candidates=this.candidates}restartICE(r){r=dn(r),this.iceParameters=r,this.sessionDesc.mediaDescriptions.forEach(o=>{o.attributes.iceUfrag=r.iceUfrag,o.attributes.icePwd=r.icePwd})}predictReceivingMids(r){const o=[];for(let s=0;s<r;s++)o.push((this.currentMidIndex+s+1).toString(10));return o}mungRecvMediaDsec(r,o){const s=dn(r);return Lp(s,o),_M(s,o),s}updateRecvMedia(r,o){const s=this.sessionDesc.mediaDescriptions.findIndex(a=>a.attributes.mid===r);if(-1!==s){const a=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[s],o);this.sessionDesc.mediaDescriptions[s]=a}}bumpMid(r){this.currentMidIndex+=r}updateTrackLabel(r,o,s){const a=this.sessionDesc.mediaDescriptions.find(l=>r===ie.VIDEO?"video"===l.attributes.mid:"audio"===l.attributes.mid);if(a){const l=a.attributes.ssrcs.find(d=>d.attributes.label===o);var c;l&&(l.attributes.label=s,null===(c=l.attributes.msid)||void 0===c||c.replace(o,s))}}mungMediaDesc(r){const o=dn(r);return gM(o),function(s){const a=s.attributes.extmaps.find(c=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===c.extensionName);a&&s.attributes.extmaps.splice(s.attributes.extmaps.indexOf(a),1),s.attributes.payloads.forEach(c=>{const l=c.rtcpFeedbacks.findIndex(d=>"transport-cc"===d.type);-1!==l&&c.rtcpFeedbacks.splice(l,1)})}(o),o}getSSRC(r){for(const o of this.sessionDesc.mediaDescriptions)for(const s of o.attributes.ssrcs)if(s.attributes.label===r)return[s]}}(gC(gC({},t),{},{rtpCapabilities:t.rtpCapabilities.send,localCapabilities:n.localCapabilities,sdkCodec:n.store.codec}));const i=n.remoteSDP.toString();yield n.peerConnection.setLocalDescription(n.initialOffer),yield n.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(i.toString()))}})()}updateRemoteRTPCapabilities(t,n){return C(function*(){throw new M(S.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")})()}getPreMedia(t){}send(t,n){var i=this;return Do(function*(){const r=yield Ne(i.mutex.lock());try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const o=t.map(h=>i.peerConnection.addTrack(h._mediaStreamTrack)),s=yield Ne(i.peerConnection.createOffer()),a=Zn.parse(s.sdp),c=t.map(h=>{const p=h._mediaStreamTrack,m=a.mediaDescriptions.find(f=>f.attributes.mid===p.kind);if(!m)throw new Error("Cannot extract ssrc from mediaDescription.");return function(f,g,E){const b=f.attributes.ssrcs.filter(I=>I.attributes.label===g),T=f.attributes.ssrcGroups;if(0===b.length)throw new Error("Cannot extract ssrc from plan-b SDP.");if(T&&b.length>1){const I=T.find(D=>-1!==D.ssrcIds.indexOf(b[0].ssrcId));return I?[{ssrcId:I.ssrcIds[0],rtx:E?I.ssrcIds[1]:void 0}]:[{ssrcId:b[0].ssrcId}]}return[{ssrcId:b[0].ssrcId}]}(m,p.id,i.useRTX)});let l;try{l=yield c}catch(h){throw o.forEach(p=>{ei()&&p.replaceTrack(null),i.peerConnection.removeTrack(p)}),h}const d=i.mungSendOfferSDP(s.sdp,t);i.remoteSDP.receive(t,n,l);const u=i.remoteSDP.toString();return yield Ne(i.peerConnection.setLocalDescription({type:"offer",sdp:d})),yield Ne(i.applySendEncodings(o,t)),yield Ne(i.peerConnection.setRemoteDescription({type:"answer",sdp:u})),t.map((h,p)=>({localSSRC:c[p],id:h._mediaStreamTrack.id}))}catch(o){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(o.toString()))}finally{r()}})()}stopSending(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const i=n.peerConnection.getSenders().filter(s=>{var a;return-1!==t.indexOf((null===(a=s.track)||void 0===a?void 0:a.id)||"")});if(i.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");i.map(s=>{ei()&&s.replaceTrack(null),n.peerConnection.removeTrack(s)});const r=yield n.peerConnection.createOffer();yield n.peerConnection.setLocalDescription(r),n.remoteSDP.stopReceiving(t);const o=n.remoteSDP.toString();yield n.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(i.toString()))}})()}receive(t,n,i,r){var o=this;return C(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{id:s,mslabel:a}=o.remoteSDP.send(t,n,r),c=new q((u,h)=>{const p=setTimeout(()=>{h(new Error("Cannot receive track, id: ".concat(s)))},1e4),m=f=>{const g=xe();if(("Safari"===g.name&&11===Number(g.version)||Ki())&&f.track.id!==s&&f.streams[0].id===a){var E;const b=f.streams[0].getTracks()[0];return null===(E=o.remoteSDP)||void 0===E||E.updateTrackLabel(t,s,f.track.id),o.peerConnection.removeEventListener("track",m),clearTimeout(p),void u(b)}if(f.track.id===s)return o.peerConnection.removeEventListener("track",m),clearTimeout(p),void u(f.track)};o.peerConnection.addEventListener("track",m)}),l=o.remoteSDP.toString();yield o.peerConnection.setRemoteDescription({type:"offer",sdp:l});const d=yield o.peerConnection.createAnswer();return yield o.peerConnection.setLocalDescription(d),{track:yield c,id:s}}catch(s){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}})()}stopReceiving(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");n.remoteSDP.stopSending(t);const i=n.remoteSDP.toString();yield n.peerConnection.setRemoteDescription({type:"offer",sdp:i});const r=yield n.peerConnection.createAnswer();yield n.peerConnection.setLocalDescription(r)}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}})()}muteRemote(t){return C(function*(){})()}unmuteRemote(t){return C(function*(){})()}muteLocal(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const i=n.peerConnection.getSenders().filter(r=>{var o;return-1!==t.indexOf((null===(o=r.track)||void 0===o?void 0:o.id)||"")});if(i.length!==t.length)throw new Error("sender' length doesn't match mids' length.");i.map(r=>{if(ei()&&r.track)r.track.enabled=!1;else{const o=r.getParameters();o.encodings.forEach(s=>s.active=!1),r.setParameters(o)}})}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(i.toString()))}})()}unmuteLocal(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const i=n.peerConnection.getSenders().filter(s=>{var a;return-1!==t.indexOf((null===(a=s.track)||void 0===a?void 0:a.id)||"")});if(i.length!==t.length)throw new Error("Senders' length doesn't match mids' length.");i.map(function(){var s=C(function*(a){if(ei()&&a.track)a.track.enabled=!0;else{const c=a.getParameters();c.encodings.forEach(l=>l.active=!0),yield a.setParameters(c)}});return function(a){return s.apply(this,arguments)}}());const r=yield n.peerConnection.createOffer();yield n.peerConnection.setLocalDescription(r);const o=n.remoteSDP.toString();yield n.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(i.toString()))}})()}restartICE(t){var n=this;return Do(function*(){const i=yield Ne(n.mutex.lock("From P2PConnection.restartICE"));try{if(!n.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(Fe().supportPCSetConfiguration){const c=n.peerConnection.getConfiguration(),l=t===Mr.RELAY?"relay":"all";c.iceTransportPolicy!==l&&(_.debug("[".concat(n.store.clientId,"] restartICE change iceTransportPolicy from [").concat(c.iceTransportPolicy,"] to [").concat(l,"]")),c.iceTransportPolicy=l,n.peerConnection.setConfiguration(c))}else if(t===Mr.RELAY)return;t!==Mr.RELAY&&n.remoteSDP.updateCandidates(t);const r=yield Ne(n.peerConnection.createOffer({iceRestart:!0}));if(!r.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const o=Cl(r.sdp),{remoteIceParameters:s}=yield o.iceParameters;n.remoteSDP.restartICE(s);const a=n.remoteSDP.toString();yield Ne(n.peerConnection.setLocalDescription(r)),yield Ne(n.peerConnection.setRemoteDescription({type:"answer",sdp:a}))}catch(r){_.warning("[".concat(n.store.clientId,"] restart ICE failed, abort operation"),r)}finally{i()}})()}close(){var t;this.peerConnection.close(),null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}updateEncoderConfig(t,n){var i=this;return C(function*(){try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const r=yield i.peerConnection.createOffer(),o=i.mungSendOfferSDP(r.sdp,[n]);i.remoteSDP.updateRecvMedia(n._mediaStreamTrack.kind,n);const s=i.remoteSDP.toString();yield i.peerConnection.setLocalDescription({type:"offer",sdp:o}),yield i.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(r){throw new M(S.EXCHANGE_SDP_FAILED,r.toString())}})()}updateSendParameters(t,n){var i=this;return C(function*(){const r=i.peerConnection.getSenders().filter(o=>{var s;return(null===(s=o.track)||void 0===s?void 0:s.id)===t});1===r.length&&(yield i.applySendEncodings(r,[n]))})()}setStatsRemoteVideoIsReady(t,n){this.statsFilter.setVideoIsReady2(t,n)}replaceTrack(t,n){var i=this;return C(function*(){const r=i.peerConnection.getSenders().find(o=>{var s;return(null===(s=o.track)||void 0===s?void 0:s.id)===n});r&&(yield r.replaceTrack(t._mediaStreamTrack))})()}createDataChannels(t,n){throw new M(S.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(t){throw new M(S.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;null===(t=this.onICEConnectionStateChange)||void 0===t||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,_.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,_.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},R("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[],sdpSemantics:"plan-b"};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(AS(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...L_.turnServerConfigToIceServers(t.turnServer.servers)),R("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...L_.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(i=>{i.forceturn&&(n.iceTransportPolicy="relay")}))),n}static turnServerConfigToIceServers(t){const n=[];return t.forEach(i=>{i.security?i.tcpport&&n.push({username:i.username,credential:i.password,credentialType:"password",urls:"turns:".concat(i.turnServerURL,":").concat(i.tcpport,"?transport=tcp")}):(i.udpport&&n.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":").concat(i.udpport,"?transport=udp")}),i.tcpport&&n.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":").concat(i.tcpport,"?transport=tcp")}))}),n}updateRtpSenderEncodings(t,n){var i=this;return C(function*(){var r;if(n||(n=i.peerConnection.getSenders().find(d=>{var u;return(null===(u=d.track)||void 0===u?void 0:u.id)===t._mediaStreamTrack.id})),!n)return _.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(!Fe().supportSetRtpSenderParameters)return _.warn("Browser not support set rtp-sender parameters");const o={},s={};if(t instanceof yt)switch(t._optimizationMode){case"motion":o.degradationPreference="maintain-framerate";break;case"detail":o.degradationPreference="maintain-resolution";break;default:o.degradationPreference="balanced"}if(R("DSCP_TYPE")&&fl()){var a;const d=R("DSCP_TYPE");Y(a=["very-low","low","medium","high"]).call(a,d)&&(s.networkPriority=d)}const c=n.getParameters(),l=null===(r=c.encodings)||void 0===r?void 0:r[0];l&&Object.assign(l,s),Object.assign(c,o),_.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(c.encodings))),yield n.setParameters(c)})()}applySendEncodings(t,n){var i=this;return C(function*(){try{if(!Fe().supportSetRtpSenderParameters||t.length!==n.length)return;for(let r=0;r<t.length;r++){const o=t[r],s=n[r];o&&s&&(yield i.updateRtpSenderEncodings(s,o))}}catch{_.debug("[".concat(i.store.clientId,"] Apply RTPSendEncodings failed."))}})()}mungSendOfferSDP(t,n){const i=Zn.parse(t);return n.forEach((r,o)=>{const s=r._mediaStreamTrack,a=i.mediaDescriptions.find(c=>c.attributes.mid===s.kind);a&&Lp(a,r)}),Zn.print(i)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var n;null===(n=this.onFirstAudioReceived)||void 0===n||n.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var n;null===(n=this.onFirstVideoReceived)||void 0===n||n.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var n;null===(n=this.onFirstAudioDecoded)||void 0===n||n.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,n,i)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,t,n,i)},this.statsFilter.onSelectedLocalCandidateChanged=(t,n)=>{var i;null===(i=this.onSelectedLocalCandidateChanged)||void 0===i||i.call(this,t,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,n)=>{var i;null===(i=this.onSelectedRemoteCandidateChanged)||void 0===i||i.call(this,t,n)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}batchReceive(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const i=n.remoteSDP.batchSend(t).map((s,a)=>{let{id:c,mslabel:l}=s;const{kind:d}=t[a];return new q((u,h)=>{const p=setTimeout(()=>{h(new Error("Cannot receive track, id: ".concat(c)))},1e4),m=f=>{const g=xe();if("Safari"===g.name&&11===Number(g.version)&&f.track.id!==c&&f.streams[0].id===l){var E;const b=f.streams[0].getTracks()[0];return null===(E=n.remoteSDP)||void 0===E||E.updateTrackLabel(d,c,f.track.id),n.peerConnection.removeEventListener("track",m),clearTimeout(p),void u({track:b,id:c})}if(f.track.id===c)return n.peerConnection.removeEventListener("track",m),clearTimeout(p),void u({track:f.track,id:c})};n.peerConnection.addEventListener("track",m)})}),r=n.remoteSDP.toString();yield n.peerConnection.setRemoteDescription({type:"offer",sdp:r});const o=yield n.peerConnection.createAnswer();return yield n.peerConnection.setLocalDescription(o),yield q.all(i)}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(i.toString()))}})()}getRemoteSSRC(t){var n=this;return C(function*(){if(!n.remoteSDP)return;const i=n.remoteSDP.getSSRC(t);return i?.[0].ssrcId})()}setConfiguration(t){if(Fe().supportPCSetConfiguration){const n=L_.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}}},Q(lt.prototype,"connect",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"connect"),lt.prototype),Q(lt.prototype,"stopSending",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"stopSending"),lt.prototype),Q(lt.prototype,"receive",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"receive"),lt.prototype),Q(lt.prototype,"stopReceiving",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"stopReceiving"),lt.prototype),Q(lt.prototype,"muteRemote",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"muteRemote"),lt.prototype),Q(lt.prototype,"unmuteRemote",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"unmuteRemote"),lt.prototype),Q(lt.prototype,"muteLocal",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"muteLocal"),lt.prototype),Q(lt.prototype,"unmuteLocal",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"unmuteLocal"),lt.prototype),Q(lt.prototype,"close",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"close"),lt.prototype),Q(lt.prototype,"updateEncoderConfig",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"updateEncoderConfig"),lt.prototype),Q(lt.prototype,"updateSendParameters",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"updateSendParameters"),lt.prototype),Q(lt.prototype,"replaceTrack",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"replaceTrack"),lt.prototype),Q(lt.prototype,"getRemoteSSRC",[Lo],Object.getOwnPropertyDescriptor(lt.prototype,"getRemoteSSRC"),lt.prototype),lt);function Lo(e,t,n){const i=e[t];if("function"!=typeof i)throw new Error("Cannot use mutex on object property.");return n.value=C(function*(){const r=this.mutex,o=yield r.lock("Locking from P2PConnection.".concat(t));try{for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return yield i.apply(this,a)}finally{o()}}),n}function zX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function Rl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}class RFe{get localCapabilities(){return dn(this._localCapabilities)}get rtpCapabilities(){return dn(this._rtpCapabilities)}get candidates(){return dn(this._candidates)}get iceParameters(){return dn(this._iceParameters)}get dtlsParameters(){return dn(this._dtlsParameters)}constructor(t){y(this,"sessionDesc",void 0),y(this,"_localCapabilities",void 0),y(this,"_rtpCapabilities",void 0),y(this,"_candidates",void 0),y(this,"_iceParameters",void 0),y(this,"_dtlsParameters",void 0),y(this,"setup",void 0),y(this,"currentMidIndex",void 0),y(this,"cname",void 0),y(this,"firefoxSsrcMidMap",new Map),t=dn(t);const{iceParameters:n,dtlsParameters:i,candidates:r,rtpCapabilities:o,setup:s,localCapabilities:a,cname:c}=t;this._rtpCapabilities=o,this._candidates=r,this._iceParameters=n,this._dtlsParameters=i,this._localCapabilities=a,this.setup=s,this.cname=c,this.sessionDesc=this.updateRemoteRTPCapabilities(o),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}preloadRemoteMedia(t){const n=this.candidates,i=this.dtlsParameters,r=this.iceParameters,o=this.rtpCapabilities.send;let s=this.sessionDesc.mediaDescriptions.length-1;for(let a=1;a<t;a++){const c=2*a+2e4,l=2*a+4e4,{ssrcs:d,ssrcGroups:u}=Wd([{ssrcId:c}],this.cname),{ssrcs:h,ssrcGroups:p}=Wd([{ssrcId:l,rtx:R("USE_SUB_RTX")?l+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:o.videoCodecs.map(m=>m.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:r.iceUfrag,icePwd:r.icePwd,unrecognized:[],candidates:n,extmaps:o.videoExtensions,fingerprints:i.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:h,ssrcGroups:p,rtcpFeedbackWildcards:[],payloads:o.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++s)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:o.audioCodecs.map(m=>m.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:r.iceUfrag,icePwd:r.icePwd,unrecognized:[],candidates:n,extmaps:o.audioExtensions,fingerprints:i.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:d,ssrcGroups:u,rtcpFeedbackWildcards:[],payloads:o.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++s)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return Zn.print(this.sessionDesc)}send(t,n,i,r){const{ssrcs:o,ssrcGroups:s}=Wd(n,this.cname,R("SYNC_GROUP")?i:void 0),a=this.findPreloadMediaDesc(o);if(a){if(Bt()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,a.attributes.mid),r&&(r.twcc||r.remb)){const c=this.sessionDesc.mediaDescriptions.indexOf(a);return this.sessionDesc.mediaDescriptions[c]=this.mungSendMediaDesc(a,r),{mid:a.attributes.mid,needExchangeSDP:!0}}return{mid:a.attributes.mid,needExchangeSDP:!1}}{const c=this.findAvailableMediaIndex(t,o);let l;return-1===c||1===c&&(ei()||function(){const d=xe();return!(d.name!==Ye.CHROME||!d.osVersion)&&Number(d.version)<=90}())||0===c&&R("USE_SUB_RTX")||nK()?(l=this.createOrRecycleSendMedia(t,o,s,"sendonly",r),this.updateBundleMids()):(l=dn(this.sessionDesc.mediaDescriptions[c]),l.attributes.direction="sendonly",l.attributes.ssrcs=o,l.attributes.ssrcGroups=s,this.sessionDesc.mediaDescriptions[c]=this.mungSendMediaDesc(l,r)),Bt()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,l.attributes.mid),{mid:l.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:t,needExchangeSDP:n}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:t.attributes.mid,needExchangeSDP:n}}batchSend(t){const n=t.map(o=>{let{kind:s,ssrcMsg:a,mslabel:c}=o;return this.send(s,a,c)}),i=[];let r=!1;return n.forEach(o=>{let{mid:s,needExchangeSDP:a}=o;a&&(r=!0),i.push(s)}),{mids:i,needExchangeSDP:r}}stopSending(t){const n=this.sessionDesc.mediaDescriptions.filter(i=>i.attributes.mid&&-1!==t.indexOf(i.attributes.mid));if(n.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");n.forEach(i=>{"0"===i.attributes.mid||Bt()||nK()?i.attributes.ssrcs=[]:(i.attributes.ssrcs=[],i.attributes.direction="inactive",i.media.port="0")}),this.updateBundleMids()}mute(t){const n=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===t);if(!n)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.mute."));n.attributes.direction="inactive"}unmute(t){const n=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===t);if(!n)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.unmute."));n.attributes.direction="sendonly"}muteRemote(t){const n=this.sessionDesc.mediaDescriptions.filter(i=>Y(t).call(t,i.attributes.mid||""));if(n.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");n.forEach(i=>{i.attributes.direction="inactive"})}unmuteRemote(t){const n=this.sessionDesc.mediaDescriptions.filter(i=>Y(t).call(t,i.attributes.mid||""));if(n.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");n.forEach(i=>{i.attributes.direction="recvonly"})}receive(t,n,i,r){t.forEach((o,s)=>{this.createOrRecycleRecvMedia(o,[],"recvonly",n,i,r[s])}),this.updateBundleMids()}stopReceiving(t){const n=this.sessionDesc.mediaDescriptions.filter(i=>-1!==t.indexOf(i.attributes.mid));if(n.length!==t.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");n.forEach(i=>{i.media.port="0",i.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(t){const n=this.sessionDesc||Zn.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=ice-lite\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n");this._rtpCapabilities=t;const i=this.rtpCapabilities.send,r=this.localCapabilities.send;for(const o of n.mediaDescriptions){if(o.attributes.iceUfrag=this._iceParameters.iceUfrag,o.attributes.icePwd=this._iceParameters.icePwd,o.attributes.fingerprints=this._dtlsParameters.fingerprints,o.attributes.candidates=this._candidates,o.attributes.setup=this.setup,"application"===o.media.mediaType&&(o.attributes.sctpPort="5000"),"video"===o.media.mediaType)if(0===i.videoCodecs.length){const s=r.videoCodecs.filter(a=>{var c,l;return null===(c=a.rtpMap)||void 0===c?void 0:Y(l=c.encodingName.toLowerCase()).call(l,"vp8")})||[r.videoCodecs[0]];o.media.fmts=s.map(a=>a.payloadType.toString(10)),o.attributes.payloads=s,o.attributes.extmaps=[]}else if(o.media.fmts=i.videoCodecs.map(s=>s.payloadType.toString(10)),o.attributes.payloads=i.videoCodecs,o.attributes.extmaps=i.videoExtensions,R("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:s,ssrcGroups:a}=Wd([{ssrcId:4e4,rtx:R("USE_SUB_RTX")?40001:void 0}],this.cname);o.attributes.ssrcs=s,o.attributes.ssrcGroups=a}if("audio"===o.media.mediaType)if(0===i.audioCodecs.length){const s=r.audioCodecs.filter(a=>{var c,l;return null===(c=a.rtpMap)||void 0===c?void 0:Y(l=c.encodingName.toLowerCase()).call(l,"opus")})||[r.audioCodecs[0]];o.media.fmts=s.map(a=>a.payloadType.toString(10)),o.attributes.payloads=s,o.attributes.extmaps=[]}else if(o.media.fmts=i.audioCodecs.map(s=>s.payloadType.toString(10)),o.attributes.payloads=i.audioCodecs,o.attributes.extmaps=i.audioExtensions,Fp(o),R("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:s,ssrcGroups:a}=Wd([{ssrcId:2e4}],this.cname);o.attributes.ssrcs=s,o.attributes.ssrcGroups=a}}return this.sessionDesc=n,this.currentMidIndex=n.mediaDescriptions.length-1,this.sessionDesc}updateCandidates(t){const n=this._candidates.filter(i=>"udp"===i.transport);if(t===Mr.TCP){if(0===n.length)return;if(R("TCP_CANDIDATE_ONLY")){const i=this._candidates.filter(r=>"tcp"===r.transport);n.forEach(r=>{-1===i.findIndex(o=>o.connectionAddress===r.connectionAddress)&&i.push(Rl(Rl({},r),{},{foundation:"tcpcandidate",priority:Number(r.priority)-1+"",transport:"tcp",port:Number(r.port)+90+""}))}),this._candidates=i}else{const i=[];n.forEach(r=>{i.push(Rl(Rl({},r),{},{foundation:"tcpcandidate",priority:Number(r.priority)-1+"",transport:"tcp",port:Number(r.port)+90+""}))}),this._candidates=[...n,...i]}}else if(t===Mr.RELAY){if(0!==n.length)return;{const i=this._candidates.filter(r=>"tcp"===r.transport);i.forEach(r=>{n.push(Rl(Rl({},r),{},{foundation:"udpcandidate",priority:Number(r.priority)+1+"",transport:"udp",port:Number(r.port)-90+""}))}),this._candidates=[...n,...i]}}else 0===n.length?(this._candidates.filter(i=>"tcp"===i.transport).forEach(i=>{n.push(Rl(Rl({},i),{},{foundation:"udpcandidate",priority:Number(i.priority)+1+"",transport:"udp",port:Number(i.port)-90+""}))}),this._candidates=n):this._candidates=this._candidates.filter(i=>"tcp"!==i.transport);for(const i of this.sessionDesc.mediaDescriptions)i.attributes.candidates=this.candidates}restartICE(t){t=dn(t),this._iceParameters=t,this.sessionDesc.mediaDescriptions.forEach(n=>{n.attributes.iceUfrag=t.iceUfrag,n.attributes.icePwd=t.icePwd})}predictReceivingMids(t){const n=[];for(let i=0;i<t;i++)n.push((this.currentMidIndex+i+1).toString(10));return n}findAvailableMediaIndex(t,n){return this.sessionDesc.mediaDescriptions.findIndex(i=>{const r=i.media.mediaType===t&&"0"!==i.media.port&&("sendonly"===i.attributes.direction||"sendrecv"===i.attributes.direction)&&0===i.attributes.ssrcs.length;if(Bt()){if(r){const o=this.firefoxSsrcMidMap.get(n[0].ssrcId);return!(o||"0"!==i.attributes.mid&&"1"!==i.attributes.mid)||!(!o||o!==i.attributes.mid)}return!1}return r})}createOrRecycleDataChannel(){for(const i of this.sessionDesc.mediaDescriptions)if("application"===i.media.mediaType)return{mediaDesc:i,needExchangeSDP:!1};this.currentMidIndex+=1;const t="".concat(this.currentMidIndex),n={media:{mediaType:"application",port:"9",protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(t),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(n),{mediaDesc:n,needExchangeSDP:!0}}createOrRecycleRecvMedia(t,n,i,r,o,s){const a=t._mediaStreamTrack.kind,c=this.rtpCapabilities.recv,l=r_(a,c,this.localCapabilities.send,a===ie.VIDEO?r:o),d=a===ie.VIDEO?c.videoExtensions:c.audioExtensions;this.currentMidIndex+=1;const u="".concat(this.currentMidIndex);let h={media:{mediaType:a,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:l.map(m=>m.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:d,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:n,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:l,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(u)}};h=this.mungRecvMediaDsec(h,t,s);const p=this.findFirstClosedMedia(a);if(p){const m=this.sessionDesc.mediaDescriptions.indexOf(p);this.sessionDesc.mediaDescriptions[m]=h}else this.sessionDesc.mediaDescriptions.push(h);return h}updateRemoteCodec(t,n,i){const r=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(h=>h.rtpMap&&h.rtpMap.encodingName.toLowerCase()||"").filter(h=>{var p;return Y(p=Object.keys(kS)).call(p,h)}))],o=new Set(n);if(r.every(h=>o.has(h)))return _.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(n)),!1;const s=this._rtpCapabilities.recv.videoCodecs.filter(h=>n.some(p=>{var m;return Y(m=h.rtpMap&&h.rtpMap.encodingName.toLowerCase()||"").call(m,p)}));if(0===s.length)return _.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(r," codecs: ").concat(n)),!1;const a=[...new Set(s.map(h=>h.rtpMap&&h.rtpMap.encodingName.toLowerCase()||""))];let c;if(_.debug("updateRemoteCodec, from ".concat(r," to ").concat(a)),0===t.length)c=this.sessionDesc.mediaDescriptions.filter(h=>"video"===h.media.mediaType&&"recvonly"===h.attributes.direction);else if(c=this.sessionDesc.mediaDescriptions.filter(h=>h.attributes.mid&&Y(t).call(t,h.attributes.mid)&&"recvonly"===h.attributes.direction),c.length!==t.length)return _.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(t,", codecs: ").concat(n)),!1;if(R("USE_PUB_RTX")||R("USE_SUB_RTX")){const h=EM(s,this.rtpCapabilities.recv.videoCodecs);s.push(...h)}this._rtpCapabilities.recv.videoCodecs=s;const u=r_(ie.VIDEO,this.rtpCapabilities.recv,this.localCapabilities.send,i);return c.forEach(h=>{const p=u.map(m=>m.payloadType.toString(10));_.debug("updateRemoteCodec mid: ".concat(h.attributes.mid,", from ").concat(h.attributes.payloads," to ").concat(u)),h.attributes.payloads=u,h.media.fmts=p}),!0}createOrRecycleSendMedia(t,n,i,r,o){const s=this.rtpCapabilities.send,a=t===ie.VIDEO?s.videoCodecs:s.audioCodecs,c=t===ie.VIDEO?s.videoExtensions:s.audioExtensions;this.currentMidIndex+=1;const l="".concat(this.currentMidIndex);let d={media:{mediaType:t,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:a.map(h=>h.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:n,ssrcGroups:i,rtcpFeedbackWildcards:[],payloads:a,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(l)}};d=this.mungSendMediaDesc(d,o);const u=this.findFirstClosedMedia(t);if(u){const h=this.sessionDesc.mediaDescriptions.indexOf(u);this.sessionDesc.mediaDescriptions[h]=d}else this.sessionDesc.mediaDescriptions.push(d);return d}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(t=>"0"!==t.media.port).map(t=>t.attributes.mid)}mungRecvMediaDsec(t,n,i){const r=dn(t);return gM(r),Lp(r,n),_M(r,n),V$(r),aC(r,i,this.localCapabilities.send),r}mungSendMediaDesc(t,n){const i=dn(t);return aC(i,n,this.localCapabilities.recv),Fp(i),i}updateRecvMedia(t,n){const i=this.sessionDesc.mediaDescriptions.findIndex(r=>r.attributes.mid===t);if(-1!==i){const r=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],n);this.sessionDesc.mediaDescriptions[i]=r}}bumpMid(t){this.currentMidIndex+=t}findFirstClosedMedia(t){return this.sessionDesc.mediaDescriptions.find(n=>Bt()?"0"===n.media.port&&n.media.mediaType===t:"0"===n.media.port)}findPreloadMediaDesc(t){return this.sessionDesc.mediaDescriptions.find(n=>{var i;return(null===(i=n.attributes)||void 0===i||null===(i=i.ssrcs[0])||void 0===i?void 0:i.ssrcId)===t[0].ssrcId})}getSSRC(t){var n;return null===(n=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===t))||void 0===n?void 0:n.attributes.ssrcs}}function qX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function Sc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}let u_=function(e){return e.BANDWIDTH="bandwidth",e.CPU="cpu",e.NONE="none",e.OTHER="other",e}({});var Bp=function(e){return e[e.DOWN=0]="DOWN",e[e.UP=1]="UP",e}(Bp||{});const _C=new Map;function YX(e,t,n,i){let{scale:r}=e;if(0===r&&i===Bp.UP||r>=t.length-1&&i===Bp.DOWN)return e;let o=Sc(Sc({},e),{},{scale:i===Bp.DOWN?++r:--r});switch(n){case"maintain-framerate":o=Sc(Sc({},o),t[r].motion);break;case"maintain-resolution":o=Sc(Sc({},o),t[r].detail);break;case"balanced":o=Sc(Sc({},o),t[r].balanced)}return o}function $X(e,t){if(t){const n={overUse:0,underUse:0,adaptationList:XX(t)};_C.set(e,n)}else _C.delete(e)}function XX(e){const t=Sc({},e),{bitrateMax:n,frameRate:i,scaleResolutionDownBy:r,bitrateMin:o}=t,{MIN_FRAME_RATE:s,MAX_THRESHOLD_FRAMERATE:a,MAX_SCALE:c,BITRATE_MIN_THRESHOLD:l,BITRATE_MAX_THRESHOLD:d,BWE_SCALE_UP_THRESHOLD:u,BWE_SCALE_DOWN_THRESHOLD:h,PERF_SCALE_DOWN_THRESHOLD:p,PERF_SCALE_UP_THRESHOLD:m,BALANCE_BITRATE_FACTOR:f,BALANCE_FRAMERATE_FACTOR:g,BALANCE_RESOLUTION_FACTOR:E,MOTION_RESOLUTION_FACTOR:b,MOTION_BITRATE_FACTOR:T,DETAIL_FRAMERATE_FACTOR:I,DETAIL_BITRATE_FACTOR:D}=lP,O=Math.min(t.frameRate,a),k=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(h,1)*n),bwe_up:n,fps_down:Math.round(Math.pow(p,1)*O),fps_up:i},balanced:{scaleResolutionDownBy:1,frameRate:i,bitrateMax:n,bitrateMin:o},motion:{scaleResolutionDownBy:1,frameRate:i,bitrateMax:n,bitrateMin:o},detail:{scaleResolutionDownBy:1,frameRate:i,bitrateMax:n,bitrateMin:o}}];for(let L=1;L<=c;L++){const V={bwe_up:Math.round(Math.pow(u,L)*n),bwe_down:Math.round(Math.pow(h,L+1)*n),fps_up:Math.round(Math.pow(m,L)*O),fps_down:Math.round(Math.pow(p,L+1)*O)},ee={scaleResolutionDownBy:r/Math.pow(E,L),frameRate:Math.max(Math.round(Math.pow(g,L)*i),s),bitrateMax:Math.max(Math.round(Math.pow(f,L)*n),d),bitrateMin:Math.max(Math.round(Math.pow(f,L)*o),l)},oe={scaleResolutionDownBy:r/Math.pow(b,L),frameRate:i,bitrateMax:Math.max(Math.round(Math.pow(T,L)*n),d),bitrateMin:Math.max(Math.round(Math.pow(T,L)*o),l)},Ie={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(I,L)*i),s),bitrateMax:Math.max(Math.round(Math.pow(D,L)*n),d),bitrateMin:Math.max(Math.round(Math.pow(D,L)*o),l)};k.push({scale:L,threshold:V,balanced:ee,motion:oe,detail:Ie})}return k}function ZX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function qM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ZX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}const vC=new Map;function EC(e,t){const n=vC.get(e);if(n){const{timer:i}=n;window.clearTimeout(i),vC.delete(e)}t.qualityLimitationReason=u_.NONE,$X(e)}var Oe;function JX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function xa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?JX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}let Ws=(Oe=class F_ extends HK{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,n;return null!==(t=null===(n=this.peerConnection.getReceivers()[0])||void 0===n||null===(n=n.transport)||void 0===n?void 0:n.state)&&void 0!==t?t:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(t=>t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").filter(t=>{var n;return Y(n=Object.keys(kS)).call(n,t)}))]}constructor(t,n){super(t,n),y(this,"store",void 0),y(this,"peerConnection",void 0),y(this,"id",gt(5,"connection-")),y(this,"remoteSDP",void 0),y(this,"initialOffer",void 0),y(this,"transportEventReceiver",void 0),y(this,"statsFilter",void 0),y(this,"extension",{useXR:R("USE_XR")}),y(this,"localCapabilities",void 0),y(this,"remoteCodecs",void 0),y(this,"localCandidateCount",0),y(this,"allCandidatesReceived",!1),y(this,"isPreallocation",!1),y(this,"preSSRCMap",new Map),y(this,"dataStreamChannelMap",new Map),y(this,"establishPromise",void 0),y(this,"recoveredDataChannelIds",[]),y(this,"currentDataChannelId",1),y(this,"mutex",new mi("P2PConnection-mutex")),y(this,"qualityLimitationReason",u_.NONE),this.store=n,this.peerConnection=new RTCPeerConnection(F_.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=GM(this.peerConnection,R("STATS_UPDATE_INTERVAL"),void 0,Bt()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}getPreMedia(t){const n=this.preSSRCMap.get(t);if(void 0!==n){const i=this.peerConnection.getTransceivers().find(r=>r.mid===n);if(i)return{transceiver:i,track:i.receiver.track,id:n}}}updateRemoteRTPCapabilities(t,n){var i=this;return C(function*(){if(i.remoteCodecs=n,i.remoteSDP)if(i.remoteSDP.updateRemoteCodec(t,n,i.store.codec)){const r=yield i.peerConnection.createOffer(),o=i.logSDPExchange(r.sdp||"","offer","local","muteLocal");yield i.peerConnection.setLocalDescription(r);const s=i.remoteSDP.toString();o?.(s),yield i.peerConnection.setRemoteDescription({type:"answer",sdp:s})}else _.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.");else _.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(i.localCodecs,", codecs: ").concat(n))})()}establish(){var t=this;return C(function*(){try{t.peerConnection.addTransceiver("video",{direction:"recvonly"}),t.peerConnection.addTransceiver("audio",{direction:"recvonly"});const n=yield t.peerConnection.createOffer();if(!n.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const i=Cl(n.sdp),r=yield j$({filterRTX:!R("USE_PUB_RTX")&&!R("USE_SUB_RTX"),filterVideoFec:R("FILTER_VIDEO_FEC"),filterAudioFec:R("FILTER_AUDIO_FEC"),filterVideoCodec:R("FILTER_VIDEO_CODEC")},t.extension);return t.localCapabilities=cC(r),t.initialOffer=n,xa(xa({},i),{},{rtpCapabilities:r,offerSDP:n.sdp})}catch(n){throw new M(S.GET_LOCAL_CONNECTION_PARAMS_FAILED,n.toString())}})()}connect(t){var n=this;return C(function*(){try{if(!n.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");n.remoteSDP=new RFe(xa(xa({},t),{},{localCapabilities:n.localCapabilities})),t.preallocation&&(n.isPreallocation=!0),Array.isArray(n.remoteCodecs)&&n.remoteCodecs.length>0&&n.remoteSDP.updateRemoteCodec([],n.remoteCodecs,n.store.codec);const i=n.remoteSDP.toString(),r=G$(n.initialOffer.sdp,n.extension),o=n.logSDPExchange(r||"","offer","local","connect");n.store.descriptionStart(),yield n.peerConnection.setLocalDescription({type:"offer",sdp:r}),o?.(i),yield n.peerConnection.setRemoteDescription({type:"answer",sdp:i});const s=n.peerConnection.getTransceivers()[0];if(null!=s&&s.receiver&&n.tryBindTransportEvents(s.receiver),R("PRELOAD_MEDIA_COUNT")>0){n.remoteSDP.preloadRemoteMedia(R("PRELOAD_MEDIA_COUNT"));const c=n.remoteSDP.toString();yield n.peerConnection.setRemoteDescription({type:"offer",sdp:c});const l=yield n.peerConnection.createAnswer();yield n.peerConnection.setLocalDescription(l)}const{preSSRCs:a}=t;if(Array.isArray(a)&&a.length>0){const{mids:c}=n.remoteSDP.batchSend(a.map(l=>({kind:l.kind,ssrcMsg:[{ssrcId:l.ssrcId,rtx:l.rtx}],mslabel:l.mslabel})));c.forEach((l,d)=>{n.preSSRCMap.set(a[d].ssrcId,l)}),yield lC(n.peerConnection,n.remoteSDP,n.extension),_.debug("[".concat(n.store.clientId,"] [P2PConnection] pre-batchReceive exchange SDP."))}}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(i.toString()))}})()}updateRemoteConnect(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");const{rtpCapabilities:i}=t;n.remoteSDP.updateRemoteRTPCapabilities(i),Array.isArray(n.remoteCodecs)&&n.remoteCodecs.length>0&&n.remoteSDP.updateRemoteCodec([],n.remoteCodecs,n.store.codec);const{preSSRCs:r}=t;if(Array.isArray(r)&&r.length>0){const{mids:o}=n.remoteSDP.batchSend(r.map(s=>Object.assign({},{kind:s.kind,ssrcMsg:[{ssrcId:s.ssrcId,rtx:s.rtx}],mslabel:s.mslabel})));o.forEach((s,a)=>{n.preSSRCMap.set(r[a].ssrcId,s)})}yield lC(n.peerConnection,n.remoteSDP,n.extension),_.debug("[P2PConnection] updateRemoteRTPCapabilities by exchanging SDP.")}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(i.toString()))}})()}send(t,n,i){var r=this;return Do(function*(){const o=yield Ne(r.mutex.lock("From P2PConnection.send"));try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const s=[];t.forEach(f=>{const g=r.peerConnection.addTransceiver(f._mediaStreamTrack,{direction:"sendonly"});s.push(g),f._updateRtpTransceiver(g)}),Bt()&&!0===R("SIMULCAST")&&(yield Ne(r.applySimulcastForFirefox(s,t)));const a=yield Ne(r.peerConnection.createOffer()),c=r.remoteSDP.predictReceivingMids(t.length),l=r.mungSendOfferSDP(a.sdp,t,c),d=Zn.parse(l),u=c.map(f=>{const g=d.mediaDescriptions.find(E=>E.attributes.mid===f);if(!g)throw new Error("Cannot extract ssrc from mediaDescription.");return L$(g,R("USE_PUB_RTX"))});let h;try{h=yield u}catch(f){h=[],r.remoteSDP.receive(t,n,i,h);const g=r.remoteSDP.toString();throw yield Ne(r.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield Ne(r.peerConnection.setRemoteDescription({type:"answer",sdp:g})),yield Ne(r.stopSending(c,!0)),f}r.remoteSDP.receive(t,n,i,h);const p=r.remoteSDP.toString(),m=r.logSDPExchange(l,"offer","local","send");return yield Ne(r.peerConnection.setLocalDescription({type:"offer",sdp:l})),yield Ne(r.applySimulcastEncodings(s,t)),yield Ne(r.applySendEncodings(s,t)),m?.(p),yield Ne(r.peerConnection.setRemoteDescription({type:"answer",sdp:p})),s.map((f,g)=>({localSSRC:u[g],id:c[g],transceiver:f}))}catch(s){throw s instanceof M?s:new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(s.toString()))}finally{o()}})()}createDataChannels(t,n){var i=this;return C(function*(){try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let r=i.dataStreamChannelMap.get(t);if(r&&"open"===r.readyState)_.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const s=i.currentDataChannelId<1023?i.currentDataChannelId++:i.recoveredDataChannelIds.shift();if("number"!=typeof s)throw new Error("create DataChannel error, because cannot get dc id");r=i.peerConnection.createDataChannel("datastream-channel",{id:s,negotiated:!0,ordered:!1,maxRetransmits:R("DATASTREAM_MAX_RETRANSMITS")}),r.binaryType="arraybuffer",i.dataStreamChannelMap.set(t,r)}n.forEach(s=>{s._updateOriginDataChannel(r)});const{needExchangeSDP:o}=i.remoteSDP.sendDataChannel();if(o){const s=i.remoteSDP.toString();yield i.peerConnection.setRemoteDescription({type:"offer",sdp:s});const a=yield i.peerConnection.createAnswer();yield i.peerConnection.setLocalDescription(a),_.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else _.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(r){throw r instanceof M?r:new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(r.toString()))}})()}stopDataChannels(t){var n=this;return C(function*(){try{const i=n.dataStreamChannelMap.get(t);return i&&(i.id&&n.recoveredDataChannelIds.push(i.id),i.close()),void n.dataStreamChannelMap.delete(t)}catch(i){throw i instanceof M?i:new M(S.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(i.toString()))}})()}stopSending(t,n){var i=this;return C(function*(){const r=n?void 0:yield i.mutex.lock("From P2PConnection.stopSending");try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const o=i.peerConnection.getTransceivers().filter(l=>-1!==t.indexOf(l.mid));if(o.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");o.map(l=>{var d;EC(i.id+l.mid,i),l.direction="inactive",null===(d=l.stop)||void 0===d||d.call(l)});const s=yield i.peerConnection.createOffer(),a=i.logSDPExchange(s.sdp||"","offer","local","stopSending");yield i.peerConnection.setLocalDescription(s),i.remoteSDP.stopReceiving(t);const c=i.remoteSDP.toString();a?.(c),yield i.peerConnection.setRemoteDescription({type:"answer",sdp:c})}catch(o){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(o.toString()))}finally{r&&r()}})()}receive(t,n,i,r){var o=this;return C(function*(){try{if(!o.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:s,needExchangeSDP:a}=o.remoteSDP.send(t,n,i,r);a&&(yield lC(o.peerConnection,o.remoteSDP,o.extension),_.debug("[".concat(o.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP.")));const c=o.peerConnection.getTransceivers().find(l=>l.mid===s);if(!c)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:c.receiver.track,id:s,transceiver:c}}catch(s){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}})()}batchReceive(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:i,needExchangeSDP:r}=n.remoteSDP.batchSend(t);return r&&(yield lC(n.peerConnection,n.remoteSDP,n.extension),_.debug("[".concat(n.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),i.map(o=>{const s=n.peerConnection.getTransceivers().find(a=>a.mid===o);if(!s)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:s.receiver.track,id:o,transceiver:s}})}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(i.toString()))}})()}stopReceiving(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");t.forEach(s=>{Array.from(n.preSSRCMap.entries()).some(a=>{let[c,l]=a;if(l===s)return n.preSSRCMap.delete(c),!0})}),n.remoteSDP.stopSending(t);const i=n.remoteSDP.toString(),r=n.logSDPExchange(i,"offer","remote","stopReceiving");yield n.peerConnection.setRemoteDescription({type:"offer",sdp:i});const o=yield n.peerConnection.createAnswer();r?.(o.sdp||""),yield n.peerConnection.setLocalDescription(o)}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(i.toString()))}})()}muteRemote(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(t," before remote SDP created."));n.remoteSDP.mute(t);const i=n.remoteSDP.toString(),r=n.logSDPExchange(i,"offer","remote","muteRemote");yield n.peerConnection.setRemoteDescription({type:"offer",sdp:i});const o=yield n.peerConnection.createAnswer();r?.(o.sdp||""),yield n.peerConnection.setLocalDescription(o)}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(i.toString()))}})()}unmuteRemote(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(t," before remote SDP created."));n.remoteSDP.unmute(t);const i=n.remoteSDP.toString(),r=n.logSDPExchange(i,"offer","remote","unmuteRemote");yield n.peerConnection.setRemoteDescription({type:"offer",sdp:i});const o=yield n.peerConnection.createAnswer();r?.(o.sdp||""),yield n.peerConnection.setLocalDescription(o)}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(i.toString()))}})()}muteLocal(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const i=n.peerConnection.getTransceivers().filter(a=>a.mid&&-1!==t.indexOf(a.mid));if(i.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(a=>{a.direction="inactive"});const r=yield n.peerConnection.createOffer(),o=n.logSDPExchange(r.sdp||"","offer","local","muteLocal");yield n.peerConnection.setLocalDescription(r),n.remoteSDP.muteRemote(t);const s=n.remoteSDP.toString();o?.(s),yield n.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(i.toString()))}})()}unmuteLocal(t){var n=this;return C(function*(){try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const i=n.peerConnection.getTransceivers().filter(a=>a.mid&&-1!==t.indexOf(a.mid));if(i.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");i.map(function(){var a=C(function*(c,l){c.direction="sendonly"});return function(c,l){return a.apply(this,arguments)}}());const r=yield n.peerConnection.createOffer(),o=n.logSDPExchange(r.sdp||"","offer","local","unmuteLocal");yield n.peerConnection.setLocalDescription(r),n.remoteSDP.unmuteRemote(t);const s=n.remoteSDP.toString();o?.(s),yield n.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(i){throw new M(S.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(i.toString()))}})()}restartICE(t){var n=this;return Do(function*(){const i=yield Ne(n.mutex.lock("From P2PConnection.restartICE"));try{if(!n.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(Fe().supportPCSetConfiguration){const l=n.peerConnection.getConfiguration(),d=t===Mr.RELAY?"relay":"all";l.iceTransportPolicy!==d&&(_.debug("[".concat(n.store.clientId,"] restartICE change iceTransportPolicy from [").concat(l.iceTransportPolicy,"] to [").concat(d,"]")),l.iceTransportPolicy=d,n.peerConnection.setConfiguration(l))}else if(t===Mr.RELAY)return;n.remoteSDP.updateCandidates(t);const r=yield Ne(n.peerConnection.createOffer({iceRestart:!0}));if(!r.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const o=Cl(r.sdp),{remoteIceParameters:s}=yield o.iceParameters;n.remoteSDP.restartICE(s);const a=n.remoteSDP.toString(),c=n.logSDPExchange(r.sdp||"","offer","local","restartICE");n.store.descriptionStart(),yield Ne(n.peerConnection.setLocalDescription(r)),c?.(a),yield Ne(n.peerConnection.setRemoteDescription({type:"answer",sdp:a}))}catch(r){_.warning("[".concat(n.store.clientId,"] restart ICE failed, abort operation"),r)}finally{i()}})()}close(){var t;this.peerConnection.getTransceivers().forEach(n=>{EC(this.id+n.mid,this)}),this.preSSRCMap.clear(),this.peerConnection.close(),null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return xa(xa({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}updateEncoderConfig(t,n){var i=this;return C(function*(){try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const r=yield i.peerConnection.createOffer(),o=i.mungSendOfferSDP(r.sdp,[n],[t]);i.remoteSDP.updateRecvMedia(t,n);const s=i.remoteSDP.toString(),a=i.logSDPExchange(o,"offer","local","updateEncoderConfig");yield i.peerConnection.setLocalDescription({type:"offer",sdp:o}),a?.(s),yield i.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(r){throw new M(S.EXCHANGE_SDP_FAILED,r.toString())}})()}updateSendParameters(t,n){var i=this;return C(function*(){const r=i.peerConnection.getTransceivers().filter(o=>o.mid===t);1===r.length&&(i.isVP8Simulcast(n)?Bt()||(yield i.applySimulcastEncodings(r,[n])):yield i.applySendEncodings(r,[n]))})()}setStatsRemoteVideoIsReady(t,n){this.statsFilter.setVideoIsReady2(t,n)}replaceTrack(t,n){var i=this;return C(function*(){const r=i.peerConnection.getTransceivers().find(o=>o.mid===n);r&&(yield r.sender.replaceTrack(t._mediaStreamTrack))})()}getSelectedCandidatePair(){var t=this;return C(function*(){const n=t.peerConnection.getReceivers();if(n.length>0&&n[0].transport&&n[0].transport.iceTransport&&n[0].transport.iceTransport.getSelectedCandidatePair&&n[0].transport.iceTransport.getSelectedCandidatePair()){const i=n[0].transport.iceTransport,{local:r,remote:o}=i.getSelectedCandidatePair();return{local:xa(xa({},Ma),{},{candidateType:r.type,protocol:r.protocol,address:r.address,port:r.port}),remote:xa(xa({},Ma),{},{candidateType:o.type,protocol:o.protocol,address:o.address,port:o.port})}}return t.statsFilter.getSelectedCandidatePair()})()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;null===(t=this.onICEConnectionStateChange)||void 0===t||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,_.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,_.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},R("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[]};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(AS(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...F_.turnServerConfigToIceServers(t.turnServer.servers)),R("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...F_.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),R("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(i=>{i.forceturn&&(n.iceTransportPolicy="relay")}))),R("ENABLE_ENCODED_TRANSFORM")&&Fe().supportWebRTCEncodedTransform&&(n.encodedInsertableStreams=!0),n}static turnServerConfigToIceServers(t){const n=[];return t.forEach(i=>{i.security?i.tcpport&&n.push({username:i.username,credential:i.password,credentialType:"password",urls:"turns:".concat(vp(i.turnServerURL),":").concat(i.tcpport,"?transport=tcp")}):(i.udpport&&!R("FORCE_TURN_TCP")&&n.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":").concat(i.udpport,"?transport=udp")}),i.tcpport&&n.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":").concat(i.tcpport,"?transport=tcp")}))}),n}tryBindTransportEvents(t){const n=t.transport;if(n){this.transportEventReceiver=t,n.onstatechange=()=>{var r;null!=n&&n.state&&(null===(r=this.onDTLSTransportStateChange)||void 0===r||r.call(this,n.state))},n.onerror=r=>{var o;null===(o=this.onDTLSTransportError)||void 0===o||o.call(this,"error"in r?r.error:r)};const i=n.iceTransport;i&&(i.onstatechange=()=>{const r=n?.iceTransport.state;var o;r&&(null===(o=this.onICETransportStateChange)||void 0===o||o.call(this,r))},i.getSelectedCandidatePair&&(i.onselectedcandidatepairchange=()=>{if(i.getSelectedCandidatePair()){const{local:r,remote:o}=i.getSelectedCandidatePair();_.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:r.type,protocol:r.protocol}),", remote ").concat(JSON.stringify({candidateType:o.type,protocol:o.protocol,address:o.address,port:o.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}updateRtpSenderEncodings(t,n){var i=this;return C(function*(){var r,o;if(n||(n=i.peerConnection.getSenders().find(E=>E.track===t._mediaStreamTrack)),!n)return _.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(i.isVP8Simulcast(t))return _.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Fe().supportSetRtpSenderParameters)return _.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const s={},a={};switch(t._optimizationMode){case"motion":s.degradationPreference="maintain-framerate";break;case"detail":s.degradationPreference="maintain-resolution";break;case"balanced":s.degradationPreference="balanced"}const c=(E=t._mediaStreamTrack,i.peerConnection.getTransceivers().find(b=>b.sender.track===E||b.receiver.track===E)),l=(e=>{const t=e._encoderConfig;if(!t)return;const{frameRate:n,width:i,height:r}=e.getMediaStreamTrackSettings();let{frameRate:o=n,width:s=i,height:a=r}=t;if(!o||!s||!a)return;s=iP(s),a=iP(a),o=iP(o);const{max:c,min:l}=function(p,m,f){const g=200*Math.pow(f/15,.6)*Math.pow(p*m/640/360,.75);return{min:Math.floor(g),max:Math.floor(4*g)}}(s,a,o),{bitrateMax:d,bitrateMin:u}=t||{};d||_.debug("calculate bitrate: [w: ".concat(s,", h: ").concat(a,", fps: ").concat(o,"] => [brMax: ").concat(d,", brMin: ").concat(u,"]"));const{maxFramerate:h}=R("ENCODER_CONFIG_LIMIT");return h&&"number"==typeof h&&(o=Math.min(o,h)),{frameRate:o,bitrateMax:d||c,bitrateMin:u||l,scaleResolutionDownBy:1,scale:0}})(t);var E;if(function DFe(e){var t;return!(!R("ENABLE_AG_ADAPTATION")||!(e instanceof hM||Y(t=e._hints).call(t,ft.CUSTOM_TRACK))||!R("FORCE_SUPPORT_AG_ADAPTATION")&&!(function(n){const i=xe();if(i.os!==kn.IOS||!i.osVersion)return!1;const r=i.osVersion.split(".");return Number(r[0])>=14}()&&Q7(17,4,!0)||J7(14)&&eK(17,4,!0)))}(t)&&c&&n&&l&&i.getLocalVideoStats&&Y(r=["vp8","vp9"]).call(r,i.store.codec)){var d;const g=s.degradationPreference||(Y(d=t._hints).call(d,ft.CUSTOM_TRACK)?R("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");!function(E,b,T,I,D,O){if(EC(E,T),D(b),"balanced"!==I&&"maintain-framerate"!==I&&"maintain-resolution"!==I)return;let k=-1;$X(E,b);const L=window.setInterval(()=>{const ee=vC.get(E);if(!R("ENABLE_AG_ADAPTATION")||!ee)return EC(E,T),void D(b);const oe=O();if(oe.sendPackets>0&&oe.OutgoingAvailableBandwidth>0){if(-1===k)return void(k=Date.now());if(Date.now()-k<1e3)return;const Ie=oe.sendFrameRate,Ue=oe.OutgoingAvailableBandwidth,[Dt,dt]=function AFe(e,t,n,i,r,o){const s=_C.get(e)||{overUse:0,underUse:0,adaptationList:XX(r)},{adaptationList:a}=s;_C.set(e,s);const{OVERUSE_TIMES_THRESHOLD:c,UNDERUSE_TIMES_THRESHOLD:l}=lP,{scale:d}=i;let u,h;return"number"==typeof t&&t>0&&function(p,m,f,g){if(m>=f.length)return!1;let{threshold:{fps_down:E}}=f[m];return R("FORCE_AG_HIGH_FRAMERATE")&&"maintain-framerate"===g&&(E=f[0].threshold.fps_down),p<E}(t,d,a,o)&&(s.overUse++,h=u_.CPU,s.overUse>c)||"number"==typeof n&&n>0&&function(p,m,f){if(m>=f.length)return!1;const{threshold:{bwe_down:g}}=f[m];return p<g}(n,d,a)&&(s.overUse++,h=u_.BANDWIDTH,s.overUse>c)?(s.overUse=0,s.underUse=0,u=YX(i,a,o,Bp.DOWN),[u,h]):("number"==typeof t&&t>0&&"number"==typeof n&&n>0&&function(p,m,f,g){if(0===m)return;let{threshold:{fps_up:E}}=f[m];return R("FORCE_AG_HIGH_FRAMERATE")&&"maintain-framerate"===g&&(E=f[1].threshold.fps_up),p>E}(t,d,a,o)&&function(p,m,f){if(0===m)return;const{threshold:{bwe_up:g}}=f[m];return p>g}(n,d,a)&&(s.underUse++,s.underUse>l&&(s.overUse=0,s.underUse=0,u=YX(i,a,o,Bp.UP),0===u.scale&&(h=u_.NONE))),[u,h])}(E,Ie,Ue,ee.adaptationConfig,b,I);dt&&(T.qualityLimitationReason=dt),Dt&&ee.adaptationConfig.scale!==Dt.scale&&(_.debug("[".concat(E,"] applyAdaptation: ").concat(T.qualityLimitationReason,"\n           sendFps ").concat(Ie,", bwe ").concat(Ue,", switch from ").concat(ee.adaptationConfig.scale," to ").concat(Dt.scale," ")),ee.adaptationConfig=qM(qM({},ee.adaptationConfig),Dt),D(Dt))}},R("CHECK_LOCAL_STATS_INTERVAL")),V=qM({},b);vC.set(E,{timer:L,adaptationConfig:V,originConfig:b,adaptationFunc:D}),_.debug("[".concat(E,"] start adaptation, originConfig: ").concat(JSON.stringify(b),", degradationPreference: ").concat(I))}(i.id+c.mid,l,i,g,E=>{n&&i.updateAdaptation(n,E)},i.getLocalVideoStats.bind(i))}if(t._encoderConfig){var u;const{bitrateMax:g,frameRate:E,scaleResolutionDownBy:b}=t._encoderConfig;g&&(a.maxBitrate=1e3*g),(Y(u=t._hints).call(u,ft.LOW_STREAM)||t.isUseScaleResolutionDownBy)&&(E&&(a.maxFramerate=xr(E)),b&&b>=1&&(a.scaleResolutionDownBy=b))}const{maxFramerate:h}=R("ENCODER_CONFIG_LIMIT");if(h&&"number"==typeof h&&(a.maxFramerate=a.maxFramerate?Math.min(a.maxFramerate,h):h),R("DSCP_TYPE")&&fl()){var p;const g=R("DSCP_TYPE");Y(p=["very-low","low","medium","high"]).call(p,g)&&(a.networkPriority=g)}const m=n.getParameters(),f=null===(o=m.encodings)||void 0===o?void 0:o[0];var g;Bt()&&!f&&(s.encodings=[a]),f&&Object.assign(f,a),Object.assign(m,s),_.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(m.encodings))),yield n.setParameters(m),yield(g=C(function*(E,b,T){try{var I;if(!Fe().supportSetRtpSenderParameters||!function(V){return"vp9"===V}(E)||!R("ENABLE_SVC"))return;const D={},O={},k=b.getParameters(),L=null===(I=k.encodings)||void 0===I?void 0:I[0];O.scalabilityMode=mM(T),L&&Object.assign(L,O),Object.assign(k,D),yield b.setParameters(k),_.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(k.encodings)))}catch(D){_.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",D)}}),function(E,b,T){return g.apply(this,arguments)})(i.store.codec,n,R("SVC_MODE"))})()}updateAdaptation(t,n){var i=this;return C(function*(){var r,o;if(!t)return _.debug("[updateAdaptation] no rtpSender found");if(!Fe().supportSetRtpSenderParameters)return _.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const s={},{bitrateMax:a,frameRate:c,scaleResolutionDownBy:l}=n;a&&(s.maxBitrate=1e3*a),c&&(s.maxFramerate=xr(c)),l&&l>=1&&Y(r=["vp8","vp9"]).call(r,i.store.codec)&&(s.scaleResolutionDownBy=l);const d=t.getParameters(),u=null===(o=d.encodings)||void 0===o?void 0:o[0];u&&Object.assign(u,s),Object.assign(d,{});try{yield t.setParameters(d),_.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(d.encodings)))}catch(h){!("transport"in t)||t.transport&&"connected"===t.transport.state?"connected"!==i.peerConnectionState?_.debug("[updateAdaptation] peerConnection not connected}"):_.debug("[updateAdaptation] updateRtpSenderEncodings failed",h):_.debug("[updateAdaptation] rtpSender transport not connected}")}})()}applySendEncodings(t,n){var i=this;return C(function*(){try{if(!Fe().supportSetRtpSenderParameters||t.length!==n.length)return;for(let r=0;r<t.length;r++){const o=t[r],s=n[r];s instanceof yt&&!i.isVP8Simulcast(s)&&(yield i.updateRtpSenderEncodings(s,o.sender))}}catch{_.debug("[".concat(i.store.clientId,"] Apply RTPSendEncodings failed."))}})()}mungSendOfferSDP(t,n,i){const r=Zn.parse(t);return n.forEach((o,s)=>{const a=i[s],c=r.mediaDescriptions.find(l=>l.attributes.mid===a);c&&(Lp(c,o),B$(c,o,this.store.codec))}),Zn.print(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var n;null===(n=this.onFirstAudioReceived)||void 0===n||n.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var n;null===(n=this.onFirstVideoReceived)||void 0===n||n.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var n;null===(n=this.onFirstAudioDecoded)||void 0===n||n.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,n,i)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,t,n,i)},this.statsFilter.onSelectedLocalCandidateChanged=(t,n)=>{var i;null===(i=this.onSelectedLocalCandidateChanged)||void 0===i||i.call(this,t,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,n)=>{var i;null===(i=this.onSelectedRemoteCandidateChanged)||void 0===i||i.call(this,t,n)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var n;null===(n=this.onFirstVideoDecodedTimeout)||void 0===n||n.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}applySimulcastForFirefox(t,n){var i=this;return C(function*(){if(t.length===n.length)for(let l=0;l<t.length;l++){var r,o,s,a,c;const d=t[l],u=n[l];if(u instanceof yt&&!Y(r=u._hints).call(r,ft.LOW_STREAM)&&null!==(o=u._encoderConfig)&&void 0!==o&&o.bitrateMax&&(null===(s=u._encoderConfig)||void 0===s?void 0:s.bitrateMax)>200&&null!==(a=u._scalabilityMode)&&void 0!==a&&a.numSpatialLayers&&(null===(c=u._scalabilityMode)||void 0===c?void 0:c.numSpatialLayers)>1&&"vp8"===i.store.codec){const h={},p={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{rid:"m",active:!0,maxBitrate:p.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:p.high}];const m=d.sender.getParameters();yield d.sender.setParameters(Object.assign(m,h))}}})()}applySimulcastEncodings(t,n){var i=this;return C(function*(){if(!Bt()&&t.length===n.length)for(let r=0;r<t.length;r++){const o=n[r];if(o instanceof yt&&i.isVP8Simulcast(o)){const s=t[r],a={},c={high:1e3*(o._encoderConfig.bitrateMax-50),medium:5e4};a.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:c.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:c.medium,scaleResolutionDownBy:4}];const l=s.sender.getParameters();yield s.sender.setParameters(Object.assign(l,a))}}})()}isVP8Simulcast(t){var n,i,r,o,s;return!!(t instanceof yt&&R("SIMULCAST")&&"vp8"===this.store.codec&&!Y(n=t._hints).call(n,ft.LOW_STREAM)&&null!==(i=t._encoderConfig)&&void 0!==i&&i.bitrateMax&&(null===(r=t._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(o=t._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(s=t._scalabilityMode)||void 0===s?void 0:s.numSpatialLayers)>1)}logSDPExchange(t,n,i,r){if(R("SDP_LOGGING"))return _.upload("[".concat(this.store.clientId,"] exchanging ").concat(i," ").concat(n," SDP during P2PConnection.").concat(r,"\n"),t),"offer"===n?o=>{this.logSDPExchange(o,"answer","local"===i?"remote":"local",r)}:void 0}getRemoteSSRC(t){var n=this;return C(function*(){if(!n.remoteSDP)return;const i=n.remoteSDP.getSSRC(t);return i&&0!==i.length?i[0].ssrcId:void 0})()}setConfiguration(t){if(Fe().supportPCSetConfiguration){const n=F_.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}}},Q(Oe.prototype,"updateRemoteRTPCapabilities",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"updateRemoteRTPCapabilities"),Oe.prototype),Q(Oe.prototype,"connect",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"connect"),Oe.prototype),Q(Oe.prototype,"updateRemoteConnect",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"updateRemoteConnect"),Oe.prototype),Q(Oe.prototype,"createDataChannels",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"createDataChannels"),Oe.prototype),Q(Oe.prototype,"receive",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"receive"),Oe.prototype),Q(Oe.prototype,"batchReceive",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"batchReceive"),Oe.prototype),Q(Oe.prototype,"stopReceiving",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"stopReceiving"),Oe.prototype),Q(Oe.prototype,"muteRemote",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"muteRemote"),Oe.prototype),Q(Oe.prototype,"unmuteRemote",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"unmuteRemote"),Oe.prototype),Q(Oe.prototype,"muteLocal",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"muteLocal"),Oe.prototype),Q(Oe.prototype,"unmuteLocal",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"unmuteLocal"),Oe.prototype),Q(Oe.prototype,"close",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"close"),Oe.prototype),Q(Oe.prototype,"updateEncoderConfig",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"updateEncoderConfig"),Oe.prototype),Q(Oe.prototype,"updateSendParameters",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"updateSendParameters"),Oe.prototype),Q(Oe.prototype,"replaceTrack",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"replaceTrack"),Oe.prototype),Q(Oe.prototype,"updateAdaptation",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"updateAdaptation"),Oe.prototype),Q(Oe.prototype,"getRemoteSSRC",[rr],Object.getOwnPropertyDescriptor(Oe.prototype,"getRemoteSSRC"),Oe.prototype),Oe);function rr(e,t,n){const i=e[t];if("function"!=typeof i)throw new Error("Cannot use mutex on object property.");return n.value=C(function*(){const r=this.mutex,o=yield r.lock("From P2PConnection.".concat(t));try{for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return yield i.apply(this,a)}finally{o()}}),n}var be;function QX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function ka(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?QX(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QX(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function eZ(e){var t,n,i,r=2;for(typeof Symbol<"u"&&(n=UN,i=Symbol.iterator);r--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new bC(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function bC(e){function t(n){if(Object(n)!==n)return q.reject(new TypeError(n+" is not an object."));var i=n.done;return q.resolve(n.value).then(function(r){return{value:r,done:i}})}return(bC=function(n){this.s=n,this.n=n.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(n){var i=this.s.return;return void 0===i?q.resolve({value:n,done:!0}):t(i.apply(this.s,arguments))},throw:function(n){var i=this.s.return;return void 0===i?q.reject(n):t(i.apply(this.s,arguments))}},new bC(e)}let yC=(be=class extends xt{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(de.StateChange,t,this._state)}constructor(e,t){var n;super(),n=this,y(this,"isPlanB",void 0),y(this,"store",void 0),y(this,"statsUploader",void 0),y(this,"connection",void 0),y(this,"localTrackMap",new Map),y(this,"remoteUserMap",new Map),y(this,"localDataChannels",[]),y(this,"remoteDataChannelMap",new Map),y(this,"pendingLocalTracks",[]),y(this,"pendingRemoteTracks",[]),y(this,"pendingLocalDataChannels",[]),y(this,"pendingRemoteDataChannels",[]),y(this,"statsCollector",void 0),y(this,"shouldForwardP2PCreation",void 0),y(this,"iceFailedCount",0),y(this,"dtlsFailedCount",0),y(this,"mutex",new mi("P2PChannel-mutex")),y(this,"_state",Xe.Disconnected),y(this,"_pcStatsUploadType",R("NEW_ICE_RESTART")?mc.FIRST_CONNECTION:mc.OLD_FIRST_CONNECTION),y(this,"_isInRestartIce",!1),y(this,"_isStartRestartIce",!1),y(this,"_restartStates",["disconnected","failed"]),y(this,"_restartTimer",void 0),y(this,"_isFirstConnected",!0),y(this,"handleMuteLocalTrack",function(){var i=C(function*(r,o,s){const a=yield n.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!n.connection||n.state!==Xe.Connected)return void s(new M(S.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const c=n.filterTobeMutedTracks(r);if(0===c.length)return void o();const l=c.find(u=>"videoLowTrack"===u[0]);l&&l[1].track._originMediaStreamTrack.stop(),yield n.connection.muteLocal(c.map(u=>{let[,{id:h}]=u;return h}));const d=n.createMuteMessage(c);yield ct(n,de.RequestMuteLocal,d),o()}catch(c){s(c)}finally{a()}});return function(r,o,s){return i.apply(this,arguments)}}()),y(this,"handleUnmuteLocalTrack",function(){var i=C(function*(r,o,s){const a=yield n.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!n.connection||n.state!==Xe.Connected)return void s(new M(S.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const c=n.filterTobeUnmutedTracks(r);if(0===c.length)return void o();const l=c.find(u=>"videoLowTrack"===u[0]);if(l){const u=l[1];if(u.track._originMediaStreamTrack.stop(),!R("DISABLE_DUAL_STREAM_USE_ENCODING")&&Fe().supportDualStreamEncoding){const h=r._mediaStreamTrack.clone();u.track._mediaStreamTrack=h,u.track._originMediaStreamTrack=h}else{const h=WM(r,Wg(n,de.RequestLowStreamParameter));u.track._mediaStreamTrack=h,u.track._originMediaStreamTrack=h}yield new q((h,p)=>{n.handleReplaceTrack(u.track,h,p,!0)})}yield n.connection.unmuteLocal(c.map(u=>{let[,{id:h}]=u;return h}));const d=n.createUnmuteMessage(c);yield ct(n,de.RequestUnmuteLocal,d),o()}catch(c){s(c)}finally{a()}});return function(r,o,s){return i.apply(this,arguments)}}()),y(this,"handleUpdateVideoEncoder",function(){var i=C(function*(r,o,s){const a=yield n.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const c=n.localTrackMap.get(j.LocalVideoTrack);if(!n.connection||!c||c.track!==r||n.state!==Xe.Connected)return void o();const{id:l,track:d}=c;yield n.connection.updateSendParameters(l,d),yield n.connection.updateEncoderConfig(l,d),n.emit(de.UpdateVideoEncoder,d),o()}catch(c){s(c)}finally{a()}});return function(r,o,s){return i.apply(this,arguments)}}()),y(this,"handleUpdateVideoSendParameters",function(){var i=C(function*(r,o,s){const a=yield n.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const c=n.localTrackMap.get(j.LocalVideoTrack);if(!n.connection||!c||c.track!==r||n.state!==Xe.Connected)return void o();const{id:l,track:d}=c;yield n.connection.updateSendParameters(l,d),o()}catch(c){s(c)}finally{a()}});return function(r,o,s){return i.apply(this,arguments)}}()),y(this,"handleReplaceMixingTrack",function(){var i=C(function*(r,o,s,a){if(!n.connection||n.state!==Xe.Connected)return void o();const c=KM([r]);let l;_.debug("[".concat(n.store.clientId,"] [p2pId: ").concat(n.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(c.getTrackId(),"]")),"boolean"==typeof a&&a||(l=yield n.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{yield n.replaceTrack(r,c),o()}catch(u){s(u)}finally{var d;null===(d=l)||void 0===d||d()}});return function(r,o,s,a){return i.apply(this,arguments)}}()),y(this,"handleReplaceTrack",function(){var i=C(function*(r,o,s,a){let c;_.debug("[".concat(n.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(r.getTrackId(),"]")),"boolean"==typeof a&&a||(c=yield n.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var l;const u=Array.from(n.localTrackMap.entries()).find(h=>{let[,{track:p}]=h;return r===p});if(!n.connection||!u||n.state!==Xe.Connected)return void o();if(yield null===(l=n.connection)||void 0===l?void 0:l.replaceTrack(r,u[1].id),n.isPlanB){const h=u[1];h.id=r._mediaStreamTrack.id,n.localTrackMap.set(u[0],h)}if(u[0]===j.LocalVideoTrack&&!R("DISABLE_DUAL_STREAM_USE_ENCODING")&&Fe().supportDualStreamEncoding){const h=n.localTrackMap.get(j.LocalVideoLowTrack);if(h){const p=r._mediaStreamTrack.clone();h.track._originMediaStreamTrack.stop(),h.track._mediaStreamTrack=p,h.track._originMediaStreamTrack=p,yield new q((m,f)=>{n.handleReplaceTrack(h.track,m,f,!0)})}}o()}catch(u){s(u)}finally{var d;null===(d=c)||void 0===d||d()}});return function(r,o,s,a){return i.apply(this,arguments)}}()),y(this,"handleGetRTCStats",i=>{i(this.statsCollector.getRTCStats())}),y(this,"handleGetLocalVideoStats",i=>{i(this.statsCollector.getLocalVideoTrackStats())}),y(this,"handleGetLocalAudioStats",i=>{i(this.statsCollector.getLocalAudioTrackStats())}),y(this,"handleGetRemoteVideoStats",i=>this.statsCollector.getRemoteVideoTrackStats(i.uid)[i.uid]),y(this,"handleGetRemoteAudioStats",i=>this.statsCollector.getRemoteAudioTrackStats(i.uid)[i.uid]),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new IX(this.store),this.bindStatsUploaderEvents(),this.isPlanB=!Fe().supportUnifiedPlan||R("CHROME_FORCE_PLAN_B")&&fl(),this.shouldForwardP2PCreation=R("FORWARD_P2P_CREATION")&&Fe().supportPCSetConfiguration&&ZN(),this.shouldForwardP2PCreation&&(this.connection=this.isPlanB?new l_({},this.store):new Ws({},this.store),this.bindConnectionEvents(this.connection))}startP2PConnection(e){var t=this;return C(function*(){var n;t.state=Xe.New;const i=t.shouldForwardP2PCreation&&"closed"===(null===(n=t.connection)||void 0===n?void 0:n.peerConnectionState);if(t.shouldForwardP2PCreation&&!i||(i&&t.connection&&(_.warning("[".concat(t.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),t.connection.close(),t.unbindConnectionEvents(t.connection)),t.connection=t.isPlanB?new l_(e,t.store):new Ws(e,t.store),t.bindConnectionEvents(t.connection)),!t.connection)throw new M(S.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return t._pcStatsUploadType=R("NEW_ICE_RESTART")?mc.FIRST_CONNECTION:mc.OLD_FIRST_CONNECTION,t._isFirstConnected=!0,t._isInRestartIce=!1,t._isStartRestartIce=!1,t.connection.setConfiguration(e),t.connection.establishPromise})()}connect(e){var t=this;return C(function*(){if(!t.connection)throw new M(S.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");R("ENABLE_PREALLOC_PC")&&t.state===Xe.Connected?yield t.connection.updateRemoteConnect(e):(t.store.peerConnectionStart(),yield t.connection.connect(e),t.statsUploader.startUploadTransportStats(),t.statsUploader.startUploadExtensionUsageStats(),t.state=Xe.Connected)})()}updateRemoteRTPCapabilities(e){const t=Array.from(this.localTrackMap.entries()).filter(r=>{var o;let[s]=r;return Y(o=[j.LocalVideoLowTrack,j.LocalVideoTrack]).call(o,s)}),n=t.map(r=>{let[,{id:o}]=r;return o}),i=t.map(r=>{let[o]=r;return o});if(this.connection instanceof Ws){if(ne.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(i),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(e)}),!Y(e).call(e,this.store.codec)){const r=["vp9","vp8","h264"].find(o=>Y(e).call(e,o));r&&(this.store.codec=r,_.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(r,".")))}this.connection.updateRemoteRTPCapabilities(n,e)}}getEstablishParams(){var e=this;return C(function*(){var t;if(e.connection instanceof Ws&&"closed"!==e.connection.peerConnectionState&&Y(t=[Xe.New,Xe.Connected]).call(t,e.state))return e.connection.establishPromise})()}publishDataChannel(e){var t=this;return C(function*(){if(!t.connection||t.state!==Xe.Connected){if(t.state===Xe.Disconnected)throw new M(S.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return e.forEach(i=>{var r;Y(r=t.pendingLocalDataChannels).call(r,i)||t.pendingLocalDataChannels.push(i)}),[]}const n=t.filterTobePublishedDataChannels(e);return 0===n.length?[]:(n.forEach(i=>{const r=Date.now();t.store.publish(i.id.toString(),"datachannel",r)}),yield t.connection.createDataChannels(t.store.uid,n),n.forEach(i=>{t.localDataChannels.push(i);const r=Date.now();t.store.publish(i.id+"","datachannel",void 0,r)}),e.map(i=>({streamId:i.id,ordered:i.ordered,maxRetransmits:i.maxRetransmits,metadata:i.metadata,channelId:i._originDataChannelId})))})()}publish(e,t,n){var i=this;return Do(function*(){const r=yield Ne(i.mutex.lock("From P2PChannel.publish"));try{if(!i.connection||i.state!==Xe.Connected){if(i.state===Xe.Disconnected)throw new M(S.UNEXPECTED_ERROR,"PeerConnection already disconnected.");i.throwIfTrackTypeNotMatch(e);const s=e.filter(a=>-1===i.pendingLocalTracks.indexOf(a));return void(i.pendingLocalTracks=i.pendingLocalTracks.concat(s))}i.store.pubId=i.store.pubId+1,_i.markPublishStart(i.store.clientId,i.store.pubId);const o=i.filterTobePublishedTracks(e,t,n);if(0===o.length)return void(yield Ne(i.tryToUnmuteAudio(e)));yield*_S(eZ(i.doPublish(i.connection,o)))}finally{r()}})()}doPublish(e,t){var n=this;return Do(function*(){t.forEach(u=>{let{track:h,type:p}=u;const m=Date.now();n.store.publish(h.getTrackId(),p===j.LocalAudioTrack?"audio":"video",m)}),n.bindLocalTrackEvents(t);const i=t.map(u=>{let{track:h}=u;return h}),r=yield Ne(e.send(i,n.store.codec,n.store.audioCodec)),o=(yield Ne(r.next())).value,s=n.createGatewayPublishMessage(t,o);let a;try{a=yield s}catch(u){throw r.throw(u),u?.code===S.WS_ABORT&&t.forEach(h=>{let{track:p}=h;-1===n.pendingLocalTracks.indexOf(p)&&n.pendingLocalTracks.push(p)}),n.unbindLocalTrackEvents(t),u}const c=n.mapPubResToRemoteConfig(s,a,i),l=(yield Ne(r.next(c))).value,d=R("ENABLE_VIDEO_SEI");i.forEach(function(){var u=C(function*(h){const p=h.getRTCRtpTransceiver();var m;p&&d&&(h.trackMediaType===ie.VIDEO?yield function tFe(e,t){return fM.apply(this,arguments)}(p.sender,h):h.trackMediaType===ie.AUDIO&&(yield(m=C(function*(f){if(!Fe().supportWebRTCEncodedTransform)return void _.warning("browser not support audio encoded transform");if(rC.has(f)||!f.track)return;const g={track:f.track};if(pl()){if(!f.createEncodedStreams)return void _.warning("browser not support createEncodedStreams() API");let b=null;try{b=f.createEncodedStreams()}catch(I){return void _.error("create audio-encoded-streams error",I&&I.message)}const T=new TransformStream({transform(I,D){g.controller||(g.controller=D),f.track&&f.track.id!==g.track.id&&(_.debug("audio track changed: ".concat(g.track.id," => ").concat(f.track.id)),g.track.removeEventListener("ended",E),g.track=f.track,g.track.addEventListener("ended",E)),D.enqueue(I)}});b.readable.pipeThrough(T).pipeTo(b.writable)}else if(ei()){if(typeof RTCRtpScriptTransform>"u")return void _.warning("browser not support RTCRtpScriptTransform");const b=iC(),T=new MessageChannel;yield new q(D=>b.onmessage=O=>{"registered"===O.data&&D(void 0)});const I=new RTCRtpScriptTransform(b,{name:"tx",port:T.port2},[T.port2]);f.transform=I,yield new q(D=>b.onmessage=O=>{"started"===O.data&&D(void 0)}),T.port1.onmessage=D=>{var O;D.data.transformed&&f.track&&(null===(O=f.track)||void 0===O?void 0:O.id)!==g.track.id&&(_.debug("audio track changed: ".concat(g.track.id," => ").concat(f.track.id)),g.track.removeEventListener("ended",E),g.track=f.track,g.track.addEventListener("ended",E))},g.worker=b}function E(){if(f.track){if(this.id!==f.track.id)return;f.track.removeEventListener("ended",E)}const b=rC.get(f);if(b){rC.delete(f);try{var T,I;null===(T=b.controller)||void 0===T||T.terminate(),null===(I=b.worker)||void 0===I||I.terminate()}catch(D){_.warning(D&&D.message)}}}rC.set(f,g),f.track.addEventListener("ended",E)}),function(f){return m.apply(this,arguments)})(p.sender)))});return function(h){return u.apply(this,arguments)}}()),t.forEach(u=>{let{type:h}=u;n.statsCollector.addLocalStats(h)}),n.assignLocalTracks(t,l),n.statsUploader.startUploadOutboundStats(),t.forEach(u=>{let{track:h,type:p}=u;const m=Date.now();n.store.publish(h.getTrackId(),p===j.LocalAudioTrack?"audio":"video",void 0,m)})})()}updateVideoStreamParameter(e,t){var n=this;return C(function*(){const i=n.localTrackMap.get(t);if(!i)return;if(!(i.track instanceof yt))return _.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");if(!(n.connection instanceof Ws||n.connection instanceof l_))return _.warn("[updateVideoStreamParameter]: connection is not P2PConnection or P2PConnectionPlanB");const{track:r}=i,o=function(s,a){const c={};return s.height&&s.width&&(c.scaleResolutionDownBy=IP(s,a)),c.maxFramerate=s.framerate?xr(s.framerate):void 0,c.maxBitrate=s.bitrate?1e3*s.bitrate:void 0,c}(e,r);if(r._encoderConfig||(r._encoderConfig={}),t!==j.LocalVideoLowTrack||!R("DISABLE_DUAL_STREAM_USE_ENCODING")&&Fe().supportDualStreamEncoding)null!=o.scaleResolutionDownBy&&(r._encoderConfig.scaleResolutionDownBy=o.scaleResolutionDownBy);else{const s=r._originMediaStreamTrack;if(!s.canvas)return _.warn("[".concat(r.getTrackId(),"] no canvas on track"));!function(a,c){const l=a.canvas;c.width&&(l.width=xr(c.width)),c.height&&(l.height=xr(c.height)),c.framerate&&(l.stopCapture&&l.stopCapture(),l.stopCapture=tM(()=>{!l.startCapture&&l.stopCapture&&l.stopCapture(),l.startCapture&&l.startCapture()},xr(c.framerate)))}(s,e)}null!=o.maxBitrate&&(r._encoderConfig.bitrateMax=o.maxBitrate/1e3),null!=o.maxFramerate&&(r._encoderConfig.frameRate&&"object"==typeof r._encoderConfig.frameRate?r._encoderConfig.frameRate.max=o.maxFramerate:r._encoderConfig.frameRate={max:o.maxFramerate}),_.debug("[".concat(r.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(r._encoderConfig))),yield n.connection.updateRtpSenderEncodings(r)})()}publishLowStream(e){var t=this;return Do(function*(){if(!t.connection||t.state!==Xe.Connected)return;const n=yield Ne(t.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const r=t.localTrackMap.get(j.LocalVideoTrack);if(!r)throw new M(S.UNEXPECTED_ERROR,"Could not find high stream");if(t.localTrackMap.has(j.LocalVideoLowTrack))throw new M(S.UNEXPECTED_ERROR,"[".concat(t.store.clientId,"] Can't publish low stream when stream already publish"));const o=[{track:t.getLowVideoTrack(r.track,e),type:j.LocalVideoLowTrack}];if(yield*_S(eZ(t.doPublish(t.connection,o))),r.track.muted||!r.track.enabled){var i;const s=null===(i=t.localTrackMap.get(j.LocalVideoLowTrack))||void 0===i?void 0:i.id;void 0!==s&&(yield Ne(t.connection.muteLocal([s])))}}finally{n()}})()}republish(){var e=this;return C(function*(){e.pendingLocalTracks.length>0&&(_.debug("[".concat(e.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),yield ni(e,de.RequestRePublish,e.pendingLocalTracks),e.emit(de.MediaReconnectEnd,e.store.uid),e.pendingLocalTracks=[]),e.pendingLocalDataChannels.length>0&&(_.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),yield ni(e,de.RequestRePublishDataChannel,e.pendingLocalDataChannels),e.pendingLocalDataChannels=[])})()}reSubscribe(e){var t=this;return C(function*(){for(let n=t.pendingRemoteTracks.length-1;n>=0;n--){const{user:i,kind:r}=t.pendingRemoteTracks[n];(r!==ie.AUDIO||i._audio_added_&&i._audioSSRC)&&(r!==ie.VIDEO||i._video_added_&&i._videoSSRC)||t.pendingRemoteTracks.splice(n,1)}if(e)yield ni(t,de.RequestReSubscribe,t.pendingRemoteTracks);else for(const{user:n,kind:i}of t.pendingRemoteTracks)yield t.subscribe(n,i,i===ie.VIDEO?n._videoSSRC:n._audioSSRC);t.pendingRemoteTracks.forEach(n=>{let{user:i}=n;t.emit(de.MediaReconnectEnd,i.uid)}),t.pendingRemoteTracks=[]})()}unpublish(e){var t=this;return C(function*(){if(!t.connection||t.state!==Xe.Connected)return void e.forEach(r=>{const o=t.pendingLocalTracks.indexOf(r);-1!==o&&t.pendingLocalTracks.splice(o,1)});const n=t.filterTobeUnpublishedTracks(e);if(0===n.length)return;const i=n.find(r=>"videoLowTrack"===r[0]);return i&&i[1].track.close(),t.doUnpublish(t.connection,n)})()}unpublishDataChannel(e){var t=this;return C(function*(){if(!t.connection||t.state!==Xe.Connected)return void e.forEach(i=>{const r=t.pendingLocalDataChannels.indexOf(i);-1!==r&&t.pendingLocalDataChannels.splice(r,1)});const n=t.filterTobeUnpublishedDataChannels(e);return 0!==n.length?(n.forEach(i=>{const r=t.localDataChannels.indexOf(i);-1!==r&&t.localDataChannels.splice(r,1)}),0===t.localDataChannels.length&&(yield t.connection.stopDataChannels(t.store.uid)),n.map(i=>i.id)):void 0})()}unpublishLowStream(){var e=this;return C(function*(){if(!e.connection||e.state!==Xe.Connected)return;const t=e.localTrackMap.get(j.LocalVideoLowTrack);return t?(t.track.close(),e.doUnpublish(e.connection,[[j.LocalVideoLowTrack,t]])):void 0})()}doUnpublish(e,t){var n=this;return C(function*(){const i=n.createGatewayUnpublishMessage(t);return yield e.stopSending(t.map(r=>{let[,{id:o}]=r;return o})),n.withdrawLocalTracks(t),n.unbindLocalTrackEvents(t.map(r=>{let[o,{track:s}]=r;return{type:o,track:s}})),t.forEach(r=>{let[o]=r;n.statsCollector.removeLocalStats(o)}),0===n.localTrackMap.size&&n.statsUploader.stopUploadOutboundStats(),i})()}subscribeDataChannel(e,t){var n=this;return C(function*(){if(!n.connection||n.state!==Xe.Connected)throw new M(S.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const i=t.filter(r=>{var o;return!(null!==(o=n.remoteDataChannelMap.get(e))&&void 0!==o&&o.get(r.id))});if(0!==i.length)return yield n.connection.createDataChannels(e.uid,i),i.forEach(r=>{var o;n.remoteDataChannelMap.has(e)?null===(o=n.remoteDataChannelMap.get(e))||void 0===o||o.set(r.id,r):n.remoteDataChannelMap.set(e,new Map([[r.id,r]]));const s=n.pendingRemoteDataChannels.findIndex(a=>{let{user:c,id:l}=a;return c.uid===e.uid&&l===r.id});-1!==s&&n.pendingRemoteDataChannels.splice(s,1)}),i.map(r=>r.id)})()}subscribe(e,t,n,i,r){var o=this;return C(function*(){var s;if(!o.connection||o.state!==Xe.Connected)throw new M(S.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(null!==(s=o.remoteUserMap.get(e))&&void 0!==s&&s.has(t))return;let a,c,l;const d=o.connection.getPreMedia(n);if(d)_.debug("[".concat(o.store.clientId,"] [").concat(o.store.p2pId,"] preSSRCMap has ssrcId: ").concat(n,", no need to send sub to gateway.")),l=d.transceiver,a=d.track,c=d.id;else if(r){const p=r.find(f=>{let{stream_type:g}=f;return g===t});if(!p)throw new M(S.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(t," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(t,"."));const m=yield o.connection.receive(t,p.ssrcs,String(e._uintid),p.attributes);o.connection instanceof Ws&&(l=m.transceiver),a=m.track,c=m.id}else{const p=yield o.connection.receive(t,[{ssrcId:n,rtx:i}],String(e._uintid),void 0);o.connection instanceof Ws&&(l=p.transceiver),a=p.track,c=p.id}var p;t===ie.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(a):(e._audioTrack=new kp(a,e.uid,e._uintid,o.store),_.info("[".concat(o.store.clientId,"] [").concat(o.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),l&&e._audioTrack._updateRtpTransceiver(l),o.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(a):(e._videoTrack=new xp(a,e.uid,e._uintid,o.store),_.info("[".concat(o.store.clientId,"] [").concat(o.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),l&&e._videoTrack._updateRtpTransceiver(l),o.bindRemoteTrackEvents(e,e._videoTrack)),R("ENABLE_VIDEO_SEI")&&l&&(t==ie.VIDEO?yield(p=C(function*(m){let f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Fe().supportWebRTCEncodedTransform)return void _.warning("browser not support video encoded transform");if(!m.track)return;if(n_.has(m)){const b=n_.get(m);return void(b&&(b.onSei=f.onSei))}const g={track:m.track,onSei:f.onSei};if(pl()){if(!m.createEncodedStreams)return void _.warning("browser not support createEncodedStreams() API");let b=null;try{b=m.createEncodedStreams()}catch(I){return void _.error("create video-encoded-streams error",I&&I.message)}const T=new TransformStream({transform(I,D){g.controller||(g.controller=D),m.track&&m.track.id!==g.track.id&&(_.debug("video track changed: ".concat(g.track.id," => ").concat(m.track.id)),g.track.removeEventListener("ended",E),g.track=m.track,g.track.addEventListener("ended",E));const O=function(k){const L=new DataView(k.data);let V=0;for(;V+4<k.data.byteLength;){if(0===L.getUint8(V+0)&&0===L.getUint8(V+1)&&0===L.getUint8(V+2)&&1===L.getUint8(V+3)&&6===L.getUint8(V+4)){let ee=V+6,oe=0,Ie=0;for(;255===(Ie=L.getUint8(ee++));)oe+=255;oe+=Ie;const Ue=eFe(k.data,ee,oe);return new Uint8Array(Ue)}V++}return null}(I);O&&g.onSei&&g.onSei(O),D.enqueue(I)}});b.readable.pipeThrough(T).pipeTo(b.writable)}else if(ei()){if(typeof RTCRtpScriptTransform>"u")return void _.warning("browser not support RTCRtpScriptTransform");const b=iC(),T=new MessageChannel;yield new q(D=>b.onmessage=O=>{"registered"===O.data&&D(void 0)});const I=new RTCRtpScriptTransform(b,{name:"rx",port:T.port2},[T.port2]);m.transform=I,yield new q(D=>b.onmessage=O=>{"started"===O.data&&D(void 0)}),T.port1.onmessage=D=>{var O;D.data.transformed&&m.track&&(null===(O=m.track)||void 0===O?void 0:O.id)!==g.track.id?(_.debug("video track changed: ".concat(g.track.id," => ").concat(m.track.id)),g.track.removeEventListener("ended",E),g.track=m.track,g.track.addEventListener("ended",E)):D.data.sei&&g.onSei&&g.onSei(D.data.sei)},g.worker=b}function E(){if(m.track){if(this.id!==m.track.id)return;m.track.removeEventListener("ended",E)}!function(b){const T=n_.get(b);if(T){n_.delete(b);try{var I,D;null===(I=T.controller)||void 0===I||I.terminate(),null===(D=T.worker)||void 0===D||D.terminate()}catch(O){_.warning(O&&O.message)}}}(m)}n_.set(m,g),m.track.addEventListener("ended",E)}),function(m){return p.apply(this,arguments)})(l.receiver,{onSei:p=>{var m;null===(m=e._videoTrack)||void 0===m||m._onSei(p)}}):t==ie.AUDIO&&(yield function(){var p=C(function*(m){if(!Fe().supportWebRTCEncodedTransform)return void _.warning("browser not support audio encoded transform");if(oC.has(m))return;const f={track:m.track};if(pl()){if(!m.createEncodedStreams)return void _.warning("browser not support createEncodedStreams() API");let E=null;try{E=m.createEncodedStreams()}catch(T){return void _.error("create audio-encoded-streams error",T&&T.message)}const b=new TransformStream({transform(T,I){f.controller||(f.controller=I),m.track&&m.track.id!==f.track.id&&(_.debug("audio track changed: ".concat(f.track.id," => ").concat(m.track.id)),f.track.removeEventListener("ended",g),f.track=m.track,f.track.addEventListener("ended",g)),I.enqueue(T)}});E.readable.pipeThrough(b).pipeTo(E.writable)}else if(ei()){if(typeof RTCRtpScriptTransform>"u")return void _.warning("browser not support RTCRtpScriptTransform");const E=iC(),b=new MessageChannel;yield new q(I=>E.onmessage=D=>{"registered"===D.data&&I(void 0)});const T=new RTCRtpScriptTransform(E,{name:"rx",port:b.port2},[b.port2]);m.transform=T,yield new q(I=>E.onmessage=D=>{"started"===D.data&&I(void 0)}),b.port1.onmessage=I=>{var D;I.data.transformed&&m.track&&(null===(D=m.track)||void 0===D?void 0:D.id)!==f.track.id&&(_.debug("audio track changed: ".concat(f.track.id," => ").concat(m.track.id)),f.track.removeEventListener("ended",g),f.track=m.track,f.track.addEventListener("ended",g))},f.worker=E}function g(){m.track.removeEventListener("ended",g),function(E){const b=oC.get(E);if(b){oC.delete(E);try{var T,I;null===(T=b.controller)||void 0===T||T.terminate(),null===(I=b.worker)||void 0===I||I.terminate()}catch(D){_.warning(D&&D.message)}}}(m)}oC.set(m,f),m.track.addEventListener("ended",g)});return function(m){return p.apply(this,arguments)}}()(l.receiver)));const u=o.remoteUserMap.get(e);u?u.set(t,c):o.remoteUserMap.set(e,new Map([[t,c]])),o.statsCollector.addRemoteStats(e.uid),o.statsUploader.startUploadInboundStats();const h=o.pendingRemoteTracks.findIndex(p=>{let{user:m,kind:f}=p;return m.uid===e.uid&&t===f});-1!==h&&(o.pendingRemoteTracks.splice(h,1),o.emit(de.MediaReconnectEnd,e.uid))})()}massSubscribe(e){var t=this;return C(function*(){return t.massSubscribeNoLock(e)})()}massSubscribeNoLock(e){var t=this;return C(function*(){if(!t.connection||t.state!==Xe.Connected)throw new M(S.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");e=e.filter(o=>{var s;let{user:a,mediaType:c}=o;return!(null!==(s=t.remoteUserMap.get(a))&&void 0!==s&&s.has(c))});const n=[],i=new Map;e.forEach(o=>{if(!t.connection)return;const s=t.connection.getPreMedia(o.ssrcId);s?i.set(o.ssrcId,s):n.push(o)});const r=yield t.connection.batchReceive(n.map(o=>{let{user:s,mediaType:a,ssrcId:c,rtxSsrcId:l}=o;return{kind:a,ssrcMsg:[{ssrcId:c,rtx:l}],mslabel:String(s._uintid)}}));n.forEach((o,s)=>{i.set(o.ssrcId,r[s])}),e.forEach(o=>{let{user:s,mediaType:a,ssrcId:c}=o;const l=i.get(c);if(!l)return void _.debug("[".concat(t.store.clientId,"] [").concat(t.store.p2pId,"] cannot find ").concat(s.uid," subscribe data,").concat(a,", ").concat(c));const{track:d,id:u,transceiver:h}=l;a===ie.AUDIO?(s._audioTrack?s._audioTrack._updateOriginMediaStreamTrack(d):(s._audioTrack=new kp(d,s.uid,s._uintid,t.store),_.info("[".concat(t.store.clientId,"] [").concat(t.store.p2pId,"] create remote audio track: ").concat(s._audioTrack.getTrackId()))),h&&s._audioTrack._updateRtpTransceiver(h),t.bindRemoteTrackEvents(s,s._audioTrack)):(s._videoTrack?s._videoTrack._updateOriginMediaStreamTrack(d):(s._videoTrack=new xp(d,s.uid,s._uintid,t.store),_.info("[".concat(t.store.clientId,"] [").concat(t.store.p2pId,"] create remote video track: ").concat(s._videoTrack.getTrackId()))),h&&s._videoTrack._updateRtpTransceiver(h),t.bindRemoteTrackEvents(s,s._videoTrack));const p=t.remoteUserMap.get(s);p?p.set(a,u):t.remoteUserMap.set(s,new Map([[a,u]])),t.statsCollector.addRemoteStats(s.uid),t.statsUploader.startUploadInboundStats();const m=t.pendingRemoteTracks.findIndex(f=>{let{user:g,kind:E}=f;return g.uid===s.uid&&a===E});-1!==m&&(t.pendingRemoteTracks.splice(m,1),t.emit(de.MediaReconnectEnd,s.uid))})})()}unsubscribe(e,t,n){var i=this;return C(function*(){const r=i.pendingRemoteTracks.filter(a=>{let{user:c,kind:l}=a;return void 0!==t?c.uid===e.uid&&t===l:c.uid===e.uid});if(r.forEach(a=>{const c=i.pendingRemoteTracks.indexOf(a);i.pendingRemoteTracks.splice(c,1)}),i.connection&&i.state===Xe.Connected||n||r.forEach(a=>{let{kind:c}=a;var l;if(c===ie.AUDIO)null===(l=e._audioTrack)||void 0===l||l._destroy(),e._audioTrack=void 0;else if(c===ie.VIDEO){var d;null===(d=e._videoTrack)||void 0===d||d._destroy(),e._videoTrack=void 0}}),!i.connection||i.state!==Xe.Connected)return;const o=i.filterTobeUnSubscribedTracks(e,t);if(0===o.length)return;yield i.connection.stopReceiving(o.map(a=>{let[,{id:c}]=a;return c}));const s=i.createUnsubscribeMessage(o);return i.withdrawRemoteTracks(o),0===i.remoteUserMap.size&&i.statsUploader.stopUploadInboundStats(),o.forEach(a=>{let[c,{kind:l}]=a;var d,u;if(l===ie.VIDEO&&c._videoSSRC&&(null===(d=i.connection)||void 0===d||d.setStatsRemoteVideoIsReady(c._videoSSRC,!1)),l===ie.VIDEO)i.unbindRemoteTrackEvents(c._videoTrack),n||(null===(u=c._videoTrack)||void 0===u||u._destroy(),c._videoTrack=void 0);else if(l===ie.AUDIO){var h;i.unbindRemoteTrackEvents(c._audioTrack),!n&&(null===(h=c._audioTrack)||void 0===h||h._destroy(),c._audioTrack=void 0)}}),s})()}unsubscribeDataChannel(e,t){var n=this;return C(function*(){if(t.forEach(o=>{const s=n.pendingRemoteDataChannels.findIndex(a=>a.id===o.id);-1!==s&&n.pendingRemoteDataChannels.splice(s,1)}),!n.connection)return;const i=n.filterTobeUnSubscribedDataChannels(e,t);if(0===i.length)return;t.forEach(o=>{o._close()});const r=n.remoteDataChannelMap.get(e);return i.forEach(o=>{r&&r.delete(o.id)}),r&&0===r.size&&(n.remoteDataChannelMap.delete(e),yield n.connection.stopDataChannels(e.uid)),i.map(o=>o.id)})()}massUnsubscribe(e){var t=this;return C(function*(){return t.massUnsubscribeNoLock(e)})()}massUnsubscribeNoLock(e){var t=this;return C(function*(){let n=[];for(const{user:o,mediaType:s}of e){const a=t.pendingRemoteTracks.filter(c=>{let{user:l,kind:d}=c;return void 0!==s?l.uid===o.uid&&s===d:l.uid===o.uid});a.forEach(c=>{const l=t.pendingRemoteTracks.indexOf(c);t.pendingRemoteTracks.splice(l,1)}),n=n.concat(a)}if(!t.connection||t.state!==Xe.Connected)return void n.forEach(o=>{let{user:s,kind:a}=o;var c;if(a===ie.AUDIO)null===(c=s._audioTrack)||void 0===c||c._destroy(),s._audioTrack=void 0;else if(a===ie.VIDEO){var l;null===(l=s._videoTrack)||void 0===l||l._destroy(),s._videoTrack=void 0}});const i=Ps(e).call(e,(o,s)=>{let{user:a,mediaType:c}=s;const l=t.filterTobeUnSubscribedTracks(a,c);return o.concat(l)},[]);if(0===i.length)return;yield t.connection.stopReceiving(i.map(o=>{let[,{id:s}]=o;return s}));const r=t.createUnsubscribeAllMessage(i);return t.withdrawRemoteTracks(i),0===t.remoteUserMap.size&&t.statsUploader.stopUploadInboundStats(),i.forEach(o=>{let[s,{kind:a}]=o;var c,l;if(a===ie.VIDEO&&s._videoSSRC&&(null===(c=t.connection)||void 0===c||c.setStatsRemoteVideoIsReady(s._videoSSRC,!1)),a===ie.VIDEO)t.unbindRemoteTrackEvents(s._videoTrack),null===(l=s._videoTrack)||void 0===l||l._destroy(),s._videoTrack=void 0;else if(a===ie.AUDIO){var d;t.unbindRemoteTrackEvents(s._audioTrack),null===(d=s._audioTrack)||void 0===d||d._destroy(),s._audioTrack=void 0}}),r})()}isPreSubScribe(e){return!(!this.connection||this.state!==Xe.Connected||!this.connection.getPreMedia(e))}muteRemote(e,t){var n=this;return C(function*(){if(!n.connection)return;const i=n.remoteUserMap.get(e);if(!i)return void _.warning("[".concat(n.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid,"."));if(!i.get(t))return void _.warning("[".concat(n.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const r=t===ie.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==r&&n.connection.setStatsRemoteVideoIsReady(r,!1)})()}unmuteRemote(e,t){var n=this;return C(function*(){return n.unmuteRemoteNoLock(e,t)})()}unmuteRemoteNoLock(e,t){var n=this;return C(function*(){if(!n.connection)return;const i=n.remoteUserMap.get(e);i?i.get(t)||_.warning("[".concat(n.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,".")):_.warning("[".concat(n.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid,"."))})()}getAllTracks(e){const t=this.localTrackMap.get(j.LocalAudioTrack);if(t?.track instanceof wn){const n=t.track;return Array.from(this.localTrackMap.entries()).filter(i=>{let[r]=i;return r!==j.LocalAudioTrack}).filter(i=>{let[r]=i;return!(e&&r===j.LocalVideoLowTrack)}).map(i=>{let[,{track:r}]=i;return r}).concat(n.trackList)}return Array.from(this.localTrackMap.entries()).filter(n=>{let[i]=n;return!(e&&i===j.LocalVideoLowTrack)}).map(n=>{let[,{track:i}]=n;return i})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(e,t,n,i,r){if(e){const s=this.localTrackMap.get(j.LocalAudioTrack),a=this.localTrackMap.get(i?j.LocalVideoLowTrack:j.LocalVideoTrack);ne.publish(this.store.sessionId,{eventElapse:_i.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:s?.track.getTrackLabel(),videoName:a?.track.getTrackLabel(),screenshare:-1!==a?.track._hints.indexOf(ft.SCREEN_TRACK),audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:r})}else{var o;n||(n=[]);const s=n.find(c=>c instanceof Ht),a=i?null===(o=this.localTrackMap.get(j.LocalVideoTrack))||void 0===o?void 0:o.track:n.find(c=>c instanceof yt);ne.publish(this.store.sessionId,{eventElapse:_i.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:s?.getTrackLabel(),videoName:a?.getTrackLabel(),screenshare:-1!==a?._hints.indexOf(ft.SCREEN_TRACK),audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:r})}}reportSubscribeEvent(e,t,n,i){const r=i===ie.VIDEO?n._videoSSRC:n._audioSSRC;r&&ne.subscribe(this.store.sessionId,{succ:e,ec:t,video:i===ie.VIDEO,audio:i===ie.AUDIO,peerid:n.uid,subscribeRequestid:r,p2pid:this.store.p2pId,eventElapse:_i.measureFromSubscribeStart(this.store.clientId,r),preSsrc:this.isPreSubScribe(r)})}reset(){_.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new mi("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.isPlanB?new l_({},this.store):new Ws({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(j.LocalAudioTrack);if(e?.track instanceof wn){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach(n=>{t.removeAudioTrack(n)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=Xe.Disconnected}getStats(){var e;return null===(e=this.connection)||void 0===e?void 0:e.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.connection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(j.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(j.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof yt||t&&t.track instanceof Ht?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}hasRemoteMediaWithLock(e,t){var n=this;return C(function*(){if(!e)return n.remoteUserMap.size>0;const i=n.remoteUserMap.get(e);return!!i&&(!t||i.has(t))})()}getRemoteMedia(e){var t;const n=Array.from(Xr(t=this.remoteUserMap).call(t)).find(i=>i.uid===e);return n?{audioTrack:n.audioTrack,audioSSRC:n._audioSSRC,videoTrack:n.videoTrack,videoSSRC:n._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(n=>{let[i]=n;return{uid:i.uid,level:i.audioTrack?100*i.audioTrack._source.getAccurateVolumeLevel():0}});const t=this.localTrackMap.get(j.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Ig(e).call(e,(n,i)=>n.level-i.level),e}disconnectForReconnect(){var e=this;return C(function*(){e.connection&&(_.debug("[".concat(e.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),e.state=Xe.Reconnecting,R("KEEP_LAST_FRAME")&&0!==e.remoteUserMap.size&&Array.from(e.remoteUserMap.entries()).forEach(t=>{let[n]=t;var i;n._videoTrack&&n._videoTrack._player&&(null===(i=n._videoTrack._player.getVideoElement())||void 0===i||i.pause(),n._videoTrack._player.isKeepLastFrame=!0,n._videoTrack._originMediaStreamTrack.stop())}),e.connection.close(),e.unbindConnectionEvents(e.connection),e.connection=void 0,e.shouldForwardP2PCreation&&(e.connection=e.isPlanB?new l_({},e.store):new Ws({},e.store),e.bindConnectionEvents(e.connection)),0!==e.localTrackMap.size&&(Array.from(e.localTrackMap.entries()).forEach(t=>{var n;let[i,{track:r}]=t;switch(i){case j.LocalVideoTrack:Y(n=r._hints).call(n,ft.LOW_STREAM)?r.close():e.pendingLocalTracks.push(r);break;case j.LocalAudioTrack:r instanceof wn?e.pendingLocalTracks=e.pendingLocalTracks.concat(r.trackList):e.pendingLocalTracks.push(r)}}),e.emit(de.MediaReconnectStart,e.store.uid)),e.unbindLocalTrackEvents(),e.localTrackMap.clear(),0!==e.remoteUserMap.size&&Array.from(e.remoteUserMap.entries()).forEach(t=>{let[n,i]=t;Array.from(Xr(i).call(i)).forEach(r=>{e.setPendingRemoteMedia(n,r)}),e.emit(de.MediaReconnectStart,n.uid)}),e.unbindAllRemoteTrackEvents(),e.remoteUserMap.clear(),0!==e.localDataChannels.length&&(e.localDataChannels.forEach(t=>{e.pendingLocalDataChannels.push(t)}),e.localDataChannels.length=0),0!==e.remoteDataChannelMap.size&&(Array.from(e.remoteDataChannelMap.entries()).forEach(t=>{let[n,i]=t;Array.from(Xr(i).call(i)).forEach(r=>{e.setPendingRemoteDataChannel(n,r)})}),e.remoteDataChannelMap.clear()),e.statsUploader.stopUploadOutboundStats(),e.statsUploader.stopUploadInboundStats(),e.statsUploader.stopUploadTransportStats(),_.debug("[".concat(e.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))})()}hasPendingRemoteDataChannel(e,t){for(const n of this.pendingRemoteDataChannels){const{user:i,id:r}=n;if((e instanceof Il?e.uid:e)===i.uid&&r===t)return!0}return!1}setPendingRemoteDataChannel(e,t){this.hasPendingRemoteDataChannel(e,t)||this.pendingRemoteDataChannels.push({user:e,id:t})}hasPendingRemoteMedia(e,t){for(const n of this.pendingRemoteTracks){const{user:i,kind:r}=n;if((e instanceof Il?e.uid:e)===i.uid&&t===r)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}restartICE(e){var t=this;return Do(function*(){if(!t.connection||t.state!==Xe.Connected)return;const n=yield Ne(t.mutex.lock("From P2PChannel.restartICE"));let i;try{i=yield Ne(t.connection.restartICE(e));const o=yield Ne(i.next());if(o.done)return;const s=o.value,a=yield s;switch(t.reportPCDisconnectedOrFailed(e),e){case Mr.TCP:t._pcStatsUploadType=mc.TCP_RESTART;break;case Mr.RELAY:t._pcStatsUploadType=mc.RELAY_RESTART;break;default:t._pcStatsUploadType=mc.OLD_RESTART}t._isInRestartIce=!0,i.next(a)}catch(o){var r;null===(r=i)||void 0===r||r.throw(o)}finally{n()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),t=this.localTrackMap.get(j.LocalVideoTrack),n=this.localTrackMap.get(j.LocalAudioTrack),i=e.videoSend.find(p=>p.ssrc===t?.ssrcs[0].ssrcId),r=e.audioSend.find(p=>p.ssrc===n?.ssrcs[0].ssrcId);if(!i||!r)return 1;const o=Oo(this,de.NeedSignalRTT),s=i?i.rttMs:void 0,a=r?r.rttMs:void 0,c=s&&a?(s+a)/2:s||a,d=100*e.sendPacketLossRate*.7/50+.3*((c&&o?(c+o)/2:c||o)||0)/1500,u=d<.17?1:d<.36?2:d<.59?3:d<.1?4:5,h=t?.track;if(h&&h._encoderConfig&&-1===h._hints.indexOf(ft.SCREEN_TRACK)){const p=h._encoderConfig.bitrateMax,m=e.bitrate.actualEncoded;if(p&&m){const f=(1e3*p-m)/(1e3*p);return NK[f<.15?0:f<.3?1:f<.45?2:f<.6?3:4][u]}}return u}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach(n=>{let[i]=n;const r=i._audioSSRC,o=i._videoSSRC,s=e.audioRecv.find(m=>m.ssrc===r),a=e.videoRecv.find(m=>m.ssrc===o);if(!s&&!a)return void(t+=1);const c=Oo(this,de.NeedSignalRTT),l=e.rtt,d=(l&&c?(l+c)/2:l||c)||0,u=s?s.jitterMs:void 0,h=e.recvPacketLossRate;let p=.7*h*100/50+.3*d/1500;u&&(p=.6*h*100/50+.2*d/1500+.2*u/400),t+=p<.1?1:p<.17?2:p<.36?3:p<.59?4:5}),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}muteLocalTrack(e){var t=this;return C(function*(){return new q((n,i)=>{t.handleMuteLocalTrack(e,n,i)})})()}replaceTrack(e,t){var n=this;return C(function*(){var i;if(_.debug("[".concat(n.store.clientId,"] P2PChannel replaceTrack from [").concat(e.getTrackId(),"] to [").concat(t.getTrackId(),"]")),!n.connection||n.state!==Xe.Connected)return;const r=Array.from(n.localTrackMap.entries()).find(s=>{let[,{track:a}]=s;return e===a});if(!r)return;const o=r[0];if(e!==t&&(n.unbindLocalTrackEvents([{track:e,type:o}]),n.bindLocalTrackEvents([{track:t,type:o}]),r[1].track=t),yield null===(i=n.connection)||void 0===i?void 0:i.replaceTrack(t,r[1].id),n.isPlanB){const s=r[1];s.id=t._mediaStreamTrack.id,n.localTrackMap.set(o,s)}if(o===j.LocalVideoTrack&&!R("DISABLE_DUAL_STREAM_USE_ENCODING")&&Fe().supportDualStreamEncoding){const s=n.localTrackMap.get(j.LocalVideoLowTrack);if(s){const a=e._mediaStreamTrack.clone();s.track._originMediaStreamTrack.stop(),s.track._mediaStreamTrack=a,s.track._originMediaStreamTrack=a,yield new q((c,l)=>{n.handleReplaceTrack(s.track,c,l,!0)})}}})()}filterTobePublishedTracks(e,t,n){const i=[],r=this.getAllTracks();e=dp(e=e.filter(c=>-1===r.indexOf(c)));let o,s=!1;const a=this.localTrackMap.get(j.LocalAudioTrack);for(const c of e){if(c instanceof yt&&(this.localTrackMap.has(j.LocalVideoTrack)||s?new M(S.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(i.push({track:c,type:j.LocalVideoTrack}),s=!0),t)){const l=this.getLowVideoTrack(c,n);i.push({track:l,type:j.LocalVideoLowTrack})}if(c instanceof Ht)if(a){const l=a.track;if(l instanceof wn)zM([c]),l.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0);else{const d=KM([l,c]);_.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(d.getTrackId(),"]")),this.replaceTrack(l,d)}}else o instanceof wn?(zM([c]),o.addAudioTrack(c)):o=o||!c._useAudioElement&&Fe().webAudioMediaStreamDest&&!c._bypassWebAudio?KM(o?[c,o]:[c]):c}return o&&(_.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(o.getTrackId(),"]")),i.push({track:o,type:j.LocalAudioTrack})),i}filterTobeUnpublishedTracks(e){const t=[],n=this.getAllTracks();e=dp(e=e.filter(i=>-1!==n.indexOf(i)));for(const i of e){if(i instanceof Ht){const r=this.localTrackMap.get(j.LocalAudioTrack);if(!r)continue;r.track instanceof wn?(r.track.removeAudioTrack(i),this.unbindLocalAudioTrackEvents(i),0===r.track.trackList.length&&(t.push([j.LocalAudioTrack,r]),r.track.close())):t.push([j.LocalAudioTrack,r])}if(i instanceof yt){const r=this.localTrackMap.get(j.LocalVideoTrack);if(!r)continue;t.push([j.LocalVideoTrack,r]);const o=this.localTrackMap.get(j.LocalVideoLowTrack);o&&t.push([j.LocalVideoLowTrack,o])}}return t}filterTobePublishedDataChannels(e){return(e=dp(e)).filter(t=>-1===this.localDataChannels.findIndex(n=>n.id===t.id))}filterTobeUnpublishedDataChannels(e){return(e=(e=dp(e)).filter(t=>-1!==this.localDataChannels.indexOf(t))).filter(t=>t._originDataChannel)}bindLocalTrackEvents(e){e.forEach(t=>{let{track:n,type:i}=t;switch(i){case j.LocalVideoTrack:n.addListener(X.GET_STATS,this.handleGetLocalVideoStats),n.addListener(X.GET_RTC_STATS,this.handleGetRTCStats),n.addListener(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.addListener(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.addListener(X.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),n.addListener(X.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),n.addListener(X.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.addListener(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.addListener(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case j.LocalAudioTrack:this.bindLocalAudioTrackEvents(n)}})}bindLocalAudioTrackEvents(e,t){e instanceof wn?e.trackList.forEach(n=>{n.addListener(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.addListener(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.addListener(X.GET_STATS,this.handleGetLocalAudioStats),n.addListener(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.addListener(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(X.GET_STATS,this.handleGetLocalAudioStats),e.addListener(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||(e.addListener(X.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(X.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(t=>{let[n,{track:i}]=t;return{track:i,type:n}})),e.forEach(t=>{let{track:n,type:i}=t;switch(i){case j.LocalVideoTrack:n.off(X.GET_STATS,this.handleGetLocalVideoStats),n.off(X.GET_RTC_STATS,this.handleGetRTCStats),n.off(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(X.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),n.off(X.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),n.off(X.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.off(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case j.LocalAudioTrack:this.unbindLocalAudioTrackEvents(n)}})}unbindLocalAudioTrackEvents(e){e instanceof wn?e.trackList.forEach(t=>{t.off(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(X.GET_STATS,this.handleGetLocalAudioStats),t.off(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(X.GET_STATS,this.handleGetLocalAudioStats),e.off(X.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(X.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(X.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(X.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),e.off(X.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(X.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof xp&&t.addListener(X.GET_STATS,n=>{n(this.handleGetRemoteVideoStats(e))}),t instanceof kp&&t.addListener(X.GET_STATS,n=>{n(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(X.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,n]=e;n.has(ie.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),n.has(ie.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)})}createGatewayPublishMessage(e,t){return e.map((n,i)=>{var r;let o,s,{track:a,type:c}=n;switch(c){case j.LocalAudioTrack:o=$e.Audio,s={dtx:a instanceof nC&&a._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case j.LocalVideoTrack:o=Y(r=a._hints).call(r,ft.SCREEN_TRACK)?$e.Screen:$e.High,s=ka(ka({},XK(a)),{},{codec:this.store.codec,svc_mode:mM()});break;case j.LocalVideoLowTrack:o=$e.Low,s=ka(ka({},XK(a)),{},{codec:this.store.codec,svc_mode:mM()})}return{stream_type:o,attributes:s,ssrcs:t[i]}})}createGatewayUnpublishMessage(e){return e.map(t=>{var n;let i,[r,{track:o,ssrcs:s,id:a}]=t;switch(r){case j.LocalVideoTrack:i=Y(n=o._hints).call(n,ft.SCREEN_TRACK)?$e.Screen:$e.High;break;case j.LocalAudioTrack:i=$e.Audio;break;case j.LocalVideoLowTrack:i=$e.Low}return{stream_type:i,ssrcs:s,mid:a}})}assignLocalTracks(e,t){e.forEach((n,i)=>{let{track:r,type:o}=n;this.localTrackMap.set(o,{track:r,id:t[i].id,ssrcs:t[i].localSSRC})})}withdrawLocalTracks(e){e.forEach(t=>{let[n]=t;this.localTrackMap.delete(n)})}bindConnectionEvents(e){var t=this;e.onConnectionStateChange=function(){var n=C(function*(i){if(_.info("[".concat(t.store.clientId,"] [p2pId: ").concat(t.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(i,")")),t.emit(de.PeerConnectionStateChange,i),"connected"!==i||t.store.keyMetrics.peerConnectionEnd||t.store.peerConnectionEnd(),"connected"===i&&(t._restartTimer&&(clearTimeout(t._restartTimer),t._restartTimer=void 0),(t._isFirstConnected||t._isInRestartIce)&&t.reportPCStats(Date.now(),!0,t._pcStatsUploadType),t._isInRestartIce=!1,t._isFirstConnected=!1,t._isStartRestartIce=!1),R("NEW_ICE_RESTART")){var r;if(Y(r=t._restartStates).call(r,i)){if(t._isStartRestartIce)return;t._isStartRestartIce=!0;const o=c=>{("disconnected"===e.iceConnectionState||"checking"===e.iceConnectionState||"failed"===e.iceConnectionState)&&(_.debug("[".concat(t.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(c)),"CONNECTED"===Oo(t,de.QueryClientConnectionState)&&t.emit(de.RequestRestartICE,c))},s=()=>{"disconnected"!==e.iceConnectionState&&"checking"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||(t.reportPCStats(Date.now(),!1,t._pcStatsUploadType),_.debug("[".concat(t.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>t.emit(de.P2PLost),0),t.iceFailedCount+=1,t.requestReconnect())},a=R("ICE_RESTART_INTERVAL");return void(t._restartTimer=window.setTimeout(()=>{if(R("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&Fe().supportPCSetConfiguration)o(Mr.RELAY),t._restartTimer=window.setTimeout(s,a);else if(Bt())o(Mr.UDP),t._restartTimer=window.setTimeout(s,4e3);else{if(o(Mr.TCP),Fe().supportPCSetConfiguration)return void(t._restartTimer=window.setTimeout(()=>{o(Mr.RELAY),t._restartTimer=window.setTimeout(s,a)},a));t._restartTimer=window.setTimeout(s,a)}},800))}}else{if("disconnected"===i&&"disconnected"===e.iceConnectionState)return setTimeout(()=>{"disconnected"===e.iceConnectionState&&R("ICE_RESTART")&&"CONNECTED"===Oo(t,de.QueryClientConnectionState)&&t.emit(de.RequestRestartICE)},800),void setTimeout(()=>{"disconnected"===e.peerConnectionState&&(_.debug("[".concat(t.store.clientId,"] [p2pId: ").concat(t.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),t.reportPCStats(Date.now(),!1,t._pcStatsUploadType),t._isInRestartIce=!1,setTimeout(()=>t.emit(de.P2PLost),0),t.iceFailedCount+=1,t.requestReconnect())},4e3);"failed"===i&&(_.debug("[".concat(t.store.clientId,"] [p2pId: ").concat(t.store.p2pId,"]: P2PConnection state failed, force reconnect")),t.reportPCDisconnectedOrFailed(),setTimeout(()=>t.emit(de.P2PLost),0),t.iceFailedCount+=1,yield t.requestReconnect())}});return function(i){return n.apply(this,arguments)}}(),e.onICEConnectionStateChange=n=>{"connected"!==n||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(n,")")),ne.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:n,tag:jt.TRACER}).onSuccess(),this.emit(de.IceConnectionStateChange,n)},e.onICETransportStateChange=n=>{_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(n,")"))},e.onDTLSTransportStateChange=n=>{_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(n,")"))},e.onDTLSTransportError=n=>{_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(n,")"))},e.onFirstAudioDecoded=n=>{var i;const r=Array.from(Xr(i=this.remoteUserMap).call(i)).find(s=>s._audioSSRC===n);var o;r&&(this.store.subscribe(r.uid,"audio",void 0,void 0,void 0,Date.now()),null===(o=r.audioTrack)||void 0===o||o.emit(Dp.FIRST_FRAME_DECODED),ne.firstRemoteFrame(this.store.sessionId,Yn.FIRST_AUDIO_DECODE,kt.FIRST_AUDIO_DECODE,{peer:r._uintid,subscribeElapse:_i.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=n=>{var i;const r=Array.from(Xr(i=this.remoteUserMap).call(i)).find(o=>o._audioSSRC===n);r&&ne.firstRemoteFrame(this.store.sessionId,Yn.FIRST_AUDIO_RECEIVED,kt.FIRST_AUDIO_RECEIVED,{peer:r._uintid,subscribeElapse:_i.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(n,i,r)=>{this.reportVideoFirstFrameDecoded(n,i,r)},e.onFirstVideoReceived=n=>{var i;const r=Array.from(Xr(i=this.remoteUserMap).call(i)).find(o=>o._videoSSRC===n);r&&ne.firstRemoteFrame(this.store.sessionId,Yn.FIRST_VIDEO_RECEIVED,kt.FIRST_VIDEO_RECEIVED,{peer:r._uintid,subscribeElapse:_i.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(n,i)=>{const r="relay"===n.candidateType;"unknown"!==i.candidateType&&r===("relay"===i.candidateType)||this.emit(de.ConnectionTypeChange,r),_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(bl(i))," -> ").concat(JSON.stringify(bl(n)),")"))},e.onSelectedRemoteCandidateChanged=(n,i)=>{_.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(bl(i))," -> ").concat(JSON.stringify(bl(n)),")"))},e.onFirstVideoDecodedTimeout=n=>{this.reportVideoFirstFrameDecoded(n,void 0,void 0,!0)},e.getLocalVideoStats=()=>{const n=this.statsCollector.getLocalVideoTrackStats(),i=this.statsCollector.getRTCStats();return ka(ka({},n),i)}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.getLocalVideoStats=void 0}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const n=this.localTrackMap.get(j.LocalAudioTrack);if(e instanceof Ht&&n?.track instanceof wn)return n.track.isActive||t.push([j.LocalAudioTrack,n]),t;const i=Array.from(this.localTrackMap.entries()).find(r=>{let[,{track:o}]=r;return e===o});if(i&&(t.push(i),i[0]===j.LocalVideoTrack)){const r=this.localTrackMap.get(j.LocalVideoLowTrack);r&&t.push([j.LocalVideoLowTrack,r])}return t}filterTobeUnmutedTracks(e){const t=[],n=this.localTrackMap.get(j.LocalAudioTrack);if(e instanceof Ht&&n?.track instanceof wn)return n.track.isActive&&t.push([j.LocalAudioTrack,n]),t;const i=Array.from(this.localTrackMap.entries()).find(r=>{let[,{track:o}]=r;return e===o});if(i)if(i[0]===j.LocalVideoTrack){t.push(i);const r=this.localTrackMap.get(j.LocalVideoLowTrack);r&&t.push([j.LocalVideoLowTrack,r])}else t.push(i);return t}createMuteMessage(e){return e.map(t=>{var n;let i,[r,{track:o,ssrcs:s,id:a}]=t;switch(r){case j.LocalAudioTrack:i=$e.Audio;break;case j.LocalVideoTrack:i=Y(n=o._hints).call(n,ft.SCREEN_TRACK)?$e.Screen:$e.High;break;case j.LocalVideoLowTrack:i=$e.Low}return{stream_type:i,ssrcs:s,mid:a}})}createUnmuteMessage(e){return e.map(t=>{var n;let i,[r,{track:o,ssrcs:s,id:a}]=t;switch(r){case j.LocalAudioTrack:i=$e.Audio;break;case j.LocalVideoTrack:i=Y(n=o._hints).call(n,ft.SCREEN_TRACK)?$e.Screen:$e.High;break;case j.LocalVideoLowTrack:i=$e.Low}return{stream_type:i,ssrcs:s,mid:a}})}filterTobeUnSubscribedTracks(e,t){const n=[],i=this.remoteUserMap.get(e);if(!i)return n;if(t){const r=i.get(t);if(!r)return n;n.push([e,{kind:t,id:r}])}else Array.from(i.entries()).forEach(r=>{let[o,s]=r;n.push([e,{kind:o,id:s}])});return n}filterTobeUnSubscribedDataChannels(e,t){const n=[];return t.forEach(i=>{var r;null!==(r=this.remoteDataChannelMap.get(e))&&void 0!==r&&r.has(i.id)&&n.push(i)}),n}createUnsubscribeMessage(e){const t=[];return e.forEach(n=>{let[i,{kind:r}]=n;switch(r){case ie.VIDEO:return void(i._videoSSRC&&t.push({stream_type:ie.VIDEO,ssrcId:i._videoSSRC}));case ie.AUDIO:return void(i._audioSSRC&&t.push({stream_type:ie.AUDIO,ssrcId:i._audioSSRC}))}}),t}createUnsubscribeAllMessage(e){const t=new Map;return e.forEach(n=>{let[i,{kind:r}]=n;if(t.has(i)){let o=t.get(i);o|=r===ie.VIDEO?Ln.Video:Ln.Audio,t.set(i,o)}else t.set(i,r===ie.VIDEO?Ln.Video:Ln.Audio)}),{users:Array.from(t.entries()).map(n=>{let[i,r]=n;return{stream_id:i.uid,stream_type:r}})}}withdrawRemoteTracks(e){e.forEach(t=>{let[n,{kind:i}]=t;const r=this.remoteUserMap.get(n);r&&(r.delete(i),0===Array.from(r.entries()).length&&this.remoteUserMap.delete(n))})}updateBitrateLimit(e){var t=this;return C(function*(){const n=t.localTrackMap.get(j.LocalVideoTrack),i=t.localTrackMap.get(j.LocalVideoLowTrack);n&&(yield n.track.setBitrateLimit(e.uplink)),i&&e.low_stream_uplink&&(yield i.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}))})()}isP2PDisconnected(){return!this.connection||"connected"!==this.connection.peerConnectionState}mapPubResToRemoteConfig(e,t,n){return e.map((i,r)=>{var o;let{stream_type:s}=i;const a=null===(o=t.find(c=>{let{stream_type:l}=c;return s===l}))||void 0===o?void 0:o.attributes;if(a&&R("DISABLE_SCREEN_SHARE_REMB")){const c=n[r]._hints;(Y(c).call(c,ft.SCREEN_TRACK)||Y(c).call(c,ft.SCREEN_LOW_TRACK))&&(a.remb=!1,_.debug("disable remb for screen share, hints:",c))}return a})}tryToUnmuteAudio(e){var t=this;return C(function*(){for(let i=0;i<e.length;i++)if(e[i]instanceof Ht){var n;const r=t.filterTobeUnmutedTracks(e[i]);if(0===r.length)continue;yield null===(n=t.connection)||void 0===n?void 0:n.unmuteLocal(r.map(s=>{let[,{id:a}]=s;return a}));const o=t.createUnmuteMessage(r);return void(yield ct(t,de.RequestUnmuteLocal,o))}})()}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.connection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(de.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(de.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}requestReconnect(){var e=this;return C(function*(){e.dtlsFailedCount+=1,yield qn(rP(e.dtlsFailedCount,vn)),e.emit(de.RequestReconnect)})()}reconnectP2P(){var e=this;return C(function*(){const t=Array.from(e.localTrackMap.entries()),n=e.createGatewayUnpublishMessage(t);Array.from(e.remoteUserMap.entries()),n.length>0&&(yield ni(e,de.RequestUnpublishForReconnectPC,n)),e.disconnectForReconnect(),e.emit(de.RequestReconnectPC)})()}canPublishLowStream(){return this.localTrackMap.has(j.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof yt)}throwIfTrackTypeNotMatch(e){if(e.filter(t=>t instanceof yt).length>1)throw new M(S.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(t=>t instanceof Ht).length>1&&(e.some(t=>t instanceof Ht&&t._bypassWebAudio)||!Fe().webAudioMediaStreamDest))throw new M(S.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof yt&&this.pendingLocalTracks.some(n=>n instanceof yt))throw new M(S.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof Ht&&this.pendingLocalTracks.some(n=>n instanceof Ht)&&(!Fe().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some(n=>n instanceof Ht&&n._bypassWebAudio)))throw new M(S.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){var n;const i=!R("DISABLE_DUAL_STREAM_USE_ENCODING")&&Fe().supportDualStreamEncoding,r=ka(ka({},{width:160,height:120,framerate:15,bitrate:50}),t);let o;o=i?e._mediaStreamTrack.clone():WM(e,r);const s=gt(8,"track-low-"),a=new yt(o,ka(ka({},i&&{scaleResolutionDownBy:IP(r,e)}),{},{frameRate:r.framerate,bitrateMax:r.bitrate,bitrateMin:r.bitrate}),void 0,void 0,s);return a.on(Bd.TRANSCEIVER_UPDATED,c=>{e._updateRtpTransceiver(c,Rp.LOW_STREAM)}),a._hints.push(ft.LOW_STREAM),Y(n=e._hints).call(n,ft.SCREEN_TRACK)&&a._hints.push(ft.SCREEN_LOW_TRACK),e.on("sei-to-send",c=>{a.emit("sei-to-send",c)}),e.addListener(X.NEED_CLOSE,()=>{a.close()}),a}globalLock(){var e=this;return C(function*(){return e.mutex.lock("From P2PChannel.globalLock")})()}reportPCStats(e,t,n){var i=arguments,r=this;return C(function*(){let o=i.length>3&&void 0!==i[3]?i[3]:null;if(r.connection&&r.connection instanceof Ws){var s,a,c,l;const d=r.store.keyMetrics.descriptionStart||0,{iceConnectionState:u,dtlsTransportState:h,peerConnectionState:p}=r.connection,{local:m,remote:f}=yield r.connection.getSelectedCandidatePair();ne.pcStats(r.store.sessionId,{startTime:d,eventElapse:e-d||0,iceconnectionsate:u,dtlsstate:h,connectionstate:p,intSucc:t?1:2,error:o,selectedLocalCandidateProtocol:null!==(s=m?.protocol)&&void 0!==s?s:"",selectedLocalCandidateType:null!==(a=m.candidateType)&&void 0!==a?a:"",selectedLocalCandidateAddress:"".concat(m.address,":").concat(m.port),selectedRemoteCandidateProtocol:null!==(c=f.protocol)&&void 0!==c?c:"",selectedRemoteCandidateType:null!==(l=f.candidateType)&&void 0!==l?l:"",selectedRemoteCandidateAddress:"".concat(f.address,":").concat(f.port),restartCnt:n,preallocation:r.connection.isPreallocation})}})()}reportVideoFirstFrameDecoded(e,t,n,i){var r;const o=Array.from(Xr(r=this.remoteUserMap).call(r)).find(s=>s._videoSSRC===e);if(o){i||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());const s=this.store.keyMetrics,a=s.subscribe.find(c=>c.userId===o.uid&&"video"===c.type);ne.firstRemoteVideoDecode(this.store.sessionId,Yn.FIRST_VIDEO_DECODE,kt.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:n,subscribeElapse:_i.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:s.requestAPEnd||0,apStart:s.requestAPStart||0,joinGwEnd:s.joinGatewayEnd||0,joinGwStart:s.joinGatewayStart||0,pcEnd:s.peerConnectionEnd||0,pcStart:s.peerConnectionStart||0,subscriberEnd:a?.subscribeEnd||0,subscriberStart:a?.subscribeStart||0,videoAddNotify:a?.streamAdded||0,state:i?1:0,firstFrame:a?.firstFrame||0})}}remoteMediaSsrcChanged(e,t,n){var i=this;return C(function*(){if(!i.connection)return!1;const r=i.remoteUserMap.get(e);if(!r)return!1;const o=r.get(t);if(!o)return!1;const s=yield i.connection.getRemoteSSRC(o);return void 0!==s&&s!==n})()}unbindRtpTransceiver(){0!==this.localTrackMap.size&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[t,{track:n}]=e;t===j.LocalVideoLowTrack?n._updateRtpTransceiver(void 0,Rp.LOW_STREAM):n._updateRtpTransceiver(void 0)})}reportPCDisconnectedOrFailed(e){this.connection&&this.connection instanceof Ws&&("disconnected"!==this.connection.iceConnectionState&&"checking"!==this.connection.iceConnectionState&&"failed"!==this.connection.iceConnectionState||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this.reportPCStats(Date.now(),!1,this._pcStatsUploadType===mc.TCP_RESTART&&e===Mr.RELAY?this._pcStatsUploadType:mc.DISCONNECTED_OR_FAILED)))}},Q(be.prototype,"startP2PConnection",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"startP2PConnection"),be.prototype),Q(be.prototype,"connect",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"connect"),be.prototype),Q(be.prototype,"updateRemoteRTPCapabilities",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"updateRemoteRTPCapabilities"),be.prototype),Q(be.prototype,"publishDataChannel",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"publishDataChannel"),be.prototype),Q(be.prototype,"unpublish",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"unpublish"),be.prototype),Q(be.prototype,"unpublishDataChannel",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"unpublishDataChannel"),be.prototype),Q(be.prototype,"unpublishLowStream",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"unpublishLowStream"),be.prototype),Q(be.prototype,"subscribeDataChannel",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"subscribeDataChannel"),be.prototype),Q(be.prototype,"subscribe",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"subscribe"),be.prototype),Q(be.prototype,"massSubscribe",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"massSubscribe"),be.prototype),Q(be.prototype,"unsubscribe",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"unsubscribe"),be.prototype),Q(be.prototype,"unsubscribeDataChannel",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"unsubscribeDataChannel"),be.prototype),Q(be.prototype,"massUnsubscribe",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"massUnsubscribe"),be.prototype),Q(be.prototype,"muteRemote",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"muteRemote"),be.prototype),Q(be.prototype,"unmuteRemote",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"unmuteRemote"),be.prototype),Q(be.prototype,"hasRemoteMediaWithLock",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"hasRemoteMediaWithLock"),be.prototype),Q(be.prototype,"disconnectForReconnect",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"disconnectForReconnect"),be.prototype),Q(be.prototype,"updateBitrateLimit",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"updateBitrateLimit"),be.prototype),Q(be.prototype,"remoteMediaSsrcChanged",[Ui],Object.getOwnPropertyDescriptor(be.prototype,"remoteMediaSsrcChanged"),be.prototype),be);function Ui(e,t,n){const i=e[t];if("function"!=typeof i)throw new Error("Cannot use mutex on object property.");return n.value=C(function*(){const r=this.mutex,o=yield r.lock("From P2PChannel.".concat(t));try{for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return yield i.apply(this,a)}finally{o()}}),n}const tZ={};function h_(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&_.debug("install service ".concat(e.name)),tZ[e.name]=e}function p_(e){const t=tZ[e];if(!t)throw new M(S.INVALID_OPERATION,"".concat(e," not found, please use AgoraRTC.use(").concat(e,"Service) to load it first"));return t}function nZ(e,t){return p_("DataStream").create(e,t)}function iZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function rZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iZ(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iZ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}const OFe=Date.now(),NFe=20,YM=new Map,SC=new Map;function oZ(e){return $M.apply(this,arguments)}function $M(){return $M=C(function*(e){const t=YM.get(e),n=Array.isArray(t)&&t[t.length-1],i=SC.get(e);if(!n)return void(i.isSyncing=!1);const r={uid:n.uid,payload:n.payload};0===i.firstRecvTs&&(i.firstRecvTs=n.recvTs,i.firstSendTs=n.sendTs);const o=n.sendTs-i.firstSendTs,s=o-(Date.now()-i.firstRecvTs);s>0&&(i.firstRecvTs=Date.now()-o);let a=n.mediaDelay+s;a<=0?(t.pop(),sZ(n.context,r),a=0):a=Math.min(a,NFe),setTimeout(()=>t.length&&oZ(e),a)}),$M.apply(this,arguments)}function sZ(e,t){e.safeEmit(Ae.STREAM_MESSAGE,t.uid,t.payload),e.onStreamMessage&&e.onStreamMessage(t)}const MFe=xe().name;function aZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function cZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aZ(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aZ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}const jp="websdk_ng_cache_parameter",xFe=R("MAX_PRELOAD_ASYNC_LENGTH"),kFe=1e4,Xd=new Map,Zd=[];let XM=null,ZM=0,JM=0;const CC=new Map,LFe=function(e,t){const n=[];let i=0;const r=function(){var o=C(function*(){const s=n.shift();s&&(yield s()),n.length>0&&i<t?r():i--});return function(){return o.apply(this,arguments)}}();return C(function*(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return new q(function(){var c=C(function*(l,d){n.push(C(function*(){try{const u=yield e(...s);l(u)}catch(u){d(u)}})),i<t&&(i++,r())});return function(l,d){return c.apply(this,arguments)}}())})}(lZ,xFe),QM=nr.CancelToken.source();function lZ(e,t,n,i,r,o){return e1.apply(this,arguments)}function e1(){return e1=C(function*(e,t,n,i,r,o){try{if(!R("ENABLE_PRELOAD"))return;if(!Fe().supportWebCrypto)return void ml(()=>{_.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!n&&null!==n)throw new M(S.INVALID_PARAMS,"Invalid token: ".concat(n,". If you don not use token, set it to null"));n&&Kn(n,"token",1,2047),Kn(e,"appid",1,2047),US(t),i&&VS(i);const s=up();_.debug("preload channel ".concat(t,", uid is ").concat(i));const a={appId:e,cname:t,token:n||e,uid:"string"!=typeof i?i:null,sid:s,proxyServer:r};let c,l;"string"==typeof i?(a.stringUid=i,[l,c]=yield q.all([cFe(i,{sid:s,appId:e},QM.token),tX(cZ(cZ({},a),{},{token:n||e,uid:0}),QM.token)]),a.uid=l.uid,c.gatewayInfo.uid=a.uid,c.gatewayInfo.res.uid=a.uid):(o&&(a.stringUid=o),c=yield tX(a,QM.token));const d={sid:s,appId:e,cname:t,token:n||e,uid:a.stringUid||i,intUid:a.uid||c.gatewayInfo.uid,stringUid:a.stringUid,ts:Date.now(),sua:l,ap:c};yield(u=C(function*(h){let p;try{h.uid&&uZ({appId:h.appId,cname:h.cname,token:h.token,uid:h.uid,stringUid:h.stringUid});const m=mZ(h),f=yield(E=C(function*(b,T){try{const I=yield window.crypto.subtle.importKey("raw",mK(T),"AES-GCM",!1,["encrypt"]),D=yield window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},I,Md(window.btoa(JSON.stringify(b))));return gl(new Uint8Array(D))}catch{return}}),function(b,T){return E.apply(this,arguments)})(h,h.token||h.appId);if(!f)return;p=fZ(jp);const g=p?JSON.parse(p):[];g.push({[m]:f}),g.length>R("AP_CACHE_NUM")&&g.shift(),TC(jp,JSON.stringify(g))}catch(m){_.warn("Error caching server parameters:",m.message),TC(jp,"")}var E}),function(h){return u.apply(this,arguments)})(d),ZM++}catch(s){throw JM++,function(a){XM||(XM=window.setTimeout(()=>{let l="";CC.forEach((d,u)=>{l+="".concat(u,": ").concat(d," ;")}),ne.reportApiInvoke(null,{name:Cn.PRELOAD,options:{success:ZM,failed:JM,err:l}}).onError(a),ZM=0,JM=0,CC.clear(),XM=null},kFe));const c=CC.get(a.code)||0;CC.set(a.code,c+1)}(s),s}var u}),e1.apply(this,arguments)}function dZ(e){return t1.apply(this,arguments)}function t1(){return t1=C(function*(e){try{if(R("AP_REQUEST_DETAIL"))return;const t=uZ(e);if(!t||"disabled"!==e.cloudProxyServer)return;const n=yield(i=C(function*(r,o){try{const s=yield window.crypto.subtle.importKey("raw",mK(o),"AES-GCM",!1,["decrypt"]),a=yield window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},s,Md(r));return JSON.parse(window.atob(gl(new Uint8Array(a))))}catch{return}}),function(r,o){return i.apply(this,arguments)})(t,e.token||e.appId);if(!n||!function(i,r){return i.cname===r.cname&&i.appId===r.appId&&i.token===r.token&&(r.stringUid?i.stringUid===r.stringUid:"number"==typeof r.uid?i.uid===r.uid:i.uid==r.uid)}(n,e))return;if(n&&Date.now()-n.ts<R("AP_CACHE_LIFETIME"))return n}catch(t){_.warn("Error get preloadInfo",t.message)}var i}),t1.apply(this,arguments)}function uZ(e){let t;try{if(t=fZ(jp),!t)return;const n=JSON.parse(t),i=mZ(e),r=function(s,a){for(let c=s.length-1;c>=0;c--)if(a(s[c]))return c;return-1}(n,s=>i in s);if(-1===r)return;const o=n.splice(r,1)[0];return TC(jp,JSON.stringify(n)),o[i]}catch(n){_.warn("Error delete preload info: ".concat(t),n.message),TC(jp,"")}}function n1(e){if(e){let t=Xd.get(e);t&&(window.clearTimeout(t),t=null,Xd.delete(e)),Y(Zd).call(Zd,e)||"disabled"!==e.cloudProxyServer||Zd.push(e)}if(Xd.size<R("AP_CACHE_NUM")&&Zd.length>0){const t=Zd.shift();Xd.set(t,window.setTimeout(C(function*(){const{appId:n,cname:i,token:r,stringUid:o,uid:s,proxyServer:a}=t;try{yield LFe(n,i,r,s,a,o),Xd.has(t)&&n1(t)}catch(c){_.warn("update preload failed",c.message),hZ(t)}}),R("AP_UPDATE_INTERVAL")))}}function hZ(e){const t=Zd.indexOf(e);-1!==t&&Zd.splice(t,1);let n=Xd.get(e);n&&(window.clearTimeout(n),n=null,Xd.delete(e),n1())}function pZ(e,t){const n=e.sua,i=e.ap;t&&n&&ne.reqUserAccount(e.sid,{lts:n.requestTime,elapse:n.elapse,success:!0,serverAddr:n.url,stringUid:t,uid:e.intUid,errorCode:null,extend:n.req}),ne.reportResourceTiming(e.ap.url,e.sid),ne.joinWebProxyAP(e.sid,{lts:i.requestTime,elapse:i.elapse,sucess:1,apServerAddr:i.url,turnServerAddrList:i.proxyInfo.addresses.map(r=>r.ip).join(","),eventType:"disabled",unilbsServerIds:[un.CHOOSE_SERVER,un.CLOUD_PROXY_FALLBACK].toString()}),ne.joinChooseServer(e.sid,{lts:i.requestTime,elapse:i.elapse,succ:!0,csAddr:i.url,opid:i.opid,serverList:i.gatewayInfo.gatewayAddrs.map(r=>r.address),ec:null,cid:i.gatewayInfo.cid.toString(),uid:i.gatewayInfo.uid.toString(),csIp:i.gatewayInfo.csIp,unilbsServerIds:[un.CHOOSE_SERVER].toString(),isHttp3:i.isHttp3})}function fZ(e){return window.atob(window.localStorage.getItem(e)||"")}function TC(e,t){window.localStorage.setItem(e,window.btoa(t))}function mZ(e){let t="".concat(e.appId,"_").concat(e.cname);return"string"==typeof e.uid&&(t+="_s_".concat(e.uid)),"number"==typeof e.uid&&(t+="_".concat(e.uid)),e.token&&(t+="_".concat(e.token)),SK(t)}function VFe(e,t){switch(t){case 0:for(;128&us(e););break;case 2:r1(e,f_(e));break;case 5:r1(e,4);break;case 1:r1(e,8);break;default:throw new Error("Unimplemented type: "+t)}}function Hp(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let BFe=[];function r1(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function jFe(e){return e.offset>=e.limit}function wC(e,t){let n=e.bytes,i=e.offset,r=e.limit,o=i+t;if(o>n.length){let s=new Uint8Array(2*o);s.set(n),e.bytes=s}return e.offset=o,o>r&&(e.limit=o),i}function gZ(e,t){let n=e.offset;if(n+t>e.limit)throw new Error("Read past limit");return e.offset+=t,n}function _Z(e,t){let n=wC(e,t.length);e.bytes.set(t,n)}function vZ(e,t){let n=gZ(e,t),i=String.fromCharCode,r=e.bytes,o="\ufffd",s="";for(let a=0;a<t;a++){let c,l,d,u,h=r[a+n];128&h?192==(224&h)?a+1>=t?s+=o:(c=r[a+n+1],128!=(192&c)?s+=o:(u=(31&h)<<6|63&c,u<128?s+=o:(s+=i(u),a++))):224==(240&h)?a+2>=t?s+=o:(c=r[a+n+1],l=r[a+n+2],32896!=(49344&(c|l<<8))?s+=o:(u=(15&h)<<12|(63&c)<<6|63&l,u<2048||u>=55296&&u<=57343?s+=o:(s+=i(u),a+=2))):240==(248&h)?a+3>=t?s+=o:(c=r[a+n+1],l=r[a+n+2],d=r[a+n+3],8421504!=(12632256&(c|l<<8|d<<16))?s+=o:(u=(7&h)<<18|(63&c)<<12|(63&l)<<6|63&d,u<65536||u>1114111?s+=o:(u-=65536,s+=i(55296+(u>>10),56320+(1023&u)),a+=3))):s+=o:s+=i(h)}return s}function Al(e,t){let n=t.length,i=0;for(let s=0;s<n;s++){let a=t.charCodeAt(s);a>=55296&&a<=56319&&s+1<n&&(a=(a<<10)+t.charCodeAt(++s)-56613888),i+=a<128?1:a<2048?2:a<65536?3:4}hn(e,i);let r=wC(e,i),o=e.bytes;for(let s=0;s<n;s++){let a=t.charCodeAt(s);a>=55296&&a<=56319&&s+1<n&&(a=(a<<10)+t.charCodeAt(++s)-56613888),a<128?o[r++]=a:(a<2048?o[r++]=a>>6&31|192:(a<65536?o[r++]=a>>12&15|224:(o[r++]=a>>18&7|240,o[r++]=a>>12&63|128),o[r++]=a>>6&63|128),o[r++]=63&a|128)}}function us(e){return e.bytes[gZ(e,1)]}function EZ(e,t){let n=wC(e,1);e.bytes[n]=t}function f_(e){let t,n=0,i=0;do{t=us(e),n<32&&(i|=(127&t)<<n),n+=7}while(128&t);return i}function hn(e,t){for(t>>>=0;t>=128;)EZ(e,127&t|128),t>>>=7;EZ(e,t)}function HFe(e,t){let n,i=0,r=0,o=0;return n=us(e),i=127&n,128&n&&(n=us(e),i|=(127&n)<<7,128&n&&(n=us(e),i|=(127&n)<<14,128&n&&(n=us(e),i|=(127&n)<<21,128&n&&(n=us(e),r=127&n,128&n&&(n=us(e),r|=(127&n)<<7,128&n&&(n=us(e),r|=(127&n)<<14,128&n&&(n=us(e),r|=(127&n)<<21,128&n&&(n=us(e),o=127&n,128&n&&(n=us(e),o|=(127&n)<<7))))))))),{low:i|r<<28,high:r>>>4|o<<24,unsigned:t}}function Dl(e,t){let n=t.low>>>0,i=(t.low>>>28|t.high<<4)>>>0,r=t.high>>>24,o=0===r?0===i?n<16384?n<128?1:2:n<1<<21?3:4:i<16384?i<128?5:6:i<1<<21?7:8:r<128?9:10,s=wC(e,o),a=e.bytes;switch(o){case 10:a[s+9]=r>>>7&1;case 9:a[s+8]=9!==o?128|r:127&r;case 8:a[s+7]=8!==o?i>>>21|128:i>>>21&127;case 7:a[s+6]=7!==o?i>>>14|128:i>>>14&127;case 6:a[s+5]=6!==o?i>>>7|128:i>>>7&127;case 5:a[s+4]=5!==o?128|i:127&i;case 4:a[s+3]=4!==o?n>>>21|128:n>>>21&127;case 3:a[s+2]=3!==o?n>>>14|128:n>>>14&127;case 2:a[s+1]=2!==o?n>>>7|128:n>>>7&127;case 1:a[s]=1!==o?128|n:127&n}}const bZ={},yZ={},IC=4294967296,SZ=IC*IC,CZ=SZ/2,o1=wZ(0,!0),TZ=wZ(0),GFe=Gp(0,-2147483648,!1),WFe=Gp(-1,2147483647,!1),zFe=Gp(-1,-1,!0);function wZ(e,t){let n,i,r;return t?(r=0<=(e>>>=0)&&e<256)&&(i=yZ[e],i)?i:(n=Gp(e,0,!0),r&&(yZ[e]=n),n):(r=-128<=(e|=0)&&e<128)&&(i=bZ[e],i)?i:(n=Gp(e,e<0?-1:0,!1),r&&(bZ[e]=n),n)}function Gp(e,t,n){return{low:0|e,high:0|t,unsigned:!!n}}function KFe(e,t){if(isNaN(e))return t?o1:TZ;if(t){if(e<0)return o1;if(e>=SZ)return zFe}else{if(e<=-CZ)return GFe;if(e+1>=CZ)return WFe}return e<0?t?o1:TZ:Gp(e%IC|0,e/IC|0,t)}function IZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}class s1 extends xt{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;const n=this._connectionState;this._connectionState=t,this.emit(Us.CONNECTION_STATE_CHANGE,t,n)}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(t){var n;super(),y(this,"name","AgoraRTCImageModeration"),y(this,"_connectionState",Mo.CONNECTING),y(this,"_sequence",0),y(this,"_moderationStartTime",void 0),y(this,"_workerConnection",void 0),y(this,"_workerMessageLengthLimit",void 0),y(this,"_qualityRatio",void 0),y(this,"_connectInfo",void 0),y(this,"_cancelTokenSource",nr.CancelToken.source()),y(this,"_retryConfig",void 0),y(this,"_moderationInterval",void 0),y(this,"_moderationTimer",null),y(this,"_moderationMode",1),y(this,"_quality",1),y(this,"_qualityTimer",null),y(this,"_ticket",void 0),y(this,"_moderationIntervalMinimum",void 0),y(this,"_uploadFailedNum",0),y(this,"_uploadNum",0),y(this,"_uploadTimer",null),y(this,"_extraInfo",void 0),y(this,"_vendor",""),y(this,"_encoder",new TextEncoder),y(this,"_moderationId",void 0),y(this,"inspectImage",()=>{if(this.connectionState!==Mo.CONNECTED)throw new N(S.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===Mo.CONNECTED?this.requestToInspectImage():_.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=gt(5,"image-moderation-"),this._workerMessageLengthLimit=R("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=R("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=null!==(n=t.interval)&&void 0!==n?n:1e3,t.extraInfo&&(this._extraInfo=this._encoder.encode(t.extraInfo)),t.vendor&&(this._vendor=t.vendor),this._qualityRatio=R("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new Yg("worker-"+this._moderationId,vn),this.on(Us.STATE_CHANGE,(i,r)=>{_.debug("[".concat(this._moderationId,"] Moderation operation :").concat(mp[i]," ").concat(r||""))}),this.handleWorkerEvents()}init(t,n){var i=this;return C(function*(){i.emit(Us.STATE_CHANGE,mp.CONNECT_AP),i._connectInfo=t;const r=i._cancelTokenSource.token;return i._retryConfig=n,new q((o,s)=>{i.on(Us.CONNECTION_STATE_CHANGE,(a,c)=>{a===Mo.CONNECTED&&o()}),i.requestAP(t,r,n).then(a=>{i.connectWorker(a)}).catch(a=>{s(a)})})})()}updateConfig(t){var n;this._moderationInterval=null!==(n=t.interval)&&void 0!==n?n:1e3,t.extraInfo&&(this._extraInfo=this._encoder.encode(t.extraInfo)),t.vendor&&(this._vendor=t.vendor),_.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(t))),this.connectionState===Mo.CONNECTED&&this.inspectImage()}requestAP(t,n,i){var r=this;return C(function*(){const o=R("WEBCS_DOMAIN").map(l=>"https://".concat(l,"/api/v1")),s=yield function(l,d,u,h){let{appId:p,areaCode:m,cname:f,sid:g,token:E,uid:b}=d;Up++;const T="moderation_plugin",I={service_name:T,json_body:JSON.stringify({appId:p,areaCode:m,cname:f,command:"allocateEdge",requestId:Up,seq:Up,sid:g,appToken:E,ts:Date.now(),uid:b+""})};let D,O,k=l[0];return Fs(C(function*(){D=Date.now();const L=yield js(k,{data:I,cancelToken:u,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(O=Date.now()-D,0!==L.code){const oe=new N(S.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+L.code,{retry:!0,responseTime:O});throw _.error(oe.toString()),oe}const V=JSON.parse(L.json_body);if(200!==V.code){const oe=new N(S.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(V.code,", reason: ").concat(V.reason),{code:V.code,responseTime:O});throw _.error(oe.toString()),oe}if(!V.servers||!Array.isArray(V.servers)||0===V.servers.length){const oe=new N(S.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:V.code,responseTime:O});throw _.error(oe.toString()),oe}if(!V.servers.some(oe=>!!oe.wss)){const oe=new N(S.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:V.code,responseTime:O});throw _.error(oe.toString()),oe}const ee=R("IMAGE_MODERATION_WORKER_HOST");return{addressList:V.servers.map(oe=>{let{address:Ie,wss:Ue}=oe;if(Ie&&Ue)return"wss://".concat(Ie.replace(/\./g,"-"),".").concat(ee,":").concat(Ue,"/moderation")}).filter(oe=>!!oe),workerToken:V.workerToken,vid:V.vid,ticket:V.appTicket,responseTime:O}}),(L,V)=>(ne.apworkerEvent(g,{success:!0,sc:200,serviceName:T,responseDetail:JSON.stringify(L.addressList),firstSuccess:0===V,responseTime:O,serverIp:l[V%l.length]}),!1),(L,V)=>(ne.apworkerEvent(g,{success:!1,sc:L.data&&L.data.code||200,serviceName:T,responseTime:O,serverIp:l[V%l.length]}),!!(L.code!==S.OPERATION_ABORTED&&L.code!==S.UNEXPECTED_RESPONSE||L.data&&L.data.retry)&&(k=l[(V+1)%l.length],!0)),h)}(o,t,n,i);r.emit(Us.STATE_CHANGE,mp.AP_CONNECTED);const{addressList:a,ticket:c}=s;return r._ticket=c,a})()}connectWorker(t){var n=this;return C(function*(){n.emit(Us.STATE_CHANGE,mp.CONNECT_WORKER),yield n._workerConnection.init(t,1e4)})()}handleWorkerEvents(){var t=this;this._workerConnection.on(fe.CONNECTED,C(function*(){t.emit(Us.STATE_CHANGE,mp.WORKER_CONNECTED,t._workerConnection.url),t.connectionState=Mo.CONNECTED})),this._workerConnection.on(fe.CLOSED,()=>{this.connectionState=Mo.CLOSED}),this._workerConnection.on(fe.FAILED,()=>{this.connectionState=Mo.CLOSED}),this._workerConnection.on(fe.RECONNECTING,()=>{this.connectionState=this.connectionState===Mo.CONNECTED?Mo.RECONNECTING:Mo.CONNECTING}),this._workerConnection.on(fe.ON_MESSAGE,function(){var n=C(function*(i){if(i.data instanceof ArrayBuffer){const r=function UFe(e){return function(n){let i={};e:for(;!jFe(n);){let r=f_(n);switch(r>>>3){case 0:break e;case 1:i.code=f_(n);break;case 2:i.msg=vZ(n,f_(n));break;case 3:i.requestId=vZ(n,f_(n));break;case 4:i.timestamp=HFe(n,!1);break;default:VFe(n,7&r)}}return i}({bytes:t=e,offset:0,limit:t.length});var t}(new Uint8Array(i.data));R("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&_.debug("[".concat(t._moderationId,"] Response message for worker of image moderation "),JSON.stringify(r)),t._uploadNum++,void 0===r.code||0===r.code||(t._uploadFailedNum++,_.error("[".concat(t._moderationId,"] Error response from worke, code is ").concat(r.code,", msg is ").concat(r.msg)),t._uploadTimer||(t._uploadTimer=window.setTimeout(()=>{ne.reportApiInvoke(t._connectInfo.sid||null,{name:Cn.IMAGE_MODERATION_UPLOAD,options:[t._uploadFailedNum,t._uploadNum,r.code],tag:jt.TRACER}).onError(new N(S.IMAGE_MODERATION_UPLOAD_FAILED,r.msg)),t._uploadTimer=null},R("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else _.error("[".concat(t._moderationId,"] Unexpected message type from worker"))});return function(i){return n.apply(this,arguments)}}()),this._workerConnection.on(fe.WILL_RECONNECT,(n,i,r)=>{"recover"===n&&r(n),r("tryNext")}),this._workerConnection.on(fe.REQUEST_NEW_URLS,(n,i)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(n).catch(i)})}static intToLong(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}requestToInspectImage(){var t=this;return C(function*(){const n=Oo(t,Us.CLIENT_LOCAL_VIDEO_TRACK),i={appId:t._connectInfo.appId,cname:t._connectInfo.cname,cid:t._connectInfo.cid,sid:t._connectInfo.sid,uid:t._connectInfo.uid,vid:t._connectInfo.vid};if(n){if(!n.isPlaying)return void(R("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&_.debug("Only the track being played can be inspected"));t._sequence++;const r=yield t.generateRequestData(n,i);t._workerConnection.sendMessage(r,!0,!0)}else R("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&_.debug("Only the track being published can be inspected")})()}generateRequestData(t,n){var i=this;return C(function*(){let{appId:r,cname:o,cid:s,vid:a,sid:c,uid:l}=n;const d=Date.now(),u=yield t.getCurrentFrameImage("image/jpeg",i.quality),h=yield eY(u,r,o),p=i._sequence+"-"+s+"-"+l+"-"+d+"-"+gt(12,""),m={appId:r,cid:s,cname:o,deviceId:"",elapse:s1.intToLong(Number(d-i._moderationStartTime)),fileSize:u.buffer.byteLength,height:u.height,width:u.width,jpg:h,networkType:6,osType:7,requestId:p,sdkVersion:"4.22.1",sequence:i._sequence,sid:c,timestamp:KFe(d),uid:l,vid:a,service:i._moderationMode,ticket:i._ticket,callbackData:i._extraInfo,vendorConfigs:i._vendor};void 0===i._extraInfo&&delete m.callbackData;const f=function FFe(e){let t=function(){const n=BFe.pop();return n?(n.offset=n.limit=0,n):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(n,i){let r=n.appId;void 0!==r&&(hn(i,10),Al(i,r));let o=n.cid;void 0!==o&&(hn(i,16),hn(i,o));let s=n.cname;void 0!==s&&(hn(i,26),Al(i,s));let a=n.deviceId;void 0!==a&&(hn(i,34),Al(i,a));let c=n.elapse;void 0!==c&&(hn(i,40),Dl(i,c));let l=n.fileSize;void 0!==l&&(hn(i,48),Dl(i,Hp(l)));let d=n.height;void 0!==d&&(hn(i,56),Dl(i,Hp(d)));let u=n.jpg;void 0!==u&&(hn(i,66),hn(i,u.length),_Z(i,u));let h=n.networkType;void 0!==h&&(hn(i,72),Dl(i,Hp(h)));let p=n.osType;void 0!==p&&(hn(i,80),Dl(i,Hp(p)));let m=n.requestId;void 0!==m&&(hn(i,90),Al(i,m));let f=n.sdkVersion;void 0!==f&&(hn(i,98),Al(i,f));let g=n.sequence;void 0!==g&&(hn(i,104),Dl(i,Hp(g)));let E=n.sid;void 0!==E&&(hn(i,114),Al(i,E));let b=n.timestamp;void 0!==b&&(hn(i,120),Dl(i,b));let T=n.uid;void 0!==T&&(hn(i,128),hn(i,T));let I=n.vid;void 0!==I&&(hn(i,136),hn(i,I));let D=n.width;void 0!==D&&(hn(i,144),Dl(i,Hp(D)));let O=n.service;void 0!==O&&(hn(i,152),hn(i,O));let k=n.callbackData;void 0!==k&&(hn(i,162),hn(i,k.length),_Z(i,k));let L=n.ticket;void 0!==L&&(hn(i,170),Al(i,L));let V=n.vendorConfigs;void 0!==V&&(hn(i,178),Al(i,V))}(e,t),function(n){let i=n.bytes,r=n.limit;return i.length===r?i:i.subarray(0,r)}(t)}(m);if(f.byteLength<i._workerMessageLengthLimit){if(R("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const g=function(E){for(var b=1;b<arguments.length;b++){var T=null!=arguments[b]?arguments[b]:{};b%2?IZ(Object(T),!0).forEach(function(I){y(E,I,T[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(T)):IZ(Object(T)).forEach(function(I){Object.defineProperty(E,I,Object.getOwnPropertyDescriptor(T,I))})}return E}({},m);delete g.jpg,_.debug("[".concat(i._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(g))}return f}return i.quality=i.quality*i._qualityRatio,yield i.generateRequestData(t,{appId:r,cname:o,cid:s,vid:a,sid:c,uid:l})})()}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=nr.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=Mo.CLOSED,this.emit(Us.STATE_CHANGE,mp.CLOSED)}}function RZ(e){if(ot(e.interval,"interval",1e3,1/0),e&&e.extraInfo&&e.extraInfo.length>1024)throw new N(S.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(e&&e.vendor&&e.vendor.length>1024)throw new N(S.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const qFe={name:"ImageModeration",create:function(e){let{config:t}=e;return RZ(t),new s1(t)}};var AZ,DZ,OZ,NZ,PZ,MZ,xZ,kZ,LZ,FZ,UZ,VZ,BZ,jZ,HZ,GZ,WZ,zZ,KZ,qZ,YZ,$Z,XZ,ZZ,JZ,QZ,eJ,tJ,nJ,iJ,rJ,oJ,sJ,aJ,cJ,lJ,dJ,uJ,hJ,pJ,$;function fJ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function hs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fJ(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fJ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}mi.setLogger(_);let YFe=(AZ=le(),DZ=le({argsMap:(e,t)=>{if(!Array.isArray(t)){if(!(t instanceof Np))return[t];t=[t]}return t.map(n=>n?Object(n).toString():"null")}}),OZ=le({argsMap:(e,t)=>(t||(t=[]),Array.isArray(t)||t.trackMediaType!==Op.DATA?(Array.isArray(t)||(t=[t]),t.map(n=>n.getTrackId())):[t.getChannelId()])}),NZ=le({argsMap:(e,t,n,i)=>["object"==typeof t?t.uid:t,n,i]}),PZ=le({argsMap:(e,t,n)=>[t,n]}),MZ=le({argsMap:(e,t)=>t.map(n=>{let{user:i,mediaType:r}=n;return[i?.uid,r]})}),xZ=le({argsMap:(e,t,n,i)=>["object"==typeof t?t.uid:t,n,i]}),kZ=le({argsMap:(e,t)=>t.map(n=>{let{user:i,mediaType:r}=n;return{uid:i?.uid,mediaType:r}})}),LZ=le(),FZ=le(),UZ=le(),VZ=le(),BZ=le(),jZ=le(),HZ=le(),GZ=le(),WZ=le(),zZ=le(),KZ=le(),qZ=le(),YZ=le(),$Z=le(),XZ=le({argsMap:(e,t)=>[t]}),ZZ=le(),JZ=le(),QZ=le(),eJ=le(),tJ=le(),nJ=le(),iJ=le(),rJ=le(),oJ=le({argsMap:(e,t)=>(Array.isArray(t)||(t=[t]),[JSON.stringify(t)])}),sJ=le(),aJ=le(),cJ=le(),lJ=le(),dJ=le(),uJ=le(),hJ=le({reportResult:!0}),pJ=le(),$=class extends xt{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var e;return(null===(e=this._config)||void 0===e?void 0:e.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(e){var t;let n;if(super(),t=this,y(this,"store",void 0),y(this,"_uid",void 0),y(this,"_channelName",void 0),y(this,"_uintUid",void 0),y(this,"_users",[]),y(this,"_config",void 0),y(this,"_clientId",void 0),y(this,"_appId",void 0),y(this,"_sessionId",null),y(this,"_key",void 0),y(this,"_rtmConfig",{}),y(this,"_joinInfo",void 0),y(this,"_gateway",void 0),y(this,"_statsCollector",void 0),y(this,"_configDistribute",void 0),y(this,"_leaveMutex",new mi("client-leave")),y(this,"_publishMutex",new mi("client-publish")),y(this,"_renewTokenMutex",new mi("client-renewtoken")),y(this,"_subscribeMutex",new mi("client-subscribe")),y(this,"_encryptionMode","none"),y(this,"_encryptionSecret",null),y(this,"_encryptionSalt",null),y(this,"_encryptDataStream",!1),y(this,"_encryptDataStreamKey",null),y(this,"_encryptDataStreamIv",null),y(this,"_proxyServer",void 0),y(this,"_turnServer",{servers:[],mode:"auto"}),y(this,"_cloudProxyServerMode","disabled"),y(this,"_isDualStreamEnabled",!1),y(this,"_defaultStreamFallbackType",void 0),y(this,"_lowStreamParameter",void 0),y(this,"_streamFallbackTypeCacheMap",new Map),y(this,"_remoteStreamTypeCacheMap",new Map),y(this,"_axiosCancelSource",nr.CancelToken.source()),y(this,"_audioVolumeIndicationInterval",void 0),y(this,"_networkQualityInterval",void 0),y(this,"_userOfflineTimeout",void 0),y(this,"_streamRemovedTimeout",void 0),y(this,"_liveTranscodeStreamingClient",void 0),y(this,"_liveRawStreamingClient",void 0),y(this,"_channelMediaRelayClient",void 0),y(this,"_networkQualitySensitivity","normal"),y(this,"_p2pChannel",void 0),y(this,"_useLocalAccessPoint",!1),y(this,"_setLocalAPVersion",void 0),y(this,"_joinAndNotLeaveYet",!1),y(this,"_numberOfJoinCount",0),y(this,"_remoteDefaultVideoStreamType",void 0),y(this,"_inspect",void 0),y(this,"_moderation",void 0),y(this,"_license",void 0),y(this,"_pendingPublishedUsers",[]),y(this,"ntpAlignErrorCount",0),y(this,"remoteInboundOffset",0),y(this,"_handleLocalTrackEnable",(i,r,o)=>{this.publish(i,!1).then(r).catch(o)}),y(this,"_handleLocalTrackDisable",(i,r,o)=>{this.unpublish(i).then(r).catch(o)}),y(this,"_handleUserOnline",i=>{if(R("BLOCK_LOCAL_CLIENT")&&Ld(i.uid,this.channelName))return void _.debug("[".concat(i.uid,"] will be ignored in local"));this.isStringUID&&"string"!=typeof i.uid&&_.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const r=this._users.find(o=>o.uid===i.uid);if(r)r._trust_in_room_=!0,r._is_pre_created&&(r._is_pre_created=!1,this.safeEmit(Ae.USER_JOINED,r));else{const o=new Il(i.uid,i.uint_id||i.uid);this._users.push(o),_.debug("[".concat(this._clientId,"] user online"),i.uid),this.safeEmit(Ae.USER_JOINED,o)}}),y(this,"_handleUserOffline",i=>{if(R("BLOCK_LOCAL_CLIENT")&&Ld(i.uid,this.channelName))return;const r=this._users.find(o=>o.uid===i.uid);r&&(this._handleRemoveStream(i),this._handleRemoveDataChannels(i),r._audio_pre_subscribed||r._video_pre_subscribed?r._is_pre_created=!0:DS(this._users,r),this._remoteStreamTypeCacheMap.delete(r.uid),this._streamFallbackTypeCacheMap.delete(r.uid),_.debug("[".concat(this._clientId,"] user offline"),i.uid,"reason:",i.reason),this.safeEmit(Ae.USER_LEAVED,r,i.reason))}),y(this,"_handleAddAudioOrVideoStream",(i,r,o,s,a,c,l)=>{if(R("BLOCK_LOCAL_CLIENT")&&Ld(r,this.channelName))return;const d=this._users.find(h=>h.uid===r);if(!d)return void _.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));_.debug("[".concat(this._clientId,"] stream added with uid ").concat(r,", type ").concat(i)),this.store.subscribe(d.uid,i,void 0,void 0,void 0,Date.now());const u="audio"===i?d.hasAudio:d.hasVideo;d._uintid||(d._uintid=a||r),"audio"===i?d._trust_audio_stream_added_state_=!0:d._trust_video_stream_added_state_=!0,"audio"===i?(d._audio_added_=!0,void 0!==o&&(d._audioSSRC=o),void 0!==s&&(d._cname=s),c&&(d._audioOrtc=c)):(d._video_added_=!0,void 0!==o&&(d._videoSSRC=o),void 0!==s&&(d._cname=s),void 0!==l&&(d._rtxSsrcId=l),c&&(d._videoOrtc=c)),("audio"===i?d.hasAudio:d.hasVideo)&&!u&&(_.info("[".concat(this._clientId,"] remote user ").concat(d.uid," published ").concat(i)),this.safeEmit(Ae.USER_PUBLISHED,d,i)),"video"===i?ne.onGatewayStream(this._sessionId,Yn.ON_ADD_VIDEO_STREAM,kt.ON_ADD_VIDEO_STREAM,{peer:a||r,ssrc:d._videoSSRC}):ne.onGatewayStream(this._sessionId,Yn.ON_ADD_AUDIO_STREAM,kt.ON_ADD_AUDIO_STREAM,{peer:a||r,ssrc:d._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(d,i,o).then(h=>{if(h&&(_.debug("[".concat(this._clientId,"] resubscribe ").concat(i," for user ").concat(d.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof yC))return this._p2pChannel.unsubscribe(d,i,!0).then(()=>this._subscribe(d,i,!0).catch(p=>{_.error("[".concat(this._clientId,"] resubscribe error"),p.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(d,i)&&(_.debug("[".concat(this._clientId,"] resubscribe ").concat(i," for user ").concat(d.uid," after reconnect.")),this._subscribe(d,i,!0).catch(h=>{_.error("[".concat(this._clientId,"] resubscribe error"),h.toString())}))}),y(this,"_handleRemoveStream",i=>{if(R("BLOCK_LOCAL_CLIENT")&&Ld(i.uid,this.channelName))return;const r=this._users.find(s=>s.uid===i.uid);if(!r)return void _.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));_.debug("[".concat(this._clientId,"] stream removed with uid ").concat(i.uid));let o=()=>{};r.hasAudio&&r.hasVideo?o=()=>{_.info("[".concat(this._clientId,"] remote user ").concat(r.uid," unpublished audio track")),this.safeEmit(Ae.USER_UNPUBLISHED,r,"audio"),_.info("[".concat(this._clientId,"] remote user ").concat(r.uid," unpublished video track")),this.safeEmit(Ae.USER_UNPUBLISHED,r,"video")}:r.hasVideo?o=()=>{_.info("[".concat(this._clientId,"] remote user ").concat(r.uid," unpublished video track")),this.safeEmit(Ae.USER_UNPUBLISHED,r,"video")}:r.hasAudio&&(o=()=>{_.info("[".concat(this._clientId,"] remote user ").concat(r.uid," unpublished audio track")),this.safeEmit(Ae.USER_UNPUBLISHED,r,"audio")}),r._video_pre_subscribed||r._audio_pre_subscribed||(r._trust_audio_stream_added_state_=!0,r._trust_video_stream_added_state_=!0,r._audio_added_=!1,r._video_added_=!1,this._p2pChannel instanceof yC&&this._p2pChannel.unsubscribe(r).then(s=>{if(s)return this._gateway.unsubscribe(s,r.uid)}),r._audioSSRC=void 0,r._videoSSRC=void 0,r._audioOrtc=void 0,r._videoOrtc=void 0,r._rtxSsrcId=void 0),ne.onGatewayStream(this._sessionId,Yn.ON_REMOVE_STREAM,kt.ON_REMOVE_STREAM,{peer:i.uint_id||i.uid}),o()}),y(this,"_handleSetStreamLocalEnable",(i,r,o)=>{if(R("BLOCK_LOCAL_CLIENT")&&Ld(r,this.channelName))return;const s=this._users.find(l=>l.uid===r);if(!s)return void _.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));_.debug("[".concat(this._clientId,"] local ").concat(i," ").concat(o?"enabled":"disabled"," with uid ").concat(r));const a="audio"===i?s.hasAudio:s.hasVideo;if("audio"===i){s._trust_audio_enabled_state_=!0;const l=s._audio_enabled_;if(s._audio_enabled_=o,s._audio_enabled_===l)return;{const d=s._audio_enabled_?"enable-local-audio":"disable-local-audio";_.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(r,", msg: ").concat(d)),this.safeEmit(Ae.USER_INFO_UPDATED,r,d)}}else{s._trust_video_enabled_state_=!0;const l=s._video_enabled_;if(s._video_enabled_=o,s._video_enabled_===l)return;{const d=s._video_enabled_?"enable-local-video":"disable-local-video";_.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(r,", msg: ").concat(d)),this.safeEmit(Ae.USER_INFO_UPDATED,r,d)}}const c="audio"===i?s.hasAudio:s.hasVideo;return a!==c?!a&&c?(_.info("[".concat(this._clientId,"] remote user ").concat(r," published ").concat(i)),void this.safeEmit(Ae.USER_PUBLISHED,s,i)):("video"===i&&s._videoTrack&&s._videoTrack._destroy(),this._p2pChannel.muteRemote(s,i),_.info("[".concat(this._clientId,"] remote user ").concat(r," unpublished ").concat(i)),void this.safeEmit(Ae.USER_UNPUBLISHED,s,i)):void 0}),y(this,"_handleMuteStream",(i,r,o)=>{if(R("BLOCK_LOCAL_CLIENT")&&Ld(i,this.channelName))return;_.debug("[".concat(this._clientId,"] receive mute message"),i,r,o);const s=this._users.find(l=>l.uid===i);if(!s)return void _.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(i));const a="audio"===r?s.hasAudio:s.hasVideo;if("audio"===r){s._trust_audio_mute_state_=!0;const l=s._audio_muted_;if(s._audio_muted_=o,s._audio_muted_===l)return;{const d=s._audio_muted_?"mute-audio":"unmute-audio";_.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(i,", msg: ").concat(d)),this.safeEmit(Ae.USER_INFO_UPDATED,i,d)}}else{s._trust_video_mute_state_=!0;const l=s._video_muted_;if(s._video_muted_=o,s._video_muted_===l)return;{const d=s._video_muted_?"mute-video":"unmute-video";_.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(i,", msg: ").concat(d)),this.safeEmit(Ae.USER_INFO_UPDATED,i,d)}}const c="audio"===r?s.hasAudio:s.hasVideo;if(a!==c){if(!a&&c)return("audio"===r?s._audioSSRC:s._videoSSRC)?(_.info("[".concat(this._clientId,"] remote user ").concat(i," published ").concat(r)),void this.safeEmit(Ae.USER_PUBLISHED,s,r)):void _.warning("[".concat(this._clientId,"] remote user ").concat(i," receive ").concat(r," unmute message  before add stream message, ").concat(r," SSRC doesn't exist yet."));"video"===r&&s._videoTrack&&!s._video_pre_subscribed&&s._videoTrack._destroy(),this._p2pChannel.muteRemote(s,r),_.info("[".concat(this._clientId,"] remote user ").concat(i," unpublished ").concat(r)),this.safeEmit(Ae.USER_UNPUBLISHED,s,r)}}),y(this,"_handleP2PLost",function(){var i=C(function*(r){_.debug("[".concat(t._clientId,"] receive p2p lost"),r),parseInt(r.p2pid,10)===t.store.p2pId?yield t._p2pChannel.requestReconnect():_.warning("[".concat(t._clientId,"] P2PLost stream not found"),r)});return function(r){return i.apply(this,arguments)}}()),y(this,"_handleTokenWillExpire",()=>{_.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Ae.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),y(this,"_handleBeforeUnload",i=>{"beforeunload"===i.type&&void 0!==i.returnValue&&""!==i.returnValue||(this.leave(),_.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),y(this,"_handleUpdateNetworkQuality",()=>{if("normal"===this._networkQualitySensitivity)return;if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void this.safeEmit(Ae.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const i={downlinkNetworkQuality:0,uplinkNetworkQuality:0};i.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),i.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Ae.NETWORK_QUALITY,i)}),y(this,"_handleP2PAddAudioOrVideoStream",(i,r,o,s)=>{const a=this._users.find(l=>l.uid===r);if(!a)return void _.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));_.debug("[".concat(this._clientId,"] stream added with uid ").concat(r,", type ").concat(i)),this.store.subscribe(a.uid,i,void 0,void 0,void 0,Date.now());const c="audio"===i?a.hasAudio:a.hasVideo;"audio"===i?a._trust_audio_stream_added_state_=!0:a._trust_video_stream_added_state_=!0,"audio"===i?(a._audio_added_=!0,void 0!==o&&(a._audioSSRC=o),void 0!==s&&(a._audioMid=s)):(a._video_added_=!0,void 0!==o&&(a._videoSSRC=o),void 0!==s&&(a._videoMid=s)),("audio"===i?a.hasAudio:a.hasVideo)&&!c&&(_.info("[".concat(this._clientId,"] remote user ").concat(a.uid," published ").concat(i)),this.safeEmit(Ae.USER_PUBLISHED,a,i)),this._p2pChannel.hasPendingRemoteMedia(a,i)&&(_.debug("[".concat(this._clientId,"] resubscribe ").concat(i," for user ").concat(a.uid," after reconnect.")),this._subscribe(a,i,!0).catch(l=>{_.error("[".concat(this._clientId,"] resubscribe error"),l.toString())}))}),this._config=e,this._clientId=gt(5,"client-"),this.store=new Ike(e.codec,e.audioCodec,e.mode,this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),_.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(No," build: ").concat(dP,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),e.clientRoleOptions)try{pK(e.clientRoleOptions),n=Object.assign({},e.clientRoleOptions)}catch(i){_.warning("[".concat(this._clientId,"] ").concat(i.toString()))}this._statsCollector=new c_(this.store),this._statsCollector.onStatsException=(i,r,o)=>{_.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(i,", msg: ").concat(r,", uid: ").concat(o)),this.safeEmit(Ae.EXCEPTION,{code:i,msg:r,uid:o})},this._statsCollector.onUploadPublishDuration=(i,r,o,s)=>{const a=this._users.find(c=>c.uid===i);a&&ne.peerPublishStatus(this._sessionId,{subscribeElapse:s,audioPublishDuration:r,videoPublishDuration:o,peer:a._uintid})},this.store.useP2P="p2p"===e.mode,this._gateway=new nFe(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:e.websocketRetryConfig||vn,httpRetryConfig:e.httpRetryConfig||vn,forceWaitGatewayResponse:void 0===e.forceWaitGatewayResponse||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:n}),this._configDistribute=new hFe,this.store.useP2P?(this._p2pChannel=new Lr(this.store,this._statsCollector),this._handleP2PEvents()):this._p2pChannel=new yC(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}joinMeta(e,t,n,i,r){var o=arguments,s=this;return C(function*(){let a=!(o.length>5&&void 0!==o[5])||o[5],c=o.length>6&&void 0!==o[6]&&o[6];st("JOIN_GATEWAY_USE_443PORT_ONLY",a),st("JOIN_GATEWAY_USE_DUAL_DOMAIN",c);const l=s._gateway.signal.websocket;return l instanceof CP&&(l.use443PortOnly=a,l.tryDoubleDomain=c),(d=C(function*(u,h,p){CS.get(u)||CS.set(u,[]),TS.get(u)||TS.set(u,h),Ta.get(u)||Ta.set(u,0);const m=CS.get(u),f=TS.get(u);if(!m||!f)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(Ta.get(u)===f){const I=Bg();m.push(I),yield I.promise}Ta.set(u,Ta.get(u)+1);for(var g=arguments.length,E=new Array(g>3?g-3:0),b=3;b<g;b++)E[b-3]=arguments[b];const T=yield p(...E);return Ta.set(u,Ta.get(u)-1),Ta.get(u)===f-1&&m.length>0&&(m[0].resolve(),m.shift()),0===Ta.get(u)&&(CS.set(u,[]),TS.set(u,0),Ta.set(u,0)),T}),function(u,h,p){return d.apply(this,arguments)})("client.join",R("JOIN_MAX_CONCURRENCY"),s.join.bind(s),e,t,n,i,r);var d})()}join(e,t,n,i,r){var o=this;return C(function*(){const s=++o._numberOfJoinCount;o.store.joinStart(),i&&(o.store.uid=i);const a="HTTPS"===(MS||MS||(MS=(window.location.protocol.split(":")[0]||"").toUpperCase(),MS)),c=TK()?window.isSecureContext:"Browser Not Support";(!TK()&&!a||!window.isSecureContext)&&_.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser"),"DISCONNECTED"===o.connectionState&&(o.store.avoidJoinStart=Math.round(Date.now()),_.debug("[".concat(o._clientId,"] set avoidJoinStart to ").concat(o.store.avoidJoinStart))),ne.setAppId(e);try{if(!n&&null!==n)throw new N(S.INVALID_PARAMS,"Invalid token: ".concat(n,". If you don not use token, set it to null"));n&&Kn(n,"token",1,2047),Kn(e,"appid",1,2047),US(t),i&&VS(i),r&&Kn(r,"optionalInfo",1,2047)}catch(g){throw ne.reportApiInvoke(up(),{name:Cn.JOIN,options:[e,t,n,i],states:{isHttps:a,isSecureContext:c},tag:jt.TRACER}).onError(g),g}if(o._leaveMutex.isLocked&&(_.debug("[".concat(o._clientId,"] join: waiting leave operation")),(yield o._leaveMutex.lock())(),_.debug("[".concat(o._clientId,"] join: continue"))),o._joinAndNotLeaveYet=!0,"DISCONNECTED"!==o.connectionState){const g=new N(S.INVALID_OPERATION,"[".concat(o._clientId,"] Client already in connecting/connected state"));throw ne.reportApiInvoke(up(),{name:Cn.JOIN,options:[e,t,n,i],states:{isHttps:a,isSecureContext:c},tag:jt.TRACER}).onError(g),g}o._gateway.state="CONNECTING";const l=yield dZ({appId:e,cname:t,uid:i,stringUid:"string"==typeof i?i:void 0,token:n||e,cloudProxyServer:o._cloudProxyServerMode});if(!o._joinAndNotLeaveYet)throw new N(S.INVALID_OPERATION,"[".concat(o._clientId,"] Client already left"));const d=l?.sid||up();_.info("[".concat(o._clientId,"] start join channel ").concat(t,", join number: ").concat(s)),o._sessionId||(o._sessionId=d,o.store.sessionId=o._sessionId);const u=ne.reportApiInvoke(d,{name:Cn.JOIN,options:[e,t,n,i],states:{isHttps:a,isSecureContext:c},tag:jt.TRACER}),h=hs(hs(hs({},o._rtmConfig),{},{clientId:o._clientId,appId:e,sid:o._sessionId,cname:t,uid:"string"!=typeof i?i:null,turnServer:o._turnServer,proxyServer:o._proxyServer,token:n||e,cloudProxyServer:o._cloudProxyServerMode,optionalInfo:r,license:o._license,useLocalAccessPoint:o._useLocalAccessPoint,preload:!!l},void 0!==o._remoteDefaultVideoStreamType&&{defaultVideoStream:o._remoteDefaultVideoStreamType}),{},{apRequestDetail:R("AP_REQUEST_DETAIL")||void 0});if(o._useLocalAccessPoint&&(h.setLocalAPVersion=o._setLocalAPVersion),"string"==typeof i&&(h.stringUid=i,o._uintUid?(h.uid=o._uintUid,o._uintUid=void 0):h.uid=0),"none"!==o._encryptionMode&&o._encryptionSecret){if(h.aesmode=o._encryptionMode,h.aespassword=yield(g=C(function*(E){const b=function(O){const k=window.atob("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),L=new Uint8Array(new ArrayBuffer(k.length));for(let V=0;V<k.length;V+=1)L[V]=k.charCodeAt(V);return L}(),T=yield window.crypto.subtle.importKey("spki",b,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),I=eP(E),D=yield window.crypto.subtle.encrypt({name:"RSA-OAEP"},T,I);return function(O){let k="";for(let L=0;L<O.length;L+=1)k+=String.fromCharCode(O[L]);return window.btoa(k)}(new Uint8Array(D))}),function(E){return g.apply(this,arguments)})(o._encryptionSecret),!o._joinAndNotLeaveYet)throw new N(S.INVALID_OPERATION,"[".concat(o._clientId,"] Client already left"));o._encryptionSalt&&(h.aessalt=o._encryptionSalt)}var g,b;if(o._encryptDataStream&&("aes-128-gcm2"===o._encryptionMode||"aes-256-gcm2"===o._encryptionMode))if(o._encryptionSalt&&o._encryptionSecret)if(window.crypto.subtle){const g=new TextEncoder,E=R("USE_PURE_ENCRYPTION_MASTER_KEY")?g.encode(h.appId+o._encryptionSecret+o._encryptionSecret):g.encode(h.appId+h.cname+o._encryptionSecret);o._encryptDataStreamIv=yield(b=C(function*(T,I,D){const O=yield window.crypto.subtle.importKey("raw",I,"PBKDF2",!1,["deriveBits","deriveKey"]),k="aes-128-gcm2"===T?128:256,L=yield window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:1e3,hash:"SHA-256",salt:D},O,k+96);return new Uint8Array(L).subarray(k/8)}),function(T,I,D){return b.apply(this,arguments)})(o._encryptionMode,E,Md(o._encryptionSalt)),o._encryptDataStreamKey=yield function(){var b=C(function*(T,I,D){const O=yield window.crypto.subtle.importKey("raw",I,"PBKDF2",!1,["deriveBits","deriveKey"]),k="aes-128-gcm2"===T?128:256;return yield window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:1e3,hash:"SHA-256",salt:D},O,{name:"AES-GCM",length:k},!0,["encrypt","decrypt"])});return function(T,I,D){return b.apply(this,arguments)}}()(o._encryptionMode,E,Md(o._encryptionSalt))}else _.warning("[".concat(o._clientId,c?"] encrypt datastream must be running in a secure context, fallback to plain data stream":"] current browser do not support WebCrypto ,fallback to plain data stream")),o._encryptDataStream=!1;else o._encryptDataStream=!1,_.debug("[".concat(o._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));o._startSession(o._sessionId,{channel:t,appId:e,stringUid:h.stringUid});const p=o._sessionId;setTimeout(()=>{"CONNECTING"===o.connectionState&&p===o._sessionId&&ne.joinChannelTimeout(o._sessionId,5)},5e3);try{var m;let g;const E=h.cloudProxyServer;if(Y(m=["proxy3","proxy4","proxy5"]).call(m,E)){const O=R("PROXY_SERVER_TYPE3");h.proxyServer=Array.isArray(O)?O[0]:O}if(ne.setProxyServer(h.proxyServer),_.setProxyServer(h.proxyServer),o.store.requestAPStart(),l){if(_.debug("[".concat(o._clientId,"] get serverInfo Success from Preload Cache ").concat(h.stringUid?", ".concat(h.stringUid," => ").concat(l.intUid):""," ")),h.stringUid&&!h.uid&&(h.uid=l.intUid),g={gatewayInfo:l.ap.gatewayInfo},R("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&"auto"===h.turnServer.mode)if(0===l.ap.proxyInfo.addresses.length)_.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const O=(yield JK(l.ap.proxyInfo,l.ap.gatewayInfo.uid)).map(k=>({turnServerURL:k.address,tcpport:k.tcpport||ii.tcpport,udpport:k.udpport||ii.udpport,username:k.username||ii.username,password:k.password||ii.password,forceturn:!1,security:!0}));h.turnServer={mode:"manual",servers:O}}pZ(l,h.stringUid)}else{if(h.stringUid&&!h.uid){let O;[O,g]=yield q.all([eX(h.stringUid,h,o._axiosCancelSource.token,o._config.httpRetryConfig||vn,o.store),Q$(h,o._axiosCancelSource.token,o._config.httpRetryConfig||vn,!0,o.store)]),_.debug("[".concat(o._clientId,"] getUserAccount Success ").concat(h.stringUid," => ").concat(O)),h.uid=O,g.gatewayInfo.uid=O,g.gatewayInfo.res.uid=O}else g=yield Q$(h,o._axiosCancelSource.token,o._config.httpRetryConfig||vn,!0,o.store);if(!o._joinAndNotLeaveYet)throw new N(S.INVALID_OPERATION,"[".concat(o._clientId,"] Client already left"))}o.store.requestAPEnd(),setTimeout(()=>{o._configDistribute.startGetConfigDistribute(h,o._axiosCancelSource.token),o._configDistribute.on(yP.UPDATE_BITRATE_LIMIT,O=>{o._p2pChannel.updateBitrateLimit(O)})},0),o._key=n||e;const b=g.gatewayInfo,T=h.uid?h.uid:b.uid;o._joinInfo=hs(hs({},h),{},{cid:b.cid,uid:T,vid:b.vid,apResponse:b.res,apGatewayAddress:b.apGatewayAddress,uni_lbs_ip:b.uni_lbs_ip,gatewayAddrs:b.gatewayAddrs}),o.store.intUid=T;const I=yield o._joinGateway();if(!o._joinAndNotLeaveYet)throw new N(S.INVALID_OPERATION,"[".concat(o._clientId,"] Client already left"));u.onSuccess(I),o._appId=e,o._channelName=h.cname,o._uid=I,o.store.uid=I,setTimeout(()=>{o._networkQualityInterval&&window.clearInterval(o._networkQualityInterval),o._networkQualityInterval=window.setInterval(o._handleUpdateNetworkQuality,2e3),window.addEventListener(ei()?"beforeunload":"pagehide",o._handleBeforeUnload),o._statsCollector.startUpdateStats()},0);const D=h.stringUid?"string uid: ".concat(h.stringUid,",uid: ").concat(h.uid):"uid: ".concat(o._uid);return _.info("[".concat(o._clientId,"] Joining channel success: channel: ").concat(t,",").concat(D)),setTimeout(()=>{_.startUpload()},5e3),o.store.joinEnd(),f=o,Y(kd).call(kd,f)||kd.push(f),"disabled"===o._cloudProxyServerMode&&Fe().supportWebCrypto&&R("ENABLE_PRELOAD")&&n1(o._joinInfo),I}catch(g){const E=Array.isArray(g)?g[0]:g;throw E&&E.code===S.OPERATION_ABORTED?_.warning("[".concat(o._clientId,"] join number: ").concat(s,", Joining channel failed, rollback"),E):_.error("[".concat(o._clientId,"] join number: ").concat(s,", Joining channel failed, rollback"),E),E.code!==S.OPERATION_ABORTED&&o._numberOfJoinCount===s&&(o._gateway.state="DISCONNECTED",o._reset()),u.onError(E),E}var f})()}_joinGateway(){if(!this._joinInfo||!this._key)throw new N(S.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!("disabled"!==this._joinInfo.cloudProxyServer||this._joinInfo.proxyServer||!R("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}leave(){var e=this;return C(function*(){_.info("[".concat(e._clientId,"] Leaving channel")),window.removeEventListener(ei()?"beforeunload":"pagehide",e._handleBeforeUnload),e._reset(),function(n){const i=kd.indexOf(n);-1!==i&&kd.splice(i,1)}(e),e._statsCollector.stopUpdateStats();const t=yield e._leaveMutex.lock();if("DISCONNECTED"===e.connectionState)return _.info("[".concat(e._clientId,"] Leaving channel repeated, success")),void t();yield e._gateway.leave("CONNECTED"!==e.connectionState),_.info("[".concat(e._clientId,"] Leaving channel success")),e._joinAndNotLeaveYet=!1,e.store.resetJoinChannelServiceRecords(),t()})()}publish(e){var t=arguments,n=this;return C(function*(){let i=!(t.length>1&&void 0!==t[1])||t[1];if(!Array.isArray(e)){if(!(e instanceof Np))return n._publishDataChannel(e);e=[e]}if(0===e.length)throw new N(S.INVALID_PARAMS,"param list is empty");const r=e;if("audience"===n._gateway.role)throw new N(S.INVALID_OPERATION,"audience can not publish stream");for(const s of r){if(!(s instanceof Np))throw new N(S.INVALID_PARAMS,"parameter is not local track");if(!s._enabled&&i)throw new N(S.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(s.getTrackId()))}_.info("[".concat(n._clientId,"] Publishing tracks, id ").concat(r.map(s=>"".concat(s.getTrackId()," "))));const o=yield n._publishMutex.lock();yield n._configDistribute.awaitConfigDistributeComplete(),i&&r.forEach(s=>{const a=n._configDistribute.getBitrateLimit();s instanceof yt&&a&&s.setBitrateLimit(a.uplink)});try{yield n._publishHighStream(r),_.info("[".concat(n._clientId,"] Publish success, id ").concat(r.map(s=>"".concat(s.getTrackId()," "))))}catch(s){throw _.error("[".concat(n._clientId,"] publish error"),s.toString()),s}finally{o()}})()}_publishDataChannel(e){var t=this;return C(function*(){ot(e.id,"id",0,65535,!0),hc(e.ordered,"ordered"),Kn(e.metadata,"metadata",0,512),_.info("[".concat(t._clientId,"] Publishing datachannels, id ").concat(e.id));const n=yield t._publishMutex.lock();try{if(-1!==t._p2pChannel.getAllDataChannels().findIndex(o=>o.id===e.id))throw new N(S.INVALID_PARAMS,"Invalid id: ".concat(e.id,". If you want to republish the datachannel, unpublish first"));if(!t._joinInfo||void 0===t._uid)throw new N(S.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if("CONNECTED"!==t.connectionState&&"RECONNECTING"!==t.connectionState)throw new N(S.INVALID_OPERATION,"can not publish datachannel in ".concat(t.connectionState," state"));if("auto"===t._turnServer.mode&&R("FORCE_TURN")&&!R("TURN_ENABLE_TCP")&&!R("TURN_ENABLE_UDP"))throw new N(S.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const i=nZ(o=e,!1),r=yield t._p2pChannel.publishDataChannel([i]);if(r.length>0){if("number"!=typeof i._originDataChannelId)throw _.error("[".concat(t._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new N(S.CREATE_DATACHANNEL_ERROR);try{yield q.all(r.map(o=>t._uid&&t._gateway.publishDataChannel(t._uid,o,!0))),yield i._waitTillOpen()}catch(o){if(o.code!==S.DISCONNECT_P2P)throw o}}return _.info("[".concat(t._clientId,"] Publish dataChannels success, id ").concat(i.id)),i}catch(i){throw _.error("[".concat(t._clientId,"] publish datachannels error"),i.toString()),i}finally{n()}var o})()}unpublish(e){var t=this;return C(function*(){if(!t._joinInfo||void 0===t._uid)throw new N(S.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let n=[];if(e)if(Array.isArray(e))n=e;else{if(!(e instanceof Np))return t._unpublishDataChannel([e]);n=[e]}else t.store.useP2P||(yield t._unpublishDataChannel()),n=t._p2pChannel.getAllTracks(!0);_.info("[".concat(t._clientId,"] Unpublish tracks, tracks ").concat(n.map(r=>"".concat(r.getTrackId()," "))," "));const i=yield t._publishMutex.lock();try{if(t._p2pChannel instanceof Lr){const r=yield t._p2pChannel.unpublish(n);r&&(yield t._gateway.sendExtensionMessage(Qt.UNPUBLISH,{unpubMsg:r},!0))}else{const r=yield t._p2pChannel.unpublish(n);r&&(yield t._gateway.unpublish(r,t._uid)),_.info("[".concat(t._clientId,"] Unpublish success,tracks ").concat(n.map(o=>"".concat(o.getTrackId()))))}}catch(r){throw _.error("[".concat(t._clientId,"] unpublish error"),r.toString()),r}finally{i&&i()}})()}_unpublishDataChannel(e){var t=this;return C(function*(){void 0!==e&&0!==e.length||(e=t._p2pChannel.getAllDataChannels()),_.info("[".concat(t._clientId,"] Unpublish datachannels, datachannels ").concat(e.map(i=>"".concat(i.id," "))," "));const n=yield t._publishMutex.lock();try{const i=yield t._p2pChannel.unpublishDataChannel(e);i&&(yield t._gateway.unpublishDataChannel(i)),_.info("[".concat(t._clientId,"] Unpublish dataChannel success,dataChannel ").concat(e.map(r=>"".concat(r.id))))}catch(i){throw _.error("[".concat(t._clientId,"] unpublish dataChannel error"),i.toString()),i}finally{n&&n()}})()}subscribe(e,t,n){var i=this;return C(function*(){if(!(e instanceof Il)){const r=i.remoteUsers.find(o=>o.uid===e);if(!r)throw new N(S.INVALID_REMOTE_USER,"user is not in the channel");e=r}return"datachannel"===t?i._subscribeDataChannel(e,n):i._subscribe(e,t)})()}presubscribe(e,t){var n=this;return C(function*(){if(Mn(t,"mediaType",["audio","video"]),n._p2pChannel instanceof Lr)throw new N(S.INVALID_OPERATION,"can't presub at p2p mode");if(!n._joinInfo)throw new N(S.INVALID_OPERATION,"can't presub when not join");if("CONNECTED"!==n.connectionState&&"RECONNECTING"!==n.connectionState)throw new N(S.INVALID_OPERATION,"can't presub in ".concat(n.connectionState," state"));const i=t===ie.AUDIO,r=t===ie.VIDEO,o=yield n._subscribeMutex.lock();try{const{ssrcId:s,ortc:a,rtxSsrcId:c,cname:l,uint_id:d}=yield n._gateway.presubscribe(e,t,!0);if(null==s)throw new N(S.UNEXPECTED_RESPONSE,"no ssrc id");let u=n._users.find(p=>p.uid===e);u||(u=new Il(e,d||e),u._is_pre_created=!0,n._users.push(u)),l&&(u._cname=l),u._uintid||(u._uintid=d||e),i&&(u._audioSSRC=s,u._audio_pre_subscribed=!0,a&&(u._audioOrtc=a)),r&&(u._videoSSRC=s,u._video_pre_subscribed=!0,a&&(u._videoOrtc=a),null!=c&&(u._rtxSsrcId=c)),_.info("[".concat(n._clientId,"] presub succeed ssrc: ").concat(s)),yield n._p2pChannel.subscribe(u,t,s,c,a);const h=i?u._audioTrack:u._videoTrack;if(!h)throw new N(S.UNEXPECTED_ERROR,"can not find remote track in user");return i&&(u._trust_audio_stream_added_state_=!0,u._audio_added_=!0),r&&(u._trust_video_stream_added_state_=!0,u._video_added_=!0),h}catch(s){throw _.error("[".concat(n._clientId,"] presub user ").concat(e," error"),s),s}finally{o()}})()}_subscribeDataChannel(e,t){var n=this;return C(function*(){var i;if(ot(t,"channelId",0,65535,!0),!n._joinInfo)throw new N(S.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if("CONNECTED"!==n.connectionState&&"RECONNECTING"!==n.connectionState)throw new N(S.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(n.connectionState," state"));if(!n._users.find(c=>c===e))throw _.error("[".concat(n._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),new N(S.INVALID_REMOTE_USER,"user is not in the channel");if(!e.hasAudio&&!e.hasVideo&&0===e._dataChannels.length)throw _.error("[".concat(n._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),new N(S.INVALID_REMOTE_USER,"user is not published");const o=null===(i=e._dataChannels)||void 0===i?void 0:i.find(c=>c.id===t);if(!o)throw _.error("[".concat(n._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, remote datachannel is not published")),new N(S.REMOTE_USER_IS_NOT_PUBLISHED);const s=yield n._subscribeMutex.lock();_.info("[".concat(n._clientId,"] subscribe user ").concat(e.uid,", mediaType: datachannel"));try{const c=yield n._p2pChannel.subscribeDataChannel(e,[o]);if(c&&Y(c).call(c,o.id))try{var a;if("number"!=typeof o._originDataChannelId)throw _.error("[".concat(n._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, cannot get RTCDatachannel")),new N(S.CREATE_DATACHANNEL_ERROR);const l={id:o.id,datachannelId:o._originDataChannelId,ordered:o.ordered,maxRetransmits:o.maxRetransmits,metadata:null!==(a=o.metadata)&&void 0!==a?a:""};yield n._gateway.subscribeDataChannel(e.uid,l,!0),yield o._waitTillOpen()}catch(l){if(l?.code!==S.WS_ABORT)throw yield n._p2pChannel.unsubscribeDataChannel(e,[o]),l;yield n._p2pChannel.unsubscribeDataChannel(e,[o]),n._p2pChannel.setPendingRemoteDataChannel(e,o.id)}return _.info("[".concat(n._clientId,"] subscribe success user ").concat(e.uid,", mediaType: datachannel")),o}finally{s()}})()}_p2pSubscribe(e,t,n){var i=this;return C(function*(){if(Mn(t,"mediaType",["audio","video"]),!i._joinInfo)throw new N(S.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==i.connectionState&&"RECONNECTING"!==i.connectionState)throw new N(S.INVALID_OPERATION,"Can't subscribe stream in ".concat(i.connectionState," state"));if(!i._users.find(s=>s===e)){const s=new N(S.INVALID_REMOTE_USER,"user is not in the channel");throw _.error("[".concat(i._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),s}if(!e.hasAudio&&!e.hasVideo){const s=new N(S.INVALID_REMOTE_USER,"user is not published");throw _.error("[".concat(i._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),s}if(!n&&("audio"===t&&!e.hasAudio||"video"===t&&!e.hasVideo)){const s=new N(S.REMOTE_USER_IS_NOT_PUBLISHED);throw _.error("[".concat(i._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),s}const o=yield i._subscribeMutex.lock();_.info("[".concat(i._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(yield i._p2pChannel.hasRemoteMediaWithLock(e,t))yield i._p2pChannel.unmuteRemote(e,t);else try{const a="audio"===t?e._audioSSRC:e._videoSSRC,c="audio"===t?e._audioMid:e._videoMid;i.store.subscribe(e.uid,t,Date.now()),i._p2pChannel instanceof Lr&&(yield i._p2pChannel.subscribe(e,t,a,c))}catch(a){throw a}_.info("[".concat(i._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),i._defaultStreamFallbackType&&i.setStreamFallbackOption(e.uid,i._defaultStreamFallbackType).catch(a=>{_.warning("[".concat(i._clientId,"] auto set fallback failed"),a)});const s="audio"===t?e._audioTrack:e._videoTrack;if(!s)throw new N(S.UNEXPECTED_ERROR,"can not find remote track in user object");return s}catch(s){throw _.error("[".concat(i._clientId,"] subscribe user ").concat(e.uid," error"),s),s}finally{o()}})()}_subscribe(e,t,n){var i=this;return C(function*(){if(i._p2pChannel instanceof Lr)return i._p2pSubscribe(e,t);if(Mn(t,"mediaType",["audio","video"]),!i._joinInfo)throw new N(S.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==i.connectionState&&"RECONNECTING"!==i.connectionState)throw new N(S.INVALID_OPERATION,"Can't subscribe stream in ".concat(i.connectionState," state"));if(!i._users.find(d=>d===e)){const d=new N(S.INVALID_REMOTE_USER,"user is not in the channel");throw _.error("[".concat(i._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),d}if(!e.hasAudio&&!e.hasVideo){const d=new N(S.INVALID_REMOTE_USER,"user is not published");throw _.error("[".concat(i._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),d}if(!(n||("audio"!==t||e.hasAudio&&void 0!==e._audioSSRC)&&("video"!==t||e.hasVideo&&void 0!==e._videoSSRC))){const d=new N(S.REMOTE_USER_IS_NOT_PUBLISHED);throw _.error("[".concat(i._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),d}let o="audio"===t?e._audioSSRC:e._videoSSRC,s="audio"===t?e._audioOrtc:e._videoOrtc,a="video"===t?e._rtxSsrcId:void 0,c={stream_type:"audio"===t?ie.AUDIO:ie.VIDEO,ssrcId:o};const l=yield i._subscribeMutex.lock();_.info("[".concat(i._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(yield i._p2pChannel.hasRemoteMediaWithLock(e,t))yield i._p2pChannel.unmuteRemote(e,t);else try{const u="audio"===t?e._audioSSRC:e._videoSSRC;void 0!==u&&u!==o&&(o=u,s="audio"===t?e._audioOrtc:e._videoOrtc,a="video"===t?e._rtxSsrcId:void 0,c={stream_type:"audio"===t?ie.AUDIO:ie.VIDEO,ssrcId:o}),_i.markSubscribeStart(i.store.clientId,o),i.store.subscribe(e.uid,t,Date.now()),yield i._p2pChannel.subscribe(e,t,o,a,s);try{i._p2pChannel.isPreSubScribe(o)||(yield i._gateway.subscribe(e.uid,c,!0))}catch(h){if(h?.code!==S.WS_ABORT)throw yield i._p2pChannel.unsubscribe(e,t),h;yield i._p2pChannel.unsubscribe(e,t,!0),i._p2pChannel.setPendingRemoteMedia(e,t)}i.store.subscribe(e.uid,t,void 0,Date.now()),i._p2pChannel.reportSubscribeEvent(!0,null,e,t)}catch(u){throw i._p2pChannel.reportSubscribeEvent(!1,u?.code,e,t),u}_.info("[".concat(i._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),i._defaultStreamFallbackType&&i.setStreamFallbackOption(e.uid,i._defaultStreamFallbackType).catch(u=>{_.warning("[".concat(i._clientId,"] auto set fallback failed"),u)});const d="audio"===t?e._audioTrack:e._videoTrack;if(!d)throw new N(S.UNEXPECTED_ERROR,"can not find remote track in user object");return d}catch(d){throw _.error("[".concat(i._clientId,"] subscribe user ").concat(e.uid," error"),d),d}finally{l()}})()}massSubscribe(e){var t=this;return C(function*(){if(pc(e,"subscribeList"),!t._joinInfo)throw new N(S.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==t.connectionState&&"RECONNECTING"!==t.connectionState)throw new N(S.INVALID_OPERATION,"Can't subscribe stream in ".concat(t.connectionState," state"));const n=Date.now(),i=new Map,r=yield t._subscribeMutex.lock();_.info("[".concat(t._clientId,"]start massSubscribe user ").concat(e.map(c=>{let{user:l,mediaType:d}=c;return"user: ".concat(l?.uid,", mediaType: ").concat(d)}).join("; ")));const o=(e=[...e]).map(c=>{let{user:l,mediaType:d}=c;return{user:l,mediaType:d}}),s=yield t._p2pChannel.globalLock();try{var a;for(let l=e.length-1;l>=0;l--){const d=e[l],{user:u,mediaType:h}=d;if(Mn(h,"mediaType",["audio","video"]),!u){const g=new N(S.INVALID_PARAMS,"user property does not exist in subscribeList item");throw _.error("[".concat(t._clientId,"] user property does not exist in subscribeList item")),g}if(!t._users.find(g=>g===u)){const g=new N(S.INVALID_REMOTE_USER,"user is not in the channel");_.error("[".concat(t._clientId,"] can not massSubscribe ").concat(u.uid,", this user is not in the channel")),o[l].error=g,e.splice(l,1);continue}if("audio"===h&&(!u.hasAudio||void 0===u._audioSSRC)||"video"===h&&(!u.hasVideo||void 0===u._videoSSRC)){const g=new N(S.REMOTE_USER_IS_NOT_PUBLISHED);_.error("[".concat(t._clientId,"] can not subscribe ").concat(u.uid," with mediaType ").concat(h,", remote user is not published")),o[l].error=g,e.splice(l,1);continue}const m=Ln.Video|Ln.LwoVideo,f=i.get(u);if(f){if("video"===h?f&m:f&Ln.Audio){e.splice(l,1),_.warning("[".concat(t._clientId,"] repeat massSubscribe user:").concat(u.uid,", mediaType:").concat(h," twice"));continue}i.set(u,f|("video"===h?m:Ln.Audio))}else i.set(u,"video"===h?m:Ln.Audio)}for(let l=e.length-1;l>=0;l--){const d=e[l],{user:u,mediaType:h}=d,p=Ln.Video|Ln.LwoVideo;if(t._p2pChannel.hasRemoteMedia(u,h)){yield t._p2pChannel.unmuteRemoteNoLock(u,h);const m=i.get(u);i.set(u,"video"===h?m^p:m^Ln.Audio),e.splice(l,1)}}t.store.massSubscribe(e.map(l=>({userId:l.user.uid,type:l.mediaType})),n);let c=Ps(a=Array.from(i.entries())).call(a,(l,d)=>{let[u,h]=d;if(0===h)return l;const p={stream_id:u.uid,stream_type:h};return h&Ln.Audio&&(p.audio_ssrc=u._audioSSRC),h&Ln.Video&&(p.video_ssrc=u._videoSSRC),l.push(p),l},[]);try{e.length>0&&(yield t._p2pChannel.massSubscribeNoLock(e.map(d=>{let{user:u,mediaType:h}=d;return{user:u,mediaType:h,ssrcId:h===ie.VIDEO?u._videoSSRC:u._audioSSRC,rtxSsrcId:h===ie.VIDEO?u._rtxSsrcId:void 0}})));const l=new Map;if(c=c.filter(d=>d.video_ssrc&&!t._p2pChannel.isPreSubScribe(d.video_ssrc)||d.audio_ssrc&&!t._p2pChannel.isPreSubScribe(d.audio_ssrc)||!d.video_ssrc&&!d.audio_ssrc),c.length>0){const d=yield t._gateway.subscribeAll(c,!0);(d?.users||[]).forEach(u=>{let{stream_id:h,video_error_code:p,audio_error_code:m,error_code:f}=u;(p||m||f)&&l.set(h,{video_error_code:p,audio_error_code:m,error_code:f})})}if(Array.from(l.entries()).length>0){const d=[];Array.from(l.entries()).forEach(u=>{let[h,p]=u;const m=t.remoteUsers.find(f=>f.uid===h);if(m){let f;p.error_code||p.video_error_code&&p.audio_error_code?f=void 0:p.video_error_code?f=ie.VIDEO:p.audio_error_code&&(f=ie.AUDIO),d.push({user:m,mediaType:f})}}),d.length>0&&(yield t._p2pChannel.massUnsubscribeNoLock(d))}for(const d of o){const u=l.get(d.user.uid);if(u){const h=u.error_code||"audio"===d.mediaType&&u.audio_error_code||"video"===d.mediaType&&u.video_error_code;if(h){const p=qg(h);_.error("user:".concat(d.user.uid," mediaType:").concat(d.mediaType," has massSubscribe error ").concat(p.desc)),d.error=new N(S.SUBSCRIBE_FAILED,"code ".concat(h,": ").concat(p.desc))}}d.error||(d.track="video"===d.mediaType?d.user.videoTrack:d.user.audioTrack)}return t.store.massSubscribe(o.filter(d=>!d.error).map(d=>({userId:d.user.uid,type:d.mediaType})),void 0,Date.now()),o.forEach(d=>{var u;ne.subscribe(t.store.sessionId,{succ:!!d.error,ec:(null===(u=d.error)||void 0===u?void 0:u.code)||null,video:d.mediaType===ie.VIDEO,audio:d.mediaType===ie.AUDIO,peerid:d.user.uid,subscribeRequestid:d.mediaType===ie.VIDEO?d.user._videoSSRC:d.user._audioSSRC,p2pid:t.store.p2pId,eventElapse:Math.floor(performance.now()-n),preSsrc:t._p2pChannel.isPreSubScribe(d.user._videoSSRC)},!0)}),_.info("[".concat(t._clientId,"] massSubscribe success ").concat(e.map(d=>{let{user:u,mediaType:h}=d;return"user: ".concat(u?.uid,", mediaType: ").concat(h)}).join("; "))),o}catch(l){throw yield t._p2pChannel.massUnsubscribeNoLock(e),l}}finally{s(),r()}})()}unsubscribe(e,t,n){var i=this;return C(function*(){if(!(e instanceof Il)){const s=i.remoteUsers.find(a=>a.uid===e);if(!s)throw new N(S.INVALID_REMOTE_USER,"user is not in the channel");e=s}if(t||i.store.useP2P){if("datachannel"===t)return i._unsubscribeDataChannel(e,n)}else yield i._unsubscribeDataChannel(e,n);if(t&&Mn(t,"mediaType",["audio","video"]),!i._joinInfo)throw new N(S.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!i._users.find(s=>s===e)){const s=new N(S.INVALID_REMOTE_USER,"user is not in the channel");throw _.error("[".concat(i._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),s}_.info("[".concat(i._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(t));const o=yield i._subscribeMutex.lock();try{if(i._p2pChannel instanceof Lr)yield i._p2pChannel.unsubscribe(e,t);else{const s=yield i._p2pChannel.unsubscribe(e,t);s&&(yield i._gateway.unsubscribe(s,e.uid)),t&&"audio"!==t||(e._audio_pre_subscribed=!1),t&&"video"!==t||(e._video_pre_subscribed=!1),e._is_pre_created&&DS(i._users,e),_.info("[".concat(i._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(t))}}catch(s){if(s.code===S.DISCONNECT_P2P)return void _.warning("disconnecting p2p, abort unsubscribe request.");throw _.error("[".concat(i._clientId,"] unsubscribe user ").concat(e.uid," error"),s.toString()),s}finally{o()}})()}_unsubscribeDataChannel(e,t){var n=this;return C(function*(){if(t&&ot(t,"id",0,65535,!0),!n._joinInfo)throw new N(S.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!n._users.find(o=>o===e)){const o=new N(S.INVALID_REMOTE_USER,"user is not in the channel");throw _.error("[".concat(n._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),o}let r;if("number"==typeof t){const o=e._dataChannels.find(s=>s.id===t);o&&(r=[o])}else r=e._dataChannels;if(void 0===r){const o=new N(S.REMOTE_USER_IS_NOT_PUBLISHED);throw _.error("[".concat(n._clientId,"] can not unsubscribe ").concat(e.uid," with channelId ").concat(t,", remote datachannel is not published")),o}_.info("[".concat(n._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(r.map(o=>o.id)));try{const o=yield n._p2pChannel.unsubscribeDataChannel(e,r);o&&(yield n._gateway.unsubscribeDataChannel(o,e.uid)),_.info("[".concat(n._clientId,"] unsubscribe datachannel success uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(o))}catch(o){if(o.code===S.DISCONNECT_P2P)return void _.warning("disconnecting p2p, abort unsubscribe request.");throw _.error("[".concat(n._clientId,"] unsubscribe user ").concat(e.uid," error"),o.toString()),o}})()}massUnsubscribe(e){var t=this;return C(function*(){if(pc(e,"unsubscribeList"),!t._joinInfo)throw new N(S.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");_.info("[".concat(t._clientId,"] start massUnsubscribe ").concat(e.map(i=>{let{user:r,mediaType:o}=i;return"user: ".concat(r?.uid,", mediaType: ").concat(o,";")}).join())),e=[...e];const n=new Map;for(let i=e.length-1;i>=0;i--){const{user:r,mediaType:o}=e[i];if(!r){const c=new N(S.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw _.error("[".concat(t._clientId,"] user property does not exist in unsubscribeList item")),c}if(Mn(o,"mediaType",["video","audio",void 0]),!t._users.find(c=>c===r)){_.warning("[".concat(t._clientId,"] can not unsubscribe ").concat(r.uid,", user is not in the channel")),e.splice(i,1);continue}const a=Ln.Video|Ln.LwoVideo;if(n.has(r)){const c=n.get(r);let l;switch(o){case"video":l=c&a;break;case"audio":l=c&Ln.Audio;break;default:l=c&(Ln.Audio|a)}if(l){_.warning("[".concat(t._clientId,"] repeat massUnsubscribe user:").concat(r.uid,",mediaType:").concat(o," twice.")),e.splice(i,1);continue}o?"audio"===o?n.set(r,c|Ln.Audio):"video"===o&&n.set(r,c|a):n.set(r,c|Ln.Audio|a)}else o?"audio"===o?n.set(r,Ln.Audio):"video"===o&&n.set(r,a):n.set(r,Ln.Audio|a)}try{const i=yield t._p2pChannel.massUnsubscribe(e);i&&(yield t._gateway.massUnsubscribe(i)),_.info("[".concat(t._clientId,"] massUnsubscribe success ").concat(e.map(r=>{let{user:o,mediaType:s}=r;return"user: ".concat(o?.uid,", mediaType: ").concat(s,";")}).join()))}catch(i){if(i.code===S.DISCONNECT_P2P)return void _.warning("[".concat(t._clientId,"] disconnecting p2p, abort unsubscribe request."));throw _.error("[".concat(t._clientId,"] massUnsubscribe error"),i.toString()),i}})()}setLowStreamParameter(e){var t=this;return C(function*(){(function(i){if(!i)throw new M(S.INVALID_PARAMS);Mt(i.width)||JN(i.width,"streamParameter.width"),Mt(i.height)||JN(i.height,"streamParameter.height"),Mt(i.framerate)||JN(i.framerate,"streamParameter.framerate"),Mt(i.bitrate)||ot(i.bitrate,"streamParameter.bitrate")})(e),(!e.width&&e.height||e.width&&!e.height)&&_.warning("[".concat(t._clientId,"] The width and height parameters take effect only when both are set")),_.info("[".concat(t._clientId,"] set low stream parameter to"),JSON.stringify(e));const n=t._configDistribute.getLowStreamConfigDistribute();if(n&&n.bitrate&&e.bitrate&&n.bitrate<e.bitrate&&(e.bitrate=n.bitrate),t._lowStreamParameter=e,t._isDualStreamEnabled)return t._p2pChannel.updateVideoStreamParameter(e,j.LocalVideoLowTrack)})()}enableDualStream(){var e=this;return C(function*(){if(!Fe().supportDualStream)throw ne.streamSwitch(e._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new N(S.NOT_SUPPORTED,"Your browser is not support dual stream");if(e._isDualStreamEnabled)throw new N(S.INVALID_OPERATION,"Dual stream is already enabled");if(e._p2pChannel.canPublishLowStream())try{yield e._publishLowStream()}catch(t){throw ne.streamSwitch(e._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),t}e._isDualStreamEnabled=!0,ne.streamSwitch(e._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),_.info("[".concat(e._clientId,"] enable dual stream"))})()}disableDualStream(){var e=this;return C(function*(){if(e._isDualStreamEnabled){if(!e._joinInfo)throw new N(S.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(e._p2pChannel.getLocalMedia(j.LocalVideoLowTrack))try{const t=yield e._p2pChannel.unpublishLowStream();t&&(yield e._gateway.unpublish(t,e._joinInfo.stringUid||e._joinInfo.uid))}catch(t){throw ne.streamSwitch(e._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),t}e._isDualStreamEnabled=!1,ne.streamSwitch(e._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),_.info("[".concat(e._clientId,"] disable dual stream"))}})()}setClientRole(e,t){var n=this;return C(function*(){if(Mn(e,"role",["audience","host"]),t&&pK(t),"rtc"===n.mode||"p2p"===n.mode)throw _.warning("[".concat(n._clientId,"]").concat(n.mode," mode can not use setClientRole")),new N(S.INVALID_OPERATION,"".concat(n.mode," mode can not use setClientRole"));if(t&&t.level&&"host"===e)throw new N(S.INVALID_OPERATION,"host mode can not set audience latency level");if("audience"===e&&n._p2pChannel.hasLocalMedia())throw new N(S.INVALID_OPERATION,"can not set client role to audience when publishing stream");yield n._gateway.setClientRole(e,t),n._config.role=e,_.info("[".concat(n._clientId,"] set client role to ").concat(e,", level: ").concat(t&&t.level))})()}getRemoteInboundOffset(){var e;const t=null===(e=this._p2pChannel.getStats())||void 0===e?void 0:e.audioSend[0];if(!t||!t.timestamp)return 0;const n=t.timestamp-Date.now();return Math.abs(n)>1e3+t.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?n:0}getNtpWallTimeInMs(){return"visible"===document.visibilityState&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(e,t){if(Kn(e,"proxyServer"),!t){if("DISCONNECTED"!==this.connectionState)throw new N(S.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new N(S.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,ne.setProxyServer(this._proxyServer),_.setProxyServer(this._proxyServer),_.info("[".concat(this._clientId,"] Set proxy server ").concat(t?"by initialize call":""," success."))}setTurnServer(e,t){if(Array.isArray(e)||(e=[e]),!t){if("DISCONNECTED"!==this.connectionState)throw new N(S.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new N(S.INVALID_OPERATION,"You have already set the proxy")}if(AS(e))return this._turnServer={servers:e,mode:"original-manual"},void _.info("[".concat(this._clientId,"] Set original turnserver ").concat(t?"by initialize call":""," success: ").concat(e.map(n=>n.urls).join(","),"."));e.forEach(n=>hK(n)),this._turnServer={servers:e,mode:"manual"},_.info("[".concat(this._clientId,"] Set turnserver ").concat(t?"by initialize call":""," success."))}setLicense(e){if("DISCONNECTED"!==this.connectionState)throw new N(S.INVALID_OPERATION,"you should set license before join channel");if(Kn(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new N(S.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,_.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){if("DISCONNECTED"!==this.connectionState)throw new N(S.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||"manual"===this._turnServer.mode||this._useLocalAccessPoint)throw new N(S.INVALID_OPERATION,"You have already set the proxy");const t=[3,4,5];let n;switch(void 0===e&&(e=3),e){case 1:case 2:throw new N(S.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:n="proxy3";break;case 4:n="proxy4";break;case 5:n="proxy5";break;default:throw new N(S.INVALID_PARAMS,"proxy server mode must be ".concat(t.join("|")))}this._cloudProxyServerMode=n,this.store.cloudProxyServerMode=n,_.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if("DISCONNECTED"!==this.connectionState)throw new N(S.INVALID_OPERATION,"Stop proxy server after leave channel");ne.setProxyServer(),_.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",_.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(e){if(!e.accessPoints)throw new N(S.INVALID_PARAMS,"accessPoints is required.");pc(e.accessPoints.serverList,"accessPoints.serverList"),Kn(e.accessPoints.domain,"accessPoints.domain");const t=(h,p)=>{ot(h,p,0,65535,!0)};let n=443;if(e.accessPoints.port&&(t(e.accessPoints.port,"accessPoints.port"),n=e.accessPoints.port),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new N(S.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");R("CLOSE_AFB_FOR_LOCAL_AP")&&(st("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),st("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const i=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,r=e.accessPoints.domain,o=e.accessPoints.serverList.map(h=>i.test(h)?"".concat(h.replace(/\./g,"-"),".").concat(r):h),s=o.map(h=>"".concat(h,":").concat(n));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,st("WEBCS_DOMAIN",s),st("WEBCS_DOMAIN_BACKUP_LIST",s),st("GATEWAY_DOMAINS",[r]),e.report&&e.report.hostname&&Array.isArray(e.report.hostname)&&e.report.hostname.length?(pc(e.report.hostname,"report.hostname"),st("EVENT_REPORT_DOMAIN",e.report.hostname[0]),st("EVENT_REPORT_BACKUP_DOMAIN",e.report.hostname[1]||e.report.hostname[0])):(st("EVENT_REPORT_DOMAIN",o[0]),st("EVENT_REPORT_BACKUP_DOMAIN",o[1]||o[0]));let a=6443;e.report&&e.report.port&&(t(e.report.port,"report.port"),a=e.report.port),st("STATS_COLLECTOR_PORT",a),st("ENABLE_EVENT_REPORT",!!e.report);let c="";e.log&&e.log.hostname&&Array.isArray(e.log.hostname)&&e.log.hostname.length?(pc(e.log.hostname,"log.hostname"),c=e.log.hostname[0]):c=o[0];let l=6444;e.log&&e.log.port&&(t(e.log.port,"log.port"),l=e.log.port),st("LOG_UPLOAD_SERVER","".concat(c,":").concat(l));let d=[];e.cds&&e.cds.hostname&&Array.isArray(e.cds.hostname)&&e.cds.hostname.length?(pc(e.cds.hostname,"cds.hostname"),d=e.cds.hostname):d=o;let u=443;e.cds&&e.cds.port&&(t(e.cds.port,"cds.port"),u=e.cds.port),st("CDS_AP",d.map(h=>"".concat(h,":").concat(u))),st("ENABLE_CONFIG_DISTRIBUTE",!!e.cds),_.info("set local access point v2 success")}setLocalAccessPoints(e,t){if(pc(e,"serverList"),Kn(t,"domain"),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new N(S.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const n=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map(i=>n.test(i)?"".concat(i.replace(/\./g,"-"),".").concat(t):i),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,st("WEBCS_DOMAIN",e),st("WEBCS_DOMAIN_BACKUP_LIST",e),st("GATEWAY_DOMAINS",[t]),st("EVENT_REPORT_DOMAIN",e[0]),st("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),st("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),_.info("[".concat(this._clientId,"] set local access point success"))}setRemoteDefaultVideoStreamType(e){var t=this;return C(function*(){if(Mn(e,"streamType",[0,1,4,5,6,7,8,9]),t._remoteDefaultVideoStreamType=e,t._joinInfo)try{yield t._gateway.setDefaultRemoteVideoStreamType(e),t._joinInfo.defaultVideoStream=t._remoteDefaultVideoStreamType}catch(n){throw _.error("[".concat(t._clientId,"] set default remote video stream type error"),n.toString()),n}else _.debug("[".concat(t._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(e))})()}setRemoteVideoStreamType(e,t){var n=this;return C(function*(){Mn(t,"streamType",[0,1,4,5,6,7,8,9]);try{yield n._gateway.setRemoteVideoStreamType(e,t),setTimeout(()=>{const i=n._users.find(r=>r.uid===e);i&&i.videoTrack&&i.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(i){throw _.error("[".concat(n._clientId,"] set remote video stream type error"),i.toString()),i}_.info("[".concat(n._clientId,"] set remote ").concat(e," video stream type to ").concat(t)),n._remoteStreamTypeCacheMap.set(e,t)})()}setStreamFallbackOption(e,t){var n=this;return C(function*(){Mn(t,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{yield n._gateway.setStreamFallbackOption(e,t)}catch(i){throw _.error("[".concat(n._clientId,"] set stream fallback option"),i.toString()),i}_.info("[".concat(n._clientId,"] set remote ").concat(e," stream fallback type to ").concat(t)),n._streamFallbackTypeCacheMap.set(e,t)})()}setEncryptionConfig(e,t,n,i){Mn(e,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"]),Kn(t,"secret");const r=["aes-128-gcm2","aes-256-gcm2"];if(Y(r).call(r,e)){if(!n||!(n instanceof Uint8Array&&32===n.length))throw new N(S.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(n)throw new N(S.INVALID_PARAMS,"current encrypt mode does not need salt");if(i){if(hc(i,"encryptDataStream"),!Y(r).call(r,e))throw new N(S.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'\"|{}\\[\\]])(?=.{8,})").test(t)||_.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      "),this._encryptionMode=e,this._encryptionSecret=t,n&&(this._encryptionSalt=gl(n))}renewToken(e){var t=this;return C(function*(){if(Kn(e,"token",1,2047),!t._key||!t._joinInfo)throw new N(S.INVALID_OPERATION,"renewToken should not be called before user join");const n=t._key;t._key=e,t._joinInfo&&(t._joinInfo.token=e);const i=yield t._renewTokenMutex.lock();try{if(R("USE_NEW_TOKEN")){_.debug("[".concat(t._clientId,"] start renew token with ticket from unilbs"));const r=yield function uFe(e,t,n){return UM.apply(this,arguments)}(t._joinInfo,t._axiosCancelSource.token,t._config.httpRetryConfig||vn);_.debug("[".concat(t._clientId,"] get ticket from unilbs success")),yield t._gateway.renewToken({token:e,ticket:r})}else _.debug("[".concat(t._clientId,"] start renew token without ticket")),yield t._gateway.renewToken({token:e});_.debug("[".concat(t._clientId,"] renewToken success"))}catch(r){throw t._key=n,t._joinInfo.token=n,_.error("[".concat(t._clientId,"] renewToken failed"),r.toString()),r}finally{i()}})()}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?_.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const e=this._p2pChannel.getAudioLevels();this.safeEmit(Ae.VOLUME_INDICATOR,e)},R("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}startLiveStreaming(e,t){var n=this;return C(function*(){if(!t){if("h264"!==n.codec)throw new N(S.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!n._p2pChannel.hasLocalMedia())throw new N(S.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(n._liveRawStreamingClient&&n._liveRawStreamingClient.hasUrl(e)||n._liveTranscodeStreamingClient&&n._liveTranscodeStreamingClient.hasUrl(e))throw new N(S.LIVE_STREAMING_TASK_CONFLICT);const i=t?Ia.TRANSCODE:Ia.RAW;return n._createLiveStreamingClient(i).startLiveStreamingTask(e,i)})()}setLiveTranscoding(e){return this._createLiveStreamingClient(Ia.TRANSCODE).setTranscodingConfig(e)}stopLiveStreaming(e){var t=this;return C(function*(){const n=[t._liveRawStreamingClient,t._liveTranscodeStreamingClient].filter(i=>i&&i.hasUrl(e));if(!n.length)throw new N(S.INVALID_PARAMS,"can not find live streaming url to stop");yield q.all(n.map(i=>i&&i.stopLiveStreamingTask(e)))})()}startChannelMediaRelay(e){var t=this;return C(function*(){jX(e),yield t._createChannelMediaRelayClient().startChannelMediaRelay(e)})()}updateChannelMediaRelay(e){var t=this;return C(function*(){jX(e),yield t._createChannelMediaRelayClient().updateChannelMediaRelay(e)})()}stopChannelMediaRelay(){var e=this;return C(function*(){yield e._createChannelMediaRelayClient().stopChannelMediaRelay(),e._statsCollector.onStatsChanged&&(e._statsCollector.onStatsChanged=void 0)})()}sendStreamMessage(e){var t=arguments,n=this;return C(function*(){var i;let r=!(t.length>1&&void 0!==t[1])||t[1];if(!n._joinInfo)throw new N(S.INVALID_OPERATION,"can not send data stream, not joined");if(("string"==typeof e||e instanceof Uint8Array)&&(e={payload:e}),"string"==typeof e.payload){const s=new TextEncoder;e.payload=s.encode(e.payload)}let o=!1;if(n._encryptDataStream&&n._encryptDataStreamIv&&n._encryptDataStreamKey&&window.crypto.subtle&&Y(i=["aes-128-gcm2","aes-256-gcm2"]).call(i,n._encryptionMode)&&(o=!0,e.payload=yield(s=C(function*(a,c,l){var d;const u=Ps(d=Array.from(l)).call(d,(b,T)=>b+T,0),h={serverTs:0,seq:Ake++,length:l.length,checkSum:u},p=new Uint8Array(yK(u,2)),m=new ArrayBuffer(10),f=new DataView(m);f.setUint32(0,h.serverTs),f.setUint16(4,h.seq),f.setUint16(6,h.length),f.setUint16(8,h.checkSum),l=gK(l,new Uint8Array(16-l.length%16));const E=yield window.crypto.subtle.encrypt({name:"AES-GCM",iv:a,tagLength:128,additionalData:p},c,l);return gK(new Uint8Array(m),new Uint8Array(E))}),function(a,c,l){return s.apply(this,arguments)})(n._encryptDataStreamIv,n._encryptDataStreamKey,e.payload)),new Blob([e.payload]).size>1024)throw new N(S.INVALID_PARAMS,o?"encrypted stream message out of range.":"stream message out of range.");var s;return n._gateway.signal.request(pe.DATA_STREAM,{payload:gl(e.payload),syncWithAudio:e.syncWithAudio,sendTs:Date.now()-OFe},!r)})()}sendMetadata(e){if(!this._joinInfo)throw new N(S.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new N(S.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(pe.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:gl(e)})}sendCustomReportMessage(e){var t=this;return C(function*(){if(Array.isArray(e)||(e=[e]),e.forEach(Oke),!t._joinInfo)throw new N(S.INVALID_OPERATION,"can not send custom report, not joined");yield ne.sendCustomReportMessage(t._joinInfo.sid,e)})()}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}pickSVCLayer(e,t){var n=this;return C(function*(){Mn(t.spatialLayer,"spatialLayer",[0,1,2,3]),Mn(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{yield n._gateway.pickSVCLayer(e,t)}catch(i){throw _.error("[".concat(n._clientId,"] pick SVC layer failed"),i.toString()),i}})()}setRTMConfig(e){var t=this;return C(function*(){const{apRTM:n=!1,rtmFlag:i}=e;if(hc(n,"apRTM"),ot(i,"rtmFlag",0),t._rtmConfig.apRTM=n,t._rtmConfig.rtmFlag=i,_.debug("[".concat(t._clientId,"] setRTMconfig ").concat(JSON.stringify(e)," in ").concat(t.connectionState," state")),("CONNECTED"===t.connectionState||"RECONNECTING"===t.connectionState)&&t._joinInfo)return t._joinInfo.apRTM=n,t._joinInfo.rtmFlag=i,t._gateway.setRTM2Flag(i)})()}_reset(){if(_.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=nr.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&hZ(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&ne.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy(),e._dataChannels&&(e._dataChannels.forEach(t=>t._close()),e._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),"fallback"===this._cloudProxyServerMode&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new mi("client-publish"),this._subscribeMutex=new mi("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(e,t){var n;const i=e||up();_.debug(e?"[".concat(this._clientId,"] new Session ").concat(i):"[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(i));const r=e?"":this._sessionId||"";this._sessionId=i,this.store.sessionId=i,ne.addSid(i);const o={lts:(new Date).getTime(),mode:this.mode,buildFormat:2,stringUid:t?.stringUid||(null===(n=this._joinInfo)||void 0===n?void 0:n.stringUid),channelProfile:"live"===this.mode?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:r,clientRole:"audience"===this.role?2:1};ne.sessionInit(this._sessionId,hs({cname:t.channel,appid:t.appId},o)),this._joinInfo&&(this._joinInfo.sid=i),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=i)}_publishHighStream(e){var t=this;return C(function*(){if(!t._joinInfo||void 0===t._uid)throw new N(S.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==t.connectionState&&"RECONNECTING"!==t.connectionState)throw new N(S.INVALID_OPERATION,"can not publish stream in ".concat(t.connectionState," state"));if("auto"===t._turnServer.mode&&R("FORCE_TURN")&&!R("TURN_ENABLE_TCP")&&!R("TURN_ENABLE_UDP"))throw new N(S.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");_.debug("[".concat(t._clientId,"] publish high stream"));try{const i=yield t._p2pChannel.publish(e,t._isDualStreamEnabled,t._lowStreamParameter);if(t._p2pChannel instanceof Lr){const r=(yield i.next()).value;if(r){try{yield t._gateway.sendExtensionMessage(Qt.PUBLISH,r,!0)}catch(o){throw i.throw(o),o}yield i.next()}t._p2pChannel.reportPublishEvent(!0,null)}else{const r=(yield i.next()).value;if(r){var n;let o;try{o=yield t._gateway.publish(t._uid,r,!0)}catch(s){if(s.code!==S.DISCONNECT_P2P)throw i.throw(s),s}yield i.next((null===(n=o)||void 0===n?void 0:n.ortc)||[])}t._p2pChannel.reportPublishEvent(!0,null);for(const o of e)o instanceof yt&&o._encoderConfig&&t._gateway.setVideoProfile(o._encoderConfig),!o.muted&&o.enabled||(yield t._p2pChannel.muteLocalTrack(o))}}catch(i){if(t._p2pChannel.reportPublishEvent(!1,i?.code,e),i?.code===S.WS_ABORT)return;throw i}})()}_publishLowStream(){var e=this;return C(function*(){if(!e._joinInfo||void 0===e._uid)throw new N(S.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==e.connectionState&&"RECONNECTING"!==e.connectionState)throw new N(S.INVALID_OPERATION,"can not publish stream in ".concat(e.connectionState," state"));_.debug("[".concat(e._clientId,"] publish low stream"));const t=e._configDistribute.getLowStreamConfigDistribute();t&&t.bitrate&&(e._lowStreamParameter||(e._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),e._lowStreamParameter&&e._lowStreamParameter.bitrate&&t.bitrate<e._lowStreamParameter.bitrate&&(e._lowStreamParameter.bitrate=t.bitrate));try{const i=yield e._p2pChannel.publishLowStream(e._lowStreamParameter),r=(yield i.next()).value;if(r){var n;let o;try{o=yield e._gateway.publish(e._uid,r,!0)}catch(s){if(s.code!==S.DISCONNECT_P2P)throw i.throw(s),s}i.next((null===(n=o)||void 0===n?void 0:n.ortc)||[]),e._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(i){if(e._p2pChannel.reportPublishEvent(!1,i?.code,void 0,!0),i?.code===S.WS_ABORT)return;throw i}})()}_createLiveStreamingClient(e){const t=()=>{if(!this._joinInfo||!this._appId)return new N(S.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const n=(i={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},p_("LiveStreaming").create(i));var i;return n.onLiveStreamError=(r,o)=>{ne.reportApiInvoke(this._sessionId,{name:Cn.ON_LIVE_STREAM_ERROR,options:[r,o],tag:jt.TRACER}).onSuccess(),this.safeEmit(Ae.LIVE_STREAMING_ERROR,r,o)},n.onLiveStreamWarning=(r,o)=>{ne.reportApiInvoke(this._sessionId,{name:Cn.ON_LIVE_STREAM_WARNING,options:[r,o],tag:jt.TRACER}).onSuccess(),this.safeEmit(Ae.LIVE_STREAMING_WARNING,r,o)},n.on(bP.REQUEST_WORKER_MANAGER_LIST,(r,o,s)=>{if(!this._joinInfo)return s(new N(S.INVALID_OPERATION,"can not find join info to get worker manager"));var a;(a=C(function*(c,l,d,u){const h=R("UAP_AP").slice(0,R("AJAX_REQUEST_CONCURRENT")).map(p=>l.proxyServer?"https://".concat(l.proxyServer,"/ap/?url=").concat(p+"/api/v1?action=uap"):"https://".concat(p,"/api/v1?action=uap"));return yield function oFe(e,t,n,i,r){wM+=1;const o={sid:n.sid,command:"convergeAllocateEdge",uid:"666",appId:n.appId,ts:Math.floor(Date.now()/1e3),seq:wM,requestId:wM,version:No,cname:n.cname},s={service_name:t,json_body:JSON.stringify(o)};let a,c,l=e[0];return Fs(C(function*(){a=Date.now();const d=yield js(l,{data:s,cancelToken:i,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(c=Date.now()-a,0!==d.code){const p=new N(S.UNEXPECTED_RESPONSE,"live streaming ap error, code"+d.code,{retry:!0,responseTime:c});throw _.error(p.toString()),p}const u=JSON.parse(d.json_body);if(200!==u.code){const p=new N(S.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(u.code,", reason: ").concat(u.reason),{code:u.code,responseTime:c});throw _.error(p.toString()),p}if(!u.servers||0===u.servers.length){const p=new N(S.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:u.code,responseTime:c});throw _.error(p.toString()),p}const h=(m=t,{addressList:(p=u).servers.map(f=>"wss://".concat(f.address.replace(/\./g,"-"),".").concat(R("WORKER_DOMAIN"),":").concat(f.wss,"?serviceName=").concat(encodeURIComponent(m))),workerToken:p.workerToken,vid:p.vid});var p,m;return R("LIVE_STREAMING_ADDRESS")&&(h.addressList=R("LIVE_STREAMING_ADDRESS")instanceof Array?R("LIVE_STREAMING_ADDRESS"):[R("LIVE_STREAMING_ADDRESS")]),pC(pC({},h),{},{responseTime:c})}),(d,u)=>(ne.apworkerEvent(n.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(d.addressList),firstSuccess:0===u,responseTime:c,serverIp:e[u%e.length]}),!1),(d,u)=>(ne.apworkerEvent(n.sid,{success:!1,sc:d.data&&d.data.code||200,serviceName:t,responseTime:c,serverIp:e[u%e.length]}),!!(d.code!==S.OPERATION_ABORTED&&d.code!==S.UNEXPECTED_RESPONSE||d.data&&d.data.retry)&&(l=e[(u+1)%e.length],!0)),r)}(h,c,l,d,u)}),function(c,l,d,u){return a.apply(this,arguments)})(r,this._joinInfo,this._axiosCancelSource.token,vn).then(o).catch(s)}),n};return e===Ia.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||t(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||t(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new N(S.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:t,sendResolutionHeight:n}=this.getLocalVideoStats(),i=(e={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:t,height:n}},p_("ChannelMediaRelay").create(e));i.on("state",r=>{r===_r.RELAY_STATE_FAILURE&&i&&i.dispose(),this.safeEmit(Ae.CHANNEL_MEDIA_RELAY_STATE,r)}),i.on("event",r=>{this.safeEmit(Ae.CHANNEL_MEDIA_RELAY_EVENT,r)}),this._channelMediaRelayClient=i,this._statsCollector.onStatsChanged=(r,o)=>{var s;"resolution"===r&&(null===(s=this._channelMediaRelayClient)||void 0===s||s.setVideoProfile(o))}}var e;return this._channelMediaRelayClient}_handleUpdateDataChannel(e,t){const{added:n,deleted:i}=e,r=[];if(t){const o=[];this._users.forEach(s=>{s._dataChannels.forEach(a=>{n.every(c=>c.uid!==s._uintid||c.stream_id!==a.id)&&o.push({uid:s._uintid,stream_id:a.id,ordered:a.ordered,max_retrans_times:a.maxRetransmits,metadata:a.metadata})})}),o.length>0&&this._handleUpdateDataChannel({added:[],deleted:o})}Array.isArray(n)&&n.length>0&&n.forEach(o=>{const{uid:s,stream_id:a,ordered:c,max_retrans_times:l,metadata:d}=o,u=this._users.find(h=>h._uintid===s);if(u){if(_.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(s)),Y(r).call(r,u)||r.push(u),u._uintid||(u._uintid=s),-1===u._dataChannels.findIndex(h=>h.id===o.stream_id)){const h={id:a,ordered:!!c,maxRetransmits:l,metadata:d},p=nZ(h,!0);u._dataChannels.push(p),_.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published datachannel")),t||this.safeEmit(Ae.USER_PUBLISHED,u,"datachannel",h)}this._p2pChannel.hasPendingRemoteDataChannel(u,o.stream_id)&&(_.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(u.uid," after reconnect.")),this._subscribeDataChannel(u,o.stream_id).catch(h=>{_.error("[".concat(this._clientId,"] resubscribe datachannel error"),h.toString())}))}else _.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"))}),t&&(this.safeEmit(Ae.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(i)&&i.length>0&&i.forEach(o=>{const{uid:s}=o,c=this._users.find(d=>d._uintid===s);if(!c)return void _.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const l=c._dataChannels.find(d=>d.id===o.stream_id);l&&(_.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(s)),this._p2pChannel.unsubscribeDataChannel(c,[l]).then(d=>{if(c._dataChannels=c._dataChannels.filter(u=>u!==l),d)return this._gateway.unsubscribeDataChannel(d,c.uid)}),_.info("[".concat(this._clientId,"] remote user ").concat(s," unpublished datachannel ,id:").concat(l.id)),this.safeEmit(Ae.USER_UNPUBLISHED,c,"datachannel",l._config))})}_handleRemoveDataChannels(e){const t=this._users.find(n=>n.uid===e.uid);if(t){if(void 0!==t._dataChannels&&t._dataChannels.length>0){_.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(e.uid));const n=()=>{_.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished datachannel")),t._dataChannels.forEach(i=>{this.safeEmit(Ae.USER_UNPUBLISHED,t,"datachannel",i._config)})};this._p2pChannel.unsubscribeDataChannel(t,t._dataChannels).then(i=>{if(i)return this._gateway.unsubscribeDataChannel(i,t.uid)}),n()}}else _.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){var e=this;this._gateway.on(ri.DISCONNECT_P2P,C(function*(){yield e._p2pChannel.disconnectForReconnect()})),this._gateway.on(ri.CONNECTION_STATE_CHANGE,(t,n,i)=>{var r;if(i===Qe.FALLBACK)return;const o=()=>{this.safeEmit(Ae.CONNECTION_STATE_CHANGE,t,n,i)};if(ne.reportApiInvoke(this._sessionId||(null===(r=this._gateway.joinInfo)||void 0===r?void 0:r.sid)||null,{name:Cn.CONNECTION_STATE_CHANGE,options:[t,n,i],tag:jt.TRACER}).onSuccess(JSON.stringify({cur:t,prev:n,reason:i})),_.info("[".concat(this._clientId,"] connection state change: ").concat(n," -> ").concat(t)),"DISCONNECTED"===t)return this._reset(),void o();if("RECONNECTING"===t)this._users.forEach(a=>{a._trust_in_room_=!1,a._trust_audio_enabled_state_=!1,a._trust_video_enabled_state_=!1,a._trust_audio_mute_state_=!1,a._trust_video_mute_state_=!1,a._trust_audio_stream_added_state_=!1,a._trust_video_stream_added_state_=!1,a._is_pre_created||(a._audio_pre_subscribed||(a._audioSSRC=void 0,a._audioOrtc=void 0),a._video_pre_subscribed||(a._videoSSRC=void 0,a._videoOrtc=void 0,a._rtxSsrcId=void 0),a._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if("CONNECTED"===t){var s;this._streamFallbackTypeCacheMap.forEach((a,c)=>{this._gateway.setStreamFallbackOption(c,a).catch(l=>{_.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),l)})}),this._remoteStreamTypeCacheMap.forEach((a,c)=>{this._gateway.setRemoteVideoStreamType(c,a).catch(l=>{_.warning("[".concat(this._clientId,"] auto set remote stream type failed"),l)})}),void 0!==this._remoteDefaultVideoStreamType&&void 0===(null===(s=this._joinInfo)||void 0===s?void 0:s.defaultVideoStream)&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{_.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(a=>{_.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(a))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{"CONNECTED"===this.connectionState&&(this._userOfflineTimeout=void 0,this._users.filter(a=>!a._trust_in_room_).forEach(a=>{_.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(a.uid)),this._handleUserOffline({uid:a.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{"CONNECTED"===this.connectionState&&(this._streamRemovedTimeout=void 0,this._users.forEach(a=>{a._trust_audio_mute_state_||(_.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(a.uid)),this._handleMuteStream(a.uid,ie.AUDIO,!1)),a._trust_video_mute_state_||(_.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(a.uid)),this._handleMuteStream(a.uid,ie.VIDEO,!1)),a._trust_audio_enabled_state_||(_.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(a.uid)),this._handleSetStreamLocalEnable("audio",a.uid,!0)),a._trust_video_enabled_state_||(_.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(a.uid)),this._handleSetStreamLocalEnable("video",a.uid,!0)),a._trust_video_stream_added_state_||(_.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(a.uid)),this._handleResetAddStream(a,"video")),a._trust_audio_stream_added_state_||(_.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(a.uid)),this._handleResetAddStream(a,"audio")),a._video_added_||a._audio_added_||(_.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(a.uid)),this._handleRemoveStream({uid:a.uid,uint_id:a._uintid}))}))},1e3))}o()}),this._gateway.on(ri.REQUEST_NEW_GATEWAY_LIST,function(){var t=C(function*(n,i){if(!e._joinInfo)return i(new N(S.UNEXPECTED_ERROR,"can not recover, no join info"));try{let r;const o=yield dZ(hs(hs({},e._joinInfo),{},{uid:e._joinInfo.uid,stringUid:void 0}));o?(r=o.ap,pZ(o),e._joinInfo.preload=!0):(r=yield DM(e._joinInfo,e._axiosCancelSource.token,e._config.httpRetryConfig||vn,e.store),e._joinInfo.preload=!1),e._joinInfo&&(e._joinInfo.apResponse=r.gatewayInfo.res,e._joinInfo.gatewayAddrs=r.gatewayInfo.gatewayAddrs,e._joinInfo.uni_lbs_ip=r.gatewayInfo.uni_lbs_ip);const s=[];r.gatewayInfo.gatewayAddrs.forEach(a=>{let{address:c}=a;const[l,d]=c.split(":");s.push(e._joinInfo&&e._joinInfo.proxyServer?{proxy:e._joinInfo.proxyServer,host:l,port:d}:{host:l,port:d})}),n(s)}catch(r){i(r)}});return function(n,i){return t.apply(this,arguments)}}()),this._gateway.on(ri.NETWORK_QUALITY,t=>{"normal"===this._networkQualitySensitivity&&this.safeEmit(Ae.NETWORK_QUALITY,t)}),this._gateway.on(ri.STREAM_TYPE_CHANGE,(t,n)=>{this.safeEmit(Ae.STREAM_TYPE_CHANGED,t,n),ne.reportApiInvoke(this._sessionId,{name:Cn.STREAM_TYPE_CHANGE,options:[t,n],tag:jt.TRACER}).onSuccess(JSON.stringify({uid:t,streamType:n}))}),this._gateway.on(ri.IS_P2P_DISCONNECTED,t=>{this._p2pChannel.isP2PDisconnected()?t(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?t(!1):t(!0)}),this._gateway.on(ri.REQUEST_P2P_CONNECTION_PARAMS,function(){var t=C(function*(n,i,r){try{let o=yield e._p2pChannel.getEstablishParams();R("ENABLE_PREALLOC_PC")&&o||(o=yield e._p2pChannel.startP2PConnection(n)),i(o)}catch(o){r(o)}});return function(n,i,r){return t.apply(this,arguments)}}()),this._gateway.on(ri.JOIN_RESPONSE,(t,n)=>{if(this.store.useP2P)return;const i=F$(t.ortc,n,t.attributes.userAttributes.preSubSsrcs);this._p2pChannel.connect(i)}),this._gateway.on(ri.PRE_CONNECT_PC,function(){var t=C(function*(n){const{candidates:i,fingerprint:r}=n;if(e._joinInfo&&i.length>0&&!e._p2pChannel.isPlanB){var o;yield e._p2pChannel.startP2PConnection({turnServer:e._joinInfo.turnServer});const{cert:s,cid:a}=e._joinInfo.apResponse;yield e._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(a,"_").concat(s),icePwd:"".concat(a,"_").concat(s)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:null!==(o=R("FINGERPRINT"))&&void 0!==o?o:r}]},candidates:i,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}});return function(n){return t.apply(this,arguments)}}())}_handleGatewaySignalEvents(){var e=this;this._gateway.signal.on(Te.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(Te.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(Te.ON_ADD_AUDIO_STREAM,t=>this._handleAddAudioOrVideoStream("audio",t.uid,t.ssrcId,t.cname,t.uint_id,t.ortc)),this._gateway.signal.on(Te.ON_ADD_VIDEO_STREAM,t=>this._handleAddAudioOrVideoStream("video",t.uid,t.ssrcId,t.cname,t.uint_id,t.ortc,t.rtxSsrcId)),this._gateway.signal.on(Te.ON_REMOTE_DATASTREAM_UPDATE,t=>{this._handleUpdateDataChannel(t)}),this._gateway.signal.on(Te.ON_REMOTE_FULL_DATASTREAM_INFO,t=>{this._handleUpdateDataChannel({added:t.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(Te.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(Te.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(Te.MUTE_AUDIO,t=>this._handleMuteStream(t.uid,ie.AUDIO,!0)),this._gateway.signal.on(Te.UNMUTE_AUDIO,t=>this._handleMuteStream(t.uid,ie.AUDIO,!1)),this._gateway.signal.on(Te.MUTE_VIDEO,t=>this._handleMuteStream(t.uid,ie.VIDEO,!0)),this._gateway.signal.on(Te.UNMUTE_VIDEO,t=>this._handleMuteStream(t.uid,ie.VIDEO,!1)),this._gateway.signal.on(Te.RECEIVE_METADATA,t=>{const n=Md(t.metadata);this.safeEmit(Ae.RECEIVE_METADATA,t.uid,n)}),this._gateway.signal.on(Te.ON_DATA_STREAM,function(){var t=C(function*(n){var i;if(!n)return;let r=Md(n.payload);if(e._encryptDataStream&&e._encryptDataStreamIv&&e._encryptDataStreamKey&&window.crypto.subtle&&Y(i=["aes-128-gcm2","aes-256-gcm2"]).call(i,e._encryptionMode)){if(n.payload.length<10)throw new N(S.UNEXPECTED_RESPONSE,"payload length ".concat(n.payload.length," is less than header length ").concat(10));r=yield(a=C(function*(c,l,d){const u=d.subarray(0,10),h=u.slice(8,10),p=(h[0]<<8)+h[1],m=(u[6]<<8)+u[7],f=yield window.crypto.subtle.decrypt({name:"AES-GCM",iv:c,tagLength:128,additionalData:new Uint8Array(yK(p,2))},l,d.subarray(10));return new Uint8Array(f).subarray(0,m)}),function(c,l,d){return a.apply(this,arguments)})(e._encryptDataStreamIv,e._encryptDataStreamKey,r)}var a;let o=0;if(n.ordered||n.syncWithAudio){const s=e._p2pChannel.getStats(),a=e.remoteUsers.find(l=>l.uid===n.uid),c=s?.audioRecv.find(l=>l.ssrc===a?._audioSSRC);o=c?.jitterBufferMs}null==o&&(o=0),function PFe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(!e.syncWithAudio)return sZ(n,{uid:e.uid,payload:e.payload});const i="".concat(n.id,"-").concat(e.uid),r=YM.get(i)||[],o=r.findIndex(l=>e.sendTs>=l.sendTs),s=rZ(rZ({},e),{},{context:n,mediaDelay:t,recvTs:Date.now()});-1===o?r.push(s):r.splice(o,0,s),YM.set(i,r);let a=!1;var c;SC.has(i)?a=!(null===(c=SC.get(i))||void 0===c||!c.isSyncing):SC.set(i,{isSyncing:a,firstRecvTs:0,firstSendTs:0}),a||oZ(i)}(hs(hs({},n),{},{payload:r}),o,{id:e._clientId,onStreamMessage:"function"==typeof e.onStreamMessage?e.onStreamMessage.bind(e):void 0,safeEmit:e.safeEmit.bind(e)})});return function(n){return t.apply(this,arguments)}}()),this._gateway.signal.on(Te.ON_CRYPT_ERROR,()=>{ml(()=>{_.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Ae.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(Te.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(Te.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{_.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,Qe.TOKEN_EXPIRE),this.safeEmit(Ae.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(Te.ON_STREAM_FALLBACK_UPDATE,t=>{_.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(t.stream_id,", attr: ").concat(t.stream_type)),this.safeEmit(Ae.STREAM_FALLBACK,t.stream_id,1===t.stream_type?"fallback":"recover")}),this._gateway.signal.on(Te.ON_PUBLISH_STREAM,t=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:t.proxy})),_.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(t))))}),this._gateway.signal.on(Te.ENABLE_LOCAL_VIDEO,t=>{this._handleSetStreamLocalEnable("video",t.uid,!0)}),this._gateway.signal.on(Te.DISABLE_LOCAL_VIDEO,t=>{this._handleSetStreamLocalEnable("video",t.uid,!1)}),this._gateway.signal.on(he.REQUEST_TIMEOUT,(t,n)=>{if(this._joinInfo)switch(t){case pe.PUBLISH:{if(!n)return;const o=n.ortc;if(o){var i,r;const s=o.some(l=>{let{stream_type:d}=l;return d===$e.Audio}),a=o.some(l=>{let{stream_type:d}=l;return d!==$e.Audio}),c=o.some(l=>{let{stream_type:d}=l;return d===$e.Screen||d===$e.ScreenLow});"offer"===n.state&&ne.publish(this._joinInfo.sid,{eventElapse:_i.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:S.TIMEOUT,audio:s,video:a,p2pid:n.p2p_id,publishRequestid:this.store.pubId,screenshare:c,audioName:s?null===(i=o.find(l=>{let{stream_type:d}=l;return d===$e.Audio}))||void 0===i||null===(i=i.ssrcs[0])||void 0===i?void 0:i.ssrcId.toString():void 0,videoName:a?null===(r=o.find(l=>{let{stream_type:d}=l;return d!==$e.Audio}))||void 0===r||null===(r=r.ssrcs[0])||void 0===r?void 0:r.ssrcId.toString():void 0})}break}case pe.SUBSCRIBE:n&&ne.subscribe(this._joinInfo.sid,{succ:!1,ec:S.TIMEOUT,audio:n.stream_type===ie.AUDIO,video:n.stream_type===ie.VIDEO,peerid:n.stream_id,subscribeRequestid:n.ssrcId,p2pid:this.store.p2pId,eventElapse:_i.measureFromSubscribeStart(this.store.clientId,n.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(n.ssrcId)})}}),this._gateway.signal.on(Te.ON_P2P_OK,t=>{}),this._gateway.signal.on(Te.ON_PUBLISHED_USER_LIST,t=>{if(null==t||!t.users)return;R("BLOCK_LOCAL_CLIENT")&&(t.users=t.users.filter(r=>!Ld(r.string_id||r.stream_id,this.channelName)));const n=[],i=[];for(const r of t.users){let o=this._users.find(u=>u._uintid===r.stream_id);o?o._trust_in_room_=!0:(o=new Il(r.string_id||r.stream_id,r.stream_id),this._users.push(o),0===this.getListeners(Ae.PUBLISHED_USER_LIST).length&&(_.debug("[".concat(this._clientId,"] user online"),r.stream_id),this.safeEmit(Ae.USER_JOINED,o)));const s=Ln.Audio&r.stream_type,a=(Ln.Video|Ln.LwoVideo)&r.stream_type,c=!!(65280&r.stream_type),l=s&&o.hasAudio,d=a&&o.hasVideo;a&&(o._trust_video_stream_added_state_=!0,o._video_added_=!0,o._videoSSRC=r.video_ssrc,o._rtxSsrcId=r.video_rtx),s&&(o._trust_audio_stream_added_state_=!0,o._audio_added_=!0,o._audioSSRC=r.audio_ssrc),s&&!l&&0===this.getListeners(Ae.PUBLISHED_USER_LIST).length&&(_.info("[".concat(this._clientId,"] remote user ").concat(o.uid," published audio")),this.safeEmit(Ae.USER_PUBLISHED,o,"audio")),a&&!d&&0===this.getListeners(Ae.PUBLISHED_USER_LIST).length&&(_.info("[".concat(this._clientId,"] remote user ").concat(o.uid," published video")),this.safeEmit(Ae.USER_PUBLISHED,o,"video")),(s&&!l||a&&!d||c)&&n.push(o),a&&this._p2pChannel.hasPendingRemoteMedia(o,"video")&&i.push({user:o,mediaType:"video"}),s&&this._p2pChannel.hasPendingRemoteMedia(o,"audio")&&i.push({user:o,mediaType:"audio"})}i.length>0&&(_.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(i.map(r=>"user: ".concat(r.user.uid,", mediaType: ").concat(r.mediaType)).join("; ")," ")),this.massSubscribe(i).catch(r=>{_.error("[".concat(this._clientId,"] mass resubscribe error"),r.toString())})),this.getListeners(Ae.PUBLISHED_USER_LIST).length>0?R("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=n:(_.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(n.map(r=>r.uid).join(", "))),this.safeEmit(Ae.PUBLISHED_USER_LIST,n)):_.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(n.map(r=>r.uid).join(", ")))}),this._gateway.signal.on(Te.ON_RTP_CAPABILITY_CHANGE,t=>{const{video_codec:n}=t;this._p2pChannel instanceof yC&&this._p2pChannel.updateRemoteRTPCapabilities(n.map(i=>i.toLowerCase()).filter(i=>{var r;return Y(r=Object.keys(kS)).call(r,i)}))})}_handleP2PEvents(){var e=this;this._gateway.signal.on(Te.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(Qt.PUBLISH,(t,n,i)=>{const{uid:r}=t;t.forEach(o=>{const{kind:s,ssrcs:a,mid:c,isMuted:l}=o;this._handleP2PAddAudioOrVideoStream(s,r,a[0].ssrcId,c);const d=this._users.find(u=>u.uid===r);return d&&this._p2pChannel instanceof Lr?this._p2pChannel.mockSubscribe(d,s,a[0].ssrcId,c).then(()=>{n()}).catch(i):n(),this._handleMuteStream(r,s,!!l)})}),this._gateway.signal.on(Qt.CALL,function(){var t=C(function*(n,i,r){if(e._p2pChannel instanceof Lr)try{var o;i(yield e._p2pChannel.startP2P({turnServer:null===(o=e._joinInfo)||void 0===o?void 0:o.turnServer},n))}catch(s){r(s)}});return function(n,i,r){return t.apply(this,arguments)}}()),this._gateway.signal.on(he.P2P_CONNECTION,function(){var t=C(function*(n){e._p2pChannel instanceof Lr&&(yield e._p2pChannel.p2pConnect(n))});return function(n){return t.apply(this,arguments)}}()),this._gateway.signal.on(Qt.UNPUBLISH,function(){var t=C(function*(n,i,r){if(e._p2pChannel instanceof Lr){const{unpubMsg:o,uid:s}=n,a=e._users.find(c=>c.uid===s);if(!a)return _.warning("[".concat(e._clientId,"] can not find remote user, ignore mute event, uid: ").concat(s)),void i();try{o.forEach(function(){var c=C(function*(l){let{stream_type:d}=l;const u=d===$e.Audio?ie.AUDIO:ie.VIDEO;yield e._p2pChannel.unsubscribe(a,u),e._handleMuteStream(s,u,!0)});return function(l){return c.apply(this,arguments)}}()),i()}catch(c){r(c)}}});return function(n,i,r){return t.apply(this,arguments)}}()),this._gateway.signal.on(Qt.CONTROL,function(){var t=C(function*(n,i){const{action:r}=n;switch(r){case El.MUTE_LOCAL_VIDEO:e._handleMuteStream(i,ie.VIDEO,!0);break;case El.MUTE_LOCAL_AUDIO:e._handleMuteStream(i,ie.AUDIO,!0);break;case El.UNMUTE_LOCAL_VIDEO:e._handleP2PAddAudioOrVideoStream("video",i),e._handleMuteStream(i,ie.VIDEO,!1);break;case El.UNMUTE_LOCAL_AUDIO:e._handleP2PAddAudioOrVideoStream("audio",i),e._handleMuteStream(i,ie.AUDIO,!1)}});return function(n,i){return t.apply(this,arguments)}}()),this._gateway.signal.on(Qt.RESTART_ICE,function(){var t=C(function*(n,i,r){if(e._p2pChannel instanceof Lr)try{const{direction:o,iceParameter:s}=n;o!==Yi.SEND_ONLY||s?i(yield e._p2pChannel.restartICE(o,s)):(e._p2pChannel.handleDisconnect(o),i())}catch(o){r(o)}});return function(n,i,r){return t.apply(this,arguments)}}()),this._gateway.signal.on(Qt.CANDIDATE,t=>{if(this._p2pChannel instanceof Lr){const{candidate:n,direction:i}=t;this._p2pChannel.addRemoteCandidate(n,i)}}),this._p2pChannel.on(de.RequestP2PRestartICE,function(){var t=C(function*(n,i,r){try{const{direction:o}=n;i(yield e._gateway.sendExtensionMessage(Qt.RESTART_ICE,n,o===Yi.SEND_ONLY))}catch(o){r(o)}});return function(n,i,r){return t.apply(this,arguments)}}()),this._p2pChannel.on(de.LocalCandidate,t=>{this._gateway.sendExtensionMessage(Qt.CANDIDATE,JSON.stringify(t),!0)}),this._p2pChannel.on(de.RequestP2PMuteLocal,function(){var t=C(function*(n,i,r){try{yield e._gateway.sendExtensionMessage(Qt.CONTROL,n,!0),i()}catch(o){r(o)}});return function(n,i,r){return t.apply(this,arguments)}}()),this._p2pChannel.on(de.RequestP2PUnmuteRemote,function(){var t=C(function*(n,i,r){if(e._joinInfo)try{yield e._gateway.unmuteRemote(n,e._joinInfo.stringUid||e._joinInfo.uid),i()}catch(o){o.code===S.DISCONNECT_P2P?i():r(o)}else i()});return function(n,i,r){return t.apply(this,arguments)}}()),this._p2pChannel.on(de.RequestP2PMuteRemote,function(){var t=C(function*(n,i,r){if(e._joinInfo)try{yield e._gateway.muteRemote(n,e._joinInfo.stringUid||e._joinInfo.uid),i()}catch(o){o.code===S.DISCONNECT_P2P?i():r(o)}else i()});return function(n,i,r){return t.apply(this,arguments)}}()),this._p2pChannel.on(de.StateChange,(t,n)=>{n===Xe.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){var e=this;this._p2pChannel.on(de.RequestMuteLocal,function(){var t=C(function*(n,i,r){if(e._joinInfo)try{yield e._gateway.muteLocal(n,e._joinInfo.stringUid||e._joinInfo.uid),i()}catch(o){o.code===S.DISCONNECT_P2P?i():r(o)}else i()});return function(n,i,r){return t.apply(this,arguments)}}()),this._p2pChannel.on(de.RequestUnmuteLocal,function(){var t=C(function*(n,i,r){if(e._joinInfo)try{yield e._gateway.unmuteLocal(n,e._joinInfo.stringUid||e._joinInfo.uid),i()}catch(o){o.code===S.DISCONNECT_P2P?i():r(o)}else i()});return function(n,i,r){return t.apply(this,arguments)}}()),this._p2pChannel.on(de.RequestRePublish,(t,n,i)=>{this.publish(t,!1).then(n).catch(i)}),this._p2pChannel.on(de.RequestRePublishDataChannel,(t,n,i)=>{q.all(t.map(function(){var r=C(function*(o){const s=yield e._p2pChannel.publishDataChannel([o]);try{s.forEach(a=>{e._uid&&e._gateway.publishDataChannel(e._uid,a,!0)})}catch(a){if(a.code!==S.DISCONNECT_P2P)throw a}});return function(o){return r.apply(this,arguments)}}())).then(n).catch(i)}),this._p2pChannel.on(de.RequestReSubscribe,function(){var t=C(function*(n,i,r){try{for(const{user:o,kind:s}of n)s===ie.VIDEO?yield e.subscribe(o,"video"):yield e.subscribe(o,"audio");i()}catch(o){r(o)}});return function(n,i,r){return t.apply(this,arguments)}}()),this._p2pChannel.on(de.RequestUpload,(t,n)=>{this._gateway.upload(t,n)}),this._p2pChannel.on(de.RequestUploadStats,t=>{this._gateway.uploadWRTCStats(t)}),this._p2pChannel.on(de.MediaReconnectStart,t=>{this.safeEmit(Ae.MEDIA_RECONNECT_START,t)}),this._p2pChannel.on(de.MediaReconnectEnd,t=>{this.safeEmit(Ae.MEDIA_RECONNECT_END,t)}),this._p2pChannel.on(de.NeedSignalRTT,t=>{t(this._gateway.getSignalRTT())}),this._p2pChannel.on(de.RequestRestartICE,function(){var t=C(function*(n){if(e._p2pChannel instanceof Lr)return;const i=yield e._p2pChannel.restartICE(n),r=yield i.next();if(r.done)return;const o=r.value;let s;try{s=yield e._gateway.restartICE({iceParameters:o})}catch(c){return void i.throw(c)}const{iceParameters:a}=function(c){const l=c.iceParameters;return{iceParameters:{iceUfrag:l.iceUfrag,icePwd:l.icePwd}}}(s);yield i.next({remoteIceParameters:a})});return function(n){return t.apply(this,arguments)}}()),this._p2pChannel.on(de.RequestReconnect,C(function*(){e._gateway.reconnect()})),this._p2pChannel.on(de.RequestReconnectPC,C(function*(){var t;const{iceParameters:n,dtlsParameters:i,rtpCapabilities:r}=yield e._p2pChannel.startP2PConnection({turnServer:null===(t=e._joinInfo)||void 0===t?void 0:t.turnServer}),{gatewayEstablishParams:o,gatewayAddress:s}=yield e._gateway.reconnectPC({iceParameters:n,dtlsParameters:i,rtpCapabilities:r}),a=F$(o,s);yield e._p2pChannel.connect(a),yield e._p2pChannel.republish(),yield e._p2pChannel.reSubscribe()})),this._p2pChannel.on(de.RequestUnpublishForReconnectPC,function(){var t=C(function*(n,i,r){e._joinInfo&&void 0!==e._uid?(yield e._gateway.unpublish(n,e._uid),i()):r()});return function(n,i,r){return t.apply(this,arguments)}}()),this._p2pChannel.on(de.P2PLost,()=>{this.safeEmit(Ae.P2P_LOST,this.store.uid)}),this._p2pChannel.on(de.UpdateVideoEncoder,t=>{t._encoderConfig&&this._gateway.setVideoProfile(t._encoderConfig)}),this._p2pChannel.on(de.ConnectionTypeChange,t=>{this.safeEmit(Ae.IS_USING_CLOUD_PROXY,t)}),this._p2pChannel.on(de.RequestLowStreamParameter,t=>{t(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(de.QueryClientConnectionState,t=>{t(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}enableContentInspect(e){var t=this;return C(function*(){if(!t._joinInfo||"CONNECTED"!==t.connectionState)throw new N(S.INVALID_OPERATION,"[".concat(t._clientId,"] can not create content inspect, please join channel first"));if(t._inspect)throw new N(S.INVALID_OPERATION,"[".concat(t._clientId,"] Inspect content service already in connecting/connected state"));try{const i=(n={config:e},p_("ContentInspect").create(n));t._inspect=i,t.handleVideoInspectEvents(i);const{appId:r,cname:o,sid:s,token:a,uid:c,cid:l,vid:d}=t._joinInfo;yield i.init({appId:r,areaCode:"",cname:o,sid:s,token:a,uid:c,cid:l,vid:d?Number(d):0},vn)}catch(i){throw Array.isArray(i)?i[0]:i}var n})()}handleVideoInspectEvents(e){e.on(Vn.CONNECTION_STATE_CHANGE,(t,n)=>{if(this.safeEmit(Ae.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,t,n),n===Qo.CONNECTED){if("CONNECTED"!==this.connectionState)return void this.safeEmit(Ae.CONTENT_INSPECT_ERROR,new N(S.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}}),e.on(Vn.INSPECT_RESULT,(t,n)=>{var i;if(n?.code===S.INVALID_OPERATION&&"DISCONNECTED"===this.connectionState)return _.debug("Stop inspect content because that has left channel"),null==this||null===(i=this._inspect)||void 0===i||i.close(),void(this._inspect=void 0);this.safeEmit(Ae.CONTENT_INSPECT_RESULT,t,n)}),e.on(Vn.CLIENT_LOCAL_VIDEO_TRACK,t=>{t(this.localTracks.filter(n=>"video"===n.trackMediaType)[0])})}disableContentInspect(){var e=this;return C(function*(){if(!e._inspect)throw new N(S.INVALID_OPERATION,"[".concat(e._clientId,"] inspectVideoContent not started"));try{e._inspect.close(),e._inspect=void 0}catch(t){throw Array.isArray(t)?t[0]:t}})()}setImageModeration(e,t){var n=this;return C(function*(){if(hc(e,"enabled"),e){if(!t)throw new N(S.INVALID_PARAMS,"config is required");if(RZ(t),!n._joinInfo)throw new N(S.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(n._moderation)n._moderation.updateConfig(t);else{const r=(i={config:t},p_("ImageModeration").create(i));n._moderation=r,n.handleImageModerationEvents(r);const{appId:o,cname:s,sid:a,token:c,uid:l,cid:d,vid:u}=n._joinInfo;yield r.init({appId:o,areaCode:"",cname:s,sid:a,token:c,uid:l,cid:d,vid:u?Number(u):0},vn)}}catch(r){throw Array.isArray(r)?r[0]:r}}else{var i;if(!n._moderation)throw new N(S.INVALID_OPERATION,"[".concat(n._clientId,"] image moderation not started"));try{n._moderation.close(),n._moderation.removeAllListeners(),n._moderation=void 0}catch(r){throw Array.isArray(r)?r[0]:r}}})()}handleImageModerationEvents(e){e.on(Us.CONNECTION_STATE_CHANGE,(t,n)=>{if(this.safeEmit(Ae.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,t,n),t===Mo.CONNECTED){if("CONNECTED"!==this.connectionState)throw this.setImageModeration(!1),new N(S.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");e.inspectImage()}}),e.on(Us.CLIENT_LOCAL_VIDEO_TRACK,t=>{t(this.localTracks.filter(n=>"video"===n.trackMediaType)[0])})}setP2PTransport(e){if(function(t){Mn(t,"transport",["default","auto","relay","sd-rtn"])}(e),"p2p"!==this.mode)throw new N(S.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=e,_.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(e))}getJoinChannelServiceRecords(){return _.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}setPublishAudioFilterEnabled(e){var t=this;return C(function*(){hc(e,"enabled"),st("ENABLE_PUBLISH_AUDIO_FILTER",e),t._joinInfo&&(yield t._gateway.setPublishAudioFilterEnabled(e))})()}_handleResetAddStream(e,t){switch(t){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}},Q($.prototype,"leave",[AZ],Object.getOwnPropertyDescriptor($.prototype,"leave"),$.prototype),Q($.prototype,"publish",[DZ],Object.getOwnPropertyDescriptor($.prototype,"publish"),$.prototype),Q($.prototype,"unpublish",[OZ],Object.getOwnPropertyDescriptor($.prototype,"unpublish"),$.prototype),Q($.prototype,"subscribe",[NZ],Object.getOwnPropertyDescriptor($.prototype,"subscribe"),$.prototype),Q($.prototype,"presubscribe",[PZ],Object.getOwnPropertyDescriptor($.prototype,"presubscribe"),$.prototype),Q($.prototype,"massSubscribe",[MZ],Object.getOwnPropertyDescriptor($.prototype,"massSubscribe"),$.prototype),Q($.prototype,"unsubscribe",[xZ],Object.getOwnPropertyDescriptor($.prototype,"unsubscribe"),$.prototype),Q($.prototype,"massUnsubscribe",[kZ],Object.getOwnPropertyDescriptor($.prototype,"massUnsubscribe"),$.prototype),Q($.prototype,"setLowStreamParameter",[LZ],Object.getOwnPropertyDescriptor($.prototype,"setLowStreamParameter"),$.prototype),Q($.prototype,"enableDualStream",[FZ],Object.getOwnPropertyDescriptor($.prototype,"enableDualStream"),$.prototype),Q($.prototype,"disableDualStream",[UZ],Object.getOwnPropertyDescriptor($.prototype,"disableDualStream"),$.prototype),Q($.prototype,"setClientRole",[VZ],Object.getOwnPropertyDescriptor($.prototype,"setClientRole"),$.prototype),Q($.prototype,"setProxyServer",[BZ],Object.getOwnPropertyDescriptor($.prototype,"setProxyServer"),$.prototype),Q($.prototype,"setTurnServer",[jZ],Object.getOwnPropertyDescriptor($.prototype,"setTurnServer"),$.prototype),Q($.prototype,"setLicense",[HZ],Object.getOwnPropertyDescriptor($.prototype,"setLicense"),$.prototype),Q($.prototype,"startProxyServer",[GZ],Object.getOwnPropertyDescriptor($.prototype,"startProxyServer"),$.prototype),Q($.prototype,"stopProxyServer",[WZ],Object.getOwnPropertyDescriptor($.prototype,"stopProxyServer"),$.prototype),Q($.prototype,"setLocalAccessPointsV2",[zZ],Object.getOwnPropertyDescriptor($.prototype,"setLocalAccessPointsV2"),$.prototype),Q($.prototype,"setLocalAccessPoints",[KZ],Object.getOwnPropertyDescriptor($.prototype,"setLocalAccessPoints"),$.prototype),Q($.prototype,"setRemoteDefaultVideoStreamType",[qZ],Object.getOwnPropertyDescriptor($.prototype,"setRemoteDefaultVideoStreamType"),$.prototype),Q($.prototype,"setRemoteVideoStreamType",[YZ],Object.getOwnPropertyDescriptor($.prototype,"setRemoteVideoStreamType"),$.prototype),Q($.prototype,"setStreamFallbackOption",[$Z],Object.getOwnPropertyDescriptor($.prototype,"setStreamFallbackOption"),$.prototype),Q($.prototype,"setEncryptionConfig",[XZ],Object.getOwnPropertyDescriptor($.prototype,"setEncryptionConfig"),$.prototype),Q($.prototype,"renewToken",[ZZ],Object.getOwnPropertyDescriptor($.prototype,"renewToken"),$.prototype),Q($.prototype,"enableAudioVolumeIndicator",[JZ],Object.getOwnPropertyDescriptor($.prototype,"enableAudioVolumeIndicator"),$.prototype),Q($.prototype,"startLiveStreaming",[QZ],Object.getOwnPropertyDescriptor($.prototype,"startLiveStreaming"),$.prototype),Q($.prototype,"setLiveTranscoding",[eJ],Object.getOwnPropertyDescriptor($.prototype,"setLiveTranscoding"),$.prototype),Q($.prototype,"stopLiveStreaming",[tJ],Object.getOwnPropertyDescriptor($.prototype,"stopLiveStreaming"),$.prototype),Q($.prototype,"startChannelMediaRelay",[nJ],Object.getOwnPropertyDescriptor($.prototype,"startChannelMediaRelay"),$.prototype),Q($.prototype,"updateChannelMediaRelay",[iJ],Object.getOwnPropertyDescriptor($.prototype,"updateChannelMediaRelay"),$.prototype),Q($.prototype,"stopChannelMediaRelay",[rJ],Object.getOwnPropertyDescriptor($.prototype,"stopChannelMediaRelay"),$.prototype),Q($.prototype,"sendCustomReportMessage",[oJ],Object.getOwnPropertyDescriptor($.prototype,"sendCustomReportMessage"),$.prototype),Q($.prototype,"pickSVCLayer",[sJ],Object.getOwnPropertyDescriptor($.prototype,"pickSVCLayer"),$.prototype),Q($.prototype,"setRTMConfig",[aJ],Object.getOwnPropertyDescriptor($.prototype,"setRTMConfig"),$.prototype),Q($.prototype,"enableContentInspect",[cJ],Object.getOwnPropertyDescriptor($.prototype,"enableContentInspect"),$.prototype),Q($.prototype,"disableContentInspect",[lJ],Object.getOwnPropertyDescriptor($.prototype,"disableContentInspect"),$.prototype),Q($.prototype,"setImageModeration",[dJ],Object.getOwnPropertyDescriptor($.prototype,"setImageModeration"),$.prototype),Q($.prototype,"setP2PTransport",[uJ],Object.getOwnPropertyDescriptor($.prototype,"setP2PTransport"),$.prototype),Q($.prototype,"getJoinChannelServiceRecords",[hJ],Object.getOwnPropertyDescriptor($.prototype,"getJoinChannelServiceRecords"),$.prototype),Q($.prototype,"setPublishAudioFilterEnabled",[pJ],Object.getOwnPropertyDescriptor($.prototype,"setPublishAudioFilterEnabled"),$.prototype),$);class m_{constructor(t,n){y(this,"id",0),y(this,"element",void 0),y(this,"peerPair",void 0),y(this,"context",void 0),y(this,"audioPlayerElement",void 0),y(this,"audioTrack",void 0),m_.count+=1,this.id=m_.count,this.element=t,this.context=n}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=t=>{const n=document.createElement("audio");n.srcObject=new MediaStream([t.track]),n.play(),this.audioPlayerElement=n}}switchSdp(){var t=this;return C(function*(){if(!t.peerPair)return;const n=function(){var r=C(function*(o,s){const a="offer"===s?yield o.createOffer():yield o.createAnswer();return yield o.setLocalDescription(a),"complete"===o.iceGatheringState?o.localDescription:new q(c=>{o.onicegatheringstatechange=()=>{"complete"===o.iceGatheringState&&c(o.localDescription)}})});return function(s,a){return r.apply(this,arguments)}}(),i=function(){var r=C(function*(o,s){return yield o.setRemoteDescription(s)});return function(s,a){return r.apply(this,arguments)}}();try{const r=yield n(t.peerPair[0],"offer");yield i(t.peerPair[1],r);const o=yield n(t.peerPair[1],"answer");yield i(t.peerPair[0],o)}catch(r){throw new N(S.LOCAL_AEC_ERROR,r.toString()).print()}})()}getTracksFromMediaElement(t){var n=this;return C(function*(){if(n.audioTrack)return n.audioTrack;let i;try{t instanceof HTMLVideoElement&&(t.captureStream?t.captureStream():t.mozCaptureStream()),i=n.context.createMediaStreamDestination(),n.context.createMediaElementSource(t).connect(i)}catch(o){throw new N(S.LOCAL_AEC_ERROR,o.toString()).print()}if(!i)throw new N(S.LOCAL_AEC_ERROR,"no dest node when local aec").print();const r=i.stream.getAudioTracks()[0];return n.audioTrack=r,r})()}getElement(){return this.element}startEchoCancellation(){var t=this;return C(function*(){t.context.resume(),t.peerPair&&t.close(),t.initPeers();const n=t.element,i=yield t.getTracksFromMediaElement(n);t.peerPair&&t.peerPair[0].addTrack(i),yield t.switchSdp()})()}close(){_.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(t=>{t.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var mJ,RC;y(m_,"count",0);const $Fe=window.AudioContext||window.webkitAudioContext,XFe=new(mJ=le({report:ne}),Q((RC=class{constructor(){y(this,"units",[]),y(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return _.debug("the system does not need to process local aec"),-1;this.context||(this.context=new $Fe);let t=this.units.find(n=>n&&n.getElement()===e);return t||(t=new m_(e,this.context),this.units.push(t)),t.startEchoCancellation(),_.debug("start processing local audio echo cancellation, id is",t.id),t.id}_doesEnvironmentNeedAEC(){return xe().name!==Ye.SAFARI}}).prototype,"processExternalMediaAEC",[mJ],Object.getOwnPropertyDescriptor(RC.prototype,"processExternalMediaAEC"),RC.prototype),RC);function gJ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function _J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gJ(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gJ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}const a1=window||document;function vJ(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!a1)return;const n=En._cspEventHandlerPointer;if(n&&t)return void console.error(n,t);const i=r=>{if(!(r&&r.blockedURI&&(En.onSecurityPolicyViolation||En.getListeners(Ra.SECURITY_POLICY_VIOLATION).length>0)))return;const o=r.blockedURI;R("CSP_DETECTED_HOSTNAME_LIST").some(s=>Y(o).call(o,s))&&(En.onSecurityPolicyViolation&&"function"==typeof En.onSecurityPolicyViolation&&En.onSecurityPolicyViolation(r),En.getListeners(Ra.SECURITY_POLICY_VIOLATION).length>0&&En.safeEmit(Ra.SECURITY_POLICY_VIOLATION,r))};n&&a1.removeEventListener("securitypolicyviolation",n),(t||e&&"function"==typeof e||En.getListeners(Ra.SECURITY_POLICY_VIOLATION).length>0)&&a1.addEventListener("securitypolicyviolation",i),En._cspEventHandlerPointer=i}var ZFe=Wi,JFe=p7,EJ=RegExp.prototype,Vi=Vt(function(e){return e===EJ||ZFe(EJ,e)?JFe(e):e.flags});function Wp(e){let t=e.length;for(;--t>=0;)e[t]=0}const l1=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),AC=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),eUe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),yJ=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Cc=new Array(576);Wp(Cc);const v_=new Array(60);Wp(v_);const E_=new Array(512);Wp(E_);const b_=new Array(256);Wp(b_);const d1=new Array(29);Wp(d1);const DC=new Array(30);function u1(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}let SJ,CJ,TJ;function h1(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Wp(DC);const wJ=e=>e<256?E_[e]:E_[256+(e>>>7)],y_=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},ao=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,y_(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},La=(e,t,n)=>{ao(e,n[2*t],n[2*t+1])},IJ=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},RJ=(e,t,n)=>{const i=new Array(16);let r,o,s=0;for(r=1;r<=15;r++)s=s+n[r-1]<<1,i[r]=s;for(o=0;o<=t;o++){let a=e[2*o+1];0!==a&&(e[2*o]=IJ(i[a]++,a))}},AJ=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},DJ=e=>{e.bi_valid>8?y_(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},OJ=(e,t,n,i)=>{const r=2*t,o=2*n;return e[r]<e[o]||e[r]===e[o]&&i[t]<=i[n]},p1=(e,t,n)=>{const i=e.heap[n];let r=n<<1;for(;r<=e.heap_len&&(r<e.heap_len&&OJ(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!OJ(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i},NJ=(e,t,n)=>{let i,r,o,s,a=0;if(0!==e.sym_next)do{i=255&e.pending_buf[e.sym_buf+a++],i+=(255&e.pending_buf[e.sym_buf+a++])<<8,r=e.pending_buf[e.sym_buf+a++],0===i?La(e,r,t):(o=b_[r],La(e,o+256+1,t),s=l1[o],0!==s&&(r-=d1[o],ao(e,r,s)),i--,o=wJ(i),La(e,o,n),s=AC[o],0!==s&&(i-=DC[o],ao(e,i,s)))}while(a<e.sym_next);La(e,256,t)},f1=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.elems;let s,a,c,l=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<o;s++)0!==n[2*s]?(e.heap[++e.heap_len]=l=s,e.depth[s]=0):n[2*s+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,r&&(e.static_len-=i[2*c+1]);for(t.max_code=l,s=e.heap_len>>1;s>=1;s--)p1(e,n,s);c=o;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],p1(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=a,n[2*c]=n[2*s]+n[2*a],e.depth[c]=(e.depth[s]>=e.depth[a]?e.depth[s]:e.depth[a])+1,n[2*s+1]=n[2*a+1]=c,e.heap[1]=c++,p1(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((d,u)=>{const h=u.dyn_tree,p=u.max_code,m=u.stat_desc.static_tree,f=u.stat_desc.has_stree,g=u.stat_desc.extra_bits,E=u.stat_desc.extra_base,b=u.stat_desc.max_length;let T,I,D,O,k,L,V=0;for(O=0;O<=15;O++)d.bl_count[O]=0;for(h[2*d.heap[d.heap_max]+1]=0,T=d.heap_max+1;T<573;T++)I=d.heap[T],O=h[2*h[2*I+1]+1]+1,O>b&&(O=b,V++),h[2*I+1]=O,I>p||(d.bl_count[O]++,k=0,I>=E&&(k=g[I-E]),L=h[2*I],d.opt_len+=L*(O+k),f&&(d.static_len+=L*(m[2*I+1]+k)));if(0!==V){do{for(O=b-1;0===d.bl_count[O];)O--;d.bl_count[O]--,d.bl_count[O+1]+=2,d.bl_count[b]--,V-=2}while(V>0);for(O=b;0!==O;O--)for(I=d.bl_count[O];0!==I;)D=d.heap[--T],D>p||(h[2*D+1]!==O&&(d.opt_len+=(O-h[2*D+1])*h[2*D],h[2*D+1]=O),I--)}})(e,t),RJ(n,l,e.bl_count)},PJ=(e,t,n)=>{let i,r,o=-1,s=t[1],a=0,c=7,l=4;for(0===s&&(c=138,l=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=s,s=t[2*(i+1)+1],++a<c&&r===s||(a<l?e.bl_tree[2*r]+=a:0!==r?(r!==o&&e.bl_tree[2*r]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=r,0===s?(c=138,l=3):r===s?(c=6,l=3):(c=7,l=4))},MJ=(e,t,n)=>{let i,r,o=-1,s=t[1],a=0,c=7,l=4;for(0===s&&(c=138,l=3),i=0;i<=n;i++)if(r=s,s=t[2*(i+1)+1],!(++a<c&&r===s)){if(a<l)do{La(e,r,e.bl_tree)}while(0!=--a);else 0!==r?(r!==o&&(La(e,r,e.bl_tree),a--),La(e,16,e.bl_tree),ao(e,a-3,2)):a<=10?(La(e,17,e.bl_tree),ao(e,a-3,3)):(La(e,18,e.bl_tree),ao(e,a-11,7));a=0,o=r,0===s?(c=138,l=3):r===s?(c=6,l=3):(c=7,l=4)}};let xJ=!1;const kJ=(e,t,n,i)=>{ao(e,0+(i?1:0),3),DJ(e),y_(e,n),y_(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var oUe={_tr_init:e=>{xJ||((()=>{let t,n,i,r,o;const s=new Array(16);for(i=0,r=0;r<28;r++)for(d1[r]=i,t=0;t<1<<l1[r];t++)b_[i++]=r;for(b_[i-1]=r,o=0,r=0;r<16;r++)for(DC[r]=o,t=0;t<1<<AC[r];t++)E_[o++]=r;for(o>>=7;r<30;r++)for(DC[r]=o<<7,t=0;t<1<<AC[r]-7;t++)E_[256+o++]=r;for(n=0;n<=15;n++)s[n]=0;for(t=0;t<=143;)Cc[2*t+1]=8,t++,s[8]++;for(;t<=255;)Cc[2*t+1]=9,t++,s[9]++;for(;t<=279;)Cc[2*t+1]=7,t++,s[7]++;for(;t<=287;)Cc[2*t+1]=8,t++,s[8]++;for(RJ(Cc,287,s),t=0;t<30;t++)v_[2*t+1]=5,v_[2*t]=IJ(t,5);SJ=new u1(Cc,l1,257,286,15),CJ=new u1(v_,AC,0,30,15),TJ=new u1(new Array(0),eUe,0,19,7)})(),xJ=!0),e.l_desc=new h1(e.dyn_ltree,SJ),e.d_desc=new h1(e.dyn_dtree,CJ),e.bl_desc=new h1(e.bl_tree,TJ),e.bi_buf=0,e.bi_valid=0,AJ(e)},_tr_stored_block:kJ,_tr_flush_block:(e,t,n,i)=>{let r,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(a=>{let c,l=4093624447;for(c=0;c<=31;c++,l>>>=1)if(1&l&&0!==a.dyn_ltree[2*c])return 0;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return 1;for(c=32;c<256;c++)if(0!==a.dyn_ltree[2*c])return 1;return 0})(e)),f1(e,e.l_desc),f1(e,e.d_desc),s=(a=>{let c;for(PJ(a,a.dyn_ltree,a.l_desc.max_code),PJ(a,a.dyn_dtree,a.d_desc.max_code),f1(a,a.bl_desc),c=18;c>=3&&0===a.bl_tree[2*yJ[c]+1];c--);return a.opt_len+=3*(c+1)+5+5+4,c})(e),r=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=r&&(r=o)):r=o=n+5,n+4<=r&&-1!==t?kJ(e,t,n,i):4===e.strategy||o===r?(ao(e,2+(i?1:0),3),NJ(e,Cc,v_)):(ao(e,4+(i?1:0),3),((a,c,l,d)=>{let u;for(ao(a,c-257,5),ao(a,l-1,5),ao(a,d-4,4),u=0;u<d;u++)ao(a,a.bl_tree[2*yJ[u]+1],3);MJ(a,a.dyn_ltree,c-1),MJ(a,a.dyn_dtree,l-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),NJ(e,e.dyn_ltree,e.dyn_dtree)),AJ(e),i&&DJ(e)},_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(b_[n]+256+1)]++,e.dyn_dtree[2*wJ(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{ao(e,2,3),La(e,256,Cc),(t=>{16===t.bi_valid?(y_(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(e)}},S_=(e,t,n,i)=>{let r=65535&e,o=e>>>16&65535,s=0;for(;0!==n;){s=n>2e3?2e3:n,n-=s;do{r=r+t[i++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16};const sUe=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var Zi=(e,t,n,i)=>{const r=sUe,o=i+n;e^=-1;for(let s=i;s<o;s++)e=e>>>8^r[255&(e^t[s])];return~e},Jd={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},zp={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:aUe,_tr_stored_block:m1,_tr_flush_block:cUe,_tr_tally:Ol,_tr_align:lUe}=oUe,{Z_NO_FLUSH:Nl,Z_PARTIAL_FLUSH:dUe,Z_FULL_FLUSH:uUe,Z_FINISH:ps,Z_BLOCK:LJ,Z_OK:or,Z_STREAM_END:FJ,Z_STREAM_ERROR:Fa,Z_DATA_ERROR:hUe,Z_BUF_ERROR:g1,Z_DEFAULT_COMPRESSION:pUe,Z_FILTERED:fUe,Z_HUFFMAN_ONLY:OC,Z_RLE:mUe,Z_FIXED:gUe,Z_DEFAULT_STRATEGY:_Ue,Z_UNKNOWN:vUe,Z_DEFLATED:NC}=zp,Ua=262,tu=(e,t)=>(e.msg=Jd[t],t),UJ=e=>2*e-(e>4?9:0),Pl=e=>{let t=e.length;for(;--t>=0;)e[t]=0},CUe=e=>{let t,n,i,r=e.w_size;t=e.hash_size,i=t;do{n=e.head[--i],e.head[i]=n>=r?n-r:0}while(--t);t=r,i=t;do{n=e.prev[--i],e.prev[i]=n>=r?n-r:0}while(--t)};let Ml=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Fo=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Uo=(e,t)=>{cUe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Fo(e.strm)},Xt=(e,t)=>{e.pending_buf[e.pending++]=t},T_=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},v1=(e,t,n,i)=>{let r=e.avail_in;return r>i&&(r=i),0===r?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),n),1===e.state.wrap?e.adler=S_(e.adler,t,r,n):2===e.state.wrap&&(e.adler=Zi(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)},VJ=(e,t)=>{let n,i,r=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-Ua?e.strstart-(e.w_size-Ua):0,l=e.window,d=e.w_mask,u=e.prev,h=e.strstart+258;let p=l[o+s-1],m=l[o+s];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,l[n+s]===m&&l[n+s-1]===p&&l[n]===l[o]&&l[++n]===l[o+1]){o+=2,n++;do{}while(l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&o<h);if(i=258-(h-o),o=h-258,i>s){if(e.match_start=t,s=i,i>=a)break;p=l[o+s-1],m=l[o+s]}}}while((t=u[t&d])>c&&0!=--r);return s<=e.lookahead?s:e.lookahead},qp=e=>{const t=e.w_size;let n,i,r;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Ua)&&(e.window.set(e.window.subarray(t,t+t-i),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),CUe(e),i+=t),0===e.strm.avail_in)break;if(n=v1(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=n,e.lookahead+e.insert>=3)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=Ml(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=Ml(e,e.ins_h,e.window[r+3-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Ua&&0!==e.strm.avail_in)},BJ=(e,t)=>{let n,i,r,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,a=e.strm.avail_in;do{if(n=65535,r=e.bi_valid+42>>3,e.strm.avail_out<r||(r=e.strm.avail_out-r,i=e.strstart-e.block_start,n>i+e.strm.avail_in&&(n=i+e.strm.avail_in),n>r&&(n=r),n<o&&(0===n&&t!==ps||t===Nl||n!==i+e.strm.avail_in)))break;s=t===ps&&n===i+e.strm.avail_in?1:0,m1(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Fo(e.strm),i&&(i>n&&(i=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,n-=i),n&&(v1(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===s);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==Nl&&t!==ps&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(r=e.window_size-e.strstart,e.strm.avail_in>r&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,r+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),r>e.strm.avail_in&&(r=e.strm.avail_in),r&&(v1(e.strm,e.window,e.strstart,r),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.high_water<e.strstart&&(e.high_water=e.strstart),r=e.bi_valid+42>>3,r=e.pending_buf_size-r>65535?65535:e.pending_buf_size-r,o=r>e.w_size?e.w_size:r,i=e.strstart-e.block_start,(i>=o||(i||t===ps)&&t!==Nl&&0===e.strm.avail_in&&i<=r)&&(n=i>r?r:i,s=t===ps&&0===e.strm.avail_in&&n===i?1:0,m1(e,e.block_start,n,s),e.block_start+=n,Fo(e.strm)),s?3:1)},E1=(e,t)=>{let n,i;for(;;){if(e.lookahead<Ua){if(qp(e),e.lookahead<Ua&&t===Nl)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Ml(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-Ua&&(e.match_length=VJ(e,n)),e.match_length>=3)if(i=Ol(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Ml(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ml(e,e.ins_h,e.window[e.strstart+1]);else i=Ol(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Uo(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ps?(Uo(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Uo(e,!1),0===e.strm.avail_out)?1:2},Yp=(e,t)=>{let n,i,r;for(;;){if(e.lookahead<Ua){if(qp(e),e.lookahead<Ua&&t===Nl)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Ml(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Ua&&(e.match_length=VJ(e,n),e.match_length<=5&&(e.strategy===fUe||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=Ol(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=Ml(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(Uo(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(i=Ol(e,0,e.window[e.strstart-1]),i&&Uo(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Ol(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ps?(Uo(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Uo(e,!1),0===e.strm.avail_out)?1:2};function Va(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}const w_=[new Va(0,0,0,0,BJ),new Va(4,4,8,4,E1),new Va(4,5,16,8,E1),new Va(4,6,32,32,E1),new Va(4,4,16,16,Yp),new Va(8,16,32,32,Yp),new Va(8,16,128,128,Yp),new Va(8,32,128,256,Yp),new Va(32,128,258,1024,Yp),new Va(32,258,258,4096,Yp)];function TUe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=NC,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Pl(this.dyn_ltree),Pl(this.dyn_dtree),Pl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Pl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Pl(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const I_=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||42!==t.status&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&113!==t.status&&666!==t.status?1:0},jJ=e=>{if(I_(e))return tu(e,Fa);e.total_in=e.total_out=0,e.data_type=vUe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=-2,aUe(t),or},HJ=e=>{const t=jJ(e);return t===or&&((n=e.state).window_size=2*n.w_size,Pl(n.head),n.max_lazy_match=w_[n.level].max_lazy,n.good_match=w_[n.level].good_length,n.nice_match=w_[n.level].nice_length,n.max_chain_length=w_[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t;var n},GJ=(e,t,n,i,r,o)=>{if(!e)return Fa;let s=1;if(t===pUe&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||n!==NC||i<8||i>15||t<0||t>9||o<0||o>gUe||8===i&&1!==s)return tu(e,Fa);8===i&&(i=9);const a=new TUe;return e.state=a,a.strm=e,a.status=42,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=o,a.method=n,HJ(e)};var R_={deflateInit:(e,t)=>GJ(e,t,NC,15,8,_Ue),deflateInit2:GJ,deflateReset:HJ,deflateResetKeep:jJ,deflateSetHeader:(e,t)=>I_(e)||2!==e.state.wrap?Fa:(e.state.gzhead=t,or),deflate:(e,t)=>{if(I_(e)||t>LJ||t<0)return e?tu(e,Fa):Fa;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||666===n.status&&t!==ps)return tu(e,0===e.avail_out?g1:Fa);const i=n.last_flush;if(n.last_flush=t,0!==n.pending){if(Fo(e),0===e.avail_out)return n.last_flush=-1,or}else if(0===e.avail_in&&UJ(t)<=UJ(i)&&t!==ps)return tu(e,g1);if(666===n.status&&0!==e.avail_in)return tu(e,g1);if(42===n.status&&0===n.wrap&&(n.status=113),42===n.status){let r=NC+(n.w_bits-8<<4)<<8,o=-1;if(o=n.strategy>=OC||n.level<2?0:n.level<6?1:6===n.level?2:3,r|=o<<6,0!==n.strstart&&(r|=32),r+=31-r%31,T_(n,r),0!==n.strstart&&(T_(n,e.adler>>>16),T_(n,65535&e.adler)),e.adler=1,n.status=113,Fo(e),0!==n.pending)return n.last_flush=-1,or}if(57===n.status)if(e.adler=0,Xt(n,31),Xt(n,139),Xt(n,8),n.gzhead)Xt(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Xt(n,255&n.gzhead.time),Xt(n,n.gzhead.time>>8&255),Xt(n,n.gzhead.time>>16&255),Xt(n,n.gzhead.time>>24&255),Xt(n,9===n.level?2:n.strategy>=OC||n.level<2?4:0),Xt(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Xt(n,255&n.gzhead.extra.length),Xt(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Zi(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Xt(n,0),Xt(n,0),Xt(n,0),Xt(n,0),Xt(n,0),Xt(n,9===n.level?2:n.strategy>=OC||n.level<2?4:0),Xt(n,3),n.status=113,Fo(e),0!==n.pending)return n.last_flush=-1,or;if(69===n.status){if(n.gzhead.extra){let r=n.pending,o=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+o>n.pending_buf_size;){let a=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+a),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>r&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex+=a,Fo(e),0!==n.pending)return n.last_flush=-1,or;r=0,o-=a}let s=new Uint8Array(n.gzhead.extra);n.pending_buf.set(s.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending+=o,n.gzhead.hcrc&&n.pending>r&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let r,o=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>o&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-o,o)),Fo(e),0!==n.pending)return n.last_flush=-1,or;o=0}r=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Xt(n,r)}while(0!==r);n.gzhead.hcrc&&n.pending>o&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-o,o)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let r,o=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>o&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-o,o)),Fo(e),0!==n.pending)return n.last_flush=-1,or;o=0}r=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Xt(n,r)}while(0!==r);n.gzhead.hcrc&&n.pending>o&&(e.adler=Zi(e.adler,n.pending_buf,n.pending-o,o))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Fo(e),0!==n.pending))return n.last_flush=-1,or;Xt(n,255&e.adler),Xt(n,e.adler>>8&255),e.adler=0}if(n.status=113,Fo(e),0!==n.pending)return n.last_flush=-1,or}if(0!==e.avail_in||0!==n.lookahead||t!==Nl&&666!==n.status){let r=0===n.level?BJ(n,t):n.strategy===OC?((o,s)=>{let a;for(;;){if(0===o.lookahead&&(qp(o),0===o.lookahead)){if(s===Nl)return 1;break}if(o.match_length=0,a=Ol(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++,a&&(Uo(o,!1),0===o.strm.avail_out))return 1}return o.insert=0,s===ps?(Uo(o,!0),0===o.strm.avail_out?3:4):o.sym_next&&(Uo(o,!1),0===o.strm.avail_out)?1:2})(n,t):n.strategy===mUe?((o,s)=>{let a,c,l,d;const u=o.window;for(;;){if(o.lookahead<=258){if(qp(o),o.lookahead<=258&&s===Nl)return 1;if(0===o.lookahead)break}if(o.match_length=0,o.lookahead>=3&&o.strstart>0&&(l=o.strstart-1,c=u[l],c===u[++l]&&c===u[++l]&&c===u[++l])){d=o.strstart+258;do{}while(c===u[++l]&&c===u[++l]&&c===u[++l]&&c===u[++l]&&c===u[++l]&&c===u[++l]&&c===u[++l]&&c===u[++l]&&l<d);o.match_length=258-(d-l),o.match_length>o.lookahead&&(o.match_length=o.lookahead)}if(o.match_length>=3?(a=Ol(o,1,o.match_length-3),o.lookahead-=o.match_length,o.strstart+=o.match_length,o.match_length=0):(a=Ol(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++),a&&(Uo(o,!1),0===o.strm.avail_out))return 1}return o.insert=0,s===ps?(Uo(o,!0),0===o.strm.avail_out?3:4):o.sym_next&&(Uo(o,!1),0===o.strm.avail_out)?1:2})(n,t):w_[n.level].func(n,t);if(3!==r&&4!==r||(n.status=666),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),or;if(2===r&&(t===dUe?lUe(n):t!==LJ&&(m1(n,0,0,!1),t===uUe&&(Pl(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Fo(e),0===e.avail_out))return n.last_flush=-1,or}return t!==ps?or:n.wrap<=0?FJ:(2===n.wrap?(Xt(n,255&e.adler),Xt(n,e.adler>>8&255),Xt(n,e.adler>>16&255),Xt(n,e.adler>>24&255),Xt(n,255&e.total_in),Xt(n,e.total_in>>8&255),Xt(n,e.total_in>>16&255),Xt(n,e.total_in>>24&255)):(T_(n,e.adler>>>16),T_(n,65535&e.adler)),Fo(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?or:FJ)},deflateEnd:e=>{if(I_(e))return Fa;const t=e.state.status;return e.state=null,113===t?tu(e,hUe):or},deflateSetDictionary:(e,t)=>{let n=t.length;if(I_(e))return Fa;const i=e.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return Fa;if(1===r&&(e.adler=S_(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){0===r&&(Pl(i.head),i.strstart=0,i.block_start=0,i.insert=0);let c=new Uint8Array(i.w_size);c.set(t.subarray(n-i.w_size,n),0),t=c,n=i.w_size}const o=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,qp(i);i.lookahead>=3;){let c=i.strstart,l=i.lookahead-2;do{i.ins_h=Ml(i,i.ins_h,i.window[c+3-1]),i.prev[c&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=c,c++}while(--l);i.strstart=c,i.lookahead=2,qp(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=s,e.input=a,e.avail_in=o,i.wrap=r,or},deflateInfo:"pako deflate (from Nodeca project)"};const RUe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var PC={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const i in n)RUe(n,i)&&(e[i]=n[i])}}return e},flattenChunks:e=>{let t=0;for(let i=0,r=e.length;i<r;i++)t+=e[i].length;const n=new Uint8Array(t);for(let i=0,r=0,o=e.length;i<o;i++){let s=e[i];n.set(s,r),r+=s.length}return n}};let WJ=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{WJ=!1}const A_=new Uint8Array(256);for(let e=0;e<256;e++)A_[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;A_[254]=A_[254]=1;var D_={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,i,r,o,s=e.length,a=0;for(r=0;r<s;r++)n=e.charCodeAt(r),55296==(64512&n)&&r+1<s&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),o=0,r=0;o<a;r++)n=e.charCodeAt(r),55296==(64512&n)&&r+1<s&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let i,r;const o=new Array(2*n);for(r=0,i=0;i<n;){let s=e[i++];if(s<128){o[r++]=s;continue}let a=A_[s];if(a>4)o[r++]=65533,i+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&i<n;)s=s<<6|63&e[i++],a--;a>1?o[r++]=65533:s<65536?o[r++]=s:(s-=65536,o[r++]=55296|s>>10&1023,o[r++]=56320|1023&s)}}return((s,a)=>{if(a<65534&&s.subarray&&WJ)return String.fromCharCode.apply(null,s.length===a?s:s.subarray(0,a));let c="";for(let l=0;l<a;l++)c+=String.fromCharCode(s[l]);return c})(o,r)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+A_[e[n]]>t?n:t}},zJ=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const KJ=Object.prototype.toString,{Z_NO_FLUSH:AUe,Z_SYNC_FLUSH:DUe,Z_FULL_FLUSH:OUe,Z_FINISH:NUe,Z_OK:MC,Z_STREAM_END:PUe,Z_DEFAULT_COMPRESSION:MUe,Z_DEFAULT_STRATEGY:xUe,Z_DEFLATED:kUe}=zp;function O_(e){this.options=PC.assign({level:MUe,method:kUe,chunkSize:16384,windowBits:15,memLevel:8,strategy:xUe},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zJ,this.strm.avail_out=0;let n=R_.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==MC)throw new Error(Jd[n]);if(t.header&&R_.deflateSetHeader(this.strm,t.header),t.dictionary){let i;if(i="string"==typeof t.dictionary?D_.string2buf(t.dictionary):"[object ArrayBuffer]"===KJ.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=R_.deflateSetDictionary(this.strm,i),n!==MC)throw new Error(Jd[n]);this._dict_set=!0}}function b1(e,t){const n=new O_(t);if(n.push(e,!0),n.err)throw n.msg||Jd[n.err];return n.result}O_.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?NUe:AUe,n.input="string"==typeof e?D_.string2buf(e):"[object ArrayBuffer]"===KJ.call(e)?new Uint8Array(e):e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(o===DUe||o===OUe)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(r=R_.deflate(n,o),r===PUe)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=R_.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===MC;if(0!==n.avail_out){if(o>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},O_.prototype.onData=function(e){this.chunks.push(e)},O_.prototype.onEnd=function(e){e===MC&&(this.result=PC.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var LUe={Deflate:O_,deflate:b1,deflateRaw:function(e,t){return(t=t||{}).raw=!0,b1(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,b1(e,t)},constants:zp};const xC=16209;var FUe=function(e,t){let n,i,r,o,s,a,c,l,d,u,h,p,m,f,g,E,b,T,I,D,O,k,L,V;const ee=e.state;n=e.next_in,L=e.input,i=n+(e.avail_in-5),r=e.next_out,V=e.output,o=r-(t-e.avail_out),s=r+(e.avail_out-257),a=ee.dmax,c=ee.wsize,l=ee.whave,d=ee.wnext,u=ee.window,h=ee.hold,p=ee.bits,m=ee.lencode,f=ee.distcode,g=(1<<ee.lenbits)-1,E=(1<<ee.distbits)-1;e:do{p<15&&(h+=L[n++]<<p,p+=8,h+=L[n++]<<p,p+=8),b=m[h&g];t:for(;;){if(T=b>>>24,h>>>=T,p-=T,T=b>>>16&255,0===T)V[r++]=65535&b;else{if(!(16&T)){if(!(64&T)){b=m[(65535&b)+(h&(1<<T)-1)];continue t}if(32&T){ee.mode=16191;break e}e.msg="invalid literal/length code",ee.mode=xC;break e}I=65535&b,T&=15,T&&(p<T&&(h+=L[n++]<<p,p+=8),I+=h&(1<<T)-1,h>>>=T,p-=T),p<15&&(h+=L[n++]<<p,p+=8,h+=L[n++]<<p,p+=8),b=f[h&E];n:for(;;){if(T=b>>>24,h>>>=T,p-=T,T=b>>>16&255,!(16&T)){if(!(64&T)){b=f[(65535&b)+(h&(1<<T)-1)];continue n}e.msg="invalid distance code",ee.mode=xC;break e}if(D=65535&b,T&=15,p<T&&(h+=L[n++]<<p,p+=8,p<T&&(h+=L[n++]<<p,p+=8)),D+=h&(1<<T)-1,D>a){e.msg="invalid distance too far back",ee.mode=xC;break e}if(h>>>=T,p-=T,T=r-o,D>T){if(T=D-T,T>l&&ee.sane){e.msg="invalid distance too far back",ee.mode=xC;break e}if(O=0,k=u,0===d){if(O+=c-T,T<I){I-=T;do{V[r++]=u[O++]}while(--T);O=r-D,k=V}}else if(d<T){if(O+=c+d-T,T-=d,T<I){I-=T;do{V[r++]=u[O++]}while(--T);if(O=0,d<I){T=d,I-=T;do{V[r++]=u[O++]}while(--T);O=r-D,k=V}}}else if(O+=d-T,T<I){I-=T;do{V[r++]=u[O++]}while(--T);O=r-D,k=V}for(;I>2;)V[r++]=k[O++],V[r++]=k[O++],V[r++]=k[O++],I-=3;I&&(V[r++]=k[O++],I>1&&(V[r++]=k[O++]))}else{O=r-D;do{V[r++]=V[O++],V[r++]=V[O++],V[r++]=V[O++],I-=3}while(I>2);I&&(V[r++]=V[O++],I>1&&(V[r++]=V[O++]))}break}}break}}while(n<i&&r<s);I=p>>3,n-=I,p-=I<<3,h&=(1<<p)-1,e.next_in=n,e.next_out=r,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=r<s?s-r+257:257-(r-s),ee.hold=h,ee.bits=p};const UUe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),VUe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),BUe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),jUe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var N_=(e,t,n,i,r,o,s,a)=>{const c=a.bits;let l,d,u,h,p,m,f=0,g=0,E=0,b=0,T=0,I=0,D=0,O=0,k=0,L=0,V=null;const ee=new Uint16Array(16),oe=new Uint16Array(16);let Ie,Ue,Dt,dt=null;for(f=0;f<=15;f++)ee[f]=0;for(g=0;g<i;g++)ee[t[n+g]]++;for(T=c,b=15;b>=1&&0===ee[b];b--);if(T>b&&(T=b),0===b)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(E=1;E<b&&0===ee[E];E++);for(T<E&&(T=E),O=1,f=1;f<=15;f++)if(O<<=1,O-=ee[f],O<0)return-1;if(O>0&&(0===e||1!==b))return-1;for(oe[1]=0,f=1;f<15;f++)oe[f+1]=oe[f]+ee[f];for(g=0;g<i;g++)0!==t[n+g]&&(s[oe[t[n+g]]++]=g);if(0===e?(V=dt=s,m=20):1===e?(V=UUe,dt=VUe,m=257):(V=BUe,dt=jUe,m=0),L=0,g=0,f=E,p=o,I=T,D=0,u=-1,k=1<<T,h=k-1,1===e&&k>852||2===e&&k>592)return 1;for(;;){Ie=f-D,s[g]+1<m?(Ue=0,Dt=s[g]):s[g]>=m?(Ue=dt[s[g]-m],Dt=V[s[g]-m]):(Ue=96,Dt=0),l=1<<f-D,d=1<<I,E=d;do{d-=l,r[p+(L>>D)+d]=Ie<<24|Ue<<16|Dt}while(0!==d);for(l=1<<f-1;L&l;)l>>=1;if(0!==l?(L&=l-1,L+=l):L=0,g++,0==--ee[f]){if(f===b)break;f=t[n+s[g]]}if(f>T&&(L&h)!==u){for(0===D&&(D=T),p+=E,I=f-D,O=1<<I;I+D<b&&(O-=ee[I+D],!(O<=0));)I++,O<<=1;if(k+=1<<I,1===e&&k>852||2===e&&k>592)return 1;u=L&h,r[u]=T<<24|I<<16|p-o}}return 0!==L&&(r[p+L]=f-D<<24|64<<16),a.bits=T,0};const{Z_FINISH:qJ,Z_BLOCK:HUe,Z_TREES:LC,Z_OK:nu,Z_STREAM_END:GUe,Z_NEED_DICT:WUe,Z_STREAM_ERROR:fs,Z_DATA_ERROR:YJ,Z_MEM_ERROR:$J,Z_BUF_ERROR:zUe,Z_DEFLATED:XJ}=zp,FC=16180,UC=16190,Tc=16191,VC=16199,BC=16200,Bn=16209,ZJ=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function KUe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const iu=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<FC||t.mode>16211?1:0},JJ=e=>{if(iu(e))return fs;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=FC,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,nu},QJ=e=>{if(iu(e))return fs;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,JJ(e)},eQ=(e,t)=>{let n;if(iu(e))return fs;const i=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?fs:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,QJ(e))},tQ=(e,t)=>{if(!e)return fs;const n=new KUe;e.state=n,n.strm=e,n.window=null,n.mode=FC;const i=eQ(e,t);return i!==nu&&(e.state=null),i};let T1,w1,nQ=!0;const qUe=e=>{if(nQ){T1=new Int32Array(512),w1=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(N_(1,e.lens,0,288,T1,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;N_(2,e.lens,0,32,w1,0,e.work,{bits:5}),nQ=!1}e.lencode=T1,e.lenbits=9,e.distcode=w1,e.distbits=5},iQ=(e,t,n,i)=>{let r;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(t.subarray(n-i,n-i+r),o.wnext),(i-=r)?(o.window.set(t.subarray(n-i,n),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var wc={inflateReset:QJ,inflateReset2:eQ,inflateResetKeep:JJ,inflateInit:e=>tQ(e,15),inflateInit2:tQ,inflate:(e,t)=>{let n,i,r,o,s,a,c,l,d,u,h,p,m,f,g,E,b,T,I,D,O,k,L=0;const V=new Uint8Array(4);let ee,oe;const Ie=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(iu(e)||!e.output||!e.input&&0!==e.avail_in)return fs;n=e.state,n.mode===Tc&&(n.mode=16192),s=e.next_out,r=e.output,c=e.avail_out,o=e.next_in,i=e.input,a=e.avail_in,l=n.hold,d=n.bits,u=a,h=c,k=nu;e:for(;;)switch(n.mode){case FC:if(0===n.wrap){n.mode=16192;break}for(;d<16;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(2&n.wrap&&35615===l){0===n.wbits&&(n.wbits=15),n.check=0,V[0]=255&l,V[1]=l>>>8&255,n.check=Zi(n.check,V,2,0),l=0,d=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=Bn;break}if((15&l)!==XJ){e.msg="unknown compression method",n.mode=Bn;break}if(l>>>=4,d-=4,O=8+(15&l),0===n.wbits&&(n.wbits=O),O>15||O>n.wbits){e.msg="invalid window size",n.mode=Bn;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&l?16189:Tc,l=0,d=0;break;case 16181:for(;d<16;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(n.flags=l,(255&Vi(n))!==XJ){e.msg="unknown compression method",n.mode=Bn;break}if(57344&Vi(n)){e.msg="unknown header flags set",n.mode=Bn;break}n.head&&(n.head.text=l>>8&1),512&Vi(n)&&4&n.wrap&&(V[0]=255&l,V[1]=l>>>8&255,n.check=Zi(n.check,V,2,0)),l=0,d=0,n.mode=16182;case 16182:for(;d<32;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.head&&(n.head.time=l),512&Vi(n)&&4&n.wrap&&(V[0]=255&l,V[1]=l>>>8&255,V[2]=l>>>16&255,V[3]=l>>>24&255,n.check=Zi(n.check,V,4,0)),l=0,d=0,n.mode=16183;case 16183:for(;d<16;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&Vi(n)&&4&n.wrap&&(V[0]=255&l,V[1]=l>>>8&255,n.check=Zi(n.check,V,2,0)),l=0,d=0,n.mode=16184;case 16184:if(1024&Vi(n)){for(;d<16;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.length=l,n.head&&(n.head.extra_len=l),512&Vi(n)&&4&n.wrap&&(V[0]=255&l,V[1]=l>>>8&255,n.check=Zi(n.check,V,2,0)),l=0,d=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&Vi(n)&&(p=n.length,p>a&&(p=a),p&&(n.head&&(O=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(o,o+p),O)),512&Vi(n)&&4&n.wrap&&(n.check=Zi(n.check,i,p,o)),a-=p,o+=p,n.length-=p),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&Vi(n)){if(0===a)break e;p=0;do{O=i[o+p++],n.head&&O&&n.length<65536&&(n.head.name+=String.fromCharCode(O))}while(O&&p<a);if(512&Vi(n)&&4&n.wrap&&(n.check=Zi(n.check,i,p,o)),a-=p,o+=p,O)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&Vi(n)){if(0===a)break e;p=0;do{O=i[o+p++],n.head&&O&&n.length<65536&&(n.head.comment+=String.fromCharCode(O))}while(O&&p<a);if(512&Vi(n)&&4&n.wrap&&(n.check=Zi(n.check,i,p,o)),a-=p,o+=p,O)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&Vi(n)){for(;d<16;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(4&n.wrap&&l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Bn;break}l=0,d=0}n.head&&(n.head.hcrc=Vi(n)>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Tc;break;case 16189:for(;d<32;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}e.adler=n.check=ZJ(l),l=0,d=0,n.mode=UC;case UC:if(0===n.havedict)return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=l,n.bits=d,WUe;e.adler=n.check=1,n.mode=Tc;case Tc:if(t===HUe||t===LC)break e;case 16192:if(n.last){l>>>=7&d,d-=7&d,n.mode=16206;break}for(;d<3;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}switch(n.last=1&l,l>>>=1,d-=1,3&l){case 0:n.mode=16193;break;case 1:if(qUe(n),n.mode=VC,t===LC){l>>>=2,d-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=Bn}l>>>=2,d-=2;break;case 16193:for(l>>>=7&d,d-=7&d;d<32;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Bn;break}if(n.length=65535&l,l=0,d=0,n.mode=16194,t===LC)break e;case 16194:n.mode=16195;case 16195:if(p=n.length,p){if(p>a&&(p=a),p>c&&(p=c),0===p)break e;r.set(i.subarray(o,o+p),s),a-=p,o+=p,c-=p,s+=p,n.length-=p;break}n.mode=Tc;break;case 16196:for(;d<14;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(n.nlen=257+(31&l),l>>>=5,d-=5,n.ndist=1+(31&l),l>>>=5,d-=5,n.ncode=4+(15&l),l>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Bn;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;d<3;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.lens[Ie[n.have++]]=7&l,l>>>=3,d-=3}for(;n.have<19;)n.lens[Ie[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,ee={bits:n.lenbits},k=N_(0,n.lens,0,19,n.lencode,0,n.work,ee),n.lenbits=ee.bits,k){e.msg="invalid code lengths set",n.mode=Bn;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;L=n.lencode[l&(1<<n.lenbits)-1],g=L>>>24,E=L>>>16&255,b=65535&L,!(g<=d);){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(b<16)l>>>=g,d-=g,n.lens[n.have++]=b;else{if(16===b){for(oe=g+2;d<oe;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(l>>>=g,d-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=Bn;break}O=n.lens[n.have-1],p=3+(3&l),l>>>=2,d-=2}else if(17===b){for(oe=g+3;d<oe;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}l>>>=g,d-=g,O=0,p=3+(7&l),l>>>=3,d-=3}else{for(oe=g+7;d<oe;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}l>>>=g,d-=g,O=0,p=11+(127&l),l>>>=7,d-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Bn;break}for(;p--;)n.lens[n.have++]=O}}if(n.mode===Bn)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Bn;break}if(n.lenbits=9,ee={bits:n.lenbits},k=N_(1,n.lens,0,n.nlen,n.lencode,0,n.work,ee),n.lenbits=ee.bits,k){e.msg="invalid literal/lengths set",n.mode=Bn;break}if(n.distbits=6,n.distcode=n.distdyn,ee={bits:n.distbits},k=N_(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,ee),n.distbits=ee.bits,k){e.msg="invalid distances set",n.mode=Bn;break}if(n.mode=VC,t===LC)break e;case VC:n.mode=BC;case BC:if(a>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=l,n.bits=d,FUe(e,h),s=e.next_out,r=e.output,c=e.avail_out,o=e.next_in,i=e.input,a=e.avail_in,l=n.hold,d=n.bits,n.mode===Tc&&(n.back=-1);break}for(n.back=0;L=n.lencode[l&(1<<n.lenbits)-1],g=L>>>24,E=L>>>16&255,b=65535&L,!(g<=d);){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(E&&!(240&E)){for(T=g,I=E,D=b;L=n.lencode[D+((l&(1<<T+I)-1)>>T)],g=L>>>24,E=L>>>16&255,b=65535&L,!(T+g<=d);){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}l>>>=T,d-=T,n.back+=T}if(l>>>=g,d-=g,n.back+=g,n.length=b,0===E){n.mode=16205;break}if(32&E){n.back=-1,n.mode=Tc;break}if(64&E){e.msg="invalid literal/length code",n.mode=Bn;break}n.extra=15&E,n.mode=16201;case 16201:if(n.extra){for(oe=n.extra;d<oe;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;L=n.distcode[l&(1<<n.distbits)-1],g=L>>>24,E=L>>>16&255,b=65535&L,!(g<=d);){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(!(240&E)){for(T=g,I=E,D=b;L=n.distcode[D+((l&(1<<T+I)-1)>>T)],g=L>>>24,E=L>>>16&255,b=65535&L,!(T+g<=d);){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}l>>>=T,d-=T,n.back+=T}if(l>>>=g,d-=g,n.back+=g,64&E){e.msg="invalid distance code",n.mode=Bn;break}n.offset=b,n.extra=15&E,n.mode=16203;case 16203:if(n.extra){for(oe=n.extra;d<oe;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Bn;break}n.mode=16204;case 16204:if(0===c)break e;if(p=h-c,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Bn;break}p>n.wnext?(p-=n.wnext,m=n.wsize-p):m=n.wnext-p,p>n.length&&(p=n.length),f=n.window}else f=r,m=s-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do{r[s++]=f[m++]}while(--p);0===n.length&&(n.mode=BC);break;case 16205:if(0===c)break e;r[s++]=n.length,c--,n.mode=BC;break;case 16206:if(n.wrap){for(;d<32;){if(0===a)break e;a--,l|=i[o++]<<d,d+=8}if(h-=c,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=Vi(n)?Zi(n.check,r,h,s-h):S_(n.check,r,h,s-h)),h=c,4&n.wrap&&(Vi(n)?l:ZJ(l))!==n.check){e.msg="incorrect data check",n.mode=Bn;break}l=0,d=0}n.mode=16207;case 16207:if(n.wrap&&Vi(n)){for(;d<32;){if(0===a)break e;a--,l+=i[o++]<<d,d+=8}if(4&n.wrap&&l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Bn;break}l=0,d=0}n.mode=16208;case 16208:k=GUe;break e;case Bn:k=YJ;break e;case 16210:return $J;default:return fs}return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=l,n.bits=d,(n.wsize||h!==e.avail_out&&n.mode<Bn&&(n.mode<16206||t!==qJ))&&iQ(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=Vi(n)?Zi(n.check,r,h,e.next_out-h):S_(n.check,r,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Tc?128:0)+(n.mode===VC||16194===n.mode?256:0),(0===u&&0===h||t===qJ)&&k===nu&&(k=zUe),k},inflateEnd:e=>{if(iu(e))return fs;let t=e.state;return t.window&&(t.window=null),e.state=null,nu},inflateGetHeader:(e,t)=>{if(iu(e))return fs;const n=e.state;return 2&n.wrap?(n.head=t,t.done=!1,nu):fs},inflateSetDictionary:(e,t)=>{const n=t.length;let i,r,o;return iu(e)?fs:(i=e.state,0!==i.wrap&&i.mode!==UC?fs:i.mode===UC&&(r=1,r=S_(r,t,n,0),r!==i.check)?YJ:(o=iQ(e,t,n,n),o?(i.mode=16210,$J):(i.havedict=1,nu)))},inflateInfo:"pako inflate (from Nodeca project)"},$Ue=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const rQ=Object.prototype.toString,{Z_NO_FLUSH:XUe,Z_FINISH:ZUe,Z_OK:P_,Z_STREAM_END:I1,Z_NEED_DICT:R1,Z_STREAM_ERROR:JUe,Z_DATA_ERROR:oQ,Z_MEM_ERROR:QUe}=zp;function M_(e){this.options=PC.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zJ,this.strm.avail_out=0;let n=wc.inflateInit2(this.strm,t.windowBits);if(n!==P_)throw new Error(Jd[n]);if(this.header=new $Ue,wc.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=D_.string2buf(t.dictionary):"[object ArrayBuffer]"===rQ.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=wc.inflateSetDictionary(this.strm,t.dictionary),n!==P_)))throw new Error(Jd[n])}function A1(e,t){const n=new M_(t);if(n.push(e),n.err)throw n.msg||Jd[n.err];return n.result}M_.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=t===~~t?t:!0===t?ZUe:XUe,n.input="[object ArrayBuffer]"===rQ.call(e)?new Uint8Array(e):e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),o=wc.inflate(n,s),o===R1&&r&&(o=wc.inflateSetDictionary(n,r),o===P_?o=wc.inflate(n,s):o===oQ&&(o=R1));n.avail_in>0&&o===I1&&n.state.wrap>0&&0!==e[n.next_in];)wc.inflateReset(n),o=wc.inflate(n,s);switch(o){case JUe:case oQ:case R1:case QUe:return this.onEnd(o),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||o===I1))if("string"===this.options.to){let c=D_.utf8border(n.output,n.next_out),l=n.next_out-c,d=D_.buf2string(n.output,c);n.next_out=l,n.avail_out=i-l,l&&n.output.set(n.output.subarray(c,c+l),0),this.onData(d)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(o!==P_||0!==a){if(o===I1)return o=wc.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},M_.prototype.onData=function(e){this.chunks.push(e)},M_.prototype.onEnd=function(e){e===P_&&(this.result="string"===this.options.to?this.chunks.join(""):PC.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var eVe={Inflate:M_,inflate:A1,inflateRaw:function(e,t){return(t=t||{}).raw=!0,A1(e,t)},ungzip:A1,constants:zp};const{deflate:tVe}=LUe,{inflate:nVe}=eVe;var iVe=tVe,rVe=nVe,sQ=function(e){return e[e.ONE_BYTE=0]="ONE_BYTE",e[e.TWO_BYTE=1]="TWO_BYTE",e}(sQ||{});class oVe{constructor(){y(this,"_sequence",0),y(this,"_startTime",Date.now()),y(this,"isUseOneByte",!0)}get startTime(){const t=Date.now()-this._startTime;return t<Math.pow(2,16)?t:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(t){const n={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:t};if(t.byteLength>128){const a=new Uint8Array(4);a.set([1,0,0,0]);const l={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[{id:0,length:4,data:a.buffer}]};n.commonPacketHeader.extension=1,n.extension=l,n.payload=this.compress(t),n.commonPacketHeader.length=8+(n.extension.length+2)+n.payload.byteLength}else n.commonPacketHeader.length=8+n.payload.byteLength;R("SHOW_DATASTREAM2_LOG")&&_.debug("send data header: ".concat(JSON.stringify(n.commonPacketHeader)));const i=new ArrayBuffer(n.commonPacketHeader.length),r=new Uint8Array(i),o=new DataView(i);let s=0;if(o.setUint16(s,n.commonPacketHeader.extension<<15|n.commonPacketHeader.reserved<<14|n.commonPacketHeader.length,!0),s+=2,o.setUint32(s,n.commonPacketHeader.sequence,!0),s+=4,o.setUint16(s,n.commonStreamHeader,!0),s+=2,n.extension){const a=this.serializeExtension(n.extension);r.set(new Uint8Array(a),s),s+=a.byteLength}if(r.set(new Uint8Array(n.payload),s),s+=n.payload.byteLength,s!==n.commonPacketHeader.length)throw Error("serialize error!");return i}deserialize(t){if(t.byteLength<4)return new ArrayBuffer(0);const n=new DataView(t);let i=0;const r=n.getUint16(i,!0);i+=2;const o={length:16383&r,reserved:(16384&r)>>14,extension:(32768&r)>>15,sequence:n.getUint16(i+2,!0)<<16|n.getUint16(i,!0)};let s,a;if(i+=4,R("SHOW_DATASTREAM2_LOG")&&_.debug("receive data header: ".concat(JSON.stringify(o))),n.getUint16(i,!0),i+=2,o.extension){a=this.deserializeExtension(t.slice(i)),i+=2+a.length,s=t.slice(i);let c=!1;if(a.datas.length>0){const l=a.datas.find(d=>0===d.id);l&&(c=!(1&~new DataView(l.data).getUint32(0,!0)))}s=c?this.decompress(s):s}else s=t.slice(8);return s}serializeExtension(t){const{profile:n,length:i,datas:r}=t,o=new ArrayBuffer(i+2),s=new Uint8Array(o),a=new DataView(o);let c=0;if(a.setUint8(c++,n),a.setUint8(c++,i),r.forEach(l=>{n?(a.setUint8(c++,l.id),a.setUint8(c++,l.length),s.set(new Uint8Array(l.data),c),c+=l.data.byteLength):(a.setUint8(c++,l.id|l.length<<4),s.set(new Uint8Array(l.data),c),c+=l.data.byteLength)}),c!==i+2)throw Error("serialize extension error, is ".concat(c,"!==").concat(i+2));return o}deserializeExtension(t){const n=new DataView(t);let i=0;const r=n.getUint8(i);i++;const o=n.getUint8(i);i++;const s=r===sQ.TWO_BYTE,a=[],c=new DataView(t,2);let l=0;for(;l<o;){let d=0,u=0,h=new ArrayBuffer(0);s?(d=c.getUint8(l),l++,u=c.getUint8(l),l++):(d=15&c.getUint8(l),u=c.getUint8(l)>>4,l++),u>0&&(h=c.buffer.slice(l+2,l+2+u),l+=h.byteLength),a.push({id:d,length:u,data:h})}if(l!==o)throw Error("parse error");return{profile:r,length:o,datas:a}}decompress(t){return rVe(new Uint8Array(t))}compress(t){return iVe(new Uint8Array(t))}}const sVe={name:"DataStream",create:(e,t)=>{const n=t?new J2e(e):new Q2e(e);return n.useDataStream(new oVe),n}};class aVe extends xt{constructor(t,n,i){super(),y(this,"ws",void 0),y(this,"requestId",1),y(this,"heartBeatTimer",void 0),y(this,"joinInfo",void 0),y(this,"clientId",void 0),y(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),y(this,"onClose",r=>{this.emit("close"),this.dispose()}),y(this,"onMessage",r=>{const o=JSON.parse(r.data);if(!o||"serverResponse"!==o.command||!o.requestId)return o&&"serverStatus"===o.command&&o.serverStatus&&o.serverStatus.command?(this.emit("status",o.serverStatus),void this.emit(o.serverStatus.command,o.serverStatus)):void 0;this.emit("req_".concat(o.requestId),o)}),this.joinInfo=t,this.clientId=n,this.ws=new Yg("cross-channel-".concat(this.clientId),i),this.ws.on(fe.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(fe.CONNECTED,this.onOpen),this.ws.on(fe.ON_MESSAGE,this.onMessage),this.ws.on(fe.CLOSED,this.onClose)}isConnect(){return"connected"===this.ws.state}sendMessage(t){const n=this.requestId++;return t.requestId=n,t.seq=n,this.ws.sendMessage(t),n}waitStatus(t){return new q((n,i)=>{const r=window.setTimeout(()=>{i(new N(S.TIMEOUT,"wait status timeout, status: ".concat(t)))},5e3);this.once(t,o=>{window.clearTimeout(r),o.state&&0!==o.state?i(new N(S.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(t))):n(void 0)}),this.once("dispose",()=>{window.clearTimeout(r),i(new N(S.WS_ABORT))})})}request(t){var n=this;return C(function*(){if("closed"===n.ws.state)throw new N(S.WS_DISCONNECT);"connected"!==n.ws.state&&(yield new q((a,c)=>{n.ws.once(fe.CLOSED,()=>c(new N(S.WS_ABORT))),n.ws.once(fe.CONNECTED,a)}));const r=n.sendMessage(t),o=new q((a,c)=>{const l=()=>{c(new N(S.WS_ABORT))};n.ws.once(fe.RECONNECTING,l),n.ws.once(fe.CLOSED,l),n.once("req_".concat(r),a),qn(3e3).then(()=>{n.removeAllListeners("req_".concat(r)),n.ws.off(fe.RECONNECTING,l),n.ws.off(fe.CLOSED,l),c(new N(S.TIMEOUT,"cross channel ws request timeout"))})}),s=yield o;if(!s||200!==s.code)throw new N(S.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(s)));return s})()}connect(t){var n=this;return C(function*(){n.ws.removeAllListeners(fe.REQUEST_NEW_URLS),n.ws.on(fe.REQUEST_NEW_URLS,i=>{i(t)}),yield n.ws.init(t)})()}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(t){const n=this.requestId++;return t.requestId=n,this.ws.sendMessage(t),n}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class cVe extends xt{set state(t){t!==this._state&&(t!==_r.RELAY_STATE_FAILURE&&(this.errorCode=fp.RELAY_OK),this.emit("state",t,this.errorCode),this._state=t)}get state(){return this._state}constructor(t,n,i,r,o){var s;super(),s=this,y(this,"joinInfo",void 0),y(this,"sid",void 0),y(this,"clientId",void 0),y(this,"cancelToken",nr.CancelToken.source()),y(this,"workerToken",void 0),y(this,"requestId",0),y(this,"signal",void 0),y(this,"prevChannelMediaConfig",void 0),y(this,"httpRetryConfig",void 0),y(this,"_resolution",void 0),y(this,"_state",_r.RELAY_STATE_IDLE),y(this,"errorCode",fp.RELAY_OK),y(this,"onStatus",a=>{_.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(a))),a&&a.command&&("onAudioPacketReceived"===a.command&&this.emit("event",fc.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===a.command&&this.emit("event",fc.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===a.command&&(this.errorCode=fp.SRC_TOKEN_EXPIRED,this.state=_r.RELAY_STATE_FAILURE),"onDestTokenPrivilegeDidExpire"===a.command&&(this.errorCode=fp.DEST_TOKEN_EXPIRED,this.state=_r.RELAY_STATE_FAILURE))}),y(this,"onReconnect",C(function*(){_.debug("[".concat(s.clientId,"] ChannelMediaSocket disconnect, reconnecting")),s.emit("event",fc.NETWORK_DISCONNECTED),s.state=_r.RELAY_STATE_IDLE,s.prevChannelMediaConfig&&s.sendStartRelayMessage(s.prevChannelMediaConfig).catch(a=>{s.state!==_r.RELAY_STATE_IDLE&&(_.error("auto restart channel media relay failed",a.toString()),s.errorCode=fp.SERVER_CONNECTION_LOST,s.state=_r.RELAY_STATE_FAILURE)})})),this.joinInfo=t,this.clientId=n,this.sid=up(),this.signal=new aVe(this.joinInfo,this.clientId,i),this.httpRetryConfig=r,this._resolution=o}startChannelMediaRelay(t){var n=this;return C(function*(){if(n.state!==_r.RELAY_STATE_IDLE)throw new N(S.INVALID_OPERATION);n.state=_r.RELAY_STATE_CONNECTING,yield n.connect(),_.debug("[".concat(n.clientId,"] startChannelMediaRelay: connect success"));try{yield n.sendStartRelayMessage(t)}catch(i){throw i.data&&i.data.serverResponse&&"SetSourceChannel"===i.data.serverResponse.command?new N(S.CROSS_CHANNEL_FAILED_JOIN_SRC):i.data&&i.data.serverResponse&&"SetDestChannelStatus"===i.serverResponse.command?new N(S.CROSS_CHANNEL_FAILED_JOIN_DEST):i.data&&i.data.serverResponse&&"StartPacketTransfer"===i.serverResponse.command?new N(S.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):i}n.prevChannelMediaConfig=t})()}updateChannelMediaRelay(t){var n=this;return C(function*(){if(n.state!==_r.RELAY_STATE_RUNNING)throw new N(S.INVALID_OPERATION);yield n.sendUpdateMessage(t),n.prevChannelMediaConfig=t})()}setVideoProfile(t){var n=this;return C(function*(){if(n._resolution=t,n.state!==_r.RELAY_STATE_RUNNING)throw new N(S.INVALID_OPERATION);const i=n.genMessage($i.SetVideoProfile);yield n.signal.request(i),_.debug("[".concat(n.clientId,"] startChannelMediaRelay: setVideoProfile success"))})()}stopChannelMediaRelay(){var t=this;return C(function*(){yield t.sendStopRelayMessage(),_.debug("[".concat(t.clientId,"] stopChannelMediaRelay: send stop message success")),t.state=_r.RELAY_STATE_IDLE,t.dispose()})()}dispose(){_.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=nr.CancelToken.source(),this.state=_r.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}connect(){var t=this;return C(function*(){const n=yield function dFe(e,t,n){return FM.apply(this,arguments)}(t.joinInfo,t.cancelToken.token,t.httpRetryConfig);t.workerToken=n.workerToken,yield t.signal.connect(n.addressList),t.emit("event",fc.NETWORK_CONNECTED),t.signal.on("status",t.onStatus),t.signal.on("reconnecting",t.onReconnect)})()}sendStartRelayMessage(t){var n=this;return C(function*(){const i=n.genMessage($i.StopPacketTransfer);yield n.signal.request(i),yield n.signal.waitStatus("Normal Quit"),_.debug("[".concat(n.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const r=n.genMessage($i.SetSdkProfile,t);yield n.signal.request(r),_.debug("[".concat(n.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const o=n.genMessage($i.SetSourceChannel,t);yield n.signal.request(o),yield n.signal.waitStatus("SetSourceChannelStatus"),n.emit("event",fc.PACKET_JOINED_SRC_CHANNEL),_.debug("[".concat(n.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const s=n.genMessage($i.SetSourceUserId,t);yield n.signal.request(s),_.debug("[".concat(n.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const a=n.genMessage($i.SetDestChannel,t);yield n.signal.request(a),yield n.signal.waitStatus("SetDestChannelStatus"),n.emit("event",fc.PACKET_JOINED_DEST_CHANNEL),_.debug("[".concat(n.clientId,"] startChannelMediaRelay: SetDestChannel success"));const c=n.genMessage($i.StartPacketTransfer,t);yield n.signal.request(c),n.emit("event",fc.PACKET_SENT_TO_DEST_CHANNEL),n.state=_r.RELAY_STATE_RUNNING,_.debug("[".concat(n.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),n.setVideoProfile(n._resolution)})()}sendUpdateMessage(t){var n=this;return C(function*(){const i=n.genMessage($i.UpdateDestChannel,t);yield n.signal.request(i),n.emit("event",fc.PACKET_UPDATE_DEST_CHANNEL),_.debug("[".concat(n.clientId,"] sendUpdateMessage: UpdateDestChannel success"))})()}sendStopRelayMessage(){var t=this;return C(function*(){const n=t.genMessage($i.StopPacketTransfer);yield t.signal.request(n),_.debug("[".concat(t.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))})()}genMessage(t,n){const i=[],r=[],o=[];this.requestId+=1;const s={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:No,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};"4.22.1"===s.sdkVersion&&(s.sdkVersion="0.0.1");let a=null,c=null;switch(t){case $i.SetSdkProfile:return s.clientRequest={command:"SetSdkProfile",type:"multi_channel"},s;case $i.SetSourceChannel:if(c=n&&n.getSrcChannelMediaInfo(),!c)throw new N(S.UNEXPECTED_ERROR,"can not find source config");return s.clientRequest={command:"SetSourceChannel",uid:"0",channelName:c.channelName,token:c.token||this.joinInfo.appId},s;case $i.SetSourceUserId:if(c=n&&n.getSrcChannelMediaInfo(),!c)throw new N(S.UNEXPECTED_ERROR,"can not find source config");return s.clientRequest={command:"SetSourceUserId",uid:c.uid+""},s;case $i.SetDestChannel:if(a=n&&n.getDestChannelMediaInfo(),!a)throw new N(S.UNEXPECTED_ERROR,"can not find dest config");return a.forEach(l=>{i.push(l.channelName),r.push(l.uid+""),o.push(l.token||this.joinInfo.appId)}),s.clientRequest={command:"SetDestChannel",channelName:i,uid:r,token:o},s;case $i.StartPacketTransfer:return s.clientRequest={command:"StartPacketTransfer"},s;case $i.Reconnect:return s.clientRequest={command:"Reconnect"},s;case $i.StopPacketTransfer:return s.clientRequest={command:"StopPacketTransfer"},s;case $i.UpdateDestChannel:if(a=n&&n.getDestChannelMediaInfo(),!a)throw new N(S.UNEXPECTED_ERROR,"can not find dest config");return a.forEach(l=>{i.push(l.channelName),r.push(l.uid+""),o.push(l.token||this.joinInfo.appId)}),s.clientRequest={command:"UpdateDestChannel",channelName:i,uid:r,token:o},s;case $i.SetVideoProfile:s.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return s}}const lVe={name:"ChannelMediaRelay",create:function(e){return new cVe(e.joinInfo,e.clientId,e.websocketRetryConfig||vn,e.httpRetryConfig||vn,e.resolution)}};function aQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function x_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aQ(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aQ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}class dVe extends xt{constructor(t,n,i,r){super(),y(this,"spec",void 0),y(this,"token",void 0),y(this,"websocket",void 0),y(this,"pingpongTimer",void 0),y(this,"reconnectMode","retry"),y(this,"serviceMode",void 0),y(this,"reqId",0),y(this,"commandReqId",0),y(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),y(this,"handleWebSocketMessage",o=>{if(!o.data)return;const s=JSON.parse(o.data);s.requestId?this.emit("@".concat(s.requestId,"-").concat(s.sid),s):(ne.workerEvent(this.spec.sid,{actionType:"status",serverCode:s.code,workerType:this.serviceMode===Ia.TRANSCODE?1:2}),this.emit(vl.PUBLISH_STREAM_STATUS,s))}),this.spec=n,this.token=t,this.serviceMode=r,this.websocket=new Yg("live-streaming",i),this.websocket.on(fe.CONNECTED,this.handleWebSocketOpen),this.websocket.on(fe.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(fe.REQUEST_NEW_URLS,(o,s)=>{ni(this,vl.REQUEST_NEW_ADDRESS).then(o).catch(s)}),this.websocket.on(fe.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(t){return this.websocket.init(t)}request(t,n,i,r){var o=this;return C(function*(){o.reqId+=1,"request"===t&&(o.commandReqId+=1);const s=o.commandReqId,a=o.reqId;if(!a||!o.websocket)throw new N(S.UNEXPECTED_ERROR);const c=x_({command:t,sdkVersion:"4.22.1"===No?"0.0.1":No,seq:a,requestId:a,allocate:i,cname:o.spec.cname,appId:o.spec.appId,sid:o.spec.sid,uid:o.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},n);if("closed"===o.websocket.state)throw new N(S.WS_DISCONNECT);const l=()=>new q((p,m)=>{o.websocket.once(fe.CLOSED,()=>m(new N(S.WS_ABORT))),o.websocket.once(fe.CONNECTED,p)});"connected"!==o.websocket.state&&(yield l()),c.clientRequest&&(c.clientRequest.workerToken=o.token);const d=new q((p,m)=>{const f=()=>{m(new N(S.WS_ABORT))};o.websocket.once(fe.RECONNECTING,f),o.websocket.once(fe.CLOSED,f),o.once("@".concat(a,"-").concat(o.spec.sid),g=>{p(g)})});r&&ne.workerEvent(o.spec.sid,x_(x_({},r),{},{requestId:s,actionType:"request",payload:JSON.stringify(n.clientRequest),serverCode:0,code:0}));const u=Date.now();o.websocket.sendMessage(c);let h=null;try{h=yield d}catch(p){if("closed"===o.websocket.state)throw p;return yield l(),yield o.request(t,n,i)}return r&&ne.workerEvent(o.spec.sid,x_(x_({},r),{},{requestId:s,actionType:"response",payload:JSON.stringify(h.serverResponse),serverCode:h.code,success:200===h.code,responseTime:Date.now()-u})),200!==h.code&&o.handleResponseError(h),h})()}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const t="4.22.1"===No?"0.0.1":No;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:t,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(t){switch(t.code){case Tn.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void _.warning("live stream response already exists stream");case Tn.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case Tn.LIVE_STREAM_RESPONSE_BAD_STREAM:case Tn.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new N(S.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:t.code}).throw();case Tn.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===t.serverResponse.command)return;throw new N(S.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Tn.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new N(S.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:t.code}).throw();case Tn.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const n=new N(S.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(vl.WARNING,n,t.serverResponse.url)}case Tn.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const n=new N(S.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(vl.WARNING,n,t.serverResponse.url)}case Tn.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new N(S.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Tn.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new N(S.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:t.code}).throw();case Tn.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const n=new N(S.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(vl.WARNING,n,t.serverResponse.url)}case Tn.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new N(S.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:t.code}).throw();case Tn.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new N(S.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case Tn.LIVE_STREAM_RESPONSE_WORKER_LOST:case Tn.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===t.serverResponse.command)return;throw new N(S.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Tn.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===t.serverResponse.command)return;if("UpdateTranscoding"===t.serverResponse.command||"ControlStream"===t.serverResponse.command)return new N(S.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:t.code}).throw();throw new N(S.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Tn.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Tn.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Tn.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Tn.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new N(S.LIVE_STREAMING_CDN_ERROR,"",{code:t.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{"connected"===this.websocket.state&&this.request("ping",{}).catch(NS)},6e3)}}function cQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function vr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cQ(Object(n),!0).forEach(function(i){y(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cQ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}class uVe extends xt{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vn,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vn;super(),y(this,"onLiveStreamWarning",void 0),y(this,"onLiveStreamError",void 0),y(this,"spec",void 0),y(this,"retryTimeout",1e4),y(this,"connection",void 0),y(this,"httpRetryConfig",void 0),y(this,"wsRetryConfig",void 0),y(this,"streamingTasks",new Map),y(this,"isStartingStreamingTask",!1),y(this,"taskMutex",new mi("live-streaming")),y(this,"cancelToken",nr.CancelToken.source()),y(this,"transcodingConfig",void 0),y(this,"uapResponse",void 0),y(this,"lastTaskId",1),y(this,"statusError",new Map),this.spec=t,this.httpRetryConfig=i,this.wsRetryConfig=n}setTranscodingConfig(t){var n=this;return C(function*(){const i=vr(vr({},gLe),t);var a;66!==i.videoCodecProfile&&77!==i.videoCodecProfile&&100!==i.videoCodecProfile&&(_.debug("[".concat(n.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(i.videoCodecProfile," -> 100")),i.videoCodecProfile=100),i.transcodingUsers||(i.transcodingUsers=i.userConfigs),i.transcodingUsers&&(i.transcodingUsers=i.transcodingUsers.map(a=>vr(vr(vr({},mLe),a),{},{zOrder:a.zOrder?a.zOrder+1:1}))),Mt((a=i).width)||ot(a.width,"config.width",0,1e4),Mt(a.height)||ot(a.height,"config.height",0,1e4),Mt(a.videoBitrate)||ot(a.videoBitrate,"config.videoBitrate",1,1e6),Mt(a.videoFrameRate)||ot(a.videoFrameRate,"config.videoFrameRate"),Mt(a.lowLatency)||hc(a.lowLatency,"config.lowLatency"),Mt(a.audioSampleRate)||Mn(a.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),Mt(a.audioBitrate)||ot(a.audioBitrate,"config.audioBitrate",1,128),Mt(a.audioChannels)||Mn(a.audioChannels,"config.audioChannels",[1,2,3,4,5]),Mt(a.videoGop)||ot(a.videoGop,"config.videoGop"),Mt(a.videoCodecProfile)||Mn(a.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),Mt(a.userCount)||ot(a.userCount,"config.userCount",0,17),Mt(a.backgroundColor)||ot(a.backgroundColor,"config.backgroundColor",0,16777215),Mt(a.userConfigExtraInfo)||Kn(a.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),a.transcodingUsers&&!Mt(a.transcodingUsers)&&(pc(a.transcodingUsers,"config.transcodingUsers"),a.transcodingUsers.forEach((c,l)=>{VS(c.uid),Mt(c.x)||ot(c.x,"transcodingUser[".concat(l,"].x"),0,1e4),Mt(c.y)||ot(c.y,"transcodingUser[".concat(l,"].y"),0,1e4),Mt(c.width)||ot(c.width,"transcodingUser[".concat(l,"].width"),0,1e4),Mt(c.height)||ot(c.height,"transcodingUser[".concat(l,"].height"),0,1e4),Mt(c.zOrder)||ot(c.zOrder-1,"transcodingUser[".concat(l,"].zOrder"),0,100),Mt(c.alpha)||ot(c.alpha,"transcodingUser[".concat(l,"].alpha"),0,1,!1)})),Mt(a.watermark)||EP(a.watermark,"watermark"),Mt(a.backgroundImage)||EP(a.backgroundImage,"backgroundImage"),a.images&&!Mt(a.images)&&(pc(a.images,"config.images"),a.images.forEach((c,l)=>{EP(c,"images[".concat(l,"]"))}));const r=[];i.images&&r.push(...i.images.map(a=>vr(vr(vr({},vP),a),{},{zOrder:255}))),i.backgroundImage&&(r.push(vr(vr(vr({},vP),i.backgroundImage),{},{zOrder:0})),delete i.backgroundImage),i.watermark&&(r.push(vr(vr(vr({},vP),i.watermark),{},{zOrder:255})),delete i.watermark),i.images=r,i.transcodingUsers&&(i.userConfigs=i.transcodingUsers.map(a=>vr({},a)),i.userCount=i.transcodingUsers.length,delete i.transcodingUsers);const o=(i.userConfigs||[]).map(a=>"number"==typeof a.uid?q.resolve(a.uid):eX(a.uid,n.spec,n.cancelToken.token,n.httpRetryConfig));if((yield q.all(o)).forEach((a,c)=>{i.userConfigs&&i.userConfigs[c]&&(i.userConfigs[c].uid=a)}),n.transcodingConfig=i,n.connection)try{var s;const a=yield n.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:n.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(gc(s=n.streamingTasks).call(s)).map(c=>c.taskId).join("#")});_.debug("[".concat(n.spec.clientId,"] update live transcoding config success, code: ").concat(a.code,", config:"),JSON.stringify(n.transcodingConfig))}catch(a){if(!a.data||!a.data.retry)throw a;a.data.changeAddress&&n.connection.tryNextAddress(),n.streamingTasks.forEach(c=>{_.warning("[".concat(n.spec.clientId,"] live streaming receive error"),a.toString(),"try to republish",c.url),n.startLiveStreamingTask(c.url,c.mode,a).then(()=>{_.debug("[".concat(n.spec.clientId,"] live streaming republish ").concat(c.url," success"))}).catch(l=>{_.error("[".concat(n.spec.clientId,"] live streaming republish failed"),c.url,l.toString()),n.onLiveStreamError&&n.onLiveStreamError(c.url,l)})})}})()}startLiveStreamingTask(t,n,i){var r=this;return C(function*(){if(!r.transcodingConfig&&n===Ia.TRANSCODE)throw new N(S.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const o={command:"PublishStream",ts:Date.now(),url:t,uid:r.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};_.debug("[".concat(r.spec.clientId,"] start live streaming ").concat(t,", mode: ").concat(n));const s=yield r.taskMutex.lock();if(!r.connection&&i)return void s();if(r.streamingTasks.get(t)&&!i)return s(),new N(S.LIVE_STREAMING_TASK_CONFLICT).throw();try{r.connection||(r.connection=yield r.connect(n))}catch(c){throw s(),c}n===Ia.TRANSCODE&&(o.transcodingConfig=vr({},r.transcodingConfig)),r.uapResponse&&r.uapResponse.vid&&(o.vid=r.uapResponse.vid),r.isStartingStreamingTask=!0;const a=r.lastTaskId++;try{const c=new q((d,u)=>{qn(r.retryTimeout).then(()=>{if(i)return u(i);const h=r.statusError.get(t);return h?(r.statusError.delete(t),u(h)):void 0})}),l=yield q.race([r.connection.request("request",{clientRequest:o},!0,{url:t,command:"PublishStream",workerType:n===Ia.TRANSCODE?1:2,requestByUser:!i,tid:a.toString()}),c]);r.isStartingStreamingTask=!1,_.debug("[".concat(r.spec.clientId,"] live streaming started, code: ").concat(l.code)),r.streamingTasks.set(t,{clientRequest:o,mode:n,url:t,taskId:a}),s()}catch(c){if(s(),r.isStartingStreamingTask=!1,!c.data||!c.data.retry||i)throw c;return c.data.changeAddress?(r.connection.tryNextAddress(),yield r.startLiveStreamingTask(t,n,c)):yield r.startLiveStreamingTask(t,n,c)}})()}stopLiveStreamingTask(t){return new q((n,i)=>{const r=this.streamingTasks.get(t);if(!r||!this.connection)return new N(S.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const o=r.mode;r.abortTask=()=>{_.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(t),n()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:r.url}},!1,{url:t,command:"UnPublishStream",workerType:o===Ia.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(s=>{_.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(s.code)),this.streamingTasks.delete(t),0===this.streamingTasks.size&&(this.connection&&this.connection.close(),this.connection=void 0),n()}).catch(i)})}resetAllTask(){var t;const n=Array.from(gc(t=this.streamingTasks).call(t));this.terminate();for(const i of n)this.startLiveStreamingTask(i.url,i.mode).catch(r=>{this.onLiveStreamError&&this.onLiveStreamError(i.url,r)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=nr.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}connect(t){var n=this;return C(function*(){if(n.connection)throw new N(S.UNEXPECTED_ERROR,"live streaming connection has already connected");const i=yield ni(n,bP.REQUEST_WORKER_MANAGER_LIST,t);return n.uapResponse=i,n.connection=new dVe(i.workerToken,n.spec,n.wsRetryConfig,t),n.connection.on(vl.WARNING,(r,o)=>n.onLiveStreamWarning&&n.onLiveStreamWarning(o,r)),n.connection.on(vl.PUBLISH_STREAM_STATUS,r=>n.handlePublishStreamServer(r)),n.connection.on(vl.REQUEST_NEW_ADDRESS,(r,o)=>{if(!n.connection)return o(new N(S.UNEXPECTED_ERROR,"can not get new live streaming address list"));ni(n,bP.REQUEST_WORKER_MANAGER_LIST,t).then(s=>{n.uapResponse=s,r(s.addressList)}).catch(o)}),yield n.connection.init(i.addressList),n.connection})()}handlePublishStreamServer(t){const n=t.serverStatus&&t.serverStatus.url||"empty_url",i=this.streamingTasks.get(n),r=t.reason;switch(t.code){case Tn.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Tn.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Tn.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Tn.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const s=new N(S.LIVE_STREAMING_CDN_ERROR,"",{code:t.code});if(i)return _.error(s.toString()),this.onLiveStreamError&&this.onLiveStreamError(n,s);if(!this.isStartingStreamingTask)return;this.statusError.set(n,s)}case Tn.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const s=new N(S.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,r);return this.onLiveStreamWarning&&this.onLiveStreamWarning(n,s)}case Tn.LIVE_STREAM_RESPONSE_WORKER_LOST:case Tn.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var o;if(!this.connection)return;this.connection.tryNextAddress();const s=Array.from(gc(o=this.streamingTasks).call(o));for(const a of s)a.abortTask?a.abortTask():(_.warning("[".concat(this.spec.clientId,"] publish stream status code"),t.code,"try to republish",a.url),this.startLiveStreamingTask(a.url,a.mode,new N(S.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:t.code})).then(()=>{_.debug("[".concat(this.spec.clientId,"] republish live stream success"),a.url)}).catch(c=>{_.error(c.toString()),this.onLiveStreamError&&this.onLiveStreamError(a.url,c)}));return}}}hasUrl(t){return this.streamingTasks.has(t)}}const hVe={name:"LiveStreaming",create:function(e){return new uVe(e.joinInfo,e.websocketRetryConfig||vn,e.httpRetryConfig||vn)}};function mVe(e){let t={};e:for(;!hQ(e);){let n=ja(e);switch(n>>>3){case 0:break e;case 1:t.requestId=pQ(e,ja(e));break;case 2:t.requestType=ja(e)>>>0;break;case 3:t.scorePorn=P1(e);break;case 4:t.scoreSexy=P1(e);break;case 5:t.scoreNeutral=P1(e);break;case 6:t.requestScene=ja(e)>>>0;break;case 7:t.scene=ja(e)>>>0;break;default:lQ(e,7&n)}}return t}function gVe(e,t){let n=e.service;void 0!==n&&(et(t,8),et(t,n));let i=e.vendor;void 0!==i&&(et(t,16),et(t,i));let r=e.token;void 0!==r&&(et(t,26),Ba(t,r));let o=e.callbackUrl;void 0!==o&&(et(t,34),Ba(t,o))}function _Ve(e){let t=ja(e),n=e.limit;return e.limit=e.offset+t,n}function lQ(e,t){switch(t){case 0:for(;128&fQ(e););break;case 2:O1(e,ja(e));break;case 5:O1(e,4);break;case 1:O1(e,8);break;default:throw new Error("Unimplemented type: "+t)}}let vVe=new Float32Array(1);new Uint8Array(vVe.buffer);let D1=new Float64Array(1),Er=new Uint8Array(D1.buffer);function $p(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let dQ=[];function uQ(){const e=dQ.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function EVe(e){dQ.push(e)}function O1(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function hQ(e){return e.offset>=e.limit}function Xp(e,t){let n=e.bytes,i=e.offset,r=e.limit,o=i+t;if(o>n.length){let s=new Uint8Array(2*o);s.set(n),e.bytes=s}return e.offset=o,o>r&&(e.limit=o),i}function N1(e,t){let n=e.offset;if(n+t>e.limit)throw new Error("Read past limit");return e.offset+=t,n}function pQ(e,t){let n=N1(e,t),i=String.fromCharCode,r=e.bytes,o="\ufffd",s="";for(let a=0;a<t;a++){let c,l,d,u,h=r[a+n];128&h?192==(224&h)?a+1>=t?s+=o:(c=r[a+n+1],128!=(192&c)?s+=o:(u=(31&h)<<6|63&c,u<128?s+=o:(s+=i(u),a++))):224==(240&h)?a+2>=t?s+=o:(c=r[a+n+1],l=r[a+n+2],32896!=(49344&(c|l<<8))?s+=o:(u=(15&h)<<12|(63&c)<<6|63&l,u<2048||u>=55296&&u<=57343?s+=o:(s+=i(u),a+=2))):240==(248&h)?a+3>=t?s+=o:(c=r[a+n+1],l=r[a+n+2],d=r[a+n+3],8421504!=(12632256&(c|l<<8|d<<16))?s+=o:(u=(7&h)<<18|(63&c)<<12|(63&l)<<6|63&d,u<65536||u>1114111?s+=o:(u-=65536,s+=i(55296+(u>>10),56320+(1023&u)),a+=3))):s+=o:s+=i(h)}return s}function Ba(e,t){let n=t.length,i=0;for(let s=0;s<n;s++){let a=t.charCodeAt(s);a>=55296&&a<=56319&&s+1<n&&(a=(a<<10)+t.charCodeAt(++s)-56613888),i+=a<128?1:a<2048?2:a<65536?3:4}et(e,i);let r=Xp(e,i),o=e.bytes;for(let s=0;s<n;s++){let a=t.charCodeAt(s);a>=55296&&a<=56319&&s+1<n&&(a=(a<<10)+t.charCodeAt(++s)-56613888),a<128?o[r++]=a:(a<2048?o[r++]=a>>6&31|192:(a<65536?o[r++]=a>>12&15|224:(o[r++]=a>>18&7|240,o[r++]=a>>12&63|128),o[r++]=a>>6&63|128),o[r++]=63&a|128)}}function bVe(e,t){let n=Xp(e,t.limit),i=e.bytes,r=t.bytes;for(let o=0,s=t.limit;o<s;o++)i[o+n]=r[o]}function fQ(e){return e.bytes[N1(e,1)]}function mQ(e,t){let n=Xp(e,1);e.bytes[n]=t}function P1(e){let t=N1(e,8),n=e.bytes;return Er[0]=n[t++],Er[1]=n[t++],Er[2]=n[t++],Er[3]=n[t++],Er[4]=n[t++],Er[5]=n[t++],Er[6]=n[t++],Er[7]=n[t++],D1[0]}function M1(e,t){let n=Xp(e,8),i=e.bytes;D1[0]=t,i[n++]=Er[0],i[n++]=Er[1],i[n++]=Er[2],i[n++]=Er[3],i[n++]=Er[4],i[n++]=Er[5],i[n++]=Er[6],i[n++]=Er[7]}function ja(e){let t,n=0,i=0;do{t=fQ(e),n<32&&(i|=(127&t)<<n),n+=7}while(128&t);return i}function et(e,t){for(t>>>=0;t>=128;)mQ(e,127&t|128),t>>>=7;mQ(e,t)}function xl(e,t){let n=t.low>>>0,i=(t.low>>>28|t.high<<4)>>>0,r=t.high>>>24,o=0===r?0===i?n<16384?n<128?1:2:n<1<<21?3:4:i<16384?i<128?5:6:i<1<<21?7:8:r<128?9:10,s=Xp(e,o),a=e.bytes;switch(o){case 10:a[s+9]=r>>>7&1;case 9:a[s+8]=9!==o?128|r:127&r;case 8:a[s+7]=8!==o?i>>>21|128:i>>>21&127;case 7:a[s+6]=7!==o?i>>>14|128:i>>>14&127;case 6:a[s+5]=6!==o?i>>>7|128:i>>>7&127;case 5:a[s+4]=5!==o?128|i:127&i;case 4:a[s+3]=4!==o?n>>>21|128:n>>>21&127;case 3:a[s+2]=3!==o?n>>>14|128:n>>>14&127;case 2:a[s+1]=2!==o?n>>>7|128:n>>>7&127;case 1:a[s]=1!==o?128|n:127&n}}function gQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}const yVe=new Map([["moderation",1],["supervise",2]]);function _Q(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}class SVe extends xt{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;const n=this._connectionState;this._connectionState=t,this.emit(Vn.CONNECTION_STATE_CHANGE,n,t)}get inspectType(){return this._inspectType}set inspectType(t){var n;this._inspectMode=Ps(n=t.map(i=>yVe.get(i)||0)).call(n,(i,r)=>i+r),this._inspectType=t}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(t){super(),y(this,"name","AgoraRTCVideoContentInspect"),y(this,"_connectionState",Qo.CONNECTING),y(this,"_innerConnectionState",void 0),y(this,"sequence",0),y(this,"inspectStartTime",void 0),y(this,"workerManagerConnection",void 0),y(this,"workerConnection",void 0),y(this,"workerMessageLengthLimit",void 0),y(this,"inspectIntervalMinimum",void 0),y(this,"qualityRatio",void 0),y(this,"_connectInfo",void 0),y(this,"_cancelTokenSource",nr.CancelToken.source()),y(this,"_retryConfig",void 0),y(this,"wmSequence",0),y(this,"inspectInterval",void 0),y(this,"inspectTimer",null),y(this,"ossFilePrefix",void 0),y(this,"extraInfo",void 0),y(this,"_inspectType",void 0),y(this,"_inspectMode",void 0),y(this,"_quality",1),y(this,"qualityTimer",null),y(this,"_inspectId",void 0),y(this,"_needWorkUrlOnly",!1),y(this,"inspectImage",()=>{if(this.connectionState!==Qo.CONNECTED)throw new N(S.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===Qo.CONNECTED?this.requestToInspectImage():_.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=gt(5,"inspect-"),this.workerMessageLengthLimit=R("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=R("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=R("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=t.interval,this.ossFilePrefix=t.ossFilePrefix,this.extraInfo=t.extraInfo,this.inspectType=t.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new Yg("worker-manager-"+this._inspectId,vn),this.on(Vn.STATE_CHANGE,(n,i)=>{this._innerConnectionState=n,_.debug("[".concat(this._inspectId,"] Inspect operation :").concat(es[n]," ").concat(i||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new Yg("worker-"+this._inspectId,vn),this.handleWorkerEvents()}init(t,n){var i=this;return C(function*(){i.emit(Vn.STATE_CHANGE,es.CONNECT_AP),i._connectInfo=t;const r=i._cancelTokenSource.token;return i._retryConfig=n,new q((o,s)=>{i.on(Vn.CONNECTION_STATE_CHANGE,(a,c)=>{c===Qo.CONNECTED&&o()}),i.requestAP(t,r,n).then(a=>{i.connectWorkerManager(a)}).catch(a=>{s(a)})})})()}requestAP(t,n,i){var r=this;return C(function*(){const o=R("WEBCS_DOMAIN").map(c=>"https://".concat(c,"/api/v1")),s=yield function(c,l,d,u){let{appId:h,areaCode:p,cname:m,sid:f,token:g,uid:E}=l;Up++;const b="image_moderation_api",T={service_name:b,json_body:JSON.stringify({appId:h,areaCode:p,cname:m,command:"allocateEdge",requestId:Up,seq:Up,sid:f,token:g,ts:Date.now(),uid:E+""})};let I,D,O=c[0];return Fs(C(function*(){I=Date.now();const k=yield js(O,{data:T,cancelToken:d,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(D=Date.now()-I,0!==k.code){const oe=new N(S.UNEXPECTED_RESPONSE,"image inspect ap error, code"+k.code,{retry:!0,responseTime:D});throw _.error(oe.toString()),oe}const L=JSON.parse(k.json_body);if(200!==L.code){const oe=new N(S.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(L.code,", reason: ").concat(L.reason),{code:L.code,responseTime:D});throw _.error(oe.toString()),oe}if(!L.servers||!Array.isArray(L.servers)||0===L.servers.length){const oe=new N(S.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:L.code,responseTime:D});throw _.error(oe.toString()),oe}const V=R("VIDEO_INSPECT_WORKER_MANAGER_HOST"),ee=R("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:L.servers.map(oe=>{let{address:Ie,wss:Ue}=oe;if(Ie&&Ue)return"wss://".concat(Ie.replace(/\./g,"-"),".").concat(V,":").concat(ee||Ue)}).filter(oe=>!!oe),workerToken:L.workerToken,vid:L.vid,responseTime:D}}),(k,L)=>(ne.apworkerEvent(f,{success:!0,sc:200,serviceName:b,responseDetail:JSON.stringify(k.addressList),firstSuccess:0===L,responseTime:D,serverIp:c[L%c.length]}),!1),(k,L)=>(ne.apworkerEvent(f,{success:!1,sc:k.data&&k.data.code||200,serviceName:b,responseTime:D,serverIp:c[L%c.length]}),!!(k.code!==S.OPERATION_ABORTED&&k.code!==S.UNEXPECTED_RESPONSE||k.data&&k.data.retry)&&(O=c[(L+1)%c.length],!0)),u)}(o,t,n,i);r.emit(Vn.STATE_CHANGE,es.AP_CONNECTED);const{addressList:a}=s;return r.wmSequence++,a})()}connectWorkerManager(t){var n=arguments,i=this;return C(function*(){i._needWorkUrlOnly=n.length>1&&void 0!==n[1]&&n[1],i.emit(Vn.STATE_CHANGE,es.CONNECT_WORKER_MANAGER),yield i.workerManagerConnection.init(t,1e4)})()}connectWorker(t){var n=this;return C(function*(){yield n.workerConnection.init([t])})()}handleWorkerManagerEvents(){var t=this;this.workerManagerConnection.on(fe.CONNECTED,C(function*(){t.emit(Vn.STATE_CHANGE,es.WORKER_MANAGER_CONNECTED,t.workerManagerConnection.url),t.workerManagerConnection.sendMessage({appId:t._connectInfo.appId,cname:t._connectInfo.cname,uid:t._connectInfo.uid+"",sdkVersion:"4.22.1",sid:t._connectInfo.sid,seq:t.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)})),this.workerManagerConnection.on(fe.CLOSED,()=>{this._innerConnectionState<es.GET_WORKER_MANAGER_RESPONSE&&_.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(fe.FAILED,()=>{this._innerConnectionState<es.GET_WORKER_MANAGER_RESPONSE&&_.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(fe.RECONNECTING,()=>{this._innerConnectionState<es.GET_WORKER_MANAGER_RESPONSE&&_.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(fe.ON_MESSAGE,function(){var n=C(function*(i){t.emit(Vn.STATE_CHANGE,es.GET_WORKER_MANAGER_RESPONSE);const r=t.workerManagerConnection.url;t.workerManagerConnection.close();const o=JSON.parse(i.data);if(200!==o.code)throw _.error("[".concat(t._inspectId,"] Unexpected code ").concat(o.code," from worker manager")),new N(S.UNEXPECTED_RESPONSE,"response code of worker is unexpected",o);if(!(o.serverResponse&&o.serverResponse.portWss&&r))throw _.error("[".concat(t._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(o))),new N(S.UNEXPECTED_RESPONSE,"response content of worker is unexpected",o);{const s=R("VIDEO_INSPECT_WORKER_PORT")||o.serverResponse.portWss,a=r.replace(/:\d+\/?$/,":".concat(s));t.emit(Vn.STATE_CHANGE,es.CONNECT_WORKER,a),t._needWorkUrlOnly?t.emit(Vn.REQUEST_NEW_WORKER_URL,a):yield t.connectWorker(a)}});return function(i){return n.apply(this,arguments)}}()),this.workerManagerConnection.on(fe.WILL_RECONNECT,(n,i,r)=>{r(n)}),this.workerManagerConnection.on(fe.REQUEST_NEW_URLS,(n,i)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(n).catch(i)})}handleWorkerEvents(){var t=this;this.workerConnection.on(fe.CONNECTED,C(function*(){t.emit(Vn.STATE_CHANGE,es.WORKER_CONNECTED,t.workerConnection.url),t.connectionState=Qo.CONNECTED})),this.workerConnection.on(fe.ON_MESSAGE,function(){var n=C(function*(i){if(i.data instanceof ArrayBuffer){const o=function fVe(e){return function(n){let i={};e:for(;!hQ(n);){let r=ja(n);switch(r>>>3){case 0:break e;case 1:i.code=ja(n);break;case 2:i.msg=pQ(n,ja(n));break;case 3:{let o=_Ve(n);i.data=mVe(n),n.limit=o;break}default:lQ(n,7&r)}}return i}({bytes:t=e,offset:0,limit:t.length});var t}(new Uint8Array(i.data));if(R("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&_.debug("[".concat(t._inspectId,"] Response message for worker of inspect content "),JSON.stringify(o)),200===o.code){if(Array.isArray(t.inspectType)&&1===t.inspectType.length&&"supervise"===t.inspectType[0])return void t.emit(Vn.INSPECT_RESULT,void 0,void 0);if(o.data&&o.data.scorePorn&&o.data.scoreSexy&&o.data.scoreNeutral){var r;const s={porn:o.data.scorePorn,sexy:o.data.scoreSexy,neutral:o.data.scoreNeutral},a=Ps(r=Object.keys(s)).call(r,(l,d)=>s[l]>s[d]?l:d,"porn"),c=Object.keys(s).find(l=>l===a);t.emit(Vn.INSPECT_RESULT,c)}else t.emit(Vn.INSPECT_RESULT,void 0,new N(S.UNEXPECTED_RESPONSE,o.code+"","There is an unexpected data on message"))}else t.emit(Vn.INSPECT_RESULT,void 0,new N(S.UNEXPECTED_RESPONSE,o.code+"",o.msg))}else _.error("[".concat(t._inspectId,"] Unexpected message type from worker")),t.emit(Vn.INSPECT_RESULT,void 0,new N(S.UNEXPECTED_RESPONSE,"invalid worker message type"))});return function(i){return n.apply(this,arguments)}}()),this.workerConnection.on(fe.CLOSED,()=>{this.connectionState=Qo.CLOSED}),this.workerConnection.on(fe.FAILED,()=>{this.connectionState=Qo.CLOSED}),this.workerConnection.on(fe.RECONNECTING,()=>{this.connectionState=this.connectionState===Qo.CONNECTED?Qo.RECONNECTING:Qo.CONNECTING}),this.workerConnection.on(fe.WILL_RECONNECT,(n,i,r)=>{"recover"===n&&r(n),r("tryNext")}),this.workerConnection.on(fe.REQUEST_NEW_URLS,(n,i)=>{this.workerManagerConnection.close(),this.once(Vn.REQUEST_NEW_WORKER_URL,r=>{n([r])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(r=>{this.connectWorkerManager(r,!0)}).catch(r=>{i(r)})})}requestToInspectImage(){var t=this;return C(function*(){t.sequence++;const n=Oo(t,Vn.CLIENT_LOCAL_VIDEO_TRACK),i={appId:t._connectInfo.appId,cname:t._connectInfo.cname,cid:t._connectInfo.cid,sid:t._connectInfo.sid,uid:t._connectInfo.uid,vid:t._connectInfo.vid};if(n){if(!n.isPlaying)return void t.emit(Vn.INSPECT_RESULT,void 0,new N(S.INVALID_OPERATION,"Only the track being played can be inspected"));const r=yield t.generateRequestData(n,i);t.workerConnection.sendMessage(r,!0,!0)}else t.emit(Vn.INSPECT_RESULT,void 0,new N(S.INVALID_OPERATION,"Only the track being published can be inspected"))})()}generateRequestData(t,n){var i=this;return C(function*(){let{appId:r,cname:o,cid:s,vid:a,sid:c,uid:l}=n;const d=Date.now(),u=yield t.getCurrentFrameImage("image/jpeg",i.quality),h=yield eY(u,r,o),p=i.sequence+"-"+s+"-"+l+"-"+d+"-"+gt(12,""),m={appId:r,cid:s,cname:o,deviceId:"",elapse:_Q(Number(d-i.inspectStartTime)),fileSize:h.byteLength,jpgEncryption:2,height:u.height,width:u.width,jpg:h,networkType:6,osType:7,requestId:p,sdkVersion:"4.22.1",sequence:i.sequence,sid:c,timestamp:_Q(d),uid:l,vid:a,service:i._inspectMode,callbackData:i.extraInfo,ossFilePrefix:i.ossFilePrefix};void 0===i.extraInfo&&delete m.callbackData,void 0===i.ossFilePrefix&&delete m.ossFilePrefix;const f=function pVe(e){let t=uQ();return function(n,i){let r=n.appId;void 0!==r&&(et(i,10),Ba(i,r));let o=n.cid;void 0!==o&&(et(i,16),et(i,o));let s=n.cname;void 0!==s&&(et(i,26),Ba(i,s));let a=n.deviceId;void 0!==a&&(et(i,34),Ba(i,a));let c=n.elapse;void 0!==c&&(et(i,40),xl(i,c));let l=n.fileSize;void 0!==l&&(et(i,48),xl(i,$p(l)));let d=n.height;void 0!==d&&(et(i,56),xl(i,$p(d)));let u=n.jpg;void 0!==u&&(et(i,66),et(i,u.length),function(me,P){let F=Xp(me,P.length);me.bytes.set(P,F)}(i,u));let h=n.networkType;void 0!==h&&(et(i,72),xl(i,$p(h)));let p=n.osType;void 0!==p&&(et(i,80),xl(i,$p(p)));let m=n.requestId;void 0!==m&&(et(i,90),Ba(i,m));let f=n.sdkVersion;void 0!==f&&(et(i,98),Ba(i,f));let g=n.sequence;void 0!==g&&(et(i,104),xl(i,$p(g)));let E=n.sid;void 0!==E&&(et(i,114),Ba(i,E));let b=n.timestamp;void 0!==b&&(et(i,120),xl(i,b));let T=n.uid;void 0!==T&&(et(i,128),et(i,T));let I=n.vid;void 0!==I&&(et(i,136),et(i,I));let D=n.width;void 0!==D&&(et(i,144),xl(i,$p(D)));let O=n.service;void 0!==O&&(et(i,152),et(i,O));let k=n.callbackData;void 0!==k&&(et(i,162),Ba(i,k));let L=n.jpgEncryption;void 0!==L&&(et(i,168),et(i,L));let V=n.requestType;void 0!==V&&(et(i,176),et(i,V));let ee=n.scorePorn;void 0!==ee&&(et(i,185),M1(i,ee));let oe=n.scoreSexy;void 0!==oe&&(et(i,193),M1(i,oe));let Ie=n.scoreNeutral;void 0!==Ie&&(et(i,201),M1(i,Ie));let Ue=n.scene;void 0!==Ue&&(et(i,208),et(i,Ue));let Dt=n.ossFilePrefix;void 0!==Dt&&(et(i,218),Ba(i,Dt));let dt=n.serviceVendor;if(void 0!==dt)for(let me of dt){et(i,226);let P=uQ();gVe(me,P),et(i,P.limit),bVe(i,P),EVe(P)}}(e,t),function(n){let i=n.bytes,r=n.limit;return i.length===r?i:i.subarray(0,r)}(t)}(m);if(f.byteLength<i.workerMessageLengthLimit){if(R("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const g=function(E){for(var b=1;b<arguments.length;b++){var T=null!=arguments[b]?arguments[b]:{};b%2?gQ(Object(T),!0).forEach(function(I){y(E,I,T[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(T)):gQ(Object(T)).forEach(function(I){Object.defineProperty(E,I,Object.getOwnPropertyDescriptor(T,I))})}return E}({},m);delete g.jpg,_.debug("[".concat(i._inspectId,"] Request message for worker of inspect content "),JSON.stringify(g))}return f}return i.quality=i.quality*i.qualityRatio,yield i.generateRequestData(t,{appId:r,cname:o,cid:s,vid:a,sid:c,uid:l})})()}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=nr.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=Qo.CLOSED,this.emit(Vn.STATE_CHANGE,es.CLOSED)}}const CVe={name:"ContentInspect",create:function(e){let{config:t}=e;return function(n){if(!n)throw new N(S.INVALID_PARAMS,"inspectConfig is necessary.");if(!n.inspectType||!Array.isArray(n.inspectType))throw new N(S.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const i=[...new Set(n.inspectType)];i.forEach(r=>{var o;if(!Y(o=["supervise","moderation"]).call(o,r))throw new N(S.INVALID_PARAMS,"".concat(r," is not a valid inspect type."))}),n.inspectType=i}if(n&&n.extraInfo&&n.extraInfo.length>1024)throw new N(S.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(t),new SVe(t)}};st("PROCESS_ID","process-".concat(gt(8,""),"-").concat(gt(4,""),"-").concat(gt(4,""),"-").concat(gt(4,""),"-").concat(gt(12,""))),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(t){return void _.error("Error loading sdk config",t.message)}if(e)try{const t=JSON.parse(window.atob(e)),n=Date.now();_.debug("Loading global parameters from cache",t),Object.keys(t).forEach(i=>{if(Object.prototype.hasOwnProperty.call(Jt,i)){const{value:r,expires:o}=t[i];if(o&&o<=n)return;_l[i]=r,Jt[i]=r}})}catch(t){_.error("Error loading mutableParamsCache: ".concat(e),t.message)}}(),Array.isArray(_l.AREAS)&&_l.AREAS.length>0&&TM(_l.AREAS,!0);const vQ=(e,t,n)=>{_.debug("setParameter key:".concat(e,", value:").concat(JSON.stringify(t))),st(e,t,n)};h_(lVe,!1),h_(hVe,!1),h_(qFe,!1),h_(CVe,!1),h_(sVe,!1);const En=function(e){const t=new xt,n=e,i={getListeners:t.getListeners.bind(t),on:(r,o)=>(r===Ra.SECURITY_POLICY_VIOLATION&&vJ(o,!0),t.on.bind(t)(r,o)),addListener:t.addListener.bind(t),once:t.once.bind(t),off:t.off.bind(t),removeAllListeners:t.removeAllListeners.bind(t),emit:t.emit.bind(t),safeEmit:t.safeEmit.bind(t)};return _J(_J({},n),i)}({__TRACK_LIST__:Ip,VERSION:No,BUILD:dP,ESM_BUNDLER:!1,ESM:!0,UMD:!1,DEV:!1,setParameter:vQ,getParameter:R,getSupportedCodec:function(){var e=C(function*(){let t={audio:[],video:[]};try{let n=new RTCPeerConnection;const i=yield(r=C(function*(o){let s;return Fe().supportUnifiedPlan?(o.addTransceiver("video",{direction:"recvonly"}),o.addTransceiver("audio",{direction:"recvonly"}),s=(yield o.createOffer()).sdp):s=(yield o.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,s}),function(o){return r.apply(this,arguments)})(n);if(!i)return t;n.close(),n=null,t=function(r){const o={video:[],audio:[]};return r.match(/ VP8/i)&&o.video.push("VP8"),r.match(/ VP9/i)&&o.video.push("VP9"),r.match(/ AV1/i)&&o.video.push("AV1"),r.match(/ H264/i)&&o.video.push("H264"),r.match(/ H265/i)&&o.video.push("H265"),r.match(/ opus/i)&&o.audio.push("OPUS"),r.match(/ PCMU/i)&&o.audio.push("PCMU"),r.match(/ PCMA/i)&&o.audio.push("PCMA"),r.match(/ G722/i)&&o.audio.push("G722"),o}(i)}catch(n){throw new N(S.CREATE_OFFER_FAILED,n.toString&&n.toString()).print()}var r;return t});return function(){return e.apply(this,arguments)}}(),checkSystemRequirements:function(){const e=ne.reportApiInvoke(null,{name:Cn.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:jt.TRACER});let t=!1;try{const o=window.RTCPeerConnection,s=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,a=window.WebSocket;t=!!(o&&s&&a),t&&ZN()&&X7(75)&&(new o).close()}catch(o){return _.error("check system requirement failed: ",o),!1}let n=!1;const i=xe();i.name===Ye.CHROME&&Number(i.version)>=58&&("WebKit"!==Ls.engine.name||function(){const o=xe();if(IS()){if(o.os===kn.MAC_OS)return!0;if(o.os===kn.IOS){const s=Ls.os.version&&Ls.os.version.split(".");if(s&&14===Number(s[0])&&s[1]&&Number(s[1])>=3||s&&Number(s[0])>14)return!0}}return!1}())&&(n=!0),(i.name===Ye.FIREFOX&&Number(i.version)>=56||i.name===Ye.OPERA&&Number(i.version)>=45||i.name===Ye.SAFARI&&Number(i.version)>=11||"WebKit"===i.name&&(Ki()||Zo())&&i.osVersion&&Number(i.osVersion.split(".")[0])>=11||rK()||xe().name===Ye.QQ)&&(n=!0),_.debug("checkSystemRequirements, api:",t,"browser",n);const r=t&&n;return e.onSuccess(r),r},getDevices:function(e){return ro.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return ro.getRecordingDevices(e)},getCameras:function(e){return ro.getCamerasDevices(e)},getElectronScreenSources:Gq,getPlaybackDevices:function(e){return ro.getSpeakers(e)},createClient:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const n=ne.reportApiInvoke(null,{name:Cn.CREATE_CLIENT,options:[t],tag:jt.TRACER});try{Mn((i=t).codec,"config.codec",["vp8","vp9","av1","h264","h265"]),Mn(i.mode,"config.mode",["rtc","live","p2p"]),void 0!==i.audioCodec&&Mn(i.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),void 0!==i.proxyServer&&Kn(i.proxyServer,"config.proxyServer",1,1e4),void 0!==i.turnServer&&hK(i.turnServer),void 0!==i.httpRetryConfig&&uK(i.httpRetryConfig),void 0!==i.websocketRetryConfig&&uK(i.websocketRetryConfig)}catch(i){throw n.onError(i),i}var i;return(Q7(16,0,!0)||eK(16,0,!0))&&("vp9"===t.codec&&(t.codec="vp8",_.debug("browser not support vp9, force use vp8")),st("UNSUPPORTED_VIDEO_CODEC",["vp9"])),void 0===t.audioCodec&&(t.audioCodec="opus"),n.onSuccess(),new YFe(hs(hs({forceWaitGatewayResponse:!0},t),{},{role:Y(e=["rtc","p2p"]).call(e,t.mode)?"host":t.role||"audience"}))},createCameraVideoTrack:function(){var e=C(function*(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=R("CAMERA_CAPTURE_CONFIG"),i=ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.CREATE_CAM_VIDEO_TRACK,options:[Rt({},t),n]});n&&(t.encoderConfig=n);const r=tC(t),o=gt(8,"track-cam-");let s=null;_.info("start create camera video track with config",JSON.stringify(t),"trackId",o);try{s=(yield io({video:r},o)).getVideoTracks()[0]||null}catch(c){throw i.onError(c),c}if(!s){const c=new M(S.UNEXPECTED_ERROR,"can not find track in media stream");return i.onError(c),c.throw(_)}t.optimizationMode&&pM(o,s,t,Da(t.encoderConfig));const a=new hM(s,t,r,t.scalabiltyMode?ZS(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,o);return i.onSuccess(a.getTrackId()),_.info("create camera video success, trackId:",o),a});return function(){return e.apply(this,arguments)}}(),createCustomVideoTrack:function(e){const t=ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),n=new yt(e.mediaStreamTrack,{width:e.width,height:e.height,frameRate:e.frameRate,bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?ZS(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,gt(8,"track-cus-"),[ft.CUSTOM_TRACK]);return t.onSuccess(n.getTrackId()),_.info("create custom video track success with config",e,"trackId",n.getTrackId()),n},createScreenVideoTrack:function(){var e=C(function*(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"disable";const i=ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.CREATE_SCREEN_VIDEO_TRACK,options:[Rt({},t),n]});t.encoderConfig?"string"==typeof t.encoderConfig||t.encoderConfig.width&&t.encoderConfig.height||(t.encoderConfig.width={max:1920},t.encoderConfig.height={max:1080}):t.encoderConfig="1080p_2";const r=function(u){const h={};u.screenSourceType&&(h.mediaSource=u.screenSourceType),u.extensionId&&pl()&&(h.extensionId=u.extensionId);const{displaySurface:p,selfBrowserSurface:m,surfaceSwitching:f,systemAudio:g}=u;($N(107)||Z7(107)||tK(93))&&(p&&(Mn(p,"displaySurface",["browser","window","monitor"]),h.displaySurface=p),m?(Mn(m,"selfBrowserSurface",["exclude","include"]),h.selfBrowserSurface=m):h.selfBrowserSurface="include",f&&(Mn(f,"surfaceSwitching",["exclude","include"]),h.surfaceSwitching=f)),($N(105)||Z7(105)||tK(91))&&g&&(Mn(g,"systemAudio",["exclude","include"]),h.systemAudio=g),u.electronScreenSourceId&&(h.sourceId=u.electronScreenSourceId);const E=u.encoderConfig?XP(u.encoderConfig):null;return h.mandatory={chromeMediaSource:"desktop",maxWidth:E?E.width:void 0,maxHeight:E?E.height:void 0},E&&(E.frameRate&&("number"==typeof E.frameRate?(h.mandatory.maxFrameRate=E.frameRate,h.mandatory.minFrameRate=E.frameRate):(h.mandatory.maxFrameRate=E.frameRate.max||E.frameRate.ideal||E.frameRate.exact||void 0,h.mandatory.minFrameRate=E.frameRate.min||E.frameRate.ideal||E.frameRate.exact||void 0),h.frameRate=E.frameRate),E.width&&(h.width=E.width),E.height&&(h.height=E.height)),h}(t),o=gt(8,"track-scr-v-");let s=null,a=null;const c=Fe();if(!c.supportShareAudio&&"enable"===n){const u=new M(S.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return i.onError(u),u.throw(_)}_.info("start create screen video track with config",t,"withAudio",n,"trackId",o);try{const u=yield io({screen:r,screenAudio:"auto"===n?c.supportShareAudio:"enable"===n},o);s=u.getVideoTracks()[0]||null,a=u.getAudioTracks()[0]||null}catch(u){throw i.onError(u),u}if(!s){const u=new M(S.UNEXPECTED_ERROR,"can not find track in media stream");return i.onError(u),u.throw(_)}if(!a&&"enable"===n){s&&s.stop();const u=new M(S.SHARE_AUDIO_NOT_ALLOWED);return i.onError(u),u.throw(_)}t.optimizationMode||(t.optimizationMode="detail"),t.optimizationMode&&(pM(o,s,t,t.encoderConfig&&XP(t.encoderConfig)||void 0),t.encoderConfig&&"string"!=typeof t.encoderConfig&&(t.encoderConfig.bitrateMin=t.encoderConfig.bitrateMax));const l=new yt(s,t.encoderConfig?XP(t.encoderConfig):{},t.scalabiltyMode?ZS(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,o,[ft.SCREEN_TRACK]);if(!a)return i.onSuccess(l.getTrackId()),_.info("create screen video track success","video:",l.getTrackId()),l;const d=new Ht(a,void 0,gt(8,"track-scr-a-"),!1);return i.onSuccess([l.getTrackId(),d.getTrackId()]),_.info("create screen video track success","video:",l.getTrackId(),"audio:",d.getTrackId()),[l,d]});return function(){return e.apply(this,arguments)}}(),createMicrophoneAndCameraTracks:function(){var e=C(function*(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=R("CAMERA_CAPTURE_CONFIG"),r=ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.CREATE_MIC_AND_CAM_TRACKS,options:[t,n,i]});i&&(n.encoderConfig=i);const o=tC(n),s=Qq(t),a=gt(8,"track-mic-"),c=gt(8,"track-cam-");let l=null,d=null;_.info("start create camera video track(".concat(c,") and microphone audio track(").concat(a,") with config, audio: ").concat(JSON.stringify(t),", video: ").concat(JSON.stringify(n)));try{const p=yield io({audio:s,video:o},"".concat(a,"-").concat(c));l=p.getAudioTracks()[0],d=p.getVideoTracks()[0]}catch(p){throw r.onError(p),p}if(!l||!d){const p=new M(S.UNEXPECTED_ERROR,"can not find tracks in media stream");return r.onError(p),p.throw(_)}n.optimizationMode&&pM(c,d,n,Da(n.encoderConfig));const u=new nC(l,t,s,a),h=new hM(d,n,o,n.scalabiltyMode?ZS(n.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},n.optimizationMode,c);return r.onSuccess([u.getTrackId(),h.getTrackId()]),_.info("create camera video track(".concat(c,") and microphone audio track(").concat(a,") success")),[u,h]});return function(){return e.apply(this,arguments)}}(),createMicrophoneAudioTrack:function(){var e=C(function*(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.CREATE_MIC_AUDIO_TRACK,options:[t]}),i=Qq(t),r=gt(8,"track-mic-");let o=null;_.info("start create microphone audio track with config",JSON.stringify(t),"trackId",r);try{o=(yield io({audio:i},r)).getAudioTracks()[0]||null}catch(a){throw n.onError(a),a}if(!o){const a=new M(S.UNEXPECTED_ERROR,"can not find track in media stream");return n.onError(a),a.throw(_)}const s=new nC(o,t,i,r);return n.onSuccess(s.getTrackId()),_.info("create microphone audio track success, trackId:",r),s});return function(){return e.apply(this,arguments)}}(),createCustomAudioTrack:function(e){const t=ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),n=new Ht(e.mediaStreamTrack,e.encoderConfig?JS(e.encoderConfig):{},gt(8,"track-cus-"),!1);return _.info("create custom audio track success with config",e,"trackId",n.getTrackId()),t.onSuccess(n.getTrackId()),n},createBufferSourceAudioTrack:function(){var e=C(function*(t){var n;const{cacheOnlineFile:i,encoderConfig:r}=t;let{source:o}=t;const s={source:o instanceof AudioBuffer?"AudioBuffer":o instanceof File?null!==(n=File.name)&&void 0!==n?n:"File":o,cacheOnlineFile:i,encoderConfig:r},a=ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.CREATE_BUFFER_AUDIO_TRACK,options:[s]});if(R("DISABLE_WEBAUDIO"))throw new M(S.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const c=gt(8,"track-buf-");_.info("start create buffer source audio track with config",JSON.stringify(s),"trackId",c);const l=o;if(!(o instanceof AudioBuffer))try{o=yield(h=C(function*(p,m){let f=null;if("string"==typeof p){const E=VY.get(p);if(E)return _.debug("use cached audio resource: ",p),E;try{f=(yield Fs(()=>nr.get(p,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(b){throw new M(S.FETCH_AUDIO_FILE_FAILED,b.toString())}}else f=yield new q((b,T)=>{const I=new FileReader;I.onload=D=>{D.target?b(D.target.result):T(new M(S.READ_LOCAL_AUDIO_FILE_ERROR))},I.onerror=()=>{T(new M(S.READ_LOCAL_AUDIO_FILE_ERROR))},I.readAsArrayBuffer(p)});const g=yield function(E){const b=Pp();return new q((T,I)=>{b.decodeAudioData(E,D=>{T(D)},D=>{I(new M(S.DECODE_AUDIO_FILE_FAILED,D.toString()))})})}(f);return"string"==typeof p&&m&&VY.set(p,g),g}),function(p,m){return h.apply(this,arguments)})(o,i)}catch(h){return a.onError(h),h.throw(_)}var h;const d=new Z2e(o),u=new X2e(l,d,r?JS(r):{},c);return _.info("create buffer source audio track success, trackId:",c),a.onSuccess(u.getTrackId()),u});return function(n){return e.apply(this,arguments)}}(),setAppType:function(e){if(_.debug("setAppType: ".concat(e)),!(Number.isInteger(e)&&e>=0))throw _.debug("Invalid appType"),new N(S.INVALID_PARAMS,"invalid app type",e);st("APP_TYPE",Math.floor(e))},setLogLevel:function(e){_.setLogLevel(e)},enableLogUpload:function(){R("USE_NEW_LOG")?st("UPLOAD_LOG",!0):_.enableLogUpload()},disableLogUpload:function(){R("USE_NEW_LOG")?st("UPLOAD_LOG",!1):_.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new BX},checkAudioTrackIsActive:function(){var e=C(function*(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const i=ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[n]});if(!(t instanceof Ht||t instanceof kp)){const l=new N(S.INVALID_TRACK,"the parameter is not a audio track");return i.onError(l),l.throw()}n&&n<1e3&&(n=1e3);const r=t instanceof Ht?t.getTrackLabel():"remote_track",o=t.getVolumeLevel();let s=o,a=o;const c=Date.now();return new q(l=>{const d=setInterval(()=>{const u=t.getVolumeLevel();s=u>s?u:s,a=u<a?u:a;const h=s-a>1e-4,p=Date.now()-c;if(h||p>n){clearInterval(d);const m=h,f={duration:p,deviceLabel:r,maxVolumeLevel:s,result:m};_.info("[track-".concat(t.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(f))),i.onSuccess(f),l(m)}},200)})});return function(n){return e.apply(this,arguments)}}(),checkVideoTrackIsActive:function(){var e=C(function*(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const i=ne.reportApiInvoke(null,{tag:jt.TRACER,name:Cn.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[n]});if(!(t instanceof yt||t instanceof xp)){const h=new N(S.INVALID_TRACK,"the parameter is not a video track");return i.onError(h),h.throw()}n&&n<1e3&&(n=1e3);const r=t instanceof yt?t.getTrackLabel():"remote_track",o=t.getMediaStreamTrack(!0),s=document.createElement("video");s.style.width="1px",s.style.height="1px",s.setAttribute("muted",""),s.muted=!0,s.setAttribute("playsinline",""),s.controls=!1,(ei()||IS())&&(s.style.opacity="0.01",s.style.position="fixed",s.style.left="0",s.style.top="0",document.body.appendChild(s)),s.srcObject=new MediaStream([o]),s.play();const a=document.createElement("canvas");a.width=160,a.height=120;let c=0,l=0;try{const h=Date.now();c=yield function(p,m,f,g){let E,b=0,T=null;return new q((I,D)=>{setTimeout(()=>{E&&(E(),I(b))},m),E=tM(()=>{!function O(){b>4&&E&&(E(),I(b));const k=f.getContext("2d");if(!k){const ee=new N(S.UNEXPECTED_ERROR,"can not get canvas 2d context.");return _.error(ee.toString()),void D(ee)}k.drawImage(p,0,0,160,120);const L=k.getImageData(0,0,f.width,f.height),V=Math.floor(L.data.length/3);if(T){for(let ee=0;ee<V;ee+=3)if(L.data[ee]!==T[ee])return b+=1,void(T=L.data);T=L.data}else T=L.data}()},30)})}(s,n,a),l=Date.now()-h}catch(h){throw i.onError(h),h}MFe===Ye.SAFARI&&(s.pause(),s.remove()),s.srcObject=null;const d=c>4,u={duration:l,changedPicNum:c,deviceLabel:r,result:d};return _.info("[track-".concat(t.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(u))),i.onSuccess(u),d});return function(n){return e.apply(this,arguments)}}(),setArea:TM,audioElementPlayCenter:ir,resumeAudioContext:function(){ir.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(e){XFe.processExternalMediaAEC(e)},registerExtensions:function(e){const t=R("PLUGIN_INFO")||[];e.forEach(n=>{"name"in n&&!Y(t).call(t,n.name)&&t.push(n.name);const i=n;i.__registered__=!0,i.logger.hookLog=_.extLog,i.reporter.hookApiInvoke=ne.extApiInvoke,i.parameters&&Object.keys(i.parameters).forEach(r=>{i.parameters[r]=R(r)})}),vQ("PLUGIN_INFO",t)},ChannelMediaRelayError:fp,ChannelMediaRelayEvent:fc,ChannelMediaRelayState:_r,RemoteStreamFallbackType:G2e,RemoteStreamType:H2e,ConnectionDisconnectedReason:Qe,AudienceLatencyLevelType:Ske,AREAS:We,preload:function(){var e=C(function*(t,n,i,r){return lZ(t,n,i,r)});return function(n,i,r,o){return e.apply(this,arguments)}}()});Object.defineProperties(En,{onAudioAutoplayFailed:{get:()=>oo.onAudioAutoplayFailed,set:e=>{oo.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>oo.onAutoplayFailed,set:e=>{oo.onAutoplayFailed=e}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>En._onSecurityPolicyViolation,set(e){En._onSecurityPolicyViolation=e,vJ(e)}},__CLIENT_LIST__:{get:()=>R("SHOW_GLOBAL_CLIENT_LIST")?kd:[]}}),ro.on(jd.CAMERA_DEVICE_CHANGED,e=>{_.info("camera device changed",JSON.stringify(e)),En.onCameraChanged&&En.onCameraChanged(e),En.safeEmit(Ra.CAMERA_CHANGED,e)}),ro.on(jd.RECORDING_DEVICE_CHANGED,e=>{_.info("microphone device changed",JSON.stringify(e)),En.onMicrophoneChanged&&En.onMicrophoneChanged(e),En.safeEmit(Ra.MICROPHONE_CHANGED,e)}),ro.on(jd.PLAYOUT_DEVICE_CHANGED,e=>{_.debug("playout device changed",JSON.stringify(e)),En.onPlaybackDeviceChanged&&En.onPlaybackDeviceChanged(e),En.safeEmit(Ra.PLAYBACK_DEVICE_CHANGED,e)}),ir.onAutoplayFailed=()=>{_.info("detect audio element autoplay failed"),oo.onAudioAutoplayFailed&&oo.onAudioAutoplayFailed()},tt.on("autoplay-failed",()=>{_.info("detect webaudio autoplay failed"),oo.onAudioAutoplayFailed&&oo.onAudioAutoplayFailed(),En.safeEmit(Ra.AUTOPLAY_FAILED)}),tt.on(Xn.STATE_CHANGE,(e,t)=>{_.info("audio context state changed: ".concat(t," => ").concat(e)),En.onAudioContextStateChanged&&En.onAudioContextStateChanged(e,t),En.safeEmit(Ra.AUDIO_CONTEXT_STATE_CHANGED,e,t)}),ln.on(lp.NETWORK_STATE_CHANGE,(e,t)=>{_.info("[network-indicator] network state changed, ".concat(t," => ").concat(e))}),window&&(window.__ARTC__=En);class EQ extends dg{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:i}=this;if(t)throw n;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}class TVe extends Ns{constructor(t,n){super()}schedule(t,n=0){return this}}const jC={setInterval(e,t,...n){const{delegate:i}=jC;return i?.setInterval?i.setInterval(e,t,...n):setInterval(e,t,...n)},clearInterval(e){const{delegate:t}=jC;return(t?.clearInterval||clearInterval)(e)},delegate:void 0},bQ={now:()=>(bQ.delegate||Date).now(),delegate:void 0};class k_{constructor(t,n=k_.now){this.schedulerActionCtor=t,this.now=n}schedule(t,n=0,i){return new this.schedulerActionCtor(this,t).schedule(i,n)}}k_.now=bQ.now;const x1=new class IVe extends k_{constructor(t,n=k_.now){super(t,n),this.actions=[],this._active=!1}flush(t){const{actions:n}=this;if(this._active)return void n.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=n.shift());if(this._active=!1,i){for(;t=n.shift();)t.unsubscribe();throw i}}}(class wVe extends TVe{constructor(t,n){super(t,n),this.scheduler=t,this.work=n,this.pending=!1}schedule(t,n=0){var i;if(this.closed)return this;this.state=t;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,n)),this.pending=!0,this.delay=n,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(o,this.id,n),this}requestAsyncId(t,n,i=0){return jC.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,n,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return n;null!=n&&jC.clearInterval(n)}execute(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,n);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,n){let r,i=!1;try{this.work(t)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:n}=this,{actions:i}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Qb(i,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,super.unsubscribe()}}}),RVe=x1;function k1(e=0,t,n=RVe){let i=-1;return null!=t&&(i6(t)?n=t:i=t),new So(r=>{let o=function AVe(e){return e instanceof Date&&!isNaN(e)}(e)?+e-n.now():e;o<0&&(o=0);let s=0;return n.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}function L1(e=0,t=x1){return e<0&&(e=0),k1(e,e,t)}const yQ={connected:!1,loading:!0,statusText:"Initializing",started:null,ended:!1,error:!1},DVe={mode:"rtc",codec:"h264"};let SQ=(()=>{class e{constructor(n){this.config=n,this.agoraRTC=En,this.streamState=new EQ(yQ),this.remoteStreamVideoToggle=new EQ(!0),this.callEnd=new dg,this.localContainerId="local-video",this.remoteCalls=[],this.remoteStreamVideoToggle$=this.remoteStreamVideoToggle.asObservable(),this.streamState$=this.streamState.asObservable(),this.agoraRTC.checkSystemRequirements()||this.handleError(new Error("Web RTC is not supported in this browser"))}init(n,i,r,o=!1){return this.uid=n,this.agoraRTC.setLogLevel(o?0:4),this.client=this.agoraRTC.createClient(DVe),this.assignClientHandlers(),this.initLocalStream().then(()=>{this.client.join(this.config.AppID,i,r||null,this.uid).then(()=>{this.localTracks.videoTrack.play(this.localContainerId),this.client.publish(Object.values(this.localTracks)),this.streamState.next({...this.streamState.value,connected:!0,statusText:"Waiting others to join"})}).catch(s=>this.handleError(s))}),this.callEnd.asObservable()}deinit(){this.streamState.next(yQ)}endCall(){this.client.leave().then(()=>{this.stopLocalStream(),this.streamState.next({...this.streamState.value,started:null,loading:!0,statusText:"",ended:!0}),this.remoteCalls=[],L1(500).pipe(_a(1)).subscribe(()=>this.callEnd.next())})}toggleVideo(n){this.localTracks&&this.localTracks.videoTrack.setMuted(n)}toggleAudio(n){this.localTracks&&this.localTracks.audioTrack.setMuted(n)}toggleFullScreen(n){n?document.exitFullscreen():document.documentElement.requestFullscreen()}isVideoEnabled(){return!!this.localTracks&&!this.localTracks.videoTrack.muted}isAudioEnabled(){return!!this.localTracks&&!this.localTracks.audioTrack.muted}assignClientHandlers(){this.client.on("user-joined",n=>{this.streamState.next({...this.streamState.value,started:Date.now(),loading:!1}),this.remoteCalls.length||this.remoteCalls.push(this.getRemoteId(n))}),this.client.on("user-published",(n,i)=>{const r=this.getRemoteId(n);this.client.subscribe(n,i).then(o=>{this.remoteCalls.includes(r)&&o.play(r)})}),this.client.on("user-info-updated",(n,i)=>{"mute-video"===i&&this.remoteStreamVideoToggle.next(!1),"unmute-video"===i&&this.remoteStreamVideoToggle.next(!0)}),this.client.on("user-left",()=>{this.endCall()})}initLocalStream(){return Promise.all([this.agoraRTC.createCameraVideoTrack(),this.agoraRTC.createMicrophoneAudioTrack()]).then(([n,i])=>{this.localTracks={audioTrack:i,videoTrack:n}}).catch(n=>{this.handleError(n)})}getRemoteId(n){return`remote_call-${n.uid}`}handleError(n){throw this.streamState.next({...this.streamState.value,statusText:n.message,error:!0}),this.stopLocalStream(),L1(5e3).pipe(_a(1)).subscribe(()=>this.callEnd.next()),new Error(n.message)}stopLocalStream(){this.localTracks&&Object.values(this.localTracks).forEach(n=>{n.stop(),n.close()})}static{this.\u0275fac=function(i){return new(i||e)(Z("AgoraConfig"))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function OVe(e,t){if(1&e){const n=Qa();ue(0,"div",1)(1,"button",2),zt("click",function(){return Gr(n),Wr(Kt().onToggleFullScreen())}),ue(2,"div",3),ys(),ue(3,"svg",4)(4,"g",26)(5,"g",6)(6,"g",7)(7,"g",11),pt(8,"path",27)(9,"path",28)(10,"path",29)(11,"path",30),ve()()()(),ue(12,"g",31)(13,"g",6)(14,"g",32)(15,"g",7),pt(16,"path",33)(17,"path",34)(18,"path",35)(19,"path",36),ve()()()()()(),Pc(),ue(20,"p"),fr(21),ve()()()}if(2&e){const n=Kt();Re(),wt("controls__button--active",n.fullScreenEnabled),Re(3),wt("controls__icon--shown",!n.fullScreenEnabled),Re(8),wt("controls__icon--shown",n.fullScreenEnabled),Re(9),nd(n.fullScreenEnabled?"Exit fullscreen":"Fullscreen")}}function NVe(e,t){if(1&e){const n=Qa();ue(0,"div",1)(1,"button",37),zt("click",function(){return Gr(n),Wr(Kt().onToggleSmallScreen())}),ue(2,"div",3),ys(),ue(3,"svg",4)(4,"g",38),pt(5,"path",39),ve(),ue(6,"defs")(7,"filter",40),pt(8,"feFlood",41)(9,"feColorMatrix",42)(10,"feOffset",43)(11,"feGaussianBlur",44)(12,"feComposite",45)(13,"feColorMatrix",46)(14,"feBlend",47)(15,"feBlend",48),ve()()()(),Pc(),ue(16,"p"),fr(17,"Minimize"),ve()()()}if(2&e){const n=Kt();Re(),wt("controls__button--active",n.smallScreenEnabled)}}let PVe=(()=>{class e{constructor(){this.cameraEnabled=!0,this.microphoneEnabled=!0,this.fullScreenEnabled=!1,this.smallScreenEnabled=!1,this.displaySmallScreen=!1,this.toggleCamera=new Wt,this.toggleMicrophone=new Wt,this.toggleFullScreen=new Wt,this.toggleSmallScreen=new Wt,this.endCall=new Wt}onToggleCamera(){this.toggleCamera.emit(this.cameraEnabled)}onToggleMicrophone(){this.toggleMicrophone.emit(this.microphoneEnabled)}onToggleFullScreen(){this.toggleFullScreen.emit(this.fullScreenEnabled)}onToggleSmallScreen(){this.toggleSmallScreen.emit(this.smallScreenEnabled)}onEndCall(){this.endCall.emit()}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=sr({type:e,selectors:[["ngx-controls"]],inputs:{cameraEnabled:"cameraEnabled",microphoneEnabled:"microphoneEnabled",fullScreenEnabled:"fullScreenEnabled",smallScreenEnabled:"smallScreenEnabled",displaySmallScreen:"displaySmallScreen"},outputs:{toggleCamera:"toggleCamera",toggleMicrophone:"toggleMicrophone",toggleFullScreen:"toggleFullScreen",toggleSmallScreen:"toggleSmallScreen",endCall:"endCall"},decls:43,vars:16,consts:[[1,"controls"],[1,"controls__item"],[1,"controls__button",3,"click"],[1,"controls__icon-wrapper"],["viewBox","0 0 64 64","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","video-camera",1,"controls__icon"],["id","Group"],["id","Group_2"],["id","Vector","d","M63.4134 16.2294C63.0454 15.9814 62.5787 15.928 62.1707 16.096L50.6668 20.6986V20C50.6668 16.3226 47.6748 13.3334 44.0001 13.3334H6.66663C2.992 13.3334 0 16.3226 0 20V44C0 47.6774 2.992 50.6666 6.66663 50.6666H44C47.6746 50.6666 50.6666 47.6772 50.6666 44V43.3014L62.1706 47.904C62.5812 48.072 63.048 48.0186 63.4132 47.7706C63.7786 47.5226 63.9999 47.1093 63.9999 46.6666V17.3334C64 16.8906 63.7786 16.4774 63.4134 16.2294Z","fill","white"],["id","no-camera",1,"controls__icon"],["id","Vector","d","M44.0002 13.3325H6.66735C2.99276 13.3325 0.000793457 16.3218 0.000793457 19.999V43.9988C0.000793457 47.6761 2.99276 50.6654 6.66735 50.6654H7.67797L44.9176 13.4257C44.6162 13.3832 44.315 13.3325 44.0002 13.3325Z","fill","white"],["id","Group_3"],["id","Group_4"],["id","Vector_2","d","M63.4134 16.2285C63.0454 15.9805 62.5788 15.9271 62.1708 16.0951L50.6669 20.6977V19.9991C50.6669 18.6417 50.2535 17.3831 49.5549 16.3297L63.608 2.2766C64.128 1.75661 64.128 0.911242 63.608 0.391247C63.088 -0.128748 62.2426 -0.128748 61.7226 0.391247L0.389996 61.724C-0.129999 62.244 -0.129999 63.0894 0.389996 63.6094C0.651369 63.868 0.992615 63.9988 1.33399 63.9988C1.67536 63.9988 2.01661 63.8681 2.27798 63.6094L15.2192 50.6655H44.0003C47.6749 50.6655 50.6669 47.6762 50.6669 43.9989V43.3003L62.1708 47.9029C62.5814 48.0709 63.0481 48.0175 63.4134 47.7695C63.7788 47.5215 64 47.1082 64 46.6655V17.3325C64 16.8898 63.7788 16.4765 63.4134 16.2285Z","fill","white"],["id","microphone",1,"controls__icon"],["id","Vector"],["fill-rule","evenodd","clip-rule","evenodd","d","M44.3474 12.1407L44.3468 17.2309V33.8672C44.3468 40.6024 38.9004 46.0823 32.206 46.0823C27.8366 46.0787 23.8059 43.7286 21.6503 39.9279L20.4131 36.8161C20.1824 35.875 20.0659 34.9098 20.0659 33.941V12.1407C20.0659 5.43551 25.5014 0 32.2066 0C38.9118 0 44.3474 5.43551 44.3474 12.1407Z","fill","white"],["fill-rule","evenodd","clip-rule","evenodd","d","M15.0971 33.7512C15.0947 36.1345 15.5932 38.4912 16.5596 40.6697L18.1223 43.4553C22.3699 49.6259 30.1387 52.3143 37.292 50.089C44.4453 47.8638 49.318 41.2426 49.3156 33.7518C49.3156 32.9026 50.0039 32.2143 50.8532 32.2143C51.7018 32.2143 52.3907 32.9026 52.3907 33.7518C52.4051 44.4499 44.0585 53.2951 33.3778 53.9017V60.9246H39.8098C40.6584 60.9246 41.3473 61.6135 41.3473 62.4622C41.3473 63.3114 40.6584 63.9997 39.8098 63.9997H24.6029C23.7537 63.9997 23.0654 63.3114 23.0654 62.4622C23.0654 61.6135 23.7537 60.9246 24.6029 60.9246H30.3033V53.847C25.6228 53.4212 21.2413 51.3623 17.926 48.0313C17.1926 47.298 16.5163 46.51 15.9031 45.6739L14.2418 42.9874C12.7757 40.1297 12.0148 36.9633 12.022 33.7512C12.022 32.902 12.7103 32.2137 13.5595 32.2137C14.4088 32.2137 15.0971 32.902 15.0971 33.7512Z","fill","white"],["id","no-microphone",1,"controls__icon"],["id","Vector","d","M52.9733 4.25592L44.3474 12.8813V12.1407C44.3474 5.43551 38.9118 0 32.2066 0C25.5014 0 20.0659 5.43551 20.0659 12.1407V33.941C20.0659 34.9098 20.1824 35.875 20.4131 36.8161L16.5596 40.6697C15.5932 38.4912 15.0947 36.1345 15.0971 33.7512C15.0971 32.902 14.4088 32.2137 13.5595 32.2137C12.7103 32.2137 12.022 32.902 12.022 33.7512C12.0148 36.9633 12.7757 40.1297 14.2418 42.9874L8.81411 48.4151C8.4117 48.8007 8.24954 49.3731 8.39008 49.9124C8.53002 50.4518 8.95105 50.8728 9.4898 51.0133C10.0291 51.1539 10.6021 50.9917 10.9877 50.5899L15.9031 45.6739C16.5163 46.51 17.1926 47.298 17.926 48.0313C21.2413 51.3623 25.6228 53.4212 30.3033 53.847V60.9246H24.6029C23.7537 60.9246 23.0654 61.6135 23.0654 62.4622C23.0654 63.3114 23.7537 63.9997 24.6029 63.9997H39.8098C40.6584 63.9997 41.3473 63.3114 41.3473 62.4622C41.3473 61.6135 40.6584 60.9246 39.8098 60.9246H33.3778V53.9017C44.0585 53.2951 52.4051 44.4499 52.3907 33.7518C52.3907 32.9026 51.7018 32.2143 50.8532 32.2143C50.0039 32.2143 49.3156 32.9026 49.3156 33.7518C49.318 41.2426 44.4453 47.8638 37.292 50.089C30.1387 52.3143 22.3699 49.6259 18.1224 43.4553L21.6503 39.9279C23.8059 43.7286 27.8366 46.0787 32.206 46.0823C38.9004 46.0823 44.3468 40.6024 44.3468 33.8672V17.2309L55.1475 6.43072C55.7481 5.83071 55.7481 4.85713 55.1475 4.25652C54.5469 3.65591 53.5733 3.65591 52.9733 4.25652V4.25592Z","fill","white"],["class","controls__item",4,"ngIf"],[1,"controls__button","controls__button--danger",3,"click"],["id","phone"],["id","Vector","d","M51.7097 13.2478C51.2458 12.7839 50.4959 12.7839 50.032 13.2478L1.38351 61.8963C0.919568 62.3602 0.919568 63.1101 1.38351 63.574C1.61488 63.8054 1.91864 63.9217 2.2224 63.9217C2.52615 63.9217 2.82991 63.8054 3.06129 63.574L51.7097 14.9256C52.1737 14.4628 52.1737 13.7117 51.7097 13.2478Z","fill","white"],["id","Vector_2","d","M16.9605 42.9635L26.1159 33.8081L21.3365 29.0287C18.91 26.6022 18.6869 24.3679 20.5878 21.5629C20.8535 21.1951 22.5444 19.6941 23.992 18.4839C24.9151 17.9333 25.5487 17.1181 25.8264 16.1155C26.1954 14.783 25.9225 13.2156 25.0516 11.6885C24.8463 11.3373 19.9625 3.06229 15.4583 0.680892C14.6171 0.235937 13.6714 0.0010004 12.721 0.0010004C11.1571 0.0010004 9.68576 0.610886 8.58109 1.71556L5.57082 4.72702C-3.21082 13.5098 -1.58525 24.419 10.2719 36.2749L16.9605 42.9635Z","fill","white"],["id","Vector_3","d","M63.313 48.5357C60.9304 44.0328 52.6566 39.1478 52.2923 38.9342C51.2304 38.329 50.1209 38.0099 49.0839 38.0099C47.5402 38.0099 46.2753 38.717 45.51 40.0033C44.2986 41.452 42.7964 43.1429 42.4345 43.4051C39.6129 45.3154 37.4071 45.1007 34.9652 42.6588L31.148 38.8416L21.9926 47.997L27.7189 53.7233C34.5356 60.5412 41.0367 63.9976 47.0371 63.9976C47.0383 63.9976 47.0383 63.9976 47.0383 63.9976C51.4534 63.9976 55.5672 62.1217 59.2669 58.4232L62.2771 55.413C64.1068 53.5845 64.5233 50.821 63.313 48.5357Z","fill","white"],["id","fullscreen",1,"controls__icon"],["id","Vector","d","M57.8018 53.4382L44.3964 40.0328L40.0328 44.3964L53.4382 57.8018H43.0205V64H64V43.0205H57.8018V53.4382Z","fill","white"],["id","Vector_2","d","M44.3964 23.9803L57.8018 10.5618V20.9795H64V0H43.0205V6.1982H53.4382L40.0328 19.6036L44.3964 23.9803Z","fill","white"],["id","Vector_3","d","M19.6036 40.0328L6.1982 53.4382V43.0205H0V64H20.9795V57.8018H10.5618L23.9803 44.3964L19.6036 40.0328Z","fill","white"],["id","Vector_4","d","M20.9795 6.1982V0H0V20.9795H6.1982V10.5618L19.6036 23.9803L23.9803 19.6036L10.5618 6.1982H20.9795Z","fill","white"],["id","exit-full-screen",1,"controls__icon"],["id","fullscreen_x5F_exit"],["id","Vector","d","M49.172 54.828L58.344 64L64 58.344L54.828 49.172L64 40H40V64L49.172 54.828Z","fill","white"],["id","Vector_2","d","M0 24H24V0L14.828 9.172L5.75 0.086L0.094 5.742L9.172 14.828L0 24Z","fill","white"],["id","Vector_3","d","M0 58.344L5.656 64L14.828 54.828L24 64V40H0L9.172 49.172L0 58.344Z","fill","white"],["id","Vector_4","d","M40 24H64L54.828 14.828L63.922 5.742L58.266 0.086L49.172 9.172L40 0V24Z","fill","white"],[1,"controls__button","controls__button--rotate",3,"click"],["filter","url(#filter0_d_0_4)"],["d","M-4.81762e-07 34.7678V57.0215C-4.81762e-07 60.8696 3.13284 64 6.98275 64H57.016C60.8672 64 64 60.8696 64 57.0215V7.05508C64 3.20697 60.8672 0.0757321 57.016 0.0757321H34.6959C35.8972 1.3077 36.6961 2.93443 36.871 4.74067H57.0168C58.2942 4.74067 59.3335 5.77899 59.3335 7.05508V57.0216C59.3335 58.2969 58.2942 59.3352 57.0168 59.3352H6.98342C5.7062 59.3352 4.66761 58.2969 4.66761 57.0216V36.9389C2.90982 36.7703 1.27948 36.0149 -4.81762e-07 34.7678ZM10.7807 30.6654H26.0384L1.34093 5.97437C-0.02533 4.60686 -0.02533 2.39174 1.34093 1.02583C2.70813 -0.341677 4.92462 -0.341677 6.29089 1.02423L30.9883 25.7159V10.4614C30.9883 8.52907 32.5556 6.96139 34.4888 6.96139C35.4553 6.96139 36.3305 7.35214 36.9642 7.98612C37.5976 8.62116 37.9897 9.49543 37.9897 10.4613V34.1643C37.9897 36.0966 36.4228 37.6635 34.4896 37.6635H10.7807C8.84705 37.6635 7.28056 36.0974 7.28056 34.1643C7.28056 32.2312 8.84705 30.6654 10.7807 30.6654Z","fill","white"],["id","filter0_d_0_4","x","-4","y","0","width","72","height","72","filterUnits","userSpaceOnUse","color-interpolation-filters","sRGB"],["flood-opacity","0","result","BackgroundImageFix"],["in","SourceAlpha","type","matrix","values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0","result","hardAlpha"],["dy","4"],["stdDeviation","2"],["in2","hardAlpha","operator","out"],["type","matrix","values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"],["mode","normal","in2","BackgroundImageFix","result","effect1_dropShadow_0_4"],["mode","normal","in","SourceGraphic","in2","effect1_dropShadow_0_4","result","shape"]],template:function(i,r){1&i&&(ue(0,"div",0)(1,"div",1)(2,"button",2),zt("click",function(){return r.onToggleCamera()}),ue(3,"div",3),ys(),ue(4,"svg",4)(5,"g",5)(6,"g",6)(7,"g",7),pt(8,"path",8),ve()()(),ue(9,"g",9)(10,"g",6)(11,"g",7),pt(12,"path",10),ve()(),ue(13,"g",11)(14,"g",12),pt(15,"path",13),ve()()()()(),Pc(),ue(16,"p"),fr(17,"Camera"),ve()()(),ue(18,"div",1)(19,"button",2),zt("click",function(){return r.onToggleMicrophone()}),ue(20,"div",3),ys(),ue(21,"svg",4)(22,"g",14)(23,"g",15),pt(24,"path",16)(25,"path",17),ve()(),ue(26,"g",18),pt(27,"path",19),ve()()(),Pc(),ue(28,"p"),fr(29,"Mic"),ve()()(),an(30,OVe,22,7,"div",20)(31,NVe,18,2,"div",20),ue(32,"div",1)(33,"button",21),zt("click",function(){return r.onEndCall()}),ue(34,"div",3),ys(),ue(35,"svg",4)(36,"g",22)(37,"g",6),pt(38,"path",23)(39,"path",24)(40,"path",25),ve()()()(),Pc(),ue(41,"p"),fr(42,"End"),ve()()()()),2&i&&(wt("controls--small",r.smallScreenEnabled),Re(2),wt("controls__button--active",r.cameraEnabled),Re(3),wt("controls__icon--shown",r.cameraEnabled),Re(4),wt("controls__icon--shown",!r.cameraEnabled),Re(10),wt("controls__button--active",r.microphoneEnabled),Re(3),wt("controls__icon--shown",r.microphoneEnabled),Re(4),wt("controls__icon--shown",!r.microphoneEnabled),Re(4),ht("ngIf",!r.smallScreenEnabled),Re(),ht("ngIf",r.displaySmallScreen))},dependencies:[Cm],styles:["[_nghost-%COMP%]{transition:.3s}.controls[_ngcontent-%COMP%]{background:#0000004d;bottom:0;display:flex;justify-content:center;padding:15px 0;position:absolute;left:0;width:100%}.controls--small[_ngcontent-%COMP%]{border-bottom-left-radius:10px;border-bottom-right-radius:10px;padding:5px 0}.controls--small[_ngcontent-%COMP%]   .controls__icon-wrapper[_ngcontent-%COMP%]{height:32px;width:32px}.controls--small[_ngcontent-%COMP%]   .controls__icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px}.controls--small[_ngcontent-%COMP%]   .controls__item[_ngcontent-%COMP%]{margin:0}.controls--small[_ngcontent-%COMP%]   .controls__button[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:none}.controls__item[_ngcontent-%COMP%]{margin:0 5px;text-align:center}.controls__button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer}.controls__button[_ngcontent-%COMP%]:hover   .controls__icon-wrapper[_ngcontent-%COMP%]{background-color:#101316}.controls__button--active[_ngcontent-%COMP%]   .controls__icon-wrapper[_ngcontent-%COMP%]{background-color:#0b73c9}.controls__button--active[_ngcontent-%COMP%]:hover   .controls__icon-wrapper[_ngcontent-%COMP%]{background-color:#158ef2}.controls__button--active.controls__button--rotate[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:translate(-50%,-50%) rotate(-180deg)}.controls__button--danger[_ngcontent-%COMP%]   .controls__icon-wrapper[_ngcontent-%COMP%]{background-color:#d73b3d}.controls__button--danger[_ngcontent-%COMP%]:hover   .controls__icon-wrapper[_ngcontent-%COMP%]{background-color:#e06567}.controls__button[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;margin:8px 0 0}.controls__icon-wrapper[_ngcontent-%COMP%]{background-color:#313a42;border-radius:50%;box-shadow:0 3px 8px #00000080;margin:auto;position:relative;height:60px;width:60px;transition:.3s}.controls__icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{left:50%;position:absolute;top:50%;transform:translate(-50%,-50%) rotate(0);height:32px;width:32px;transition:.3s}.controls__icon[_ngcontent-%COMP%]{opacity:0;transition:.3s}.controls__icon--shown[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0})}}return e})();function F1(e,t){return Qc((n,i)=>{let r=0;n.subscribe(lc(i,o=>{i.next(e.call(t,o,r++))}))})}let MVe=(()=>{class e{constructor(){this.started=Date.now()}ngOnInit(){this.time$=k1(0,1e3).pipe(F1(()=>this.format(Date.now()-this.started)))}format(n){const i=Math.floor(n/1e3%60).toString().padStart(2,"0"),r=Math.floor(n/6e4%60).toString().padStart(2,"0");return[Math.floor(n/36e5%24).toString().padStart(2,"0"),r,i].join(":")}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=sr({type:e,selectors:[["ngx-timer"]],inputs:{started:"started"},decls:4,vars:3,consts:[[1,"timer"]],template:function(i,r){1&i&&(ue(0,"div",0)(1,"span"),fr(2),yE(3,"async"),ve()()),2&i&&(Re(2),nd(SE(3,1,r.time$)))},dependencies:[kI],styles:[".timer[_ngcontent-%COMP%]{color:#fff;position:relative;text-align:center;z-index:1}.timer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:#0000004d;border-radius:5px;padding:5px 10px}"],changeDetection:0})}}return e})();const xVe=(e,t,n,i)=>({"spinner--connected":e,"spinner--ended":t,"spinner--small":n,"spinner--error":i});function kVe(e,t){if(1&e&&(ue(0,"div",8),fr(1),ve()),2&e){const n=Kt();Re(),nd(n.text)}}let LVe=(()=>{class e{constructor(){this.error=!1,this.connected=!0,this.ended=!1,this.small=!1}get color(){return this.ended?"#aaa":this.error?"#d73b3d":this.connected?"#37D425":"#1195E6"}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=sr({type:e,selectors:[["ngx-spinner"]],inputs:{text:"text",error:"error",connected:"connected",ended:"ended",small:"small"},decls:8,vars:9,consts:[[1,"spinner",3,"ngClass"],[1,"spinner__wrapper"],[1,"spinner__icon"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 32 32","fill","none"],["d","M5.25 5.5C3.45507 5.5 2 6.95508 2 8.75V19.25C2 21.0449 3.45507 22.5 5.25 22.5H14.75C16.5449 22.5 18 21.0449 18 19.25V8.75C18 6.95507 16.5449 5.5 14.75 5.5H5.25Z"],["d","M23.1232 20.6431L19.5 17.0935V10.9989L23.1121 7.3706C23.8988 6.58044 25.248 7.13753 25.248 8.25251V19.7502C25.248 20.8577 23.9143 21.4181 23.1232 20.6431Z"],[1,"spinner__cirle"],["class","spinner__text",4,"ngIf"],[1,"spinner__text"]],template:function(i,r){1&i&&(ue(0,"div",0)(1,"div",1)(2,"div",2),ys(),ue(3,"svg",3),pt(4,"path",4)(5,"path",5),ve()(),Pc(),pt(6,"div",6),an(7,kVe,2,1,"div",7),ve()()),2&i&&(ht("ngClass",pV(4,xVe,r.connected,r.ended,r.small,r.error)),Re(4),Ni("fill",r.color),Re(),Ni("fill",r.color),Re(2),ht("ngIf",!r.small))},dependencies:[PI,Cm],styles:[".spinner[_ngcontent-%COMP%]{background-color:#22292f;height:100vh;position:relative;transition:.3s}.spinner--connected[_ngcontent-%COMP%]   .spinner__cirle[_ngcontent-%COMP%]{border-color:#37d425}.spinner--ended[_ngcontent-%COMP%]   .spinner__cirle[_ngcontent-%COMP%]{border-color:transparent}.spinner--error[_ngcontent-%COMP%]   .spinner__cirle[_ngcontent-%COMP%]{border-color:#d73b3d}.spinner--small[_ngcontent-%COMP%]{border-radius:10px;height:200px}.spinner--small[_ngcontent-%COMP%]   .spinner__cirle[_ngcontent-%COMP%]{border-width:4px;height:80px;width:80px}.spinner--small[_ngcontent-%COMP%]   .spinner__icon[_ngcontent-%COMP%]{top:26px;transform:translate(-35%)}.spinner--small[_ngcontent-%COMP%]   .spinner__icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:32px;width:32px}.spinner__wrapper[_ngcontent-%COMP%]{left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}.spinner__cirle[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 2s linear infinite;border:5px solid #1195E6;border-radius:50%;border-top-color:transparent;height:160px;margin:auto;width:160px;transition:.3s}.spinner__icon[_ngcontent-%COMP%]{left:50%;position:absolute;top:52px;transform:translate(-40%);transition:.3s}.spinner__icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:64px;width:64px;transition:.3s}.spinner__text[_ngcontent-%COMP%]{color:#fff;font-size:1.3em;margin-top:25px;text-align:center}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"],changeDetection:0})}}return e})(),FVe=(()=>{class e{onEnter(){this.subscription.unsubscribe(),this.setStyle(1)}onLeave(){this.hide()}constructor(n,i){this.renderer=n,this.el=i,this.subscription=new Ns,this.delay=5e3}ngOnInit(){this.hide()}hide(){this.subscription.unsubscribe(),this.subscription=L1(this.delay).pipe(_a(1)).subscribe(()=>this.setStyle(0))}setStyle(n){this.renderer.setStyle(this.el.nativeElement,"opacity",n)}static{this.\u0275fac=function(i){return new(i||e)(H(ta),H(sn))}}static{this.\u0275dir=ye({type:e,selectors:[["","ngxToggle",""]],hostBindings:function(i,r){1&i&&zt("mouseenter",function(){return r.onEnter()})("mouseleave",function(){return r.onLeave()})}})}}return e})();function UVe(e,t){if(1&e&&pt(0,"ngx-spinner",15),2&e){const n=Kt().ngIf,i=Kt(2);ht("error",n.error)("text",n.statusText)("connected",n.connected)("ended",n.ended)("small",i.smallScreenEnabled)}}function VVe(e,t){1&e&&pt(0,"ngx-timer",16),2&e&&ht("started",Kt().ngIf.started)}function BVe(e,t){if(1&e&&(pt(0,"div",17),yE(1,"async")),2&e){const n=t.$implicit;wt("hidden",!1===SE(1,3,Kt(3).remoteStreamVideoToggle$)),ht("id",n)}}function jVe(e,t){if(1&e){const n=Qa();ue(0,"ngx-controls",18),zt("toggleCamera",function(r){return Gr(n),Wr(Kt(3).onToggleCamera(r))})("toggleMicrophone",function(r){return Gr(n),Wr(Kt(3).onToggleMicrophone(r))})("toggleFullScreen",function(r){return Gr(n),Wr(Kt(3).onToggleFullScreen(r))})("toggleSmallScreen",function(r){return Gr(n),Wr(Kt(3).onToggleSmallScreen(r))})("endCall",function(){return Gr(n),Wr(Kt(3).onEndCall())}),ve()}if(2&e){const n=Kt(3);ht("cameraEnabled",n.cameraEnabled)("microphoneEnabled",n.microphoneEnabled)("fullScreenEnabled",n.fullScreenEnabled)("smallScreenEnabled",n.smallScreenEnabled)("displaySmallScreen",n.displaySmallScreen)}}function HVe(e,t){if(1&e&&(ue(0,"div",2),an(1,UVe,1,5,"ngx-spinner",3)(2,VVe,1,1,"ngx-timer",4),pt(3,"div",5),an(4,BVe,2,5,"div",6),ue(5,"div",7),ys(),ue(6,"svg",8)(7,"g",9),pt(8,"path",10)(9,"path",11),ve(),ue(10,"defs")(11,"clipPath",12),pt(12,"rect",13),ve()()()(),an(13,jVe,1,5,"ngx-controls",14),ve()),2&e){const n=t.ngIf,i=Kt(2);Re(),ht("ngIf",n.loading),Re(),ht("ngIf",n.started),Re(),wt("hidden",!i.cameraEnabled||i.smallScreenEnabled),ht("id",i.localContainerId),Re(),ht("ngForOf",i.remoteCalls),Re(9),ht("ngIf",n.connected&&!n.ended)}}function GVe(e,t){if(1&e&&(ue(0,"div"),an(1,HVe,14,7,"div",1),yE(2,"async"),ve()),2&e){const n=Kt();ht("@fade",void 0)("@.disabled",!n.animate),Re(),ht("ngIf",SE(2,3,n.streamState$))}}let CQ=(()=>{class e extends T6{constructor(n,i){super(i),this.webRtcService=n,this.animate=!0,this.displaySmallScreen=!1,this.debug=!1,this.callEnd=new Wt,this.smallScreenEnabled=!1,this.active=!1,this.streamState$=this.webRtcService.streamState$,this.remoteStreamVideoToggle$=this.webRtcService.remoteStreamVideoToggle$}ngOnInit(){this.webRtcService.init(this.uid,this.channel,this.token,this.debug).pipe(_a(1)).subscribe(()=>{this.active=this.smallScreenEnabled,this.callEnd.emit(),this.closeDialog(!0)})}ngOnDestroy(){this.webRtcService.deinit()}get localContainerId(){return this.webRtcService.localContainerId}get remoteCalls(){return this.webRtcService.remoteCalls}get cameraEnabled(){return this.webRtcService.isVideoEnabled()}get microphoneEnabled(){return this.webRtcService.isAudioEnabled()}get fullScreenEnabled(){return!!document.fullscreenElement}onToggleCamera(n){this.webRtcService.toggleVideo(n)}onToggleMicrophone(n){this.webRtcService.toggleAudio(n)}onToggleFullScreen(n){this.webRtcService.toggleFullScreen(n)}onToggleSmallScreen(n){this.smallScreenEnabled=!n,this.active=!0}onEndCall(){this.webRtcService.endCall()}static{this.\u0275fac=function(i){return new(i||e)(H(SQ),H(ws))}}static{this.\u0275cmp=sr({type:e,selectors:[["ngx-webrtc"]],hostVars:4,hostBindings:function(i,r){2&i&&wt("small-screen",r.smallScreenEnabled)("active",r.active)},inputs:{uid:"uid",token:"token",channel:"channel",animate:"animate",displaySmallScreen:"displaySmallScreen",debug:"debug"},outputs:{callEnd:"callEnd"},features:[Pt],decls:1,vars:1,consts:[[4,"ngIf"],["class","container",4,"ngIf"],[1,"container"],[3,"error","text","connected","ended","small",4,"ngIf"],[3,"started",4,"ngIf"],[1,"container__local",3,"id"],["class","container__remote",3,"id","hidden",4,"ngFor","ngForOf"],[1,"container__user-icon"],["viewBox","0 0 64 64","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","user","clip-path","url(#clip0)"],["id","Vector","d","M31.5439 30.829C35.7793 30.829 39.4468 29.3099 42.4434 26.3129C45.4399 23.3163 46.959 19.6498 46.959 15.414C46.959 11.1796 45.4399 7.51267 42.4429 4.51512C39.4458 1.51904 35.7788 0 31.5439 0C27.3081 0 23.6416 1.51904 20.645 4.51561C17.6484 7.51218 16.1289 11.1792 16.1289 15.414C16.1289 19.6498 17.6484 23.3168 20.6455 26.3134C23.6426 29.3095 27.3096 30.829 31.5439 30.829V30.829Z","fill","#0B73C9"],["id","Vector_2","d","M58.5161 49.2127C58.4297 47.9656 58.2549 46.6053 57.9976 45.1688C57.7378 43.7215 57.4033 42.3533 57.0029 41.1029C56.5894 39.8104 56.0269 38.534 55.3315 37.3109C54.6099 36.0414 53.7622 34.9359 52.811 34.0262C51.8164 33.0746 50.5986 32.3094 49.1904 31.7513C47.7871 31.1962 46.2319 30.9149 44.5684 30.9149C43.915 30.9149 43.2832 31.183 42.063 31.9774C41.312 32.4672 40.4336 33.0336 39.4531 33.66C38.6147 34.1942 37.479 34.6947 36.0762 35.1478C34.7075 35.5907 33.3179 35.8153 31.9463 35.8153C30.5747 35.8153 29.1855 35.5907 27.8154 35.1478C26.4141 34.6952 25.2783 34.1947 24.4409 33.6605C23.4697 33.0399 22.5908 32.4735 21.8286 31.9769C20.6099 31.1825 19.9775 30.9144 19.3242 30.9144C17.6602 30.9144 16.1055 31.1962 14.7026 31.7518C13.2954 32.309 12.0771 33.0741 11.0815 34.0267C10.1309 34.9369 9.28271 36.0419 8.56201 37.3109C7.86719 38.534 7.30469 39.8099 6.89062 41.1034C6.49072 42.3538 6.15625 43.7215 5.89648 45.1688C5.63916 46.6033 5.46436 47.9642 5.37793 49.2142C5.29297 50.4388 5.25 51.7098 5.25 52.9934C5.25 56.3343 6.31201 59.0388 8.40625 61.0335C10.4746 63.0017 13.2114 64.0002 16.5396 64.0002H47.356C50.6841 64.0002 53.4199 63.0022 55.4888 61.0335C57.5835 59.0403 58.6455 56.3352 58.6455 52.993C58.645 51.7034 58.6016 50.4314 58.5161 49.2127V49.2127Z","fill","#0B73C9"],["id","clip0"],["width","64","height","64","fill","#0B73C9"],["ngxToggle","",3,"cameraEnabled","microphoneEnabled","fullScreenEnabled","smallScreenEnabled","displaySmallScreen","toggleCamera","toggleMicrophone","toggleFullScreen","toggleSmallScreen","endCall",4,"ngIf"],[3,"error","text","connected","ended","small"],[3,"started"],[1,"container__remote",3,"id"],["ngxToggle","",3,"toggleCamera","toggleMicrophone","toggleFullScreen","toggleSmallScreen","endCall","cameraEnabled","microphoneEnabled","fullScreenEnabled","smallScreenEnabled","displaySmallScreen"]],template:function(i,r){1&i&&an(0,GVe,3,5,"div",0),2&i&&ht("ngIf",r.shown)},dependencies:[qB,Cm,PVe,MVe,LVe,FVe,kI],styles:["ngx-timer[_ngcontent-%COMP%]{display:block;padding-top:25px}[_nghost-%COMP%]{bottom:0;max-width:100%;right:0;width:100%;transition:.3s}.active[_nghost-%COMP%]{position:fixed}.small-screen[_nghost-%COMP%]{max-width:210px}.small-screen[_nghost-%COMP%]   ngx-timer[_ngcontent-%COMP%]{padding-top:10px}.small-screen[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{border-radius:10px;box-shadow:#00000059 0 5px 15px;height:200px;max-width:200px;margin-right:10px;margin-bottom:10px}.small-screen[_nghost-%COMP%]   .container__remote[_ngcontent-%COMP%]{border-radius:10px;height:200px;width:200px}.small-screen[_nghost-%COMP%]   .container__remote[_ngcontent-%COMP%]    >div{border-radius:10px}.small-screen[_nghost-%COMP%]   .container__user-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:32px;width:32px}.container[_ngcontent-%COMP%]{background-color:#22292f;height:100vh;max-width:100%;margin-left:auto;overflow:hidden;position:relative;transition:.3s}.container__local[_ngcontent-%COMP%]{border-radius:5px;height:20vh;opacity:1;overflow:hidden;position:absolute;right:1rem;top:1rem;width:20vw;z-index:1;transition:.3s}.container__local.hidden[_ngcontent-%COMP%]{opacity:0;visibility:hidden}.container__local[_ngcontent-%COMP%]:not(:empty){box-shadow:0 3px 8px #00000080}.container__remote[_ngcontent-%COMP%]{background-color:#22292f;height:100vh;left:0;position:absolute;top:0;width:100vw;transition:.3s}.container__remote[_ngcontent-%COMP%]    >div{transition:.3s}.container__remote.hidden[_ngcontent-%COMP%]{display:none}.container__remote.hidden[_ngcontent-%COMP%] + .container__user-icon[_ngcontent-%COMP%]{display:block}.container__remote[_ngcontent-%COMP%]:empty{display:none}.container__user-icon[_ngcontent-%COMP%]{background:#0000004d;border-radius:50%;box-shadow:0 3px 8px #00000080;display:none;left:50%;padding:20px;position:absolute;top:50%;transform:translate(-50%,-50%)}.container__user-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:64px;width:64px}@media screen and (max-width: 769px){ngx-controls[_ngcontent-%COMP%]{opacity:1!important}}"],data:{animation:[w6]},changeDetection:0})}}return e})();function U1(e,t,n=1/0){return Ti(t)?U1((i,r)=>F1((o,s)=>t(i,o,r,s))(bd(e(i,r))),n):("number"==typeof t&&(n=t),Qc((i,r)=>function WVe(e,t,n,i,r,o,s,a){const c=[];let l=0,d=0,u=!1;const h=()=>{u&&!c.length&&!l&&t.complete()},p=f=>l<i?m(f):c.push(f),m=f=>{o&&t.next(f),l++;let g=!1;bd(n(f,d++)).subscribe(lc(t,E=>{r?.(E),o?p(E):t.next(E)},()=>{g=!0},void 0,()=>{if(g)try{for(l--;c.length&&l<i;){const E=c.shift();s?Jc(t,s,()=>m(E)):m(E)}h()}catch(E){t.error(E)}}))};return e.subscribe(lc(t,p,()=>{u=!0,h()})),()=>{a?.()}}(i,r,e,n)))}function TQ(e,t){return t?n=>function qVe(...e){return function KVe(){return function zVe(e=1/0){return U1(eD,e)}(1)}()(S6(e,r6(e)))}(t.pipe(_a(1),function YVe(){return Qc((e,t)=>{e.subscribe(lc(t,qA))})}()),n.pipe(TQ(e))):U1((n,i)=>bd(e(n,i)).pipe(_a(1),function $Ve(e){return F1(()=>e)}(n)))}let ZVe=(()=>{class e{constructor(n,i,r,o){this.document=n,this.componentFactoryResolver=i,this.appRef=r,this.injector=o,this.wrapperSelector="ngx-webrtc-wrapper"}open(n,i={}){return this.appendComponent(n,i)}appendComponent(n,i){const r=this.componentFactoryResolver.resolveComponentFactory(n).create(this.injector),{instance:o}=r;Object.keys(i).forEach(a=>o[a]=i[a]),this.appRef.attachView(r.hostView);const s=r.hostView.rootNodes[0];return this.getContainer().append(s),o.afterClosed.pipe(_a(1),function XVe(e,t=x1){const n=k1(e,t);return TQ(()=>n)}(250)).subscribe(()=>{this.appRef.detachView(r.hostView),r.destroy()}),o}getContainer(){let n=this.document.querySelector(`.${this.wrapperSelector}`);return n||(n=this.document.createElement("div"),n.setAttribute("class",this.wrapperSelector),n.setAttribute("style","position: fixed; top: 0; width: 100%; z-index: 1;"),this.document.body.appendChild(n)),n}static{this.\u0275fac=function(i){return new(i||e)(Z(Ut),Z(Fu),Z(aa),Z(Bi))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),JVe=(()=>{class e{constructor(n){this.dialog=n}open(n){const i=new dg,r=this.dialog.open(jTe,{data:n});return r.afterClosed.asObservable().pipe(function xTe(e,t){return Qc((n,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();n.subscribe(lc(i,c=>{r?.unsubscribe();let l=0;const d=o++;bd(e(c,d)).subscribe(r=lc(i,u=>i.next(t?t(c,u,d,l++):u),()=>{r=null,a()}))},()=>{s=!0,a()}))})}(o=>o?.channel?this.dialog.open(CQ,{uid:o.uid,token:o.token,channel:o.channel,debug:!!o.debug,displaySmallScreen:!0}).afterClosed.asObservable():function MTe(...e){return S6(e,r6(e))}(!1)),_a(1),function LTe(e,t,n){const i=Ti(e)||t||n?{next:e,error:t,complete:n}:e;return i?Qc((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe(lc(o,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),o.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),o.complete()},c=>{var l;a=!1,null===(l=i.error)||void 0===l||l.call(i,c),o.error(c)},()=>{var c,l;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):eD}(()=>i.next(!0))).subscribe(),{acceptCall:r.onAcceptCall.bind(r),close:r.closeDialog.bind(r),afterConfirmation:()=>r.afterClosed.asObservable().pipe(_a(1)),afterCallEnd:()=>i.asObservable().pipe(_a(1))}}static{this.\u0275fac=function(i){return new(i||e)(Z(ZVe))}}static{this.\u0275prov=ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),QVe=(()=>{class e{constructor(n,i,r,o,s){this.formBuilder=n,this.router=i,this.localStorage=r,this.videoCallDialogService=o,this.cdr=s,this.sessionKey="ngx-webrtc:channelId",this.outcome=!1}get channelId(){return this.localStorage.getItem(this.sessionKey)||"test-channel-ngx-webrtc"}get tooltipText(){return this.outcome?"Outcome":"Income"}ngOnInit(){this.form=this.formBuilder.group({channelId:[this.channelId,$3.required]})}onSubmit(){this.saveChannel(),this.router.navigate(["conference"],{queryParams:{...this.form.value}})}onModalOpen(){this.saveChannel(),this.dialog=this.videoCallDialogService.open({uid:String(Math.floor(100*Math.random())),channel:this.channelId,outcome:this.outcome,user:{name:"Test User",photoURL:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTvDtoEwuV9E2kHqNDi6MnBzXlefn8TfyrwgQ&usqp=CAU"},debug:!0});const n=setTimeout(()=>this.dialog?.close(),7e3);this.dialog.afterConfirmation().pipe(Yr(i=>!!i),er(()=>clearTimeout(n))).subscribe(),this.dialog.afterCallEnd().subscribe(()=>{clearTimeout(n),this.dialog=null,this.cdr.markForCheck()})}saveChannel(){const{channelId:n}=this.form.value;this.localStorage.setItem(this.sessionKey,n)}static{this.\u0275fac=function(i){return new(i||e)(H(Pme),H(yo),H(Storage),H(JVe),H(ws))}}static{this.\u0275cmp=sr({type:e,selectors:[["app-home"]],decls:25,vars:8,consts:[[1,"home"],[1,"home__welcome"],[1,"home__form",3,"ngSubmit","formGroup"],[1,"home__wrapper","home__wrapper--center"],["src","assets/user.svg","alt","User",1,"user"],[1,"home__title"],["appearance","outline",1,"home__wrapper"],["matInput","","placeholder","Channel id","formControlName","channelId"],[1,"home__wrapper","home__wrapper--center","home__wrapper--buttons"],["mat-flat-button","","color","primary",1,"home__btn",3,"disabled"],["mat-raised-button","","type","button",1,"home__btn",3,"click","disabled"],[3,"change","click","checked","disabled","matTooltip"],[1,"home__footer"],["href","https://www.npmjs.com/package/ngx-webrtc-lib","target","_blank"],["viewBox","0 0 27.23 27.23"],["width","27.23","height","27.23","rx","2"],["fill","#fff","points","5.8 21.75 13.66 21.75 13.67 9.98 17.59 9.98 17.58 21.76 21.51 21.76 21.52 6.06 5.82 6.04 5.8 21.75"],["href","https://github.com/TarasMoskovych/ngx-webrtc","target","_blank"],["aria-hidden","true","role","img","viewBox","0 0 16 16","width","50","height","50",1,""],["fill-rule","evenodd","d","M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"]],template:function(i,r){1&i&&(ue(0,"div",0)(1,"div",1)(2,"form",2),zt("ngSubmit",function(){return!r.dialog&&r.onSubmit()}),ue(3,"div",3),pt(4,"img",4),ve(),ue(5,"h1",5),fr(6," Welcome "),ve(),ue(7,"mat-form-field",6)(8,"mat-label"),fr(9,"Channel Id"),ve(),pt(10,"input",7),ve(),ue(11,"div",8)(12,"button",9),fr(13,"Start / Join call"),ve(),ue(14,"button",10),zt("click",function(){return!r.dialog&&r.onModalOpen()}),fr(15,"Open Call Dialog "),ue(16,"mat-slide-toggle",11),zt("change",function(s){return r.outcome=s.checked})("click",function(s){return s.stopPropagation()}),ve()()()(),ue(17,"div",12)(18,"a",13),ys(),ue(19,"svg",14),pt(20,"rect",15)(21,"polygon",16),ve()(),Pc(),ue(22,"a",17),ys(),ue(23,"svg",18),pt(24,"path",19),ve()()()()()),2&i&&(Re(2),ht("formGroup",r.form),Re(5),wt("mat-focused",r.form.valid),Re(5),ht("disabled",r.form.invalid||!!r.dialog),Re(2),ht("disabled",r.form.invalid||!!r.dialog),Re(2),ht("checked",r.outcome)("disabled",!!r.dialog)("matTooltip",r.tooltipText))},dependencies:[Mj,ZE,vj,Ej,km,fR,ove,tve,FR,s_e,gEe,UR],styles:[".home[_ngcontent-%COMP%]{align-items:center;background-color:#f2f2f2;display:flex;flex-wrap:wrap;justify-content:center;min-height:100vh;width:100%}.home__welcome[_ngcontent-%COMP%]{background:#fff;border-radius:10px;box-shadow:0 5px 10px #0000001a;overflow:hidden;padding:10px 35px;width:390px}.home__welcome[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]{height:150px}.home__title[_ngcontent-%COMP%]{color:#333;display:block;font-size:30px;font-weight:500;margin:10px 0 60px;text-align:center}.home__wrapper[_ngcontent-%COMP%]{width:100%}.home__wrapper--center[_ngcontent-%COMP%]{text-align:center}.home__wrapper--buttons[_ngcontent-%COMP%]{align-items:center;display:flex}.home__btn[_ngcontent-%COMP%]{letter-spacing:normal}.home__btn[_ngcontent-%COMP%]:first-of-type{margin-right:5px}.home__btn[_ngcontent-%COMP%]:last-of-type{margin-left:5px}.home__footer[_ngcontent-%COMP%]{margin-top:30px;text-align:center}.home__footer[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#333;cursor:pointer;height:24px;margin:0 5px;width:24px;transition:.3s}.home__footer[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover{fill:#aaa}"],changeDetection:0})}}return e})(),eBe=(()=>{class e{constructor(n,i){this.route=n,this.router=i,this.uid=String(Math.floor(100*Math.random()))}ngOnInit(){this.channel=this.route.snapshot.queryParams.channelId||"test-channel"}onCallEnd(){this.router.navigateByUrl("/")}static{this.\u0275fac=function(i){return new(i||e)(H(_d),H(yo))}}static{this.\u0275cmp=sr({type:e,selectors:[["app-conference"]],decls:1,vars:4,consts:[[3,"callEnd","animate","channel","debug","uid"]],template:function(i,r){1&i&&(ue(0,"ngx-webrtc",0),zt("callEnd",function(){return r.onCallEnd()}),ve()),2&i&&ht("animate",!1)("channel",r.channel)("debug",!0)("uid",r.uid)},dependencies:[CQ],changeDetection:0})}}return e})(),tBe=(()=>{class e{static forRoot(n){return{ngModule:e,providers:[SQ,{provide:"AgoraConfig",useValue:n}]}}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e})}static{this.\u0275inj=In({imports:[qE]})}}return e})();const nBe=[{path:"",component:QVe},{path:"conference",component:eBe},{path:"**",redirectTo:""}];let iBe=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=xn({type:e,bootstrap:[xCe]})}static{this.\u0275inj=In({providers:[{provide:Storage,useValue:window.localStorage}],imports:[S3,aye,tBe.forRoot(YH_configs),Mme,RCe.forRoot(nBe),sve,c_e,vEe,mve]})}}return e})();Upe().bootstrapModule(iBe).catch(e=>console.error(e))}},Qp=>{Qp(Qp.s=33)}]);